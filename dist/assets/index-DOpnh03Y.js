import{j as a,S as df,P as nt,c as _a,a as vc,u as ba,b as ke,d as Mt,e as In,f as Za,g as wr,h as wc,i as _r,k as bc,l as On,A as yc,m as uf,R as hf,n as ff,F as mf,D as Nc,C as jc,o as xf,p as gf,q as no,r as Ec,s as pf,t as vf,O as _c,v as wf,w as Sc,x as bf,T as Cc,y as Tc,z as yf,B as Nf,E as jf,G as Ef,H as Ac,I as _f,J as Rc,K as Fc,L as Sf,M as kc,V as Cf,N as Dc,Q as Pc,U as Tf,W as Af,X as Ic,Y as Rf,Z as Ff,_ as kf,$ as Df}from"./ui-tOAqJEC6.js";import{a as Pf,r as p,b as If}from"./vendor-Bx6gLRgA.js";import{u as nr,a as Oc,b as Of,c as Mn,N as aa,R as Mf,d as Et,B as Lf}from"./router-J2zmkQgy.js";import{c as Mc,_ as Bf}from"./supabase-D-oiTZwa.js";import{c as Lc,t as Uf,W as sl,A as oa,R as ot,L as Mr,H as Bc,C as ys,a as Uc,b as Di,S as $c,M as zc,P as un,d as $f,e as Vc,f as nl,G as zf,g as Xr,h as Dt,i as Ns,E as la,j as Pt,K as Vf,k as at,l as Hr,X as ar,m as hn,I as js,n as Hf,D as jr,U as Es,o as Pi,p as Wf,q as Hc,r as ln,s as ya,B as $a,u as Ii,F as Wc,v as qf,w as io,x as qc,y as oo,z as lo,J as Gf,N as Oi,O as il,Q as Gc,T as Xf,V as Xa,Y as Kf,Z as Yf,_ as Jf,$ as fn,a0 as _s,a1 as Ka,a2 as Qf,a3 as va,a4 as Kr,a5 as Xc,a6 as Ss,a7 as sa,a8 as za,a9 as Zf,aa as Mi,ab as ol,ac as mn,ad as em,ae as tm,af as rm,ag as ll,ah as am,ai as sm,aj as cl,ak as nm,al as dl,am as di,an as ul,ao as hl}from"./utils-BJObPDh-.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function r(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerPolicy&&(i.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?i.credentials="include":n.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(n){if(n.ep)return;n.ep=!0;const i=r(n);fetch(n.href,i)}})();var Li={},fl=Pf;Li.createRoot=fl.createRoot,Li.hydrateRoot=fl.hydrateRoot;const Kc="https://mywaoaofatgwbbtyqfpd.supabase.co",im="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im15d2FvYW9mYXRnd2JidHlxZnBkIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTg2MDAzMjQsImV4cCI6MjA3NDE3NjMyNH0._9AMjjkQnDam-ciD9r07X4IpiWG2Hl0jBrFcY-v61Wg",om="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im15d2FvYW9mYXRnd2JidHlxZnBkIiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTc1ODYwMDMyNCwiZXhwIjoyMDc0MTc2MzI0fQ.oUhs-CNusuqxKFIwjc1zv0Nh4TJ6opnmzt8_V1Lfq7U";let ui=null,hi=null;const lm={auth:{autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,storage:typeof window<"u"?window.localStorage:void 0,flowType:"pkce",debug:!1},global:{headers:{"Cache-Control":"no-store, max-age=0, must-revalidate"}}},Ce=(ui||(ui=Mc(Kc,im,lm)),ui),ct=(hi||(hi=Mc(Kc,om,{auth:{autoRefreshToken:!1,persistSession:!1,detectSessionInUrl:!1}})),hi),cm=["123456","password","123456789","12345678","12345","1234567","1234567890","qwerty","abc123","password123","admin","letmein","welcome","monkey","1234","dragon","master","hello","login","pass","123","qwerty123","senha","123456789","admin123","password1","root","toor","user","guest","test","demo"],Pa={lowercase:/[a-z]/,uppercase:/[A-Z]/,numbers:/[0-9]/,symbols:/[!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?]/,sequential:/(012|123|234|345|456|567|678|789|890|abc|bcd|cde|def|efg|fgh|ghi|hij|ijk|jkl|klm|lmn|mno|nop|opq|pqr|qrs|rst|stu|tuv|uvw|vwx|wxy|xyz)/i,repeated:/(.)\1{2,}/};function es(e){const t=[],r=[];let s=0;e.length<8?(t.push("A senha deve ter pelo menos 8 caracteres"),r.push("Adicione mais caracteres para aumentar a segurança")):e.length>=12?s+=25:s+=15,cm.includes(e.toLowerCase())&&(t.push("Esta senha é muito comum e fácil de adivinhar"),r.push("Use uma senha única e personalizada"),s-=30),Pa.sequential.test(e)&&(t.push("Evite sequências óbvias (123, abc, etc.)"),r.push("Use caracteres aleatórios"),s-=20),Pa.repeated.test(e)&&(t.push("Evite caracteres repetidos em sequência"),r.push("Varie os caracteres da senha"),s-=15),Pa.lowercase.test(e)?s+=10:t.push("Adicione letras minúsculas"),Pa.uppercase.test(e)?s+=10:t.push("Adicione letras maiúsculas"),Pa.numbers.test(e)?s+=10:t.push("Adicione números"),Pa.symbols.test(e)?s+=15:r.push("Considere adicionar símbolos especiais (!@#$%^&*)");const n=new Set(e).size;return n>=8?s+=15:n>=5?s+=10:r.push("Use uma maior variedade de caracteres"),s=Math.max(0,Math.min(100,s)),{isValid:t.length===0&&s>=60,score:s,errors:t,suggestions:r}}function Yc(e){const t=es(e);let r="Muito Fraca",s="red";return t.score>=80?(r="Muito Forte",s="green"):t.score>=65?(r="Boa",s="lightgreen"):t.score>=50?(r="Regular",s="yellow"):t.score>=30&&(r="Fraca",s="orange"),{score:t.score,label:r,color:s}}function xn(e,t){return e===t}function Jc(e){return es(e).isValid}async function dm(e){try{const{data:t,error:r}=await Ce.from("users").select("email").eq("email",e).single();return!r&&!!t}catch{return!1}}async function um({email:e,password:t}){var r,s,n;try{const{data:i,error:o}=await Ce.auth.signInWithPassword({email:e,password:t});if(o)throw console.error("Erro de autenticação:",o.message),o.message.includes("Email not confirmed")||o.message.includes("email_not_confirmed")||o.message.includes("Invalid login credentials")&&await dm(e)?new Error("CONFIRM_EMAIL"):new Error(o.message);if(!i.user)throw new Error("Usuário não encontrado");let l=null;try{const{data:d,error:c}=await Ce.from("users").select("*").eq("id",i.user.id).single();!c&&d&&(l=d)}catch(d){console.log("Erro ao buscar usuário na tabela, usando dados do Auth:",d)}return l?{id:l.id,email:l.email,name:l.name,role:l.role}:(console.log("Usuário não encontrado na tabela users, usando dados do Auth"),{id:i.user.id,email:i.user.email||"",name:((r=i.user.user_metadata)==null?void 0:r.full_name)||((s=i.user.email)==null?void 0:s.split("@")[0])||"Usuário",role:((n=i.user.user_metadata)==null?void 0:n.role)||"RH"})}catch(i){throw console.error("Erro no login:",i),i}}async function hm(e){try{return await fm(e)}catch(t){throw console.error("Erro ao criar usuário:",t),t}}async function fm(e){try{const{data:t,error:r}=await Ce.auth.signUp({email:e.email,password:e.password,options:{data:{full_name:e.name,role:e.role}}});if(r)throw console.error("Erro ao criar usuário no Auth:",r),new Error(r.message);if(!t.user)throw new Error("Erro ao criar usuário no Auth");const{data:s,error:n}=await Ce.from("users").insert({id:t.user.id,email:e.email,name:e.name,role:e.role,password_hash:""}).select().single();if(n)throw console.error("Erro ao criar usuário na tabela:",n),new Error(n.message);return s}catch(t){throw console.error("Erro no método alternativo:",t),t}}async function Bi(){try{const{data:e,error:t}=await Ce.from("users").select("*").order("created_at",{ascending:!1});if(t)throw console.error("Erro ao buscar usuários:",t),new Error(t.message);return e||[]}catch(e){throw console.error("Erro ao listar usuários:",e),e}}async function mm(e,t){try{const r={};t.name&&(r.name=t.name),t.email&&(r.email=t.email),t.role&&(r.role=t.role);const{data:s,error:n}=await Ce.from("users").update(r).eq("id",e).select().single();if(n)throw console.error("Erro ao atualizar usuário:",n),new Error(n.message);return s}catch(r){throw console.error("Erro ao atualizar usuário:",r),r}}async function xm(e){try{const{error:r}=await Ce.from("users").delete().eq("id",e);if(r)throw console.error("Erro ao excluir usuário da tabela:",r),new Error(r.message);return!0}catch(t){throw console.error("Erro ao excluir usuário:",t),t}}async function gm(e,t){var r,s;try{const{data:n,error:i}=await Ce.from("users").select("email, name").eq("id",e).single();if(i||!n)throw new Error("Usuário não encontrado na base de dados");const o="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im15d2FvYW9mYXRnd2JidHlxZnBkIiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTc1ODYwMDMyNCwiZXhwIjoyMDc0MTc2MzI0fQ.oUhs-CNusuqxKFIwjc1zv0Nh4TJ6opnmzt8_V1Lfq7U";if(o&&o!=="your_supabase_service_role_key_here")try{const{data:d,error:c}=await ct.auth.admin.listUsers();if(c)throw console.error("Erro ao listar usuários do Auth:",c),new Error("Erro ao acessar sistema de autenticação");const u=(r=d.users)==null?void 0:r.find(h=>h.email===n.email);if(u){console.log("Usuário encontrado no Auth, redefinindo senha...");const{error:h}=await ct.auth.admin.updateUserById(u.id,{password:t});if(h)throw console.error("Erro ao redefinir senha:",h),new Error(`Erro ao redefinir senha: ${h.message}`);return console.log("✅ Senha redefinida com sucesso"),!0}else{console.log("Usuário não existe no Supabase Auth, criando...");const{data:h,error:f}=await ct.auth.admin.createUser({email:n.email,password:t,email_confirm:!0,user_metadata:{full_name:n.name,role:"RH"}});if(f){if(console.error("Erro ao criar usuário no Auth:",f),f.message.includes("already been registered")){console.log("Email já existe no Auth, tentando redefinir senha...");const m=(s=d.users)==null?void 0:s.find(v=>v.email===n.email);if(m){const{error:v}=await ct.auth.admin.updateUserById(m.id,{password:t});if(v)throw new Error(`Erro ao redefinir senha: ${v.message}`);return console.log("✅ Senha redefinida com sucesso (usuário existente)"),!0}}throw new Error(`Erro ao criar usuário no sistema de autenticação: ${f.message}`)}return console.log("✅ Usuário criado no Supabase Auth com sucesso"),!0}}catch(d){throw console.error("Erro no processo de autenticação:",d),new Error(d.message)}}catch(n){throw console.error("Erro ao redefinir senha:",n),n}}async function Qc(){try{Ce.auth.signOut().catch(e=>{console.warn("Erro ao fazer logout (não crítico):",e)}),typeof window<"u"&&(localStorage.removeItem("supabase.auth.token"),Object.keys(localStorage).forEach(e=>{e.startsWith("sb-")&&e.includes("auth-token")&&localStorage.removeItem(e)}),sessionStorage.clear(),"caches"in window&&caches.keys().then(e=>{e.forEach(t=>{(t.includes("supabase")||t.includes("auth"))&&caches.delete(t)})}).catch(()=>{}))}catch(e){console.warn("Erro durante logout (não crítico):",e)}}async function pm(e){try{if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e))return{success:!1,message:"Por favor, insira um email válido"};const r="http://localhost:3000",{error:s}=await Ce.auth.resetPasswordForEmail(e,{redirectTo:`${r}/reset-password`});return s?(console.error("Erro ao enviar email de recuperação:",s),s.message.includes("rate limit")?{success:!1,message:"Muitas tentativas. Aguarde alguns minutos antes de tentar novamente."}:s.message.includes("not found")?{success:!0,message:"Se o email estiver cadastrado, você receberá um link de recuperação em alguns minutos."}:{success:!1,message:"Erro ao enviar email de recuperação. Tente novamente."}):{success:!0,message:"Se o email estiver cadastrado, você receberá um link de recuperação em alguns minutos."}}catch(t){return console.error("Erro inesperado ao enviar email de recuperação:",t),{success:!1,message:"Erro inesperado. Tente novamente mais tarde."}}}async function vm(e){try{if(!Jc(e))return{success:!1,message:`Senha muito fraca. ${es(e).errors.join(", ")}`};const{error:t}=await Ce.auth.updateUser({password:e});return t?(console.error("Erro ao atualizar senha:",t),t.message.includes("same")?{success:!1,message:"A nova senha deve ser diferente da senha atual."}:{success:!1,message:"Erro ao atualizar senha. Tente novamente."}):{success:!0,message:"Senha atualizada com sucesso!"}}catch(t){return console.error("Erro inesperado ao atualizar senha:",t),{success:!1,message:"Erro inesperado. Tente novamente mais tarde."}}}async function wm(e){try{if(!Jc(e))return{success:!1,message:`Senha muito fraca. ${es(e).errors.join(", ")}`};const{error:t}=await Ce.auth.updateUser({password:e});return t?(console.error("Erro ao redefinir senha:",t),t.message.includes("session")?{success:!1,message:"Link de recuperação expirado ou inválido. Solicite um novo link."}:{success:!1,message:"Erro ao redefinir senha. Tente novamente."}):{success:!0,message:"Senha redefinida com sucesso! Você será redirecionado para o login."}}catch(t){return console.error("Erro inesperado ao redefinir senha:",t),{success:!1,message:"Erro inesperado. Tente novamente mais tarde."}}}async function bm(){try{const{data:{session:e}}=await Ce.auth.getSession();return e!=null&&e.user&&e.access_token&&window.location.pathname==="/reset-password"?(console.log("Sessão de recuperação válida detectada"),!0):!1}catch(e){return console.error("Erro ao verificar sessão de recuperação:",e),!1}}async function ym(e){try{const{data:{user:t}}=await Ce.auth.getUser();if(!(t!=null&&t.email))return{success:!1,message:"Usuário não encontrado."};const{error:r}=await Ce.auth.signInWithPassword({email:t.email,password:e});return r?r.message.includes("Invalid login credentials")?{success:!1,message:"Senha atual incorreta."}:{success:!1,message:"Erro ao validar senha atual. Tente novamente."}:{success:!0,message:"Senha atual válida."}}catch(t){return console.error("Erro ao validar senha atual:",t),{success:!1,message:"Erro inesperado. Tente novamente mais tarde."}}}async function Nm(){try{await Qc(),setTimeout(()=>{window.location.href="/login"},1e3)}catch(e){console.error("Erro durante logout:",e),window.location.href="/login"}}const Or="1.0.6";new Date().toISOString();const Zc="repositoriodevagas_current_version",Ui="repositoriodevagas_last_check",Ln=()=>{try{return localStorage.getItem(Zc)}catch{return null}},co=e=>{try{localStorage.setItem(Zc,e),localStorage.setItem(Ui,new Date().toISOString())}catch(t){console.warn("Não foi possível armazenar a versão:",t)}},Bn=async()=>{try{const e=Date.now(),t=await fetch(`/version.json?t=${e}`,{method:"GET",cache:"no-store",headers:{"Cache-Control":"no-store, no-cache, must-revalidate, proxy-revalidate",Pragma:"no-cache",Expires:"0"}});if(!t.ok)throw new Error(`HTTP ${t.status}: ${t.statusText}`);const r=await t.json();if(!r.version)throw new Error("Versão não encontrada na resposta do servidor");return console.log("📦 Versão do servidor:",r.version,"| Versão local:",Or),r}catch(e){return console.error("❌ Erro ao buscar versão do servidor:",e),null}},ed=async()=>{try{console.log("🔍 Verificando atualizações...");const e=localStorage.getItem(Ui);if(e){const n=new Date(e).getTime();if(Date.now()-n<5*60*1e3)return console.log("⏰ Verificação muito recente, pulando..."),!1}const t=await Bn();if(!t)return console.log("⚠️ Não foi possível obter versão do servidor"),!1;const r=Ln();if(!r)return console.log("📝 Primeira verificação, armazenando versão atual"),co(Or),!1;const s=t.version!==Or;return console.log("🔄 Comparação de versões:"),console.log(`   APP_VERSION atual: ${Or}`),console.log(`   Servidor: ${t.version}`),console.log(`   Armazenada: ${r}`),console.log(`   Nova versão disponível: ${s?"✅ SIM":"❌ NÃO"}`),localStorage.setItem(Ui,new Date().toISOString()),s}catch(e){return console.error("❌ Erro ao verificar atualizações:",e),!1}},td=()=>{console.log("🔄 Forçando reload da aplicação..."),Bn().then(e=>{e&&(co(e.version),console.log("✅ Versão atualizada no localStorage para:",e.version),"caches"in window&&caches.keys().then(t=>{t.forEach(r=>{caches.delete(r)}),console.log("🗑️ Cache limpo para nova versão")}))}).catch(e=>{console.warn("⚠️ Não foi possível atualizar versão antes do reload:",e)}).finally(()=>{setTimeout(()=>{window.location.reload()},100)})},jm=()=>{try{const e=Ln();e?console.log("📋 Versão armazenada:",e,"| Versão atual:",Or):(co(Or),console.log("🚀 Sistema de versão inicializado com versão:",Or))}catch(e){console.warn("⚠️ Erro ao inicializar sistema de versão:",e)}};class Ba{constructor(){this.SESSION_KEY="sb-mywaoaofatgwbbtyqfpd-auth-token",this.BACKUP_KEY="repovagas-session-backup",this.MAX_AGE=7*24*60*60*1e3}static getInstance(){return Ba.instance||(Ba.instance=new Ba),Ba.instance}saveSession(t){try{if(typeof window>"u"||!window.localStorage){console.log("⚠️ localStorage não disponível para salvar sessão");return}const r={...t,created_at:Date.now(),expires_at:t.expires_at||Date.now()+this.MAX_AGE};localStorage.setItem(this.SESSION_KEY,JSON.stringify(r)),localStorage.setItem(this.BACKUP_KEY,JSON.stringify(r)),console.log("💾 Sessão salva no cache local")}catch(r){console.warn("⚠️ Erro ao salvar sessão no cache:",r)}}getSession(){try{if(typeof window>"u"||!window.localStorage)return console.log("⚠️ localStorage não disponível"),null;let t=this.getSessionFromKey(this.SESSION_KEY);return t||(t=this.getSessionFromKey(this.BACKUP_KEY)),t?this.isSessionValid(t)?(console.log("✅ Sessão válida encontrada no cache"),t):(console.log("⏰ Sessão expirada, mas mantendo para evitar deslogamento"),t):null}catch(t){return console.warn("⚠️ Erro ao recuperar sessão do cache:",t),null}}isSessionValid(t){if(!t)return!1;const r=Date.now(),s=t.expires_at||t.created_at+this.MAX_AGE,n=24*60*60*1e3,i=r<s+n;return i||console.log("⏰ Sessão expirada:",{now:new Date(r).toISOString(),expiresAt:new Date(s).toISOString(),gracePeriod:n/(60*60*1e3)+"h"}),i}clearSession(){try{localStorage.removeItem(this.SESSION_KEY),localStorage.removeItem(this.BACKUP_KEY),console.log("🗑️ Sessão removida do cache")}catch(t){console.warn("⚠️ Erro ao limpar sessão do cache:",t)}}hasValidSession(){const t=this.getSession();return t!==null&&this.isSessionValid(t)}getSessionForce(){try{if(typeof window>"u"||!window.localStorage)return console.log("⚠️ localStorage não disponível"),null;let t=this.getSessionFromKey(this.SESSION_KEY);return t||(t=this.getSessionFromKey(this.BACKUP_KEY)),t?(console.log("🔍 Sessão encontrada (forçada) no cache - mantendo usuário logado"),t):null}catch(t){return console.warn("⚠️ Erro ao recuperar sessão forçada do cache:",t),null}}getSessionAlways(){try{if(typeof window>"u"||!window.localStorage)return console.log("⚠️ localStorage não disponível"),null;let t=this.getSessionFromKey(this.SESSION_KEY);return t||(t=this.getSessionFromKey(this.BACKUP_KEY)),t?(console.log("🔍 Sessão encontrada (sempre) no cache - SEMPRE mantendo usuário logado"),t):null}catch(t){return console.warn("⚠️ Erro ao recuperar sessão sempre do cache:",t),null}}getSessionFromKey(t){try{const r=localStorage.getItem(t);return r?JSON.parse(r):null}catch(r){return console.warn(`⚠️ Erro ao parsear sessão da chave ${t}:`,r),null}}updateAccessToken(t){try{const r=this.getSession();r&&(r.access_token=t,this.saveSession(r),console.log("🔄 Token de acesso atualizado no cache"))}catch(r){console.warn("⚠️ Erro ao atualizar token de acesso:",r)}}getStats(){const t=this.getSession();return{hasSession:t!==null,isValid:t!==null&&this.isSessionValid(t),expiresAt:t==null?void 0:t.expires_at}}}const Tr=Ba.getInstance(),ml=e=>typeof e=="boolean"?`${e}`:e===0?"0":e,xl=Lc,uo=(e,t)=>r=>{var s;if((t==null?void 0:t.variants)==null)return xl(e,r==null?void 0:r.class,r==null?void 0:r.className);const{variants:n,defaultVariants:i}=t,o=Object.keys(n).map(c=>{const u=r==null?void 0:r[c],h=i==null?void 0:i[c];if(u===null)return null;const f=ml(u)||ml(h);return n[c][f]}),l=r&&Object.entries(r).reduce((c,u)=>{let[h,f]=u;return f===void 0||(c[h]=f),c},{}),d=t==null||(s=t.compoundVariants)===null||s===void 0?void 0:s.reduce((c,u)=>{let{class:h,className:f,...m}=u;return Object.entries(m).every(v=>{let[g,x]=v;return Array.isArray(x)?x.includes({...i,...l}[g]):{...i,...l}[g]===x})?[...c,h,f]:c},[]);return xl(e,o,d,r==null?void 0:r.class,r==null?void 0:r.className)};function De(...e){return Uf(Lc(e))}const Em=uo("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all duration-200 ease-in-out transform focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 active:scale-95 hover:scale-105 hover:shadow-lg",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90 hover:shadow-primary/25",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90 hover:shadow-destructive/25",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground hover:shadow-md hover:border-primary/50",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80 hover:shadow-md",ghost:"hover:bg-accent hover:text-accent-foreground hover:shadow-sm",link:"text-primary underline-offset-4 hover:underline hover:text-primary/80"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),Q=p.forwardRef(({className:e,variant:t,size:r,asChild:s=!1,...n},i)=>{const o=s?df:"button";return a.jsx(o,{className:De(Em({variant:t,size:r,className:e})),ref:i,...n})});Q.displayName="Button";const Ee=p.forwardRef(({className:e,...t},r)=>a.jsx("div",{ref:r,className:De("rounded-xl border bg-card text-card-foreground shadow","transition-all duration-300 ease-in-out","hover:shadow-lg hover:shadow-primary/10 hover:-translate-y-1","focus-within:shadow-lg focus-within:shadow-primary/10 focus-within:-translate-y-1","hover:border-primary/20 focus-within:border-primary/20",e),...t}));Ee.displayName="Card";const Ae=p.forwardRef(({className:e,...t},r)=>a.jsx("div",{ref:r,className:De("flex flex-col space-y-1.5 p-6","cursor-pointer transition-colors duration-200",e),...t}));Ae.displayName="CardHeader";const Fe=p.forwardRef(({className:e,...t},r)=>a.jsx("div",{ref:r,className:De("font-semibold leading-none tracking-tight",e),...t}));Fe.displayName="CardTitle";const Ge=p.forwardRef(({className:e,...t},r)=>a.jsx("div",{ref:r,className:De("text-sm text-muted-foreground",e),...t}));Ge.displayName="CardDescription";const Se=p.forwardRef(({className:e,...t},r)=>a.jsx("div",{ref:r,className:De("p-6 pt-0",e),...t}));Se.displayName="CardContent";const _m=p.forwardRef(({className:e,...t},r)=>a.jsx("div",{ref:r,className:De("flex items-center p-6 pt-0",e),...t}));_m.displayName="CardFooter";function Sm({error:e,onRetry:t,onGoHome:r,isOnline:s}){const n=e.message.includes("timeout"),i=!s||e.message.includes("network")||e.message.includes("fetch");return a.jsx("div",{className:"min-h-screen flex items-center justify-center bg-background p-4",children:a.jsxs(Ee,{className:"w-full max-w-md",children:[a.jsxs(Ae,{className:"text-center",children:[a.jsx("div",{className:"flex justify-center mb-4",children:i?a.jsx(sl,{className:"h-16 w-16 text-red-500"}):a.jsx(oa,{className:"h-16 w-16 text-red-500"})}),a.jsx(Fe,{className:"text-2xl font-bold text-foreground",children:"Erro ao Carregar"}),a.jsxs(Ge,{className:"text-muted-foreground",children:[i?"Problema de conectividade detectado.":"Ocorreu um problema ao inicializar a aplicação."," ",n&&"A operação demorou mais que o esperado."]})]}),a.jsxs(Se,{className:"space-y-4",children:[i&&a.jsxs("div",{className:"flex items-center justify-center space-x-2 p-3 bg-yellow-50 dark:bg-yellow-900/20 rounded-lg",children:[a.jsx(sl,{className:"h-5 w-5 text-yellow-600"}),a.jsx("span",{className:"text-sm text-yellow-700 dark:text-yellow-300",children:"Verifique sua conexão com a internet"})]}),n&&a.jsxs("div",{className:"flex items-center justify-center space-x-2 p-3 bg-blue-50 dark:bg-blue-900/20 rounded-lg",children:[a.jsx(ot,{className:"h-5 w-5 text-blue-600"}),a.jsx("span",{className:"text-sm text-blue-700 dark:text-blue-300",children:"Tentando reconectar automaticamente..."})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs(Q,{onClick:t,className:"w-full",disabled:i&&!s,children:[a.jsx(ot,{className:"h-4 w-4 mr-2"}),"Tentar Novamente"]}),a.jsx(Q,{variant:"outline",onClick:r,className:"w-full",children:"Página Inicial"})]}),a.jsxs("div",{className:"text-center",children:[a.jsx("p",{className:"text-xs text-muted-foreground",children:"Se o problema persistir, verifique sua conexão com a internet"}),a.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["Versão da aplicação: ","1.0.4"]})]})]})]})})}const $i=p.createContext(void 0);function Cm({children:e}){const[t,r]=p.useState(null),[s,n]=p.useState(!0),[i,o]=p.useState(!1),[l,d]=p.useState(!1),[c,u]=p.useState(null),[h,f]=p.useState(navigator.onLine);p.useEffect(()=>{let N=!0,y=!1,A=null;jm();const B=setTimeout(()=>{N&&!y&&(console.warn("⚠️ Timeout de segurança - forçando inicialização"),r(null),n(!1),o(!0),d(!1),y=!0)},8e3),W=async(P=0)=>{var I,V,ae,_e,ve;if(!(y||l)){if(d(!0),!navigator.onLine){console.warn("⚠️ Sem conexão com a internet - aguardando reconexão"),setTimeout(()=>W(P),2e3);return}try{let we=Tr.getSession();if(we||(we=Tr.getSessionForce()),we||(we=Tr.getSessionAlways()),we&&(console.log("🔍 [AuthContext] Sessão encontrada no cache, usando cache"),N)){r(we.user),y=!0,n(!1),o(!0),d(!1),clearTimeout(B),setTimeout(()=>{console.log("🔄 Renovando sessão em background..."),Ce.auth.getSession().then(({data:{session:me}})=>{me!=null&&me.user&&(Tr.saveSession({user:me.user,access_token:me.access_token,refresh_token:me.refresh_token,expires_at:me.expires_at?me.expires_at*1e3:Date.now()+7*24*60*60*1e3,created_at:Date.now()}),console.log("✅ Sessão renovada em background"))}).catch(me=>{console.warn("⚠️ Erro ao renovar sessão em background:",me)})},1e3);return}console.log("🔍 [AuthContext] Verificando sessão no servidor...");const be=Ce.auth.getSession(),J=new Promise((me,k)=>{A=setTimeout(()=>k(new Error("Session timeout - operação demorou mais que 3 segundos")),3e3)}),{data:{session:Z},error:ue}=await Promise.race([be,J]);if(console.log("🔍 [AuthContext] Verificando sessão:",{hasSession:!!Z,userId:(I=Z==null?void 0:Z.user)==null?void 0:I.id,email:(V=Z==null?void 0:Z.user)==null?void 0:V.email,error:ue==null?void 0:ue.message}),ue)throw console.warn("Erro ao obter sessão:",ue.message),new Error(`Erro de autenticação: ${ue.message}`);if(A&&(clearTimeout(A),A=null),Z!=null&&Z.user&&N)if(window.location.pathname==="/reset-password"){if(console.log("Sessão de recuperação detectada na inicialização - permitindo acesso à página de reset"),N){r(null),y=!0,n(!1),o(!0),d(!1),clearTimeout(B);return}}else{console.log("✅ Sessão válida encontrada no servidor:",Z.user.email),Tr.saveSession({user:Z.user,access_token:Z.access_token,refresh_token:Z.refresh_token,expires_at:Z.expires_at?Z.expires_at*1e3:Date.now()+24*60*60*1e3,created_at:Date.now()});const k=Z.user;let M={id:k.id,email:k.email||"",name:((ae=k.user_metadata)==null?void 0:ae.full_name)||((_e=k.email)==null?void 0:_e.split("@")[0])||"Usuário",role:((ve=k.user_metadata)==null?void 0:ve.role)||"RH"};try{const{data:O,error:R}=await Ce.from("users").select("name, role").eq("id",k.id).single();!R&&O&&(M={id:k.id,email:k.email||"",name:O.name||M.name,role:O.role||M.role})}catch(O){console.log("Erro ao buscar dados do usuário na tabela:",O)}if(N){r(M),y=!0,n(!1),o(!0),d(!1),clearTimeout(B);return}}N&&(r(null),y=!0,n(!1),o(!0),d(!1),clearTimeout(B))}catch(we){if(console.error("Erro ao verificar usuário:",we),A&&(clearTimeout(A),A=null),N){const be=(we==null?void 0:we.message)||"Erro desconhecido";if(be.includes("timeout")||be.includes("fetch")||be.includes("network")){console.warn("⚠️ Problema de conexão na verificação de sessão - usando cache de sessão");let J=Tr.getSession();if(J||(J=Tr.getSessionForce()),J||(J=Tr.getSessionAlways()),J&&N){console.log("✅ Sessão encontrada no cache, restaurando..."),r(J.user),y=!0,n(!1),o(!0),d(!1),clearTimeout(B),console.log("✅ Sessão restaurada do cache com sucesso");return}else console.warn("❌ Nenhuma sessão encontrada no cache")}if(be.includes("timeout")&&P<2){console.warn(`⚠️ Tentativa ${P+1} falhou - tentando novamente em 3 segundos...`),setTimeout(()=>{N&&(d(!1),W(P+1))},3e3);return}console.warn("⚠️ Erro na verificação de sessão - permitindo acesso sem autenticação"),u(new Error(`Erro de autenticação: ${be}`)),r(null),y=!0,n(!1),o(!0),d(!1),clearTimeout(B)}}}};W();const C=()=>{console.log("🌐 Conexão restaurada - verificando autenticação..."),f(!0),!y&&!l&&setTimeout(()=>W(),1e3)},L=()=>{console.warn("🌐 Conexão perdida - pausando verificações de autenticação"),f(!1)};window.addEventListener("online",C),window.addEventListener("offline",L);const{data:{subscription:T}}=Ce.auth.onAuthStateChange(async(P,I)=>{var V,ae,_e;if(N)if(console.log("Auth state change:",P),P==="SIGNED_IN"&&I)if(window.location.pathname==="/reset-password")console.log("Sessão de recuperação de senha detectada - permitindo acesso à página de reset"),N&&(r(null),n(!1),o(!0));else{const we=I.user;let be={id:we.id,email:we.email||"",name:((V=we.user_metadata)==null?void 0:V.full_name)||((ae=we.email)==null?void 0:ae.split("@")[0])||"Usuário",role:((_e=we.user_metadata)==null?void 0:_e.role)||"RH"};try{const{data:J,error:Z}=await Ce.from("users").select("name, role").eq("id",we.id).single();!Z&&J&&(be={id:we.id,email:we.email||"",name:J.name||be.name,role:J.role||be.role})}catch(J){console.log("Erro ao buscar dados do usuário na tabela:",J)}N&&(r(be),n(!1),o(!0))}else P==="SIGNED_OUT"?N&&(r(null),n(!1),o(!0),Tr.clearSession(),console.log("✅ Cache de sessão limpo após logout")):P==="TOKEN_REFRESHED"&&console.log("Token renovado com sucesso")});return()=>{N=!1,A&&clearTimeout(A),B&&clearTimeout(B),T.unsubscribe(),window.removeEventListener("online",C),window.removeEventListener("offline",L)}},[]);const m=async N=>{try{n(!0);const y=await um(N);return y?(r(y),!0):!1}catch(y){return console.error("Erro no login:",y),!1}finally{n(!1)}},v=async()=>{try{n(!0),await Qc(),r(null),Tr.clearSession();const N=void 0;if(localStorage.removeItem("repositoriodevagas_cache"),sessionStorage.clear(),"indexedDB"in window)try{const y=indexedDB.deleteDatabase("supabase");y.onsuccess=()=>console.log("Cache IndexedDB limpo")}catch(y){console.log("Não foi possível limpar IndexedDB:",y)}console.log("Logout realizado com sucesso - cache limpo")}catch(N){console.error("Erro no logout:",N),r(null)}finally{n(!1)}},g=()=>{u(null),n(!0),o(!1),d(!1),setTimeout(()=>{window.location.reload()},1e3)},x=()=>{window.location.href="/"},b={user:t,login:m,logout:v,loading:s,error:c,retry:g};return c&&!s&&!l?a.jsx($i.Provider,{value:b,children:a.jsx(Sm,{error:c,onRetry:g,onGoHome:x,isOnline:h})}):a.jsx($i.Provider,{value:b,children:e})}function tt(){const e=p.useContext($i);if(e===void 0)throw new Error("useAuth deve ser usado dentro de um AuthProvider");return e}async function rd(e){let r=null;for(let s=1;s<=3;s++)try{console.log(`🔄 [getVagasForceRefresh] Tentativa ${s}/3 - Buscando vagas diretamente do DB...`);let n=ct.from("vagas").select("*").order("created_at",{ascending:!1}).limit(1e3);e!=null&&e.cliente,e!=null&&e.site,e!=null&&e.categoria,e!=null&&e.cargo,e!=null&&e.celula;const{data:i,error:o}=await n;if(o)throw new Error(`Erro do Supabase: ${o.message} (Código: ${o.code})`);if(!i||!Array.isArray(i))throw new Error("Dados inválidos retornados do servidor");return console.log(`✅ [getVagasForceRefresh] ${i.length} vagas carregadas com sucesso na tentativa ${s}`),i}catch(n){if(r=n,console.error(`❌ [getVagasForceRefresh] Tentativa ${s} falhou:`,n),s<3){const i=s*1e3;console.log(`⏳ Aguardando ${i}ms antes da próxima tentativa...`),await new Promise(o=>setTimeout(o,i))}}return console.error("💥 [getVagasForceRefresh] Todas as tentativas falharam, retornando array vazio"),console.error("💥 [getVagasForceRefresh] Último erro:",r),[]}async function gl(e){try{let t=Ce.from("vagas").select("*").order("created_at",{ascending:!1}).limit(1e3);e!=null&&e.cliente,e!=null&&e.site,e!=null&&e.categoria,e!=null&&e.cargo,e!=null&&e.celula;const{data:r,error:s}=await t;if(s){console.warn("⚠️ Erro com cliente normal, tentando com cliente admin:",s.message);let n=ct.from("vagas").select("*").order("created_at",{ascending:!1}).limit(1e3);e!=null&&e.cliente,e!=null&&e.site,e!=null&&e.categoria,e!=null&&e.cargo,e!=null&&e.celula;const{data:i,error:o}=await n;if(o)throw new Error(`Erro com cliente admin: ${o.message}`);return console.log(`✅ ${(i==null?void 0:i.length)||0} vagas carregadas com cliente admin`),i||[]}return console.log(`✅ ${(r==null?void 0:r.length)||0} vagas carregadas com cliente normal`),r||[]}catch(t){return console.error("Erro ao buscar vagas:",t),[]}}async function Un(e){try{const{data:t,error:r}=await Ce.from("vagas").select("*").eq("id",e).single();if(r)throw new Error(r.message);return t}catch(t){return console.error("Erro ao buscar vaga:",t),null}}async function Tm(e,t){try{console.log("🔍 [createVaga] Iniciando criação de vaga"),console.log("📊 [createVaga] Dados recebidos:",e),console.log("👤 [createVaga] User ID:",t);const s=["site","categoria","cargo","cliente","celula"].filter(c=>{var u;return!((u=e[c])!=null&&u.trim())});if(s.length>0)throw new Error(`Campos obrigatórios não preenchidos: ${s.join(", ")}`);const n={...e,created_by:t,updated_by:t};console.log("💾 [createVaga] Dados para inserção:",n),console.log("🌐 [createVaga] Iniciando inserção no Supabase...");const i=Date.now(),{data:o,error:l}=await Ce.from("vagas").insert(n).select().single(),d=Date.now();if(console.log(`⏱️ [createVaga] Operação concluída em ${d-i}ms`),l)throw console.error("❌ [createVaga] Erro do Supabase:",l),console.error("❌ [createVaga] Código do erro:",l.code),console.error("❌ [createVaga] Detalhes do erro:",l.details),new Error(`Erro do banco de dados: ${l.message}`);return console.log("✅ [createVaga] Vaga criada com sucesso:",o),window.dispatchEvent(new CustomEvent("vaga-created",{detail:o})),o}catch(r){throw console.error("💥 [createVaga] Erro geral:",r),r}}async function $n(e,t,r){try{const{data:s,error:n}=await Ce.from("vagas").update({...t,updated_by:r}).eq("id",e).select().single();if(n)throw new Error(n.message);return s}catch(s){return console.error("Erro ao atualizar vaga:",s),null}}async function ad(e){try{const{error:t}=await Ce.from("vagas").delete().eq("id",e);if(t)throw new Error(t.message);return!0}catch(t){return console.error("Erro ao excluir vaga:",t),!1}}async function zi(){try{const{data:e,error:t}=await Ce.from("vagas").select("cliente").not("cliente","is",null).order("cliente");if(t){console.warn("⚠️ Erro com cliente normal para clientes, tentando com cliente admin:",t.message);const{data:s,error:n}=await ct.from("vagas").select("cliente").not("cliente","is",null).order("cliente");if(n)throw new Error(`Erro com cliente admin: ${n.message}`);const i=[...new Set((s==null?void 0:s.map(o=>o.cliente).filter(Boolean))||[])];return console.log(`✅ ${i.length} clientes carregados com cliente admin`),i}const r=[...new Set((e==null?void 0:e.map(s=>s.cliente).filter(Boolean))||[])];return console.log(`✅ ${r.length} clientes carregados com cliente normal`),r}catch(e){return console.error("Erro ao buscar clientes:",e),[]}}async function Am(){try{const{data:e,error:t}=await Ce.from("vagas").select("site").not("site","is",null).order("site");if(t){console.warn("⚠️ Erro com cliente normal para sites, tentando com cliente admin:",t.message);const{data:s,error:n}=await ct.from("vagas").select("site").not("site","is",null).order("site");if(n)throw new Error(`Erro com cliente admin: ${n.message}`);const i=[...new Set((s==null?void 0:s.map(o=>o.site).filter(Boolean))||[])];return console.log(`✅ ${i.length} sites carregados com cliente admin`),i}const r=[...new Set((e==null?void 0:e.map(s=>s.site).filter(Boolean))||[])];return console.log(`✅ ${r.length} sites carregados com cliente normal`),r}catch(e){return console.error("Erro ao buscar sites:",e),[]}}async function Rm(){try{const{data:e,error:t}=await Ce.from("vagas").select("categoria").not("categoria","is",null).order("categoria");if(t)throw new Error(t.message);return[...new Set((e==null?void 0:e.map(s=>s.categoria).filter(Boolean))||[])]}catch(e){return console.error("Erro ao buscar categorias:",e),[]}}async function Fm(){try{const{data:e,error:t}=await Ce.from("vagas").select("cargo").not("cargo","is",null).order("cargo");if(t)throw new Error(t.message);return[...new Set((e==null?void 0:e.map(s=>s.cargo).filter(Boolean))||[])]}catch(e){return console.error("Erro ao buscar cargos:",e),[]}}async function km(){try{const{data:e,error:t}=await Ce.from("vagas").select("celula").not("celula","is",null).order("celula");if(t)throw new Error(t.message);return[...new Set((e==null?void 0:e.map(s=>s.celula).filter(Boolean))||[])]}catch(e){return console.error("Erro ao buscar células:",e),[]}}async function Vi(){try{const{data:e,error:t}=await Ce.from("noticias").select("*").order("created_at",{ascending:!1});if(t)throw console.error("Erro ao buscar notícias:",t),new Error(t.message);return e||[]}catch(e){throw console.error("Erro ao listar notícias:",e),e}}async function Dm(e,t){try{const{data:r,error:s}=await Ce.from("noticias").insert({titulo:e.titulo,conteudo:e.conteudo,tipo:e.tipo,ativa:e.ativa,prioridade:e.prioridade,created_by:t}).select().single();if(s)throw console.error("Erro ao criar notícia:",s),new Error(s.message);return r}catch(r){throw console.error("Erro ao criar notícia:",r),r}}async function Pm(e,t){try{const r={};t.titulo!==void 0&&(r.titulo=t.titulo),t.conteudo!==void 0&&(r.conteudo=t.conteudo),t.tipo!==void 0&&(r.tipo=t.tipo),t.ativa!==void 0&&(r.ativa=t.ativa),t.prioridade!==void 0&&(r.prioridade=t.prioridade);const{data:s,error:n}=await Ce.from("noticias").update(r).eq("id",e).select().single();if(n)throw console.error("Erro ao atualizar notícia:",n),new Error(n.message);return s}catch(r){throw console.error("Erro ao atualizar notícia:",r),r}}async function Im(e){try{const{error:t}=await Ce.from("noticias").delete().eq("id",e);if(t)throw console.error("Erro ao excluir notícia:",t),new Error(t.message);return!0}catch(t){throw console.error("Erro ao excluir notícia:",t),t}}async function Om(e,t){try{const{data:r,error:s}=await Ce.from("noticias").update({ativa:t}).eq("id",e).select().single();if(s)throw console.error("Erro ao alterar status da notícia:",s),new Error(s.message);return r}catch(r){throw console.error("Erro ao alterar status da notícia:",r),r}}const Bt={vagas:{ttl:15*60*1e3,maxSize:1e3,priority:"high",persist:!0},clientes:{ttl:30*60*1e3,maxSize:100,priority:"medium",persist:!0},sites:{ttl:30*60*1e3,maxSize:100,priority:"medium",persist:!0},categorias:{ttl:60*60*1e3,maxSize:50,priority:"low",persist:!0},cargos:{ttl:60*60*1e3,maxSize:200,priority:"medium",persist:!0},usuarios:{ttl:10*60*1e3,maxSize:50,priority:"high",persist:!1},noticias:{ttl:5*60*1e3,maxSize:50,priority:"high",persist:!1}};class Mm{constructor(){this.memoryCache=new Map,this.stats={hits:0,misses:0,invalidations:0,size:0,lastCleanup:Date.now()},this.indexedDB=null,this.isOnline=navigator.onLine,this.currentUser=null,this.listeners=new Map,this.initializeIndexedDB(),this.setupOnlineStatusListener(),this.setupPeriodicCleanup(),this.setupBackgroundRefresh()}async initializeIndexedDB(){if(!(typeof window>"u"))try{const t=indexedDB.open("RepositorioVagasCache",1);t.onupgradeneeded=r=>{const s=r.target.result;Object.keys(Bt).forEach(n=>{if(!s.objectStoreNames.contains(n)){const i=s.createObjectStore(n,{keyPath:"id"});i.createIndex("timestamp","metadata.timestamp"),i.createIndex("userId","metadata.userId")}})},t.onsuccess=()=>{this.indexedDB=t.result,console.log("✅ IndexedDB inicializado para cache persistente")},t.onerror=()=>{console.warn("⚠️ Falha ao inicializar IndexedDB, usando apenas cache em memória")}}catch{console.warn("⚠️ IndexedDB não suportado, usando apenas cache em memória")}}setupOnlineStatusListener(){window.addEventListener("online",()=>{this.isOnline=!0,console.log("🌐 Conexão restaurada - verificando cache"),this.validateCacheOnReconnect()}),window.addEventListener("offline",()=>{this.isOnline=!1,console.log("📴 Modo offline - usando cache local")})}setupPeriodicCleanup(){setInterval(()=>{this.cleanup()},5*60*1e3)}setupBackgroundRefresh(){setInterval(()=>{this.backgroundRefresh()},10*60*1e3)}setCurrentUser(t){this.currentUser=t,t||this.clearUserSpecificCache()}async get(t,r,s={}){const n=this.generateCacheKey(t,s.userId);if(s.forceRefresh||s.skipCache)return this.fetchAndCache(t,r,n);const i=this.getFromMemory(n);if(i)return this.stats.hits++,i;const o=this.getFromSession(n);if(o)return this.stats.hits++,this.setToMemory(n,o,Bt[t].ttl),o;if(Bt[t].persist&&this.indexedDB){const l=await this.getFromIndexedDB(t,n);if(l)return this.stats.hits++,this.setToMemory(n,l,Bt[t].ttl),this.setToSession(n,l,Bt[t].ttl),l}if(this.stats.misses++,!this.isOnline){const l=await this.getStaleData(t,n);if(l)return console.log(`📴 Usando dados em cache (offline): ${t}`),l}return this.fetchAndCache(t,r,n)}async fetchAndCache(t,r,s){try{console.log(`🔄 Buscando dados do servidor: ${t}`);const n=await r();return this.setToMemory(s,n,Bt[t].ttl),this.setToSession(s,n,Bt[t].ttl),Bt[t].persist&&this.indexedDB&&await this.setToIndexedDB(t,s,n,Bt[t].ttl),this.notifyListeners(t,n),console.log(`✅ Dados armazenados no cache: ${t}`),n}catch(n){console.error(`❌ Erro ao buscar dados: ${t}`,n);const i=await this.getStaleData(t,s);if(i)return console.log(`🔄 Usando dados em cache (erro na busca): ${t}`),i;throw n}}getFromMemory(t){const r=this.memoryCache.get(t);return r?this.isExpired(r.metadata)?(this.memoryCache.delete(t),null):r.data:null}setToMemory(t,r,s){var n;this.memoryCache.size>=100&&this.evictOldestMemoryEntry(),this.memoryCache.set(t,{data:r,metadata:{timestamp:Date.now(),ttl:s,version:1,userId:(n=this.currentUser)==null?void 0:n.id}})}getFromSession(t){return null}setToSession(t,r,s){}async getFromIndexedDB(t,r){return this.indexedDB?new Promise(s=>{const o=this.indexedDB.transaction([t],"readonly").objectStore(t).get(r);o.onsuccess=()=>{const l=o.result;if(!l||this.isExpired(l.metadata)){s(null);return}s(l.data)},o.onerror=()=>s(null)}):null}async setToIndexedDB(t,r,s,n){if(this.indexedDB)return new Promise((i,o)=>{var h;const d=this.indexedDB.transaction([t],"readwrite").objectStore(t),c={id:r,data:s,metadata:{timestamp:Date.now(),ttl:n,version:1,userId:(h=this.currentUser)==null?void 0:h.id}},u=d.put(c);u.onsuccess=()=>i(),u.onerror=()=>o(u.error)})}async getStaleData(t,r){const s=this.memoryCache.get(r);return s?s.data:Bt[t].persist&&this.indexedDB?new Promise(n=>{const l=this.indexedDB.transaction([t],"readonly").objectStore(t).get(r);l.onsuccess=()=>{var d;n(((d=l.result)==null?void 0:d.data)||null)},l.onerror=()=>n(null)}):null}generateCacheKey(t,r){var n;const s=r||((n=this.currentUser)==null?void 0:n.id)||"anonymous";return`${t}:${s}`}isExpired(t){return Date.now()-t.timestamp>t.ttl}invalidate(t,r){const s=this.generateCacheKey(t,r);this.memoryCache.delete(s),Bt[t].persist&&this.indexedDB&&this.indexedDB.transaction([t],"readwrite").objectStore(t).delete(s),this.stats.invalidations++,console.log(`🗑️ Cache invalidado: ${t}`)}invalidateUserCache(t){Object.keys(Bt).forEach(r=>{this.invalidate(r,t)})}clearUserSpecificCache(){if(!this.currentUser)return;Array.from(this.memoryCache.keys()).filter(r=>r.includes(this.currentUser.id)).forEach(r=>{this.memoryCache.delete(r)})}cleanup(){const t=Date.now();let r=0;for(const[s,n]of this.memoryCache.entries())this.isExpired(n.metadata)&&(this.memoryCache.delete(s),r++);this.indexedDB&&Object.keys(Bt).forEach(async s=>{const l=this.indexedDB.transaction([s],"readwrite").objectStore(s).index("timestamp").openCursor();l.onsuccess=d=>{const c=d.target.result;c&&(t-c.value.metadata.timestamp>c.value.metadata.ttl&&(c.delete(),r++),c.continue())}}),r>0&&console.log(`🧹 Cache limpo: ${r} itens expirados removidos`),this.stats.lastCleanup=t}backgroundRefresh(){if(this.isOnline){console.log("🔄 Refresh em background iniciado");for(const[t,r]of this.memoryCache.entries()){const s=Bt[t.split(":")[0]];if(!s)continue;const n=Date.now()-r.metadata.timestamp,i=s.ttl*.8;n>i&&console.log(`🔄 Marcando para refresh em background: ${t}`)}}}validateCacheOnReconnect(){console.log("🔍 Validando cache após reconexão")}evictOldestMemoryEntry(){let t="",r=Date.now();for(const[s,n]of this.memoryCache.entries())n.metadata.timestamp<r&&(r=n.metadata.timestamp,t=s);t&&this.memoryCache.delete(t)}addListener(t,r){return this.listeners.has(t)||this.listeners.set(t,new Set),this.listeners.get(t).add(r),()=>{var s;(s=this.listeners.get(t))==null||s.delete(r)}}notifyListeners(t,r){var s;(s=this.listeners.get(t))==null||s.forEach(n=>{try{n(r)}catch(i){console.error("Erro ao notificar listener:",i)}})}getStats(){const t=this.stats.hits+this.stats.misses;return{...this.stats,hitRate:t>0?this.stats.hits/t*100:0,size:this.memoryCache.size}}clear(){this.memoryCache.clear(),this.indexedDB&&Object.keys(Bt).forEach(t=>{this.indexedDB.transaction([t],"readwrite").objectStore(t).clear()}),console.log("🗑️ Todo o cache foi limpo")}}let fi=null;function sd(){return fi||(fi=new Mm),fi}const Lm=Object.freeze(Object.defineProperty({__proto__:null,getIntelligentCache:sd},Symbol.toStringTag,{value:"Module"}));class Bm{constructor(){this.db=null,this.dbName="RepositorioVagasPersistentCache",this.version=2,this.maxTotalSize=50*1024*1024,this.maxEntryAge=7*24*60*60*1e3}async initialize(){if(typeof window>"u"){console.warn("⚠️ IndexedDB não disponível no servidor");return}return new Promise((t,r)=>{const s=indexedDB.open(this.dbName,this.version);s.onerror=()=>{console.error("❌ Erro ao abrir IndexedDB:",s.error),r(s.error)},s.onsuccess=()=>{this.db=s.result,console.log("✅ Cache persistente inicializado"),t()},s.onupgradeneeded=n=>{const i=n.target.result;["vagas","clientes","sites","categorias","cargos","celulas","usuarios","noticias","dashboard_stats","search_history","user_preferences"].forEach(l=>{if(!i.objectStoreNames.contains(l)){const d=i.createObjectStore(l,{keyPath:"id"});d.createIndex("timestamp","metadata.timestamp"),d.createIndex("userId","metadata.userId"),d.createIndex("lastAccess","metadata.lastAccess"),d.createIndex("accessCount","metadata.accessCount"),d.createIndex("size","metadata.size")}}),console.log("🔄 IndexedDB atualizado para versão",this.version)}})}async set(t,r,s,n={}){if(!this.db){console.warn("⚠️ Cache persistente não inicializado");return}const i=JSON.stringify(s),o=new Blob([i]).size;if(o>5*1024*1024){console.warn(`⚠️ Entrada muito grande (${o} bytes): ${r}`);return}const l={id:r,data:s,metadata:{timestamp:Date.now(),ttl:n.ttl||24*60*60*1e3,version:1,userId:n.userId,lastAccess:Date.now(),accessCount:1,size:o}};return new Promise((d,c)=>{const h=this.db.transaction([t],"readwrite").objectStore(t);this.getTotalSize().then(f=>{f+o>this.maxTotalSize?this.evictOldEntries(t,o).then(()=>{this.putEntry(h,l,d,c)}):this.putEntry(h,l,d,c)})})}putEntry(t,r,s,n){const i=t.put(r);i.onsuccess=()=>{console.log(`💾 Dados armazenados no cache persistente: ${r.id}`),s()},i.onerror=()=>{console.error(`❌ Erro ao armazenar no cache persistente: ${r.id}`,i.error),n(i.error)}}async get(t,r){return this.db?new Promise(s=>{const i=this.db.transaction([t],"readwrite").objectStore(t),o=i.get(r);o.onsuccess=()=>{const l=o.result;if(!l){s(null);return}if(this.isExpired(l)){i.delete(r),console.log(`🗑️ Entrada expirada removida: ${r}`),s(null);return}l.metadata.lastAccess=Date.now(),l.metadata.accessCount++;const d=i.put(l);d.onsuccess=()=>{console.log(`📖 Dados recuperados do cache persistente: ${r}`),s(l.data)}},o.onerror=()=>{console.error(`❌ Erro ao recuperar do cache persistente: ${r}`,o.error),s(null)}}):null}async has(t,r){return await this.get(t,r)!==null}async delete(t,r){if(this.db)return new Promise((s,n)=>{const l=this.db.transaction([t],"readwrite").objectStore(t).delete(r);l.onsuccess=()=>{console.log(`🗑️ Entrada removida do cache persistente: ${r}`),s()},l.onerror=()=>{console.error(`❌ Erro ao remover do cache persistente: ${r}`,l.error),n(l.error)}})}async clearStore(t){if(this.db)return new Promise((r,s)=>{const o=this.db.transaction([t],"readwrite").objectStore(t).clear();o.onsuccess=()=>{console.log(`🗑️ Store limpo: ${t}`),r()},o.onerror=()=>{console.error(`❌ Erro ao limpar store: ${t}`,o.error),s(o.error)}})}async clearUserCache(t){if(!this.db)return;const r=Array.from(this.db.objectStoreNames);for(const s of r)await new Promise((n,i)=>{const c=this.db.transaction([s],"readwrite").objectStore(s).index("userId").openCursor(IDBKeyRange.only(t));c.onsuccess=u=>{const h=u.target.result;h?(h.delete(),h.continue()):n()},c.onerror=()=>i(c.error)});console.log(`🗑️ Cache do usuário limpo: ${t}`)}async getMetrics(){if(!this.db)return{totalEntries:0,totalSize:0,averageAccessCount:0,oldestEntry:0,newestEntry:0};const t=Array.from(this.db.objectStoreNames);let r=0,s=0,n=0,i=Date.now(),o=0;for(const l of t){const d=await this.getStoreMetrics(l);r+=d.entries,s+=d.size,n+=d.accessCount,i=Math.min(i,d.oldestTimestamp),o=Math.max(o,d.newestTimestamp)}return{totalEntries:r,totalSize:s,averageAccessCount:r>0?n/r:0,oldestEntry:i,newestEntry:o}}async getStoreMetrics(t){return new Promise(r=>{const i=this.db.transaction([t],"readonly").objectStore(t).getAll();i.onsuccess=()=>{const l=i.result.reduce((d,c)=>(d.entries++,d.size+=c.metadata.size,d.accessCount+=c.metadata.accessCount,d.oldestTimestamp=Math.min(d.oldestTimestamp,c.metadata.timestamp),d.newestTimestamp=Math.max(d.newestTimestamp,c.metadata.timestamp),d),{entries:0,size:0,accessCount:0,oldestTimestamp:Date.now(),newestTimestamp:0});r(l)},i.onerror=()=>{r({entries:0,size:0,accessCount:0,oldestTimestamp:Date.now(),newestTimestamp:0})}})}async evictOldEntries(t,r){if(this.db)return new Promise((s,n)=>{const o=this.db.transaction([t],"readwrite").objectStore(t),d=o.index("lastAccess").openCursor();let c=0;const u=[];d.onsuccess=h=>{const f=h.target.result;if(f&&c<r){const m=f.value;(Date.now()-m.metadata.timestamp>this.maxEntryAge||m.metadata.accessCount<2||c<r)&&(u.push(m.id),c+=m.metadata.size),f.continue()}else u.forEach(m=>{o.delete(m)}),console.log(`🧹 Cache limpo: ${u.length} entradas removidas, ${c} bytes liberados`),s()},d.onerror=()=>n(d.error)})}isExpired(t){return Date.now()-t.metadata.timestamp>t.metadata.ttl}async getTotalSize(){return(await this.getMetrics()).totalSize}async cleanup(){if(!this.db)return;const t=Array.from(this.db.objectStoreNames);let r=0;for(const s of t){const n=await this.cleanupStore(s);r+=n}r>0&&console.log(`🧹 Limpeza periódica: ${r} entradas expiradas removidas`)}async cleanupStore(t){return new Promise(r=>{const n=this.db.transaction([t],"readwrite").objectStore(t),i=n.getAll();i.onsuccess=()=>{const o=i.result;let l=0;o.forEach(d=>{this.isExpired(d)&&(n.delete(d.id),l++)}),r(l)},i.onerror=()=>r(0)})}async exportCache(){if(!this.db)throw new Error("Cache não inicializado");const t={},r=Array.from(this.db.objectStoreNames);for(const s of r){const n=await new Promise((i,o)=>{const c=this.db.transaction([s],"readonly").objectStore(s).getAll();c.onsuccess=()=>i(c.result),c.onerror=()=>o(c.error)});t[s]=n}return new Blob([JSON.stringify(t,null,2)],{type:"application/json"})}async importCache(t){if(!this.db)throw new Error("Cache não inicializado");const r=await t.text(),s=JSON.parse(r);for(const[n,i]of Object.entries(s))if(this.db.objectStoreNames.contains(n)){const l=this.db.transaction([n],"readwrite").objectStore(n);for(const d of i)l.put(d)}console.log("✅ Cache importado com sucesso")}close(){this.db&&(this.db.close(),this.db=null,console.log("🔒 Cache persistente fechado"))}}let Js=null;function Um(){return Js||(Js=new Bm,Js.initialize().catch(e=>{console.error("❌ Erro ao inicializar cache persistente:",e)})),Js}class $m{constructor(t={}){this.eventSource=null,this.reconnectAttempts=0,this.isConnected=!1,this.listeners=new Map,this.eventBuffer=[],this.heartbeatInterval=null,this.currentUser=null,this.config={reconnectInterval:5e3,maxReconnectAttempts:10,heartbeatInterval:3e4,eventBufferSize:100,...t}}connect(t){if(!(this.isConnected||!t)){if(!this.isSSEAvailable()){console.log("⚠️ Cache reativo desabilitado (ambiente de desenvolvimento ou SSE não disponível)");return}this.currentUser=t,this.startConnection()}}isSSEAvailable(){return!(typeof EventSource>"u")}startConnection(){if(this.currentUser)try{const t="undefined/realtime/v1/events?apikey=undefined";this.eventSource=new EventSource(t,{withCredentials:!0}),this.eventSource.onopen=()=>{console.log("🔗 Cache reativo conectado"),this.isConnected=!0,this.reconnectAttempts=0,this.startHeartbeat(),this.processBufferedEvents()},this.eventSource.onmessage=r=>{this.handleMessage(r)},this.eventSource.onerror=r=>{console.error("❌ Erro na conexão reativa:",r),this.isConnected=!1,this.stopHeartbeat(),this.scheduleReconnect()},this.setupTableListeners()}catch(t){console.error("❌ Erro ao conectar cache reativo:",t),this.scheduleReconnect()}}setupTableListeners(){this.eventSource&&(this.eventSource.addEventListener("vagas",t=>{this.handleTableEvent("vagas",t)}),this.eventSource.addEventListener("users",t=>{this.handleTableEvent("users",t)}),this.eventSource.addEventListener("noticias",t=>{this.handleTableEvent("noticias",t)}),this.eventSource.addEventListener("contact_email_config",t=>{this.handleTableEvent("contact_email_config",t)}))}handleTableEvent(t,r){var s;try{const n={type:r.type,table:t,id:r.lastEventId||"unknown",data:r.data?JSON.parse(r.data):null,timestamp:Date.now(),userId:(s=this.currentUser)==null?void 0:s.id};this.processEvent(n)}catch(n){console.error(`❌ Erro ao processar evento da tabela ${t}:`,n)}}handleMessage(t){try{const r=JSON.parse(t.data);if(r.type==="heartbeat"){this.sendHeartbeatResponse();return}if(r.type==="cache_update"){const s={type:r.operation,table:r.table,id:r.id,data:r.new_data,timestamp:Date.now(),userId:r.user_id};this.processEvent(s)}}catch(r){console.error("❌ Erro ao processar mensagem:",r)}}processEvent(t){this.shouldProcessEvent(t)&&(this.notifyListeners(t),this.updateCacheFromEvent(t),console.log(`🔄 Cache atualizado via evento reativo: ${t.table}.${t.type}`))}shouldProcessEvent(t){var r;return t.userId?t.userId===((r=this.currentUser)==null?void 0:r.id)||t.userId==="global":!0}updateCacheFromEvent(t){Bf(async()=>{const{getIntelligentCache:r}=await Promise.resolve().then(()=>Lm);return{getIntelligentCache:r}},void 0).then(({getIntelligentCache:r})=>{const s=r();switch(t.type){case"CREATE":case"UPDATE":t.data&&s.invalidate(t.table,t.userId);break;case"DELETE":s.invalidate(t.table,t.userId);break;case"INVALIDATE":s.invalidate(t.table,t.userId);break}})}scheduleReconnect(){if(this.reconnectAttempts>=this.config.maxReconnectAttempts){console.warn("⚠️ Máximo de tentativas de reconexão atingido");return}this.reconnectAttempts++;const t=this.config.reconnectInterval*Math.pow(2,this.reconnectAttempts-1);console.log(`🔄 Tentando reconectar em ${t}ms (tentativa ${this.reconnectAttempts})`),setTimeout(()=>{this.disconnect(),this.startConnection()},t)}startHeartbeat(){this.heartbeatInterval=setInterval(()=>{this.isConnected&&this.eventSource&&this.sendHeartbeat()},this.config.heartbeatInterval)}stopHeartbeat(){this.heartbeatInterval&&(clearInterval(this.heartbeatInterval),this.heartbeatInterval=null)}sendHeartbeat(){}sendHeartbeatResponse(){console.log("💓 Heartbeat recebido")}processBufferedEvents(){for(;this.eventBuffer.length>0;){const t=this.eventBuffer.shift();t&&this.processEvent(t)}}addListener(t,r){return this.listeners.has(t)||this.listeners.set(t,new Set),this.listeners.get(t).add(r),()=>{var s;(s=this.listeners.get(t))==null||s.delete(r)}}notifyListeners(t){var r,s;(r=this.listeners.get(t.table))==null||r.forEach(n=>{try{n(t)}catch(i){console.error("❌ Erro ao notificar listener:",i)}}),(s=this.listeners.get("*"))==null||s.forEach(n=>{try{n(t)}catch(i){console.error("❌ Erro ao notificar listener global:",i)}})}sendEvent(t){if(!this.isConnected){console.warn("⚠️ Cache reativo não conectado, evento não enviado");return}console.log("📤 Evento enviado para o servidor:",t)}getStatus(){return{connected:this.isConnected,reconnectAttempts:this.reconnectAttempts,listeners:Array.from(this.listeners.values()).reduce((t,r)=>t+r.size,0),bufferedEvents:this.eventBuffer.length}}disconnect(){this.eventSource&&(this.eventSource.close(),this.eventSource=null),this.stopHeartbeat(),this.isConnected=!1,console.log("🔌 Cache reativo desconectado")}clearListeners(){this.listeners.clear(),console.log("🗑️ Listeners do cache reativo limpos")}destroy(){this.disconnect(),this.clearListeners(),this.eventBuffer=[],this.currentUser=null,console.log("💥 Cache reativo destruído")}}class zm{constructor(t={}){this.intervals=new Map,this.listeners=new Map,this.lastTimestamps=new Map,this.config={defaultInterval:3e4,maxInterval:3e5,backoffMultiplier:1.5,...t}}startPolling(t,r,s){if(this.intervals.has(t)){console.warn(`⚠️ Polling já ativo para ${t}`);return}const n=s||this.config.defaultInterval;console.log(`🔄 Iniciando polling para ${t} (${n}ms)`);const i=async()=>{try{const l=await r(),d=this.lastTimestamps.get(t)||0,c=Date.now();this.hasDataChanged(t,l,d)&&(this.notifyListeners(t,l),this.lastTimestamps.set(t,c),console.log(`📊 Dados atualizados via polling: ${t}`))}catch(l){console.error(`❌ Erro no polling de ${t}:`,l),this.handlePollingError(t)}};i();const o=setInterval(i,n);this.intervals.set(t,o)}stopPolling(t){const r=this.intervals.get(t);r&&(clearInterval(r),this.intervals.delete(t),this.lastTimestamps.delete(t),console.log(`⏹️ Polling parado para ${t}`))}hasDataChanged(t,r,s){return Date.now()-s>3e4}handlePollingError(t){if(!this.intervals.get(t))return;const s=Math.min(this.config.defaultInterval*this.config.backoffMultiplier,this.config.maxInterval);this.stopPolling(t),setTimeout(()=>{console.log(`🔄 Tentando reconectar polling para ${t}`)},s)}addListener(t,r){return this.listeners.has(t)||this.listeners.set(t,new Set),this.listeners.get(t).add(r),()=>{var s;(s=this.listeners.get(t))==null||s.delete(r)}}notifyListeners(t,r){var s;(s=this.listeners.get(t))==null||s.forEach(n=>{try{n(r)}catch(i){console.error("❌ Erro ao notificar listener:",i)}})}getStatus(){return{activePolling:Array.from(this.intervals.keys()),listeners:Array.from(this.listeners.values()).reduce((t,r)=>t+r.size,0)}}destroy(){this.intervals.forEach((t,r)=>{this.stopPolling(r)}),this.listeners.clear(),this.lastTimestamps.clear(),console.log("💥 Polling cache destruído")}}let mi=null,xi=null;function Vm(){return mi||(mi=new $m),mi}function Hm(){return xi||(xi=new zm),xi}class Wm{constructor(t,r={}){this.cache=new Map,this.listeners=new Set,this.preloadQueue=new Set,this.isPreloading=!1,this.fetcher=t,this.config={pageSize:10,preloadPages:2,maxCachedPages:20,ttl:5*60*1e3,...r},this.currentState={currentPage:1,totalPages:0,totalItems:0,items:[],loading:!1,error:null,hasNextPage:!1,hasPrevPage:!1}}async getPage(t,r,s=!1){const n=this.generateCacheKey(t,r);if(this.currentState.loading&&this.currentState.currentPage===t)return this.currentState;if(!s){const i=this.getFromCache(n);if(i)return this.updateState(t,i),this.schedulePreload(t,r),this.currentState}return this.loadPage(t,r)}async loadPage(t,r){const s=this.generateCacheKey(t,r);this.updateState(t,null,!0,null);try{console.log(`📄 Carregando página ${t}...`);const n=await this.fetcher(t,this.config.pageSize,r),i={page:t,data:n.data,timestamp:Date.now(),totalCount:n.totalCount,hasNextPage:n.hasNextPage,hasPrevPage:n.hasPrevPage,filters:r};this.setCache(s,i),this.updateState(t,i),this.schedulePreload(t,r),console.log(`✅ Página ${t} carregada com sucesso`)}catch(n){console.error(`❌ Erro ao carregar página ${t}:`,n),this.updateState(t,null,!1,n instanceof Error?n.message:"Erro desconhecido")}return this.currentState}schedulePreload(t,r){if(this.isPreloading)return;this.isPreloading=!0;const s=[];for(let i=Math.max(1,t-this.config.preloadPages);i<t;i++)s.push(i);for(let i=t+1;i<=Math.min(this.currentState.totalPages,t+this.config.preloadPages);i++)s.push(i);const n=s.filter(i=>{const o=this.generateCacheKey(i,r);return!this.cache.has(o)||this.isExpired(this.cache.get(o))});n.length>0?(console.log(`🔄 Pré-carregando páginas: ${n.join(", ")}`),this.preloadPages(n,r)):this.isPreloading=!1}async preloadPages(t,r){try{const s=t.map(async n=>{try{const i=await this.fetcher(n,this.config.pageSize,r),o=this.generateCacheKey(n,r),l={page:n,data:i.data,timestamp:Date.now(),totalCount:i.totalCount,hasNextPage:i.hasNextPage,hasPrevPage:i.hasPrevPage,filters:r};this.setCache(o,l),console.log(`✅ Página ${n} pré-carregada`)}catch(i){console.error(`❌ Erro ao pré-carregar página ${n}:`,i)}});await Promise.all(s)}finally{this.isPreloading=!1}}async nextPage(t){if(!this.currentState.hasNextPage)throw new Error("Não há próxima página");return this.getPage(this.currentState.currentPage+1,t)}async prevPage(t){if(!this.currentState.hasPrevPage)throw new Error("Não há página anterior");return this.getPage(this.currentState.currentPage-1,t)}async goToPage(t,r){if(t<1||t>this.currentState.totalPages)throw new Error("Página inválida");return this.getPage(t,r)}updateState(t,r,s=!1,n=null){if(r){const i=Math.ceil(r.totalCount/this.config.pageSize);this.currentState={currentPage:t,totalPages:i,totalItems:r.totalCount,items:r.data,loading:!1,error:null,hasNextPage:r.hasNextPage,hasPrevPage:r.hasPrevPage}}else this.currentState={...this.currentState,currentPage:t,loading:s,error:n};this.notifyListeners()}getFromCache(t){const r=this.cache.get(t);return r?this.isExpired(r)?(this.cache.delete(t),null):r:null}setCache(t,r){this.cache.size>=this.config.maxCachedPages&&this.evictOldestEntry(),this.cache.set(t,r)}isExpired(t){return Date.now()-t.timestamp>this.config.ttl}evictOldestEntry(){let t="",r=Date.now();for(const[s,n]of this.cache.entries())n.timestamp<r&&(r=n.timestamp,t=s);t&&(this.cache.delete(t),console.log(`🗑️ Página removida do cache: ${t}`))}generateCacheKey(t,r){const s=r?JSON.stringify(r):"default";return`page:${t}:${s}`}addListener(t){return this.listeners.add(t),()=>{this.listeners.delete(t)}}notifyListeners(){this.listeners.forEach(t=>{try{t(this.currentState)}catch(r){console.error("❌ Erro ao notificar listener:",r)}})}invalidateCache(t){const r=[];for(const[s,n]of this.cache.entries())(!t||JSON.stringify(n.filters)===JSON.stringify(t))&&r.push(s);r.forEach(s=>{this.cache.delete(s)}),console.log(`🗑️ ${r.length} páginas removidas do cache`)}updateItem(t,r){for(const[s,n]of this.cache.entries()){const i=n.data.findIndex(o=>o.id===t);i!==-1&&(n.data[i]=r,n.timestamp=Date.now(),console.log(`🔄 Item atualizado na página ${n.page}`))}}removeItem(t){for(const[r,s]of this.cache.entries()){const n=s.data.findIndex(i=>i.id===t);n!==-1&&(s.data.splice(n,1),s.timestamp=Date.now(),s.totalCount--,console.log(`➖ Item removido da página ${s.page}`))}}addItem(t){const r=this.generateCacheKey(1),s=this.cache.get(r);s&&(s.data.unshift(t),s.totalCount++,s.timestamp=Date.now(),console.log("➕ Item adicionado à primeira página"))}getStats(){const t=Array.from(this.cache.values()),r=t.reduce((n,i)=>n+i.data.length,0),s=t.map(n=>n.timestamp);return{cachedPages:this.cache.size,totalItems:r,cacheHitRate:0,oldestPage:s.length>0?Math.min(...s):0,newestPage:s.length>0?Math.max(...s):0}}getCurrentState(){return{...this.currentState}}clearCache(){this.cache.clear(),console.log("🗑️ Cache de paginação limpo")}destroy(){this.clearCache(),this.listeners.clear(),console.log("💥 Pagination cache destruído")}}class qm{constructor(){this.cache=new Map,this.userPermissions=new Map,this.permissionRules=new Map,this.currentUser=null,this.initializePermissionRules()}initializePermissionRules(){this.permissionRules.set("vagas",{resource:"vagas",actions:["read","create","update","delete"],conditions:{role:["ADMIN","RH"]},ttl:15*60*1e3,priority:"high"}),this.permissionRules.set("usuarios",{resource:"usuarios",actions:["read","create","update","delete"],conditions:{role:["ADMIN"]},ttl:10*60*1e3,priority:"high"}),this.permissionRules.set("noticias",{resource:"noticias",actions:["read"],conditions:{role:["ADMIN","RH"]},ttl:5*60*1e3,priority:"medium"}),this.permissionRules.set("configuracoes",{resource:"configuracoes",actions:["read","update"],conditions:{role:["ADMIN"]},ttl:30*60*1e3,priority:"low"}),this.permissionRules.set("relatorios",{resource:"relatorios",actions:["read","create"],conditions:{role:["ADMIN","RH"]},ttl:60*60*1e3,priority:"medium"})}setCurrentUser(t){this.currentUser=t,t?this.loadUserPermissions(t.id,t.role):this.clearUserCache()}loadUserPermissions(t,r){const s=this.calculateUserPermissions(t,r),n=this.determineCacheLevel(r,s);this.userPermissions.set(t,{userId:t,role:r,permissions:s,cacheLevel:n,expiresAt:Date.now()+24*60*60*1e3}),console.log(`👤 Permissões carregadas para ${r}:`,{cacheLevel:n,permissions:s.length})}calculateUserPermissions(t,r){const s=[];for(const[n,i]of this.permissionRules.entries())this.userHasAccess(r,i)&&i.actions.forEach(o=>{s.push({resource:n,action:o,conditions:i.conditions})});return s}userHasAccess(t,r){var s;return(s=r.conditions)!=null&&s.role?r.conditions.role.includes(t):!0}determineCacheLevel(t,r){switch(t){case"ADMIN":return"full";case"RH":return"limited";default:return"none"}}set(t,r,s,n={}){if(!this.currentUser){console.warn("⚠️ Usuário não definido, cache não armazenado");return}const i=this.userPermissions.get(this.currentUser.id);if(!i){console.warn("⚠️ Permissões do usuário não encontradas");return}if(!i.permissions.some(h=>h.resource===s&&h.action==="read")){console.warn(`⚠️ Usuário não tem permissão para cache do recurso: ${s}`);return}const l=this.permissionRules.get(s),d=n.ttl||(l==null?void 0:l.ttl)||15*60*1e3;n.priority||l!=null&&l.priority;const c=this.adjustTtlByCacheLevel(d,i.cacheLevel),u={data:r,permissions:[s],userId:this.currentUser.id,timestamp:Date.now(),ttl:c,accessCount:0,lastAccess:Date.now()};this.cache.set(t,u),console.log(`💾 Dados armazenados no cache com permissões: ${t}`)}get(t,r){if(!this.currentUser)return null;const s=this.cache.get(t);return s?this.isExpired(s)?(this.cache.delete(t),null):this.hasPermission(s,r)?(s.accessCount++,s.lastAccess=Date.now(),console.log(`📖 Dados recuperados do cache com permissões: ${t}`),s.data):(console.warn(`🚫 Acesso negado ao cache: ${t}`),null):null}hasPermission(t,r){const s=this.userPermissions.get(this.currentUser.id);return s?t.userId===this.currentUser.id?!0:s.permissions.some(i=>i.resource===r&&i.action==="read"):!1}isExpired(t){return Date.now()-t.timestamp>t.ttl}adjustTtlByCacheLevel(t,r){switch(r){case"full":return t*1.5;case"limited":return t*.8;case"none":return 0;default:return t}}invalidateUserCache(t){var n;const r=t||((n=this.currentUser)==null?void 0:n.id);if(!r)return;const s=[];for(const[i,o]of this.cache.entries())o.userId===r&&s.push(i);s.forEach(i=>{this.cache.delete(i)}),console.log(`🗑️ Cache invalidado para usuário: ${r} (${s.length} entradas)`)}invalidateResourceCache(t,r){var i;const s=r||((i=this.currentUser)==null?void 0:i.id),n=[];for(const[o,l]of this.cache.entries())l.permissions.includes(t)&&(!s||l.userId===s)&&n.push(o);n.forEach(o=>{this.cache.delete(o)}),console.log(`🗑️ Cache invalidado para recurso: ${t} (${n.length} entradas)`)}clearUserCache(){this.currentUser&&(this.invalidateUserCache(),this.userPermissions.delete(this.currentUser.id))}getStatsByUser(t){var f;const r=t||((f=this.currentUser)==null?void 0:f.id);if(!r)return{totalEntries:0,totalSize:0,averageAccessCount:0,oldestEntry:0,newestEntry:0,resources:{}};const s=Array.from(this.cache.values()).filter(m=>m.userId===r),n=s.length,i=s.reduce((m,v)=>m+JSON.stringify(v.data).length,0),o=s.reduce((m,v)=>m+v.accessCount,0),l=n>0?o/n:0,d=s.map(m=>m.timestamp),c=d.length>0?Math.min(...d):0,u=d.length>0?Math.max(...d):0,h={};return s.forEach(m=>{m.permissions.forEach(v=>{h[v]=(h[v]||0)+1})}),{totalEntries:n,totalSize:i,averageAccessCount:l,oldestEntry:c,newestEntry:u,resources:h}}getStats(){const t=Array.from(this.cache.values()),r=new Set(t.map(d=>d.userId)),s=t.length,n=r.size,i=n>0?s/n:0,o={};for(const d of r){const c=this.userPermissions.get(d);c&&(o[c.cacheLevel]=(o[c.cacheLevel]||0)+1)}const l={};return t.forEach(d=>{d.permissions.forEach(c=>{l[c]=(l[c]||0)+1})}),{totalEntries:s,totalUsers:n,averageEntriesPerUser:i,cacheLevels:o,resources:l}}cleanup(){let t=0;for(const[r,s]of this.cache.entries())this.isExpired(s)&&(this.cache.delete(r),t++);t>0&&console.log(`🧹 Cache limpo: ${t} entradas expiradas removidas`)}evictByPriority(){const t=Array.from(this.cache.entries());t.sort(([,s],[,n])=>{const i={low:1,medium:2,high:3},o=this.getEntryPriority(s),l=this.getEntryPriority(n);return o!==l?i[o]-i[l]:s.lastAccess-n.lastAccess});const r=Math.ceil(t.length*.2);for(let s=0;s<r;s++)this.cache.delete(t[s][0]);console.log(`🗑️ ${r} entradas removidas por prioridade`)}getEntryPriority(t){const r=t.permissions[0],s=this.permissionRules.get(r);return(s==null?void 0:s.priority)||"medium"}canAccess(t,r="read"){if(!this.currentUser)return!1;const s=this.userPermissions.get(this.currentUser.id);return s?s.permissions.some(n=>n.resource===t&&n.action===r):!1}getCurrentUserCacheLevel(){if(!this.currentUser)return"none";const t=this.userPermissions.get(this.currentUser.id);return(t==null?void 0:t.cacheLevel)||"none"}clear(){this.cache.clear(),this.userPermissions.clear(),console.log("🗑️ Todo o cache de permissões foi limpo")}destroy(){this.clear(),this.currentUser=null,console.log("💥 Permission cache destruído")}}let gi=null;function Gm(){return gi||(gi=new qm),gi}class Xm{constructor(t={}){this.operations=new Map,this.isOnline=navigator.onLine,this.isProcessing=!1,this.syncInterval=null,this.listeners=new Set,this.currentUser=null,this.db=null,this.config={maxRetries:3,retryDelay:5e3,batchSize:10,syncInterval:3e4,offlineTimeout:6e4,...t},this.initializeIndexedDB(),this.setupOnlineStatusListener(),this.startPeriodicSync()}async initializeIndexedDB(){if(!(typeof window>"u"))try{const t=indexedDB.open("BackgroundSyncDB",1);t.onupgradeneeded=r=>{const s=r.target.result;if(!s.objectStoreNames.contains("sync_operations")){const n=s.createObjectStore("sync_operations",{keyPath:"id"});n.createIndex("status","status"),n.createIndex("timestamp","timestamp"),n.createIndex("userId","userId"),n.createIndex("priority","priority")}},t.onsuccess=()=>{this.db=t.result,this.loadPendingOperations(),console.log("✅ Background Sync DB inicializado")},t.onerror=()=>{console.warn("⚠️ Falha ao inicializar Background Sync DB")}}catch{console.warn("⚠️ IndexedDB não suportado para Background Sync")}}setupOnlineStatusListener(){window.addEventListener("online",()=>{this.isOnline=!0,console.log("🌐 Conexão restaurada - iniciando sincronização"),this.processPendingOperations()}),window.addEventListener("offline",()=>{this.isOnline=!1,console.log("📴 Modo offline - operações serão enfileiradas")})}async loadPendingOperations(){if(this.db)return new Promise(t=>{const i=this.db.transaction(["sync_operations"],"readonly").objectStore("sync_operations").index("status").getAll("pending");i.onsuccess=()=>{const o=i.result;o.forEach(l=>{this.operations.set(l.id,l)}),console.log(`📥 ${o.length} operações pendentes carregadas`),t()},i.onerror=()=>t()})}async addOperation(t,r,s,n={}){if(!this.currentUser&&!n.userId)throw new Error("Usuário não definido");const i={id:this.generateOperationId(),type:t,table:r,data:s,timestamp:Date.now(),retryCount:0,maxRetries:this.config.maxRetries,priority:n.priority||"medium",status:"pending",userId:n.userId||this.currentUser.id};return this.operations.set(i.id,i),this.db&&await this.saveOperationToDB(i),console.log(`➕ Operação adicionada à fila: ${t} ${r}`),this.isOnline&&this.processPendingOperations(),this.notifyListeners(),i.id}async saveOperationToDB(t){if(this.db)return new Promise((r,s)=>{const o=this.db.transaction(["sync_operations"],"readwrite").objectStore("sync_operations").put(t);o.onsuccess=()=>r(),o.onerror=()=>s(o.error)})}async removeOperationFromDB(t){if(this.db)return new Promise((r,s)=>{const o=this.db.transaction(["sync_operations"],"readwrite").objectStore("sync_operations").delete(t);o.onsuccess=()=>r(),o.onerror=()=>s(o.error)})}async processPendingOperations(){if(!(!this.isOnline||this.isProcessing)){this.isProcessing=!0,console.log("🔄 Processando operações pendentes...");try{const t=Array.from(this.operations.values()).filter(s=>s.status==="pending").sort((s,n)=>{const i={high:3,medium:2,low:1};return i[n.priority]-i[s.priority]});if(t.length===0){console.log("✅ Nenhuma operação pendente"),this.isProcessing=!1;return}const r=this.chunkArray(t,this.config.batchSize);for(const s of r)await this.processBatch(s);console.log("✅ Operações pendentes processadas")}catch(t){console.error("❌ Erro ao processar operações pendentes:",t instanceof Error?t.message:t)}finally{this.isProcessing=!1,this.notifyListeners()}}}async processBatch(t){const r=t.map(s=>this.processOperation(s));try{await Promise.allSettled(r)}catch(s){console.error("❌ Erro ao processar lote:",s)}}async processOperation(t){try{t.status="processing";const r=await this.executeOperation(t);t.status="completed",this.operations.delete(t.id),this.db&&await this.removeOperationFromDB(t.id),console.log(`✅ Operação ${t.type} ${t.table} concluída`)}catch(r){t.retryCount++,t.error=r instanceof Error?r.message:"Erro desconhecido",t.retryCount>=t.maxRetries?(t.status="failed",console.error(`❌ Operação ${t.type} ${t.table} falhou após ${t.maxRetries} tentativas`)):(t.status="pending",console.warn(`⚠️ Operação ${t.type} ${t.table} falhou, tentativa ${t.retryCount}/${t.maxRetries}`),setTimeout(()=>{this.processPendingOperations()},this.config.retryDelay*t.retryCount))}}async executeOperation(t){switch(await new Promise(r=>setTimeout(r,1e3)),t.type){case"CREATE":return this.createRecord(t.table,t.data);case"UPDATE":return this.updateRecord(t.table,t.data);case"DELETE":return this.deleteRecord(t.table,t.data);default:throw new Error(`Tipo de operação não suportado: ${t.type}`)}}async createRecord(t,r){return console.log(`📝 Criando registro em ${t}:`,r),{id:Date.now(),...r}}async updateRecord(t,r){return console.log(`🔄 Atualizando registro em ${t}:`,r),r}async deleteRecord(t,r){return console.log(`🗑️ Excluindo registro em ${t}:`,r),{deleted:!0}}chunkArray(t,r){const s=[];for(let n=0;n<t.length;n+=r)s.push(t.slice(n,n+r));return s}generateOperationId(){return`op_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}startPeriodicSync(){this.syncInterval=setInterval(()=>{this.isOnline&&this.operations.size>0&&this.processPendingOperations()},this.config.syncInterval)}stopPeriodicSync(){this.syncInterval&&(clearInterval(this.syncInterval),this.syncInterval=null)}setCurrentUser(t){this.currentUser=t,t&&this.filterOperationsByUser(t.id)}filterOperationsByUser(t){const r=new Map;for(const[s,n]of this.operations.entries())n.userId===t&&r.set(s,n);this.operations=r,console.log(`👤 Operações filtradas para usuário: ${t} (${r.size} operações)`)}addListener(t){return this.listeners.add(t),()=>{this.listeners.delete(t)}}notifyListeners(){const t=this.getStats();this.listeners.forEach(r=>{try{r(t)}catch(s){console.error("❌ Erro ao notificar listener:",s)}})}getStats(){const t=Array.from(this.operations.values());return{totalOperations:t.length,pendingOperations:t.filter(r=>r.status==="pending").length,completedOperations:t.filter(r=>r.status==="completed").length,failedOperations:t.filter(r=>r.status==="failed").length,lastSyncTime:t.length>0?Math.max(...t.map(r=>r.timestamp)):0,isOnline:this.isOnline}}getOperationsByStatus(t){return Array.from(this.operations.values()).filter(r=>r.status===t)}async cancelOperation(t){const r=this.operations.get(t);r&&r.status==="pending"&&(this.operations.delete(t),this.db&&await this.removeOperationFromDB(t),console.log(`❌ Operação cancelada: ${t}`),this.notifyListeners())}async retryOperation(t){const r=this.operations.get(t);r&&r.status==="failed"&&(r.status="pending",r.retryCount=0,r.error=void 0,this.db&&await this.saveOperationToDB(r),console.log(`🔄 Operação reagendada: ${t}`),this.isOnline&&this.processPendingOperations(),this.notifyListeners())}async clearCompletedOperations(){const t=this.getOperationsByStatus("completed");for(const r of t)this.operations.delete(r.id),this.db&&await this.removeOperationFromDB(r.id);console.log(`🗑️ ${t.length} operações completadas removidas`),this.notifyListeners()}async clearFailedOperations(){const t=this.getOperationsByStatus("failed");for(const r of t)this.operations.delete(r.id),this.db&&await this.removeOperationFromDB(r.id);console.log(`🗑️ ${t.length} operações falhadas removidas`),this.notifyListeners()}async clearAllOperations(){if(this.operations.clear(),this.db){const r=this.db.transaction(["sync_operations"],"readwrite").objectStore("sync_operations");await new Promise((s,n)=>{const i=r.clear();i.onsuccess=()=>s(),i.onerror=()=>n(i.error)})}console.log("🗑️ Todas as operações foram removidas"),this.notifyListeners()}destroy(){this.stopPeriodicSync(),this.clearAllOperations(),this.listeners.clear(),this.currentUser=null,this.db&&(this.db.close(),this.db=null),console.log("💥 Background Sync destruído")}}let pi=null;function Km(){return pi||(pi=new Xm),pi}class Ym{constructor(t={}){this.paginationCaches=new Map,this.currentUser=null,this.isInitialized=!1,this.config={enableIntelligentCache:!0,enablePersistentCache:!0,enableReactiveCache:!1,enablePollingCache:!1,enablePermissionCache:!0,enableBackgroundSync:!1,enablePaginationCache:!0,...t},this.initialize()}async initialize(){try{console.log("🚀 Inicializando Sistema Unificado de Cache..."),this.config.enableIntelligentCache&&(this.intelligentCache=sd(),console.log("✅ Cache Inteligente inicializado")),this.config.enablePersistentCache&&(this.persistentCache=Um(),await this.persistentCache.initialize(),console.log("✅ Cache Persistente inicializado")),this.config.enableReactiveCache&&(this.reactiveCache=Vm(),console.log("✅ Cache Reativo inicializado")),this.config.enablePollingCache&&(this.pollingCache=Hm(),console.log("✅ Cache com Polling inicializado")),this.config.enablePermissionCache&&(this.permissionCache=Gm(),console.log("✅ Cache de Permissões inicializado")),this.config.enableBackgroundSync&&(this.backgroundSync=Km(),console.log("✅ Background Sync inicializado")),this.isInitialized=!0,console.log("🎉 Sistema Unificado de Cache inicializado com sucesso")}catch(t){console.error("❌ Erro ao inicializar Sistema Unificado de Cache:",t)}}setCurrentUser(t){this.currentUser=t,this.intelligentCache&&this.intelligentCache.setCurrentUser(t),this.permissionCache&&this.permissionCache.setCurrentUser(t),this.backgroundSync&&this.backgroundSync.setCurrentUser(t),this.reactiveCache&&t&&this.reactiveCache.connect(t),console.log(`👤 Usuário definido no sistema unificado: ${(t==null?void 0:t.email)||"Anônimo"}`)}async get(t,r,s={}){var i;if(!this.isInitialized)throw new Error("Sistema de cache não inicializado");if(this.config.enablePermissionCache&&s.resource&&!s.skipPermissionCheck&&!this.permissionCache.canAccess(s.resource))throw new Error(`Acesso negado ao recurso: ${s.resource}`);if(this.config.enableIntelligentCache)try{return await this.intelligentCache.get(s.resource,r,{forceRefresh:s.forceRefresh,userId:(i=this.currentUser)==null?void 0:i.id})}catch(o){console.warn("⚠️ Cache inteligente falhou, tentando outras opções:",o)}if(this.config.enablePersistentCache&&this.persistentCache)try{const o=await this.persistentCache.get("default",t);if(o&&!s.forceRefresh)return console.log(`📖 Dados recuperados do cache persistente: ${t}`),o}catch(o){console.warn("⚠️ Cache persistente falhou:",o)}console.log(`🔄 Buscando dados diretamente: ${t}`);const n=await r();return await this.storeInAllCaches(t,n,s),n}async storeInAllCaches(t,r,s={}){var i;const n=[];this.config.enableIntelligentCache&&s.resource&&n.push(this.intelligentCache.get(s.resource,()=>Promise.resolve(r),{skipCache:!1}).then(()=>{})),this.config.enablePersistentCache&&n.push(this.persistentCache.set("default",t,r,{ttl:s.ttl,userId:(i=this.currentUser)==null?void 0:i.id})),this.config.enablePermissionCache&&s.resource&&n.push(Promise.resolve(this.permissionCache.set(t,r,s.resource,{ttl:s.ttl,priority:s.priority}))),await Promise.allSettled(n),console.log(`💾 Dados armazenados em todos os caches: ${t}`)}createPaginationCache(t,r,s){if(!this.config.enablePaginationCache)throw new Error("Cache de paginação não habilitado");const n=new Wm(r,s);return this.paginationCaches.set(t,n),console.log(`📄 Cache de paginação criado: ${t}`),n}getPaginationCache(t){return this.paginationCaches.get(t)||null}async invalidate(t,r={}){const s=[];this.config.enableIntelligentCache&&r.resource&&s.push(Promise.resolve(this.intelligentCache.invalidate(r.resource,r.userId))),this.config.enablePersistentCache&&s.push(this.persistentCache.delete("default",t)),this.config.enablePermissionCache&&(r.allUsers?s.push(Promise.resolve(this.permissionCache.clear())):r.resource&&s.push(Promise.resolve(this.permissionCache.invalidateResourceCache(r.resource,r.userId)))),this.config.enablePaginationCache&&this.paginationCaches.forEach(n=>{s.push(Promise.resolve(n.invalidateCache()))}),await Promise.allSettled(s),console.log(`🗑️ Cache invalidado: ${t}`)}async addSyncOperation(t,r,s,n={}){if(!this.config.enableBackgroundSync)throw new Error("Background Sync não habilitado");return this.backgroundSync.addOperation(t,r,s,n)}connectReactiveCache(){this.config.enableReactiveCache&&this.currentUser&&this.reactiveCache.connect(this.currentUser)}disconnectReactiveCache(){this.config.enableReactiveCache&&this.reactiveCache.disconnect()}startPolling(t,r,s){this.config.enablePollingCache&&this.pollingCache.startPolling(t,r,s)}stopPolling(t){this.config.enablePollingCache&&this.pollingCache.stopPolling(t)}getStats(){const t={};return this.config.enableIntelligentCache&&(t.intelligent=this.intelligentCache.getStats()),this.config.enablePersistentCache&&(t.persistent=this.persistentCache.getMetrics()),this.config.enableReactiveCache&&(t.reactive=this.reactiveCache.getStatus()),this.config.enablePollingCache&&(t.polling=this.pollingCache.getStatus()),this.config.enablePermissionCache&&(t.permission=this.permissionCache.getStats()),this.config.enableBackgroundSync&&(t.backgroundSync=this.backgroundSync.getStats()),this.config.enablePaginationCache&&(t.pagination={},this.paginationCaches.forEach((r,s)=>{t.pagination[s]=r.getStats()})),t}async cleanup(){const t=[];this.config.enableIntelligentCache&&t.push(Promise.resolve(this.intelligentCache.clear())),this.config.enablePersistentCache&&t.push(this.persistentCache.cleanup()),this.config.enablePermissionCache&&t.push(Promise.resolve(this.permissionCache.cleanup())),this.config.enableBackgroundSync&&t.push(this.backgroundSync.clearCompletedOperations()),this.config.enablePaginationCache&&this.paginationCaches.forEach(r=>{t.push(Promise.resolve(r.clearCache()))}),await Promise.allSettled(t),console.log("🧹 Limpeza geral do cache concluída")}async clearUserCache(t){var n;const r=t||((n=this.currentUser)==null?void 0:n.id);if(!r)return;const s=[];this.config.enableIntelligentCache&&s.push(Promise.resolve(this.intelligentCache.invalidateUserCache(r))),this.config.enablePersistentCache&&s.push(this.persistentCache.clearUserCache(r)),this.config.enablePermissionCache&&s.push(Promise.resolve(this.permissionCache.invalidateUserCache(r))),await Promise.allSettled(s),console.log(`🗑️ Cache do usuário limpo: ${r}`)}destroy(){console.log("💥 Destruindo Sistema Unificado de Cache..."),this.config.enableReactiveCache&&this.reactiveCache.destroy(),this.config.enablePollingCache&&this.pollingCache.destroy(),this.config.enableBackgroundSync&&this.backgroundSync.destroy(),this.config.enablePaginationCache&&(this.paginationCaches.forEach(t=>{t.destroy()}),this.paginationCaches.clear()),this.config.enablePermissionCache&&this.permissionCache.destroy(),this.config.enablePersistentCache&&this.persistentCache.close(),this.currentUser=null,this.isInitialized=!1,console.log("💥 Sistema Unificado de Cache destruído")}isReady(){return this.isInitialized}getConfig(){return{...this.config}}updateConfig(t){this.config={...this.config,...t},console.log("⚙️ Configuração do cache atualizada:",t)}}let vi=null;function Jm(){return vi||(vi=new Ym),vi}function Qm(){const e=Jm();return{isReady:e.isReady.bind(e),getConfig:e.getConfig.bind(e),updateConfig:e.updateConfig.bind(e),setCurrentUser:e.setCurrentUser.bind(e),get:e.get.bind(e),invalidate:e.invalidate.bind(e),createPaginationCache:e.createPaginationCache.bind(e),getPaginationCache:e.getPaginationCache.bind(e),addSyncOperation:e.addSyncOperation.bind(e),connectReactiveCache:e.connectReactiveCache.bind(e),disconnectReactiveCache:e.disconnectReactiveCache.bind(e),startPolling:e.startPolling.bind(e),stopPolling:e.stopPolling.bind(e),getStats:e.getStats.bind(e),cleanup:e.cleanup.bind(e),clearUserCache:e.clearUserCache.bind(e),destroy:e.destroy.bind(e)}}const nd=p.createContext(void 0),pl={vagas:[],clientes:[],sites:[],categorias:[],cargos:[],celulas:[],usuarios:[],noticias:[],lastUpdated:0};function Zm({children:e}){const[t,r]=p.useState(pl),[s,n]=p.useState(!1),[i,o]=p.useState(!1),[l,d]=p.useState({vagas:!1,clientes:!1,sites:!1,categorias:!1,cargos:!1,celulas:!1,usuarios:!1,noticias:!1}),{user:c}=tt(),u=Qm(),h=p.useCallback((I,V)=>{d(ae=>({...ae,[I]:V}))},[]),f=p.useCallback(async()=>{try{console.log("🔄 Carregando vagas (FORÇANDO refresh do DB)..."),n(!0),console.log("🗑️ Limpando cache antes do refresh...");const I=await rd();r(V=>({...V,vagas:I,lastUpdated:Date.now()})),h("vagas",I.length>0),console.log(`✅ ${I.length} vagas carregadas diretamente do DB`),setTimeout(()=>{n(!1)},100)}catch(I){console.error("❌ Erro ao carregar vagas:",I),n(!1)}},[h]),m=p.useCallback(async()=>{try{console.log("🔄 Carregando clientes...");const I=await zi();r(V=>({...V,clientes:I,lastUpdated:Date.now()})),h("clientes",I.length>0),console.log(`✅ ${I.length} clientes carregados`)}catch(I){console.error("❌ Erro ao carregar clientes:",I)}},[h]),v=p.useCallback(async()=>{try{console.log("🔄 Carregando sites...");const I=await Am();r(V=>({...V,sites:I,lastUpdated:Date.now()})),h("sites",I.length>0),console.log(`✅ ${I.length} sites carregados`)}catch(I){console.error("❌ Erro ao carregar sites:",I)}},[h]),g=p.useCallback(async()=>{try{console.log("🔄 Carregando categorias...");const I=await Rm();r(V=>({...V,categorias:I,lastUpdated:Date.now()})),h("categorias",I.length>0),console.log(`✅ ${I.length} categorias carregadas`)}catch(I){console.error("❌ Erro ao carregar categorias:",I)}},[h]),x=p.useCallback(async()=>{try{console.log("🔄 Carregando cargos...");const I=await Fm();r(V=>({...V,cargos:I,lastUpdated:Date.now()})),h("cargos",I.length>0),console.log(`✅ ${I.length} cargos carregados`)}catch(I){console.error("❌ Erro ao carregar cargos:",I)}},[h]),b=p.useCallback(async()=>{try{console.log("🔄 Carregando células...");const I=await km();r(V=>({...V,celulas:I,lastUpdated:Date.now()})),h("celulas",I.length>0),console.log(`✅ ${I.length} células carregadas`)}catch(I){console.error("❌ Erro ao carregar células:",I)}},[h]),N=p.useCallback(async()=>{try{console.log("🔄 Carregando usuários...");const I=await Bi();r(V=>({...V,usuarios:I,lastUpdated:Date.now()})),h("usuarios",I.length>0),console.log(`✅ ${I.length} usuários carregados`)}catch(I){console.error("❌ Erro ao carregar usuários:",I)}},[h]),y=p.useCallback(async()=>{try{console.log("🔄 Carregando notícias...");const I=await Vi();r(V=>({...V,noticias:I,lastUpdated:Date.now()})),h("noticias",I.length>0),console.log(`✅ ${I.length} notícias carregadas`)}catch(I){console.error("❌ Erro ao carregar notícias:",I)}},[h]),A=p.useCallback(async()=>{console.log("🚀 Forçando carregamento inicial de todos os dados..."),n(!0);try{const I=[f(),m(),v(),g(),x(),b(),N(),y()];await Promise.all(I),console.log("✅ Carregamento inicial forçado concluído")}catch(I){console.error("❌ Erro no carregamento inicial forçado:",I)}finally{n(!1)}},[f,m,v,g,x,b,N,y]),B=p.useCallback(async()=>{if(!s)try{n(!0),console.log("🔄 Carregando todos os dados...");const I=[f(),m(),v(),g(),x(),b(),N(),y()];await Promise.all(I),console.log("✅ Todos os dados carregados com sucesso")}catch(I){console.error("❌ Erro ao carregar dados:",I)}finally{n(!1)}},[s,f,m,v,g,x,b,N,y]),W=p.useCallback(I=>{r(V=>({...V,vagas:[I,...V.vagas],lastUpdated:Date.now()})),console.log("➕ Vaga adicionada ao cache")},[]),C=p.useCallback(I=>{r(V=>({...V,vagas:V.vagas.map(ae=>ae.id===I.id?I:ae),lastUpdated:Date.now()})),console.log("🔄 Vaga atualizada no cache")},[]),L=p.useCallback(I=>{r(V=>({...V,vagas:V.vagas.filter(ae=>ae.id!==I),lastUpdated:Date.now()})),console.log("➖ Vaga removida do cache")},[]),T=p.useCallback(()=>{r(pl),d({vagas:!1,clientes:!1,sites:!1,categorias:!1,cargos:!1,celulas:!1,usuarios:!1,noticias:!1}),console.log("🗑️ Cache limpo")},[]);p.useEffect(()=>{if(c){try{const I={id:c.id,email:c.email,name:c.name,role:c.role,password_hash:"",created_at:new Date().toISOString(),updated_at:new Date().toISOString()};u.setCurrentUser(I)}catch(I){console.warn("⚠️ Erro ao configurar usuário no cache unificado:",I)}u.updateConfig({enableReactiveCache:!1,enablePollingCache:!1,enableIntelligentCache:!0,enablePersistentCache:!1,enablePermissionCache:!1,enableBackgroundSync:!1,enablePaginationCache:!0}),console.log("👤 Usuário configurado no cache unificado (modo desenvolvimento)")}},[c,u]),p.useEffect(()=>{c&&!i&&(console.log("👤 Usuário logado - carregando dados..."),o(!0),A())},[c==null?void 0:c.id,i,A]);const P={cache:t,loading:s,refreshVagas:f,refreshClientes:m,refreshSites:v,refreshCategorias:g,refreshCargos:x,refreshCelulas:b,refreshUsuarios:N,refreshNoticias:y,refreshAll:B,forceInitialLoad:A,addVaga:W,updateVaga:C,removeVaga:L,clearCache:T,cacheStatus:l};return a.jsx(nd.Provider,{value:P,children:e})}function Br(){const e=p.useContext(nd);if(e===void 0)throw new Error("useCache deve ser usado dentro de um CacheProvider");return e}const Hi={default:{light:{background:"0 0% 100%",foreground:"224 71.4% 4.1%",card:"180 8% 97%",cardForeground:"224 71.4% 4.1%",popover:"0 0% 100%",popoverForeground:"224 71.4% 4.1%",primary:"220.9 39.3% 11%",primaryForeground:"210 20% 98%",secondary:"220 14.3% 95.9%",secondaryForeground:"220.9 39.3% 11%",muted:"220 14.3% 95.9%",mutedForeground:"220 8.9% 46.1%",accent:"220 14.3% 95.9%",accentForeground:"220.9 39.3% 11%",destructive:"0 84.2% 60.2%",destructiveForeground:"210 20% 98%",border:"220 13% 91%",input:"220 13% 91%",ring:"224 71.4% 4.1%",success:"142 76% 36%",successForeground:"210 20% 98%",warning:"38 92% 50%",warningForeground:"210 20% 98%"},dark:{background:"216 51% 11%",foreground:"0 0% 98%",card:"213 33% 17%",cardForeground:"0 0% 98%",popover:"224 71.4% 4.1%",popoverForeground:"0 0% 98%",primary:"210 20% 98%",primaryForeground:"220.9 39.3% 11%",secondary:"216 41% 3%",secondaryForeground:"0 0% 98%",muted:"216 41% 3%",mutedForeground:"0 0% 98%",accent:"216 41% 3%",accentForeground:"0 0% 98%",destructive:"0 62.8% 30.6%",destructiveForeground:"0 0% 98%",border:"216 41% 3%",input:"216 41% 3%",ring:"216 12.2% 83.9%",success:"142 76% 36%",successForeground:"0 0% 98%",warning:"38 92% 50%",warningForeground:"0 0% 98%"}},rose:{light:{background:"0 0% 100%",foreground:"240 10% 3.9%",card:"180 8% 97%",cardForeground:"240 10% 3.9%",popover:"0 0% 100%",popoverForeground:"240 10% 3.9%",primary:"346.8 77.2% 49.8%",primaryForeground:"355.7 100% 97.3%",secondary:"240 4.8% 95.9%",secondaryForeground:"240 5.9% 10%",muted:"240 4.8% 95.9%",mutedForeground:"240 3.8% 46.1%",accent:"240 4.8% 95.9%",accentForeground:"240 5.9% 10%",destructive:"0 84.2% 60.2%",destructiveForeground:"0 0% 98%",border:"240 5.9% 90%",input:"240 5.9% 90%",ring:"346.8 77.2% 49.8%",success:"142 76% 36%",successForeground:"210 20% 98%",warning:"38 92% 50%",warningForeground:"210 20% 98%"},dark:{background:"213 51% 11%",foreground:"0 0% 98%",card:"213 33% 17%",cardForeground:"0 0% 98%",popover:"240 10% 3.9%",popoverForeground:"0 0% 98%",primary:"346.8 77.2% 49.8%",primaryForeground:"355.7 100% 97.3%",secondary:"240 3.7% 15.9%",secondaryForeground:"0 0% 98%",muted:"240 3.7% 15.9%",mutedForeground:"0 0% 98%",accent:"240 3.7% 15.9%",accentForeground:"0 0% 98%",destructive:"0 62.8% 30.6%",destructiveForeground:"0 0% 98%",border:"240 3.7% 15.9%",input:"240 3.7% 15.9%",ring:"346.8 77.2% 49.8%",success:"142 76% 36%",successForeground:"0 0% 98%",warning:"38 92% 50%",warningForeground:"0 0% 98%"}},violet:{light:{background:"0 0% 100%",foreground:"240 10% 3.9%",card:"180 8% 97%",cardForeground:"240 10% 3.9%",popover:"0 0% 100%",popoverForeground:"240 10% 3.9%",primary:"262.1 83.3% 57.8%",primaryForeground:"210 20% 98%",secondary:"240 4.8% 95.9%",secondaryForeground:"240 5.9% 10%",muted:"240 4.8% 95.9%",mutedForeground:"240 3.8% 46.1%",accent:"240 4.8% 95.9%",accentForeground:"240 5.9% 10%",destructive:"0 84.2% 60.2%",destructiveForeground:"0 0% 98%",border:"240 5.9% 90%",input:"240 5.9% 90%",ring:"262.1 83.3% 57.8%",success:"142 76% 36%",successForeground:"210 20% 98%",warning:"38 92% 50%",warningForeground:"210 20% 98%"},dark:{background:"213 51% 11%",foreground:"0 0% 98%",card:"213 33% 17%",cardForeground:"0 0% 98%",popover:"240 10% 3.9%",popoverForeground:"0 0% 98%",primary:"263.4 70% 50.4%",primaryForeground:"210 20% 98%",secondary:"240 3.7% 15.9%",secondaryForeground:"0 0% 98%",muted:"240 3.7% 15.9%",mutedForeground:"0 0% 98%",accent:"240 3.7% 15.9%",accentForeground:"0 0% 98%",destructive:"0 62.8% 30.6%",destructiveForeground:"0 0% 98%",border:"240 3.7% 15.9%",input:"240 3.7% 15.9%",ring:"263.4 70% 50.4%",success:"142 76% 36%",successForeground:"0 0% 98%",warning:"38 92% 50%",warningForeground:"0 0% 98%"}},emerald:{light:{background:"0 0% 100%",foreground:"240 10% 3.9%",card:"180 8% 97%",cardForeground:"240 10% 3.9%",popover:"0 0% 100%",popoverForeground:"240 10% 3.9%",primary:"158.1 64.4% 51.6%",primaryForeground:"355.7 100% 97.3%",secondary:"240 4.8% 95.9%",secondaryForeground:"240 5.9% 10%",muted:"240 4.8% 95.9%",mutedForeground:"240 3.8% 46.1%",accent:"240 4.8% 95.9%",accentForeground:"240 5.9% 10%",destructive:"0 84.2% 60.2%",destructiveForeground:"0 0% 98%",border:"240 5.9% 90%",input:"240 5.9% 90%",ring:"158.1 64.4% 51.6%",success:"142 76% 36%",successForeground:"210 20% 98%",warning:"38 92% 50%",warningForeground:"210 20% 98%"},dark:{background:"213 51% 11%",foreground:"0 0% 98%",card:"213 33% 17%",cardForeground:"0 0% 98%",popover:"240 10% 3.9%",popoverForeground:"0 0% 98%",primary:"158.1 64.4% 51.6%",primaryForeground:"355.7 100% 97.3%",secondary:"240 3.7% 15.9%",secondaryForeground:"0 0% 98%",muted:"240 3.7% 15.9%",mutedForeground:"0 0% 98%",accent:"240 3.7% 15.9%",accentForeground:"0 0% 98%",destructive:"0 62.8% 30.6%",destructiveForeground:"0 0% 98%",border:"240 3.7% 15.9%",input:"240 3.7% 15.9%",ring:"158.1 64.4% 51.6%",success:"142 76% 36%",successForeground:"0 0% 98%",warning:"38 92% 50%",warningForeground:"0 0% 98%"}},amber:{light:{background:"0 0% 100%",foreground:"240 10% 3.9%",card:"180 8% 97%",cardForeground:"240 10% 3.9%",popover:"0 0% 100%",popoverForeground:"240 10% 3.9%",primary:"25 95% 53%",primaryForeground:"60 9.1% 97.8%",secondary:"240 4.8% 95.9%",secondaryForeground:"240 5.9% 10%",muted:"240 4.8% 95.9%",mutedForeground:"240 3.8% 46.1%",accent:"240 4.8% 95.9%",accentForeground:"240 5.9% 10%",destructive:"0 84.2% 60.2%",destructiveForeground:"0 0% 98%",border:"240 5.9% 90%",input:"240 5.9% 90%",ring:"25 95% 53%",success:"142 76% 36%",successForeground:"210 20% 98%",warning:"38 92% 50%",warningForeground:"210 20% 98%"},dark:{background:"213 51% 11%",foreground:"0 0% 98%",card:"213 33% 17%",cardForeground:"0 0% 98%",popover:"240 10% 3.9%",popoverForeground:"0 0% 98%",primary:"20.5 90.2% 48.2%",primaryForeground:"60 9.1% 97.8%",secondary:"240 3.7% 15.9%",secondaryForeground:"0 0% 98%",muted:"240 3.7% 15.9%",mutedForeground:"0 0% 98%",accent:"240 3.7% 15.9%",accentForeground:"0 0% 98%",destructive:"0 62.8% 30.6%",destructiveForeground:"0 0% 98%",border:"240 3.7% 15.9%",input:"240 3.7% 15.9%",ring:"20.5 90.2% 48.2%",success:"142 76% 36%",successForeground:"0 0% 98%",warning:"38 92% 50%",warningForeground:"0 0% 98%"}},cyan:{light:{background:"0 0% 100%",foreground:"240 10% 3.9%",card:"180 8% 97%",cardForeground:"240 10% 3.9%",popover:"0 0% 100%",popoverForeground:"240 10% 3.9%",primary:"188.7 94.5% 42.7%",primaryForeground:"0 0% 98%",secondary:"240 4.8% 95.9%",secondaryForeground:"240 5.9% 10%",muted:"240 4.8% 95.9%",mutedForeground:"240 3.8% 46.1%",accent:"240 4.8% 95.9%",accentForeground:"240 5.9% 10%",destructive:"0 84.2% 60.2%",destructiveForeground:"0 0% 98%",border:"240 5.9% 90%",input:"240 5.9% 90%",ring:"188.7 94.5% 42.7%",success:"142 76% 36%",successForeground:"210 20% 98%",warning:"38 92% 50%",warningForeground:"210 20% 98%"},dark:{background:"213 51% 11%",foreground:"0 0% 98%",card:"213 33% 17%",cardForeground:"0 0% 98%",popover:"240 10% 3.9%",popoverForeground:"0 0% 98%",primary:"188.7 94.5% 42.7%",primaryForeground:"0 0% 98%",secondary:"240 3.7% 15.9%",secondaryForeground:"0 0% 98%",muted:"240 3.7% 15.9%",mutedForeground:"0 0% 98%",accent:"240 3.7% 15.9%",accentForeground:"0 0% 98%",destructive:"0 62.8% 30.6%",destructiveForeground:"0 0% 98%",border:"240 3.7% 15.9%",input:"240 3.7% 15.9%",ring:"188.7 94.5% 42.7%",success:"142 76% 36%",successForeground:"0 0% 98%",warning:"38 92% 50%",warningForeground:"0 0% 98%"}}};function vl(e,t){const r=Hi[t]||Hi.default,s=e==="dark"?r.dark:r.light;return{mode:e,profile:t,colors:{background:s.background,foreground:s.foreground,card:s.card,cardForeground:s.cardForeground,popover:s.popover,popoverForeground:s.popoverForeground,primary:s.primary,primaryForeground:s.primaryForeground,secondary:s.secondary,secondaryForeground:s.secondaryForeground,muted:s.muted,mutedForeground:s.mutedForeground,accent:s.accent,accentForeground:s.accentForeground,destructive:s.destructive,destructiveForeground:s.destructiveForeground,border:s.border,input:s.input,ring:s.ring,success:s.success,successForeground:s.successForeground,warning:s.warning,warningForeground:s.warningForeground},effects:{borderRadius:"0.5rem",shadow:e==="dark"?"0 4px 6px -1px rgb(0 0 0 / 0.3), 0 2px 4px -2px rgb(0 0 0 / 0.2)":"0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1)",animation:"150ms cubic-bezier(0.4, 0, 0.2, 1)",glassmorphism:!1,gradients:!1}}}function ex(e){const t=document.documentElement;t.style.setProperty("--radius",e.effects.borderRadius),t.style.setProperty("--shadow",e.effects.shadow),t.style.setProperty("--animation",e.effects.animation),t.className=`${e.mode} ${e.profile}`,e.effects.glassmorphism?t.classList.add("glassmorphism"):t.classList.remove("glassmorphism"),e.effects.gradients?t.classList.add("gradients"):t.classList.remove("gradients"),console.log("🎨 Tema aplicado:",{mode:e.mode,profile:e.profile,primary:e.colors.primary,classes:t.className})}function tx(){return Object.keys(Hi)}function rx(e){return{name:{default:"Padrão",rose:"Rosa",violet:"Violeta",emerald:"Esmeralda",amber:"Âmbar",cyan:"Ciano"}[e]||e,value:e}}const id=p.createContext(void 0);function ax({children:e}){const[t,r]=p.useState("light"),[s,n]=p.useState("default"),[i,o]=p.useState(vl("light","default"));p.useEffect(()=>{const d=localStorage.getItem("theme-mode"),c=localStorage.getItem("theme-profile");d&&r(d),c&&n(c)},[]),p.useEffect(()=>{const d=vl(t,s);o(d),ex(d),localStorage.setItem("theme-mode",t),localStorage.setItem("theme-profile",s),setTimeout(()=>{const c=document.documentElement,u=getComputedStyle(c).getPropertyValue("--primary");console.log("🔍 Debug ThemeContext:",{mode:t,profile:s,primaryColor:u,classes:c.className,expectedPrimary:d.colors.primary})},100)},[t,s]);const l=(d,c)=>{r(d),n(c)};return a.jsx(id.Provider,{value:{mode:t,profile:s,config:i,setMode:r,setProfile:n,setTheme:l},children:e})}function hr(){const e=p.useContext(id);if(e===void 0)throw new Error("useTheme must be used within a ThemeProvider");return e}function sx(){p.useEffect(()=>{const e=()=>{sessionStorage.clear(),console.log("Cache limpo antes de fechar a aplicação")},t=()=>{document.visibilityState==="hidden"&&console.log("Aplicação minimizada/fechada - preparando limpeza")};return window.addEventListener("beforeunload",e),document.addEventListener("visibilitychange",t),()=>{window.removeEventListener("beforeunload",e),document.removeEventListener("visibilitychange",t)}},[])}function ho({message:e="Carregando...",showSpinner:t=!0,variant:r="default"}){const{config:s}=hr();return r==="minimal"?a.jsx("div",{className:"flex items-center justify-center p-8",children:a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx(Mr,{className:"h-5 w-5 animate-spin text-primary"}),a.jsx("span",{className:"text-sm text-muted-foreground",children:e})]})}):r==="skeleton"?a.jsx("div",{className:"space-y-4",children:a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("div",{className:"w-8 h-8 bg-muted rounded animate-pulse"}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("div",{className:"h-4 bg-muted rounded w-32 animate-pulse"}),a.jsx("div",{className:"h-3 bg-muted rounded w-24 animate-pulse"})]})]})}):a.jsxs("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-background via-background to-muted/20 relative overflow-hidden",children:[a.jsx("div",{className:"absolute inset-0 bg-[url('data:image/svg+xml,%3Csvg%20width%3D%2260%22%20height%3D%2260%22%20viewBox%3D%220%200%2060%2060%22%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%3E%3Cg%20fill%3D%22none%22%20fill-rule%3D%22evenodd%22%3E%3Cg%20fill%3D%22%239C92AC%22%20fill-opacity%3D%220.05%22%3E%3Ccircle%20cx%3D%2230%22%20cy%3D%2230%22%20r%3D%222%22/%3E%3C/g%3E%3C/g%3E%3C/svg%3E')] opacity-40 animate-pulse"}),a.jsx("div",{className:"absolute top-20 left-20 w-32 h-32 bg-primary/10 rounded-full blur-xl animate-pulse"}),a.jsx("div",{className:"absolute bottom-20 right-20 w-24 h-24 bg-secondary/10 rounded-full blur-xl animate-pulse delay-1000"}),a.jsxs("div",{className:"flex flex-col items-center space-y-6 relative z-10",children:[t&&a.jsxs("div",{className:"relative",children:[a.jsx("div",{className:`animate-spin rounded-full h-20 w-20 border-4 ${s.effects.gradients?"border-gradient-to-r from-primary to-primary/70":"border-primary"} border-t-transparent shadow-2xl`}),a.jsx("div",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2",children:a.jsx(ot,{className:`h-8 w-8 ${s.effects.gradients,"text-primary animate-pulse"}`})}),a.jsx("div",{className:"absolute inset-0 animate-spin",style:{animationDuration:"3s",animationDirection:"reverse"},children:a.jsx("div",{className:"absolute top-0 left-1/2 transform -translate-x-1/2 w-2 h-2 bg-primary/50 rounded-full"})}),a.jsx("div",{className:"absolute inset-0 animate-spin",style:{animationDuration:"4s"},children:a.jsx("div",{className:"absolute bottom-0 left-1/2 transform -translate-x-1/2 w-1 h-1 bg-primary/30 rounded-full"})})]}),a.jsxs("div",{className:"text-center space-y-3",children:[a.jsx("h2",{className:`text-xl font-bold ${s.effects.gradients?"bg-gradient-to-r from-primary via-primary/80 to-primary/60 bg-clip-text text-transparent":"text-primary"}`,children:e}),a.jsx("p",{className:"text-muted-foreground text-sm max-w-md",children:"Aguarde enquanto carregamos os dados do sistema..."}),a.jsx("div",{className:"w-64 h-1 bg-muted rounded-full overflow-hidden",children:a.jsx("div",{className:"h-full bg-gradient-to-r from-primary to-primary/70 rounded-full animate-pulse"})})]})]})]})}function nx(){const{user:e,loading:t}=tt(),{cache:r,loading:s}=Br();return null}const ix=({error:e,onRetry:t,onGoHome:r})=>{const s=()=>{t?t():window.location.reload()},n=()=>{r?r():window.location.href="/"};return a.jsx("div",{className:"min-h-screen flex items-center justify-center bg-background",children:a.jsx("div",{className:"max-w-md w-full mx-4",children:a.jsxs("div",{className:"text-center space-y-6",children:[a.jsx("div",{className:"flex justify-center",children:a.jsx("div",{className:"w-16 h-16 bg-destructive/10 rounded-full flex items-center justify-center",children:a.jsx(oa,{className:"w-8 h-8 text-destructive"})})}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("h1",{className:"text-2xl font-bold text-foreground",children:"Erro ao Carregar"}),a.jsx("p",{className:"text-muted-foreground",children:"Ocorreu um problema ao inicializar a aplicação. Isso pode ser temporário."})]}),e&&!1,a.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 justify-center",children:[a.jsxs(Q,{onClick:s,className:"flex items-center gap-2",children:[a.jsx(ot,{className:"w-4 h-4"}),"Tentar Novamente"]}),a.jsxs(Q,{onClick:n,variant:"outline",className:"flex items-center gap-2",children:[a.jsx(Bc,{className:"w-4 h-4"}),"Página Inicial"]})]}),a.jsxs("div",{className:"text-xs text-muted-foreground space-y-1",children:[a.jsx("p",{children:"Se o problema persistir, verifique sua conexão com a internet."}),a.jsx("p",{children:"Versão da aplicação: 1.0.4"})]})]})})})},Re=p.forwardRef(({className:e,type:t,...r},s)=>a.jsx("input",{type:t,className:De("flex h-10 w-full rounded-xl border border-input bg-background/50 backdrop-blur-sm px-4 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 transition-all duration-200 hover:shadow-sm focus:shadow-md",e),ref:s,...r}));Re.displayName="Input";var ox="Label",od=p.forwardRef((e,t)=>a.jsx(nt.label,{...e,ref:t,onMouseDown:r=>{var n;r.target.closest("button, input, select, textarea")||((n=e.onMouseDown)==null||n.call(e,r),!r.defaultPrevented&&r.detail>1&&r.preventDefault())}}));od.displayName=ox;var ld=od;const lx=uo("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),fe=p.forwardRef(({className:e,...t},r)=>a.jsx(ld,{ref:r,className:De(lx(),e),...t}));fe.displayName=ld.displayName;var wi="rovingFocusGroup.onEntryFocus",cx={bubbles:!1,cancelable:!0},Ls="RovingFocusGroup",[Wi,cd,dx]=vc(Ls),[ux,zn]=_a(Ls,[dx]),[hx,fx]=ux(Ls),dd=p.forwardRef((e,t)=>a.jsx(Wi.Provider,{scope:e.__scopeRovingFocusGroup,children:a.jsx(Wi.Slot,{scope:e.__scopeRovingFocusGroup,children:a.jsx(mx,{...e,ref:t})})}));dd.displayName=Ls;var mx=p.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:r,orientation:s,loop:n=!1,dir:i,currentTabStopId:o,defaultCurrentTabStopId:l,onCurrentTabStopIdChange:d,onEntryFocus:c,preventScrollOnEntryFocus:u=!1,...h}=e,f=p.useRef(null),m=Mt(t,f),v=In(i),[g,x]=Za({prop:o,defaultProp:l??null,onChange:d,caller:Ls}),[b,N]=p.useState(!1),y=wr(c),A=cd(r),B=p.useRef(!1),[W,C]=p.useState(0);return p.useEffect(()=>{const L=f.current;if(L)return L.addEventListener(wi,y),()=>L.removeEventListener(wi,y)},[y]),a.jsx(hx,{scope:r,orientation:s,dir:v,loop:n,currentTabStopId:g,onItemFocus:p.useCallback(L=>x(L),[x]),onItemShiftTab:p.useCallback(()=>N(!0),[]),onFocusableItemAdd:p.useCallback(()=>C(L=>L+1),[]),onFocusableItemRemove:p.useCallback(()=>C(L=>L-1),[]),children:a.jsx(nt.div,{tabIndex:b||W===0?-1:0,"data-orientation":s,...h,ref:m,style:{outline:"none",...e.style},onMouseDown:ke(e.onMouseDown,()=>{B.current=!0}),onFocus:ke(e.onFocus,L=>{const T=!B.current;if(L.target===L.currentTarget&&T&&!b){const P=new CustomEvent(wi,cx);if(L.currentTarget.dispatchEvent(P),!P.defaultPrevented){const I=A().filter(we=>we.focusable),V=I.find(we=>we.active),ae=I.find(we=>we.id===g),ve=[V,ae,...I].filter(Boolean).map(we=>we.ref.current);fd(ve,u)}}B.current=!1}),onBlur:ke(e.onBlur,()=>N(!1))})})}),ud="RovingFocusGroupItem",hd=p.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:r,focusable:s=!0,active:n=!1,tabStopId:i,children:o,...l}=e,d=ba(),c=i||d,u=fx(ud,r),h=u.currentTabStopId===c,f=cd(r),{onFocusableItemAdd:m,onFocusableItemRemove:v,currentTabStopId:g}=u;return p.useEffect(()=>{if(s)return m(),()=>v()},[s,m,v]),a.jsx(Wi.ItemSlot,{scope:r,id:c,focusable:s,active:n,children:a.jsx(nt.span,{tabIndex:h?0:-1,"data-orientation":u.orientation,...l,ref:t,onMouseDown:ke(e.onMouseDown,x=>{s?u.onItemFocus(c):x.preventDefault()}),onFocus:ke(e.onFocus,()=>u.onItemFocus(c)),onKeyDown:ke(e.onKeyDown,x=>{if(x.key==="Tab"&&x.shiftKey){u.onItemShiftTab();return}if(x.target!==x.currentTarget)return;const b=px(x,u.orientation,u.dir);if(b!==void 0){if(x.metaKey||x.ctrlKey||x.altKey||x.shiftKey)return;x.preventDefault();let y=f().filter(A=>A.focusable).map(A=>A.ref.current);if(b==="last")y.reverse();else if(b==="prev"||b==="next"){b==="prev"&&y.reverse();const A=y.indexOf(x.currentTarget);y=u.loop?vx(y,A+1):y.slice(A+1)}setTimeout(()=>fd(y))}}),children:typeof o=="function"?o({isCurrentTabStop:h,hasTabStop:g!=null}):o})})});hd.displayName=ud;var xx={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function gx(e,t){return t!=="rtl"?e:e==="ArrowLeft"?"ArrowRight":e==="ArrowRight"?"ArrowLeft":e}function px(e,t,r){const s=gx(e.key,r);if(!(t==="vertical"&&["ArrowLeft","ArrowRight"].includes(s))&&!(t==="horizontal"&&["ArrowUp","ArrowDown"].includes(s)))return xx[s]}function fd(e,t=!1){const r=document.activeElement;for(const s of e)if(s===r||(s.focus({preventScroll:t}),document.activeElement!==r))return}function vx(e,t){return e.map((r,s)=>e[(t+s)%e.length])}var md=dd,xd=hd,qi=["Enter"," "],wx=["ArrowDown","PageUp","Home"],gd=["ArrowUp","PageDown","End"],bx=[...wx,...gd],yx={ltr:[...qi,"ArrowRight"],rtl:[...qi,"ArrowLeft"]},Nx={ltr:["ArrowLeft"],rtl:["ArrowRight"]},Bs="Menu",[Cs,jx,Ex]=vc(Bs),[Sa,pd]=_a(Bs,[Ex,On,zn]),Us=On(),vd=zn(),[wd,fa]=Sa(Bs),[_x,$s]=Sa(Bs),bd=e=>{const{__scopeMenu:t,open:r=!1,children:s,dir:n,onOpenChange:i,modal:o=!0}=e,l=Us(t),[d,c]=p.useState(null),u=p.useRef(!1),h=wr(i),f=In(n);return p.useEffect(()=>{const m=()=>{u.current=!0,document.addEventListener("pointerdown",v,{capture:!0,once:!0}),document.addEventListener("pointermove",v,{capture:!0,once:!0})},v=()=>u.current=!1;return document.addEventListener("keydown",m,{capture:!0}),()=>{document.removeEventListener("keydown",m,{capture:!0}),document.removeEventListener("pointerdown",v,{capture:!0}),document.removeEventListener("pointermove",v,{capture:!0})}},[]),a.jsx(no,{...l,children:a.jsx(wd,{scope:t,open:r,onOpenChange:h,content:d,onContentChange:c,children:a.jsx(_x,{scope:t,onClose:p.useCallback(()=>h(!1),[h]),isUsingKeyboardRef:u,dir:f,modal:o,children:s})})})};bd.displayName=Bs;var Sx="MenuAnchor",fo=p.forwardRef((e,t)=>{const{__scopeMenu:r,...s}=e,n=Us(r);return a.jsx(yc,{...n,...s,ref:t})});fo.displayName=Sx;var mo="MenuPortal",[Cx,yd]=Sa(mo,{forceMount:void 0}),Nd=e=>{const{__scopeMenu:t,forceMount:r,children:s,container:n}=e,i=fa(mo,t);return a.jsx(Cx,{scope:t,forceMount:r,children:a.jsx(_r,{present:r||i.open,children:a.jsx(bc,{asChild:!0,container:n,children:s})})})};Nd.displayName=mo;var ur="MenuContent",[Tx,xo]=Sa(ur),jd=p.forwardRef((e,t)=>{const r=yd(ur,e.__scopeMenu),{forceMount:s=r.forceMount,...n}=e,i=fa(ur,e.__scopeMenu),o=$s(ur,e.__scopeMenu);return a.jsx(Cs.Provider,{scope:e.__scopeMenu,children:a.jsx(_r,{present:s||i.open,children:a.jsx(Cs.Slot,{scope:e.__scopeMenu,children:o.modal?a.jsx(Ax,{...n,ref:t}):a.jsx(Rx,{...n,ref:t})})})})}),Ax=p.forwardRef((e,t)=>{const r=fa(ur,e.__scopeMenu),s=p.useRef(null),n=Mt(t,s);return p.useEffect(()=>{const i=s.current;if(i)return xf(i)},[]),a.jsx(go,{...e,ref:n,trapFocus:r.open,disableOutsidePointerEvents:r.open,disableOutsideScroll:!0,onFocusOutside:ke(e.onFocusOutside,i=>i.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>r.onOpenChange(!1)})}),Rx=p.forwardRef((e,t)=>{const r=fa(ur,e.__scopeMenu);return a.jsx(go,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>r.onOpenChange(!1)})}),Fx=ff("MenuContent.ScrollLock"),go=p.forwardRef((e,t)=>{const{__scopeMenu:r,loop:s=!1,trapFocus:n,onOpenAutoFocus:i,onCloseAutoFocus:o,disableOutsidePointerEvents:l,onEntryFocus:d,onEscapeKeyDown:c,onPointerDownOutside:u,onFocusOutside:h,onInteractOutside:f,onDismiss:m,disableOutsideScroll:v,...g}=e,x=fa(ur,r),b=$s(ur,r),N=Us(r),y=vd(r),A=jx(r),[B,W]=p.useState(null),C=p.useRef(null),L=Mt(t,C,x.onContentChange),T=p.useRef(0),P=p.useRef(""),I=p.useRef(0),V=p.useRef(null),ae=p.useRef("right"),_e=p.useRef(0),ve=v?hf:p.Fragment,we=v?{as:Fx,allowPinchZoom:!0}:void 0,be=Z=>{var z,D;const ue=P.current+Z,me=A().filter(G=>!G.disabled),k=document.activeElement,M=(z=me.find(G=>G.ref.current===k))==null?void 0:z.textValue,O=me.map(G=>G.textValue),R=Vx(O,ue,M),q=(D=me.find(G=>G.textValue===R))==null?void 0:D.ref.current;(function G(ee){P.current=ee,window.clearTimeout(T.current),ee!==""&&(T.current=window.setTimeout(()=>G(""),1e3))})(ue),q&&setTimeout(()=>q.focus())};p.useEffect(()=>()=>window.clearTimeout(T.current),[]),uf();const J=p.useCallback(Z=>{var me,k;return ae.current===((me=V.current)==null?void 0:me.side)&&Wx(Z,(k=V.current)==null?void 0:k.area)},[]);return a.jsx(Tx,{scope:r,searchRef:P,onItemEnter:p.useCallback(Z=>{J(Z)&&Z.preventDefault()},[J]),onItemLeave:p.useCallback(Z=>{var ue;J(Z)||((ue=C.current)==null||ue.focus(),W(null))},[J]),onTriggerLeave:p.useCallback(Z=>{J(Z)&&Z.preventDefault()},[J]),pointerGraceTimerRef:I,onPointerGraceIntentChange:p.useCallback(Z=>{V.current=Z},[]),children:a.jsx(ve,{...we,children:a.jsx(mf,{asChild:!0,trapped:n,onMountAutoFocus:ke(i,Z=>{var ue;Z.preventDefault(),(ue=C.current)==null||ue.focus({preventScroll:!0})}),onUnmountAutoFocus:o,children:a.jsx(Nc,{asChild:!0,disableOutsidePointerEvents:l,onEscapeKeyDown:c,onPointerDownOutside:u,onFocusOutside:h,onInteractOutside:f,onDismiss:m,children:a.jsx(md,{asChild:!0,...y,dir:b.dir,orientation:"vertical",loop:s,currentTabStopId:B,onCurrentTabStopIdChange:W,onEntryFocus:ke(d,Z=>{b.isUsingKeyboardRef.current||Z.preventDefault()}),preventScrollOnEntryFocus:!0,children:a.jsx(jc,{role:"menu","aria-orientation":"vertical","data-state":Ud(x.open),"data-radix-menu-content":"",dir:b.dir,...N,...g,ref:L,style:{outline:"none",...g.style},onKeyDown:ke(g.onKeyDown,Z=>{const me=Z.target.closest("[data-radix-menu-content]")===Z.currentTarget,k=Z.ctrlKey||Z.altKey||Z.metaKey,M=Z.key.length===1;me&&(Z.key==="Tab"&&Z.preventDefault(),!k&&M&&be(Z.key));const O=C.current;if(Z.target!==O||!bx.includes(Z.key))return;Z.preventDefault();const q=A().filter(z=>!z.disabled).map(z=>z.ref.current);gd.includes(Z.key)&&q.reverse(),$x(q)}),onBlur:ke(e.onBlur,Z=>{Z.currentTarget.contains(Z.target)||(window.clearTimeout(T.current),P.current="")}),onPointerMove:ke(e.onPointerMove,Ts(Z=>{const ue=Z.target,me=_e.current!==Z.clientX;if(Z.currentTarget.contains(ue)&&me){const k=Z.clientX>_e.current?"right":"left";ae.current=k,_e.current=Z.clientX}}))})})})})})})});jd.displayName=ur;var kx="MenuGroup",po=p.forwardRef((e,t)=>{const{__scopeMenu:r,...s}=e;return a.jsx(nt.div,{role:"group",...s,ref:t})});po.displayName=kx;var Dx="MenuLabel",Ed=p.forwardRef((e,t)=>{const{__scopeMenu:r,...s}=e;return a.jsx(nt.div,{...s,ref:t})});Ed.displayName=Dx;var gn="MenuItem",wl="menu.itemSelect",Vn=p.forwardRef((e,t)=>{const{disabled:r=!1,onSelect:s,...n}=e,i=p.useRef(null),o=$s(gn,e.__scopeMenu),l=xo(gn,e.__scopeMenu),d=Mt(t,i),c=p.useRef(!1),u=()=>{const h=i.current;if(!r&&h){const f=new CustomEvent(wl,{bubbles:!0,cancelable:!0});h.addEventListener(wl,m=>s==null?void 0:s(m),{once:!0}),gf(h,f),f.defaultPrevented?c.current=!1:o.onClose()}};return a.jsx(_d,{...n,ref:d,disabled:r,onClick:ke(e.onClick,u),onPointerDown:h=>{var f;(f=e.onPointerDown)==null||f.call(e,h),c.current=!0},onPointerUp:ke(e.onPointerUp,h=>{var f;c.current||(f=h.currentTarget)==null||f.click()}),onKeyDown:ke(e.onKeyDown,h=>{const f=l.searchRef.current!=="";r||f&&h.key===" "||qi.includes(h.key)&&(h.currentTarget.click(),h.preventDefault())})})});Vn.displayName=gn;var _d=p.forwardRef((e,t)=>{const{__scopeMenu:r,disabled:s=!1,textValue:n,...i}=e,o=xo(gn,r),l=vd(r),d=p.useRef(null),c=Mt(t,d),[u,h]=p.useState(!1),[f,m]=p.useState("");return p.useEffect(()=>{const v=d.current;v&&m((v.textContent??"").trim())},[i.children]),a.jsx(Cs.ItemSlot,{scope:r,disabled:s,textValue:n??f,children:a.jsx(xd,{asChild:!0,...l,focusable:!s,children:a.jsx(nt.div,{role:"menuitem","data-highlighted":u?"":void 0,"aria-disabled":s||void 0,"data-disabled":s?"":void 0,...i,ref:c,onPointerMove:ke(e.onPointerMove,Ts(v=>{s?o.onItemLeave(v):(o.onItemEnter(v),v.defaultPrevented||v.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:ke(e.onPointerLeave,Ts(v=>o.onItemLeave(v))),onFocus:ke(e.onFocus,()=>h(!0)),onBlur:ke(e.onBlur,()=>h(!1))})})})}),Px="MenuCheckboxItem",Sd=p.forwardRef((e,t)=>{const{checked:r=!1,onCheckedChange:s,...n}=e;return a.jsx(Fd,{scope:e.__scopeMenu,checked:r,children:a.jsx(Vn,{role:"menuitemcheckbox","aria-checked":pn(r)?"mixed":r,...n,ref:t,"data-state":bo(r),onSelect:ke(n.onSelect,()=>s==null?void 0:s(pn(r)?!0:!r),{checkForDefaultPrevented:!1})})})});Sd.displayName=Px;var Cd="MenuRadioGroup",[Ix,Ox]=Sa(Cd,{value:void 0,onValueChange:()=>{}}),Td=p.forwardRef((e,t)=>{const{value:r,onValueChange:s,...n}=e,i=wr(s);return a.jsx(Ix,{scope:e.__scopeMenu,value:r,onValueChange:i,children:a.jsx(po,{...n,ref:t})})});Td.displayName=Cd;var Ad="MenuRadioItem",Rd=p.forwardRef((e,t)=>{const{value:r,...s}=e,n=Ox(Ad,e.__scopeMenu),i=r===n.value;return a.jsx(Fd,{scope:e.__scopeMenu,checked:i,children:a.jsx(Vn,{role:"menuitemradio","aria-checked":i,...s,ref:t,"data-state":bo(i),onSelect:ke(s.onSelect,()=>{var o;return(o=n.onValueChange)==null?void 0:o.call(n,r)},{checkForDefaultPrevented:!1})})})});Rd.displayName=Ad;var vo="MenuItemIndicator",[Fd,Mx]=Sa(vo,{checked:!1}),kd=p.forwardRef((e,t)=>{const{__scopeMenu:r,forceMount:s,...n}=e,i=Mx(vo,r);return a.jsx(_r,{present:s||pn(i.checked)||i.checked===!0,children:a.jsx(nt.span,{...n,ref:t,"data-state":bo(i.checked)})})});kd.displayName=vo;var Lx="MenuSeparator",Dd=p.forwardRef((e,t)=>{const{__scopeMenu:r,...s}=e;return a.jsx(nt.div,{role:"separator","aria-orientation":"horizontal",...s,ref:t})});Dd.displayName=Lx;var Bx="MenuArrow",Pd=p.forwardRef((e,t)=>{const{__scopeMenu:r,...s}=e,n=Us(r);return a.jsx(Ec,{...n,...s,ref:t})});Pd.displayName=Bx;var wo="MenuSub",[Ux,Id]=Sa(wo),Od=e=>{const{__scopeMenu:t,children:r,open:s=!1,onOpenChange:n}=e,i=fa(wo,t),o=Us(t),[l,d]=p.useState(null),[c,u]=p.useState(null),h=wr(n);return p.useEffect(()=>(i.open===!1&&h(!1),()=>h(!1)),[i.open,h]),a.jsx(no,{...o,children:a.jsx(wd,{scope:t,open:s,onOpenChange:h,content:c,onContentChange:u,children:a.jsx(Ux,{scope:t,contentId:ba(),triggerId:ba(),trigger:l,onTriggerChange:d,children:r})})})};Od.displayName=wo;var us="MenuSubTrigger",Md=p.forwardRef((e,t)=>{const r=fa(us,e.__scopeMenu),s=$s(us,e.__scopeMenu),n=Id(us,e.__scopeMenu),i=xo(us,e.__scopeMenu),o=p.useRef(null),{pointerGraceTimerRef:l,onPointerGraceIntentChange:d}=i,c={__scopeMenu:e.__scopeMenu},u=p.useCallback(()=>{o.current&&window.clearTimeout(o.current),o.current=null},[]);return p.useEffect(()=>u,[u]),p.useEffect(()=>{const h=l.current;return()=>{window.clearTimeout(h),d(null)}},[l,d]),a.jsx(fo,{asChild:!0,...c,children:a.jsx(_d,{id:n.triggerId,"aria-haspopup":"menu","aria-expanded":r.open,"aria-controls":n.contentId,"data-state":Ud(r.open),...e,ref:wc(t,n.onTriggerChange),onClick:h=>{var f;(f=e.onClick)==null||f.call(e,h),!(e.disabled||h.defaultPrevented)&&(h.currentTarget.focus(),r.open||r.onOpenChange(!0))},onPointerMove:ke(e.onPointerMove,Ts(h=>{i.onItemEnter(h),!h.defaultPrevented&&!e.disabled&&!r.open&&!o.current&&(i.onPointerGraceIntentChange(null),o.current=window.setTimeout(()=>{r.onOpenChange(!0),u()},100))})),onPointerLeave:ke(e.onPointerLeave,Ts(h=>{var m,v;u();const f=(m=r.content)==null?void 0:m.getBoundingClientRect();if(f){const g=(v=r.content)==null?void 0:v.dataset.side,x=g==="right",b=x?-5:5,N=f[x?"left":"right"],y=f[x?"right":"left"];i.onPointerGraceIntentChange({area:[{x:h.clientX+b,y:h.clientY},{x:N,y:f.top},{x:y,y:f.top},{x:y,y:f.bottom},{x:N,y:f.bottom}],side:g}),window.clearTimeout(l.current),l.current=window.setTimeout(()=>i.onPointerGraceIntentChange(null),300)}else{if(i.onTriggerLeave(h),h.defaultPrevented)return;i.onPointerGraceIntentChange(null)}})),onKeyDown:ke(e.onKeyDown,h=>{var m;const f=i.searchRef.current!=="";e.disabled||f&&h.key===" "||yx[s.dir].includes(h.key)&&(r.onOpenChange(!0),(m=r.content)==null||m.focus(),h.preventDefault())})})})});Md.displayName=us;var Ld="MenuSubContent",Bd=p.forwardRef((e,t)=>{const r=yd(ur,e.__scopeMenu),{forceMount:s=r.forceMount,...n}=e,i=fa(ur,e.__scopeMenu),o=$s(ur,e.__scopeMenu),l=Id(Ld,e.__scopeMenu),d=p.useRef(null),c=Mt(t,d);return a.jsx(Cs.Provider,{scope:e.__scopeMenu,children:a.jsx(_r,{present:s||i.open,children:a.jsx(Cs.Slot,{scope:e.__scopeMenu,children:a.jsx(go,{id:l.contentId,"aria-labelledby":l.triggerId,...n,ref:c,align:"start",side:o.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:u=>{var h;o.isUsingKeyboardRef.current&&((h=d.current)==null||h.focus()),u.preventDefault()},onCloseAutoFocus:u=>u.preventDefault(),onFocusOutside:ke(e.onFocusOutside,u=>{u.target!==l.trigger&&i.onOpenChange(!1)}),onEscapeKeyDown:ke(e.onEscapeKeyDown,u=>{o.onClose(),u.preventDefault()}),onKeyDown:ke(e.onKeyDown,u=>{var m;const h=u.currentTarget.contains(u.target),f=Nx[o.dir].includes(u.key);h&&f&&(i.onOpenChange(!1),(m=l.trigger)==null||m.focus(),u.preventDefault())})})})})})});Bd.displayName=Ld;function Ud(e){return e?"open":"closed"}function pn(e){return e==="indeterminate"}function bo(e){return pn(e)?"indeterminate":e?"checked":"unchecked"}function $x(e){const t=document.activeElement;for(const r of e)if(r===t||(r.focus(),document.activeElement!==t))return}function zx(e,t){return e.map((r,s)=>e[(t+s)%e.length])}function Vx(e,t,r){const n=t.length>1&&Array.from(t).every(c=>c===t[0])?t[0]:t,i=r?e.indexOf(r):-1;let o=zx(e,Math.max(i,0));n.length===1&&(o=o.filter(c=>c!==r));const d=o.find(c=>c.toLowerCase().startsWith(n.toLowerCase()));return d!==r?d:void 0}function Hx(e,t){const{x:r,y:s}=e;let n=!1;for(let i=0,o=t.length-1;i<t.length;o=i++){const l=t[i],d=t[o],c=l.x,u=l.y,h=d.x,f=d.y;u>s!=f>s&&r<(h-c)*(s-u)/(f-u)+c&&(n=!n)}return n}function Wx(e,t){if(!t)return!1;const r={x:e.clientX,y:e.clientY};return Hx(r,t)}function Ts(e){return t=>t.pointerType==="mouse"?e(t):void 0}var qx=bd,Gx=fo,Xx=Nd,Kx=jd,Yx=po,Jx=Ed,Qx=Vn,Zx=Sd,eg=Td,tg=Rd,rg=kd,ag=Dd,sg=Pd,ng=Od,ig=Md,og=Bd,Hn="DropdownMenu",[lg]=_a(Hn,[pd]),Lt=pd(),[cg,$d]=lg(Hn),zd=e=>{const{__scopeDropdownMenu:t,children:r,dir:s,open:n,defaultOpen:i,onOpenChange:o,modal:l=!0}=e,d=Lt(t),c=p.useRef(null),[u,h]=Za({prop:n,defaultProp:i??!1,onChange:o,caller:Hn});return a.jsx(cg,{scope:t,triggerId:ba(),triggerRef:c,contentId:ba(),open:u,onOpenChange:h,onOpenToggle:p.useCallback(()=>h(f=>!f),[h]),modal:l,children:a.jsx(qx,{...d,open:u,onOpenChange:h,dir:s,modal:l,children:r})})};zd.displayName=Hn;var Vd="DropdownMenuTrigger",Hd=p.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,disabled:s=!1,...n}=e,i=$d(Vd,r),o=Lt(r);return a.jsx(Gx,{asChild:!0,...o,children:a.jsx(nt.button,{type:"button",id:i.triggerId,"aria-haspopup":"menu","aria-expanded":i.open,"aria-controls":i.open?i.contentId:void 0,"data-state":i.open?"open":"closed","data-disabled":s?"":void 0,disabled:s,...n,ref:wc(t,i.triggerRef),onPointerDown:ke(e.onPointerDown,l=>{!s&&l.button===0&&l.ctrlKey===!1&&(i.onOpenToggle(),i.open||l.preventDefault())}),onKeyDown:ke(e.onKeyDown,l=>{s||(["Enter"," "].includes(l.key)&&i.onOpenToggle(),l.key==="ArrowDown"&&i.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(l.key)&&l.preventDefault())})})})});Hd.displayName=Vd;var dg="DropdownMenuPortal",Wd=e=>{const{__scopeDropdownMenu:t,...r}=e,s=Lt(t);return a.jsx(Xx,{...s,...r})};Wd.displayName=dg;var qd="DropdownMenuContent",Gd=p.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...s}=e,n=$d(qd,r),i=Lt(r),o=p.useRef(!1);return a.jsx(Kx,{id:n.contentId,"aria-labelledby":n.triggerId,...i,...s,ref:t,onCloseAutoFocus:ke(e.onCloseAutoFocus,l=>{var d;o.current||(d=n.triggerRef.current)==null||d.focus(),o.current=!1,l.preventDefault()}),onInteractOutside:ke(e.onInteractOutside,l=>{const d=l.detail.originalEvent,c=d.button===0&&d.ctrlKey===!0,u=d.button===2||c;(!n.modal||u)&&(o.current=!0)}),style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});Gd.displayName=qd;var ug="DropdownMenuGroup",hg=p.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...s}=e,n=Lt(r);return a.jsx(Yx,{...n,...s,ref:t})});hg.displayName=ug;var fg="DropdownMenuLabel",Xd=p.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...s}=e,n=Lt(r);return a.jsx(Jx,{...n,...s,ref:t})});Xd.displayName=fg;var mg="DropdownMenuItem",Kd=p.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...s}=e,n=Lt(r);return a.jsx(Qx,{...n,...s,ref:t})});Kd.displayName=mg;var xg="DropdownMenuCheckboxItem",Yd=p.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...s}=e,n=Lt(r);return a.jsx(Zx,{...n,...s,ref:t})});Yd.displayName=xg;var gg="DropdownMenuRadioGroup",pg=p.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...s}=e,n=Lt(r);return a.jsx(eg,{...n,...s,ref:t})});pg.displayName=gg;var vg="DropdownMenuRadioItem",Jd=p.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...s}=e,n=Lt(r);return a.jsx(tg,{...n,...s,ref:t})});Jd.displayName=vg;var wg="DropdownMenuItemIndicator",Qd=p.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...s}=e,n=Lt(r);return a.jsx(rg,{...n,...s,ref:t})});Qd.displayName=wg;var bg="DropdownMenuSeparator",Zd=p.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...s}=e,n=Lt(r);return a.jsx(ag,{...n,...s,ref:t})});Zd.displayName=bg;var yg="DropdownMenuArrow",Ng=p.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...s}=e,n=Lt(r);return a.jsx(sg,{...n,...s,ref:t})});Ng.displayName=yg;var jg=e=>{const{__scopeDropdownMenu:t,children:r,open:s,onOpenChange:n,defaultOpen:i}=e,o=Lt(t),[l,d]=Za({prop:s,defaultProp:i??!1,onChange:n,caller:"DropdownMenuSub"});return a.jsx(ng,{...o,open:l,onOpenChange:d,children:r})},Eg="DropdownMenuSubTrigger",eu=p.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...s}=e,n=Lt(r);return a.jsx(ig,{...n,...s,ref:t})});eu.displayName=Eg;var _g="DropdownMenuSubContent",tu=p.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...s}=e,n=Lt(r);return a.jsx(og,{...n,...s,ref:t,style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});tu.displayName=_g;var Sg=zd,Cg=Hd,Tg=Wd,ru=Gd,au=Xd,su=Kd,nu=Yd,iu=Jd,ou=Qd,lu=Zd,Ag=jg,cu=eu,du=tu;const Rg=Sg,Fg=Cg,kg=Ag,uu=p.forwardRef(({className:e,inset:t,children:r,...s},n)=>a.jsxs(cu,{ref:n,className:De("flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",t&&"pl-8",e),...s,children:[r,a.jsx(ys,{className:"ml-auto"})]}));uu.displayName=cu.displayName;const hu=p.forwardRef(({className:e,...t},r)=>a.jsx(du,{ref:r,className:De("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]",e),...t}));hu.displayName=du.displayName;const fu=p.forwardRef(({className:e,sideOffset:t=4,...r},s)=>a.jsx(Tg,{children:a.jsx(ru,{ref:s,sideOffset:t,className:De("z-50 max-h-[var(--radix-dropdown-menu-content-available-height)] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md","data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]",e),...r})}));fu.displayName=ru.displayName;const Gi=p.forwardRef(({className:e,inset:t,...r},s)=>a.jsx(su,{ref:s,className:De("relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&>svg]:size-4 [&>svg]:shrink-0",t&&"pl-8",e),...r}));Gi.displayName=su.displayName;const Dg=p.forwardRef(({className:e,children:t,checked:r,...s},n)=>a.jsxs(nu,{ref:n,className:De("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),checked:r,...s,children:[a.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:a.jsx(ou,{children:a.jsx(Uc,{className:"h-4 w-4"})})}),t]}));Dg.displayName=nu.displayName;const Pg=p.forwardRef(({className:e,children:t,...r},s)=>a.jsxs(iu,{ref:s,className:De("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...r,children:[a.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:a.jsx(ou,{children:a.jsx(Di,{className:"h-2 w-2 fill-current"})})}),t]}));Pg.displayName=iu.displayName;const mu=p.forwardRef(({className:e,inset:t,...r},s)=>a.jsx(au,{ref:s,className:De("px-2 py-1.5 text-sm font-semibold",t&&"pl-8",e),...r}));mu.displayName=au.displayName;const Xi=p.forwardRef(({className:e,...t},r)=>a.jsx(lu,{ref:r,className:De("-mx-1 my-1 h-px bg-muted",e),...t}));Xi.displayName=lu.displayName;const bl={default:{name:"Padrão",icon:Di,emoji:"⚪",description:"Tema padrão do sistema"},rose:{name:"Rosa",icon:nl,emoji:"🌹",description:"Rosa elegante e sofisticado"},violet:{name:"Violeta",icon:zf,emoji:"💜",description:"Violeta místico e profundo"},emerald:{name:"Esmeralda",icon:nl,emoji:"💚",description:"Esmeralda luxuoso e refinado"},amber:{name:"Âmbar",icon:Vc,emoji:"🟡",description:"Âmbar quente e acolhedor"},cyan:{name:"Ciano",icon:Di,emoji:"🔵",description:"Ciano moderno e tecnológico"}};function As(){const{mode:e,profile:t,setMode:r,setProfile:s}=hr(),n=()=>{r(e==="light"?"dark":"light")},i=l=>{s(l)},o=bl[t];return a.jsxs(Rg,{children:[a.jsx(Fg,{asChild:!0,children:a.jsxs(Q,{variant:"outline",size:"icon",className:"relative transition-all duration-200 hover:scale-105 active:scale-95 hover:shadow-md hover:rotate-3",children:[a.jsx($c,{className:"h-[1.2rem] w-[1.2rem] rotate-0 scale-100 transition-all dark:-rotate-90 dark:scale-0"}),a.jsx(zc,{className:"absolute h-[1.2rem] w-[1.2rem] rotate-90 scale-0 transition-all dark:rotate-0 dark:scale-100"}),a.jsx("span",{className:"sr-only",children:"Configurações de tema"})]})}),a.jsxs(fu,{align:"end",className:"w-64",children:[a.jsxs(mu,{className:"flex items-center gap-2",children:[a.jsx(un,{className:"h-4 w-4"}),"Personalização Visual"]}),a.jsx(Xi,{}),a.jsxs(Gi,{onClick:n,className:"flex items-center gap-3 p-3 cursor-pointer hover:bg-accent/50 transition-all duration-200",children:[a.jsx($f,{className:"h-4 w-4"}),a.jsxs("div",{className:"flex flex-col",children:[a.jsx("span",{className:"font-medium",children:e==="light"?"Modo Escuro":"Modo Claro"}),a.jsx("span",{className:"text-xs text-muted-foreground",children:"Alternar entre claro e escuro"})]})]}),a.jsx(Xi,{}),a.jsxs(kg,{children:[a.jsxs(uu,{className:"flex items-center gap-3 p-3",children:[a.jsx(un,{className:"h-4 w-4"}),a.jsxs("div",{className:"flex flex-col",children:[a.jsx("span",{className:"font-medium",children:"Perfil de Cor"}),a.jsx("span",{className:"text-xs text-muted-foreground",children:o.description})]})]}),a.jsx(hu,{className:"w-56",children:Object.entries(bl).map(([l,d])=>{const c=d.icon,u=t===l;return a.jsxs(Gi,{onClick:()=>i(l),className:`flex items-center gap-3 p-3 cursor-pointer transition-all duration-200 ${u?"bg-accent":"hover:bg-accent/50"}`,children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-lg",children:d.emoji}),a.jsx(c,{className:"h-4 w-4"})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsx("span",{className:"font-medium",children:d.name}),a.jsx("span",{className:"text-xs text-muted-foreground",children:d.description})]}),u&&a.jsx("div",{className:"ml-auto w-2 h-2 bg-primary rounded-full"})]},l)})})]})]})]})}function fs({variant:e="principal",className:t="",width:r,height:s}){const{mode:n}=hr(),i=n==="dark",o=()=>{switch(e){case"principal":return i?"/logos/logo-repovagas-principal-dark.svg":"/logos/logo-repovagas-principal.svg";case"compacto":return"/logos/logo-repovagas-compacto.svg";case"icon":return"/logos/logo-repovagas-icon.svg";case"favicon":return"/logos/logo-repovagas-favicon.svg";default:return"/logos/logo-repovagas-principal.svg"}},d=(()=>{switch(e){case"principal":return{width:200,height:60};case"compacto":return{width:120,height:40};case"icon":return{width:48,height:48};case"favicon":return{width:32,height:32};default:return{width:200,height:60}}})(),c=r||d.width,u=s||d.height;return a.jsx("img",{src:o(),alt:"RepoVagas - Repositório de Oportunidades",className:`transition-all duration-300 ${t}`,width:c,height:u})}function Ig(){const[e,t]=p.useState({email:"",password:""}),[r,s]=p.useState(""),[n,i]=p.useState(!1),[o,l]=p.useState(!1),[d,c]=p.useState(!1),[u,h]=p.useState(!1),{login:f}=tt(),{config:m}=hr(),v=nr(),g=async N=>{N.preventDefault(),s(""),h(!1),i(!0);try{await f(e)?v("/dashboard"):(s("Email ou senha incorretos"),h(!0),setTimeout(()=>h(!1),500))}catch(y){y.message==="CONFIRM_EMAIL"?s("Seu cadastro ainda não foi confirmado. Verifique sua caixa de entrada e clique no link de confirmação enviado por email."):s("Erro ao fazer login. Tente novamente."),h(!0),setTimeout(()=>h(!1),500)}finally{i(!1)}},x=N=>{const{name:y,value:A}=N.target;t(B=>({...B,[y]:A}))},b=()=>{l(!o)};return p.useEffect(()=>(document.body.classList.add("animate-fade-in"),()=>document.body.classList.remove("animate-fade-in")),[]),a.jsxs("div",{className:"min-h-screen flex items-center justify-center p-4 relative overflow-hidden",children:[a.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-background via-background to-muted/20"}),a.jsx("div",{className:"absolute inset-0 bg-[url('data:image/svg+xml,%3Csvg%20width%3D%2260%22%20height%3D%2260%22%20viewBox%3D%220%200%2060%2060%22%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%3E%3Cg%20fill%3D%22none%22%20fill-rule%3D%22evenodd%22%3E%3Cg%20fill%3D%22%239C92AC%22%20fill-opacity%3D%220.05%22%3E%3Ccircle%20cx%3D%2230%22%20cy%3D%2230%22%20r%3D%222%22/%3E%3C/g%3E%3C/g%3E%3C/svg%3E')] opacity-40 animate-pulse"}),a.jsx("div",{className:"absolute top-20 left-20 w-32 h-32 bg-primary/10 rounded-full blur-xl animate-pulse"}),a.jsx("div",{className:"absolute bottom-20 right-20 w-24 h-24 bg-secondary/10 rounded-full blur-xl animate-pulse delay-1000"}),a.jsx("div",{className:"absolute top-1/2 left-10 w-16 h-16 bg-accent/10 rounded-full blur-xl animate-pulse delay-500"}),a.jsx("div",{className:"absolute top-4 right-4 z-20",children:a.jsx(As,{})}),a.jsxs(Ee,{className:`w-full max-w-md relative z-10 transition-all duration-300 hover:shadow-2xl ${m.effects.glassmorphism?"bg-white/10 backdrop-blur-xl border-white/20 shadow-2xl":"bg-card shadow-xl"} ${u?"animate-shake":""}`,children:[a.jsxs(Ae,{className:"text-center space-y-6 pb-8",children:[a.jsx("div",{className:"flex justify-center",children:a.jsx("div",{className:"transition-all duration-300 hover:scale-105",children:a.jsx(fs,{variant:"icon",width:80,height:80,className:"drop-shadow-lg"})})}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Fe,{className:`text-4xl font-bold font-logo transition-all duration-300 page-title ${m.effects.gradients?"bg-gradient-to-r from-repovagas-primary via-repovagas-primary/80 to-repovagas-primary/60 bg-clip-text text-transparent":"text-repovagas-primary"}`,children:"Repositório de Vagas"}),a.jsx(Ge,{className:"page-subtitle text-lg font-body text-repovagas-text-secondary",children:"Seu repositório de oportunidades profissionais"})]})]}),a.jsx(Se,{className:"space-y-6 px-8 pb-8",children:a.jsxs("form",{onSubmit:g,className:"space-y-6",children:[a.jsxs("div",{className:"space-y-3",children:[a.jsxs(fe,{htmlFor:"email",className:"flex items-center gap-2 text-sm font-medium field-title",children:[a.jsx(Xr,{className:"h-4 w-4 icon-primary"}),"Email"]}),a.jsxs("div",{className:"relative",children:[a.jsx(Re,{id:"email",name:"email",type:"email",value:e.email,onChange:x,placeholder:"seu@email.com",autoComplete:"email",required:!0,className:`w-full h-12 px-4 transition-all duration-200 focus:ring-2 focus:ring-primary/50 focus:border-primary ${m.effects.glassmorphism?"bg-white/20 backdrop-blur-sm border-white/30":"bg-background"}`}),e.email&&a.jsx(Dt,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-success animate-bounce-in"})]})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs(fe,{htmlFor:"password",className:"flex items-center gap-2 text-sm font-medium field-title",children:[a.jsx(Ns,{className:"h-4 w-4 icon-primary"}),"Senha"]}),a.jsxs("div",{className:"relative",children:[a.jsx(Re,{id:"password",name:"password",type:o?"text":"password",value:e.password,onChange:x,placeholder:"••••••••",autoComplete:"current-password",required:!0,className:`w-full h-12 px-4 pr-12 transition-all duration-200 focus:ring-2 focus:ring-primary/50 focus:border-primary ${m.effects.glassmorphism?"bg-white/20 backdrop-blur-sm border-white/30":"bg-background"}`}),a.jsx("button",{type:"button",onClick:b,className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-muted-foreground hover:text-foreground transition-all duration-200 hover:scale-110 active:scale-95 hover:rotate-12",children:o?a.jsx(la,{className:"h-5 w-5 transition-transform duration-200"}):a.jsx(Pt,{className:"h-5 w-5 transition-transform duration-200"})})]})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("input",{type:"checkbox",id:"remember",checked:d,onChange:N=>c(N.target.checked),className:"w-4 h-4 text-primary bg-background border-border rounded focus:ring-primary focus:ring-2"}),a.jsx(fe,{htmlFor:"remember",className:"text-sm text-muted-foreground cursor-pointer",children:"Lembrar sessão"})]}),a.jsxs("button",{type:"button",onClick:()=>v("/forgot-password"),className:"flex items-center gap-1 text-sm text-primary hover:text-primary/80 transition-all duration-200 hover:scale-105 active:scale-95 hover:shadow-sm",children:[a.jsx(Vf,{className:"h-3 w-3 transition-transform duration-200 hover:rotate-12"}),"Esqueci minha senha"]})]}),r&&a.jsxs("div",{className:`flex items-center gap-2 p-4 rounded-xl border transition-all duration-300 ${u?"animate-shake":""} ${r.includes("confirmado")?m.effects.glassmorphism?"bg-blue-500/20 backdrop-blur-sm border-blue-500/30":"bg-blue-500/10 border-blue-500/20":m.effects.glassmorphism?"bg-destructive/20 backdrop-blur-sm border-destructive/30":"bg-destructive/10 border-destructive/20"}`,children:[r.includes("confirmado")?a.jsx(Xr,{className:"h-5 w-5 text-blue-600 flex-shrink-0"}):a.jsx(at,{className:"h-5 w-5 text-destructive flex-shrink-0"}),a.jsx("span",{className:`text-sm font-medium ${r.includes("confirmado")?"text-blue-700":"text-destructive"}`,children:r})]}),a.jsx(Q,{type:"submit",disabled:n,className:`w-full h-14 text-base font-semibold transition-all duration-300 hover:scale-105 active:scale-95 hover:shadow-xl ${n?"btn-active":"btn-text"} ${m.effects.gradients?"bg-gradient-to-r from-primary to-primary/80 hover:from-primary/90 hover:to-primary/70":"bg-primary hover:bg-primary/90"} ${n?"animate-pulse":""}`,children:n?a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"w-4 h-4 border-2 border-primary-foreground/30 border-t-primary-foreground rounded-full animate-spin"}),"Entrando..."]}):"Entrar"})]})})]})]})}function Og(){const[e,t]=p.useState(""),[r,s]=p.useState(!1),[n,i]=p.useState(""),[o,l]=p.useState(!1),[d,c]=p.useState(!1),{config:u}=hr(),h=nr(),f=async v=>{v.preventDefault(),i(""),c(!1),s(!0);try{const g=await pm(e);g.success?(l(!0),i(g.message),setTimeout(()=>{h("/login")},3e3)):(l(!1),i(g.message),c(!0),setTimeout(()=>c(!1),500))}catch{l(!1),i("Erro inesperado. Tente novamente mais tarde."),c(!0),setTimeout(()=>c(!1),500)}finally{s(!1)}},m=()=>{h("/login")};return a.jsxs("div",{className:"min-h-screen flex items-center justify-center p-4 relative overflow-hidden",children:[a.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-background via-background to-muted/20"}),a.jsx("div",{className:"absolute inset-0 bg-[url('data:image/svg+xml,%3Csvg%20width%3D%2260%22%20height%3D%2260%22%20viewBox%3D%220%200%2060%2060%22%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%3E%3Cg%20fill%3D%22none%22%20fill-rule%3D%22evenodd%22%3E%3Cg%20fill%3D%22%239C92AC%22%20fill-opacity%3D%220.05%22%3E%3Ccircle%20cx%3D%2230%22%20cy%3D%2230%22%20r%3D%222%22/%3E%3C/g%3E%3C/g%3E%3C/svg%3E')] opacity-40 animate-pulse"}),a.jsx("div",{className:"absolute top-20 left-20 w-32 h-32 bg-primary/10 rounded-full blur-xl animate-pulse"}),a.jsx("div",{className:"absolute bottom-20 right-20 w-24 h-24 bg-secondary/10 rounded-full blur-xl animate-pulse delay-1000"}),a.jsx("div",{className:"absolute top-1/2 left-10 w-16 h-16 bg-accent/10 rounded-full blur-xl animate-pulse delay-500"}),a.jsx("div",{className:"absolute top-4 right-4 z-20",children:a.jsx(As,{})}),a.jsxs(Ee,{className:`w-full max-w-md relative z-10 transition-all duration-300 hover:shadow-2xl ${u.effects.glassmorphism?"bg-white/10 backdrop-blur-xl border-white/20 shadow-2xl":"bg-card shadow-xl"} ${d?"animate-shake":""}`,children:[a.jsxs(Ae,{className:"text-center space-y-6 pb-8",children:[a.jsx("div",{className:"flex justify-start",children:a.jsxs(Q,{variant:"ghost",size:"sm",onClick:m,className:"flex items-center gap-2 text-muted-foreground hover:text-foreground",children:[a.jsx(Hr,{className:"h-4 w-4"}),"Voltar ao Login"]})}),a.jsx("div",{className:"flex justify-center",children:a.jsx("div",{className:`w-20 h-20 rounded-3xl flex items-center justify-center shadow-2xl transition-all duration-300 hover:scale-110 hover:rotate-6 ${u.effects.gradients?"bg-gradient-to-br from-primary via-primary/80 to-primary/60":"bg-primary"}`,children:a.jsx(Xr,{className:"h-10 w-10 text-primary-foreground animate-bounce-in"})})}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Fe,{className:`text-3xl font-bold transition-all duration-300 ${u.effects.gradients?"bg-gradient-to-r from-primary via-primary/80 to-primary/60 bg-clip-text text-transparent":"text-primary"}`,children:"Recuperar Senha"}),a.jsx(Ge,{className:"text-muted-foreground text-base",children:o?"Email enviado com sucesso!":"Digite seu email para receber um link de recuperação"})]})]}),a.jsx(Se,{className:"space-y-6 px-8 pb-8",children:o?a.jsxs("div",{className:"space-y-6 text-center",children:[a.jsx("div",{className:"flex justify-center",children:a.jsx("div",{className:"w-16 h-16 bg-success/20 rounded-full flex items-center justify-center animate-pulse",children:a.jsx(Dt,{className:"h-8 w-8 text-success"})})}),a.jsxs("div",{className:"space-y-3",children:[a.jsx("h3",{className:"text-xl font-semibold text-success",children:"Email Enviado!"}),a.jsx("p",{className:"text-muted-foreground text-sm",children:n}),a.jsx("p",{className:"text-xs text-muted-foreground",children:"Você será redirecionado para o login em alguns segundos..."})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsx(Q,{onClick:m,className:"w-full",children:"Voltar ao Login"}),a.jsxs("p",{className:"text-xs text-muted-foreground",children:["Não recebeu o email? Verifique sua caixa de spam ou"," ",a.jsx("button",{onClick:()=>{l(!1),i(""),t("")},className:"text-primary hover:underline",children:"tente novamente"})]})]})]}):a.jsxs("form",{onSubmit:f,className:"space-y-6",children:[a.jsxs("div",{className:"space-y-3",children:[a.jsxs(fe,{htmlFor:"email",className:"flex items-center gap-2 text-sm font-medium",children:[a.jsx(Xr,{className:"h-4 w-4"}),"Email"]}),a.jsxs("div",{className:"relative",children:[a.jsx(Re,{id:"email",name:"email",type:"email",value:e,onChange:v=>t(v.target.value),placeholder:"seu@email.com",autoComplete:"email",required:!0,disabled:r,className:`w-full h-12 px-4 transition-all duration-200 focus:ring-2 focus:ring-primary/50 focus:border-primary ${u.effects.glassmorphism?"bg-white/20 backdrop-blur-sm border-white/30":"bg-background"} ${r?"opacity-50":""}`}),e&&!r&&a.jsx(Dt,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-success animate-bounce-in"})]})]}),n&&a.jsxs("div",{className:`flex items-center gap-2 p-4 rounded-xl border transition-all duration-300 ${d?"animate-shake":""} ${u.effects.glassmorphism?o?"bg-success/20 backdrop-blur-sm border-success/30":"bg-destructive/20 backdrop-blur-sm border-destructive/30":o?"bg-success/10 border-success/20":"bg-destructive/10 border-destructive/20"}`,children:[o?a.jsx(Dt,{className:"h-5 w-5 text-success flex-shrink-0"}):a.jsx(at,{className:"h-5 w-5 text-destructive flex-shrink-0"}),a.jsx("span",{className:`text-sm font-medium ${o?"text-success":"text-destructive"}`,children:n})]}),a.jsx(Q,{type:"submit",disabled:r||!e,className:`w-full h-14 text-base font-semibold transition-all duration-300 hover:scale-105 hover:shadow-lg ${u.effects.gradients?"bg-gradient-to-r from-primary to-primary/80 hover:from-primary/90 hover:to-primary/70":"bg-primary hover:bg-primary/90"} ${r?"animate-pulse":""}`,children:r?a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Mr,{className:"w-4 h-4 animate-spin"}),"Enviando..."]}):"Enviar Link de Recuperação"})]})})]})]})}function Mg(){const[e,t]=p.useState({password:"",confirmPassword:""}),[r,s]=p.useState(!1),[n,i]=p.useState(!1),[o,l]=p.useState(!1),[d,c]=p.useState(""),[u,h]=p.useState(!1),[f,m]=p.useState(!1),[v,g]=p.useState(null);Oc();const{config:x}=hr(),b=nr();p.useEffect(()=>{(async()=>{try{const T=await bm();g(T),T||c("Link de recuperação inválido ou expirado. Solicite um novo link.")}catch(T){console.error("Erro ao verificar sessão:",T),g(!1),c("Erro ao verificar link de recuperação.")}})()},[]);const N=async L=>{if(L.preventDefault(),c(""),m(!1),!e.password){c("Por favor, digite uma nova senha."),m(!0),setTimeout(()=>m(!1),500);return}if(!e.confirmPassword){c("Por favor, confirme sua nova senha."),m(!0),setTimeout(()=>m(!1),500);return}if(!xn(e.password,e.confirmPassword)){c("As senhas não coincidem."),m(!0),setTimeout(()=>m(!1),500);return}const T=es(e.password);if(!T.isValid){c(`Senha muito fraca. ${T.errors.join(", ")}`),m(!0),setTimeout(()=>m(!1),500);return}l(!0);try{const P=await wm(e.password);P.success?(h(!0),c(P.message),setTimeout(()=>{Nm()},2e3)):(h(!1),c(P.message),m(!0),setTimeout(()=>m(!1),500))}catch{h(!1),c("Erro inesperado. Tente novamente mais tarde."),m(!0),setTimeout(()=>m(!1),500)}finally{l(!1)}},y=L=>{const{name:T,value:P}=L.target;t(I=>({...I,[T]:P}))},A=()=>{s(!r)},B=()=>{i(!n)},W=e.password?Yc(e.password):null,C=e.password&&e.confirmPassword?xn(e.password,e.confirmPassword):null;return v===!1?a.jsxs("div",{className:"min-h-screen flex items-center justify-center p-4 relative overflow-hidden",children:[a.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-background via-background to-muted/20"}),a.jsx("div",{className:"absolute top-4 right-4 z-20",children:a.jsx(As,{})}),a.jsxs(Ee,{className:`w-full max-w-md relative z-10 transition-all duration-300 ${x.effects.glassmorphism?"bg-white/10 backdrop-blur-xl border-white/20 shadow-2xl":"bg-card shadow-xl"}`,children:[a.jsxs(Ae,{className:"text-center space-y-6 pb-8",children:[a.jsx("div",{className:"flex justify-center",children:a.jsx("div",{className:"w-20 h-20 bg-destructive/20 rounded-full flex items-center justify-center",children:a.jsx(ar,{className:"h-10 w-10 text-destructive"})})}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Fe,{className:"text-3xl font-bold text-destructive",children:"Link Inválido"}),a.jsx(Ge,{className:"text-muted-foreground text-base",children:"Este link de recuperação não é válido ou expirou"})]})]}),a.jsxs(Se,{className:"space-y-6 px-8 pb-8",children:[a.jsxs("div",{className:"flex items-center gap-2 p-4 rounded-xl border bg-destructive/10 border-destructive/20",children:[a.jsx(at,{className:"h-5 w-5 text-destructive flex-shrink-0"}),a.jsx("span",{className:"text-destructive text-sm font-medium",children:d})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsx(Q,{onClick:()=>b("/forgot-password"),className:"w-full",children:"Solicitar Novo Link"}),a.jsx(Q,{variant:"outline",onClick:()=>b("/login"),className:"w-full",children:"Voltar ao Login"})]})]})]})]}):a.jsxs("div",{className:"min-h-screen flex items-center justify-center p-4 relative overflow-hidden",children:[a.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-background via-background to-muted/20"}),a.jsx("div",{className:"absolute inset-0 bg-[url('data:image/svg+xml,%3Csvg%20width%3D%2260%22%20height%3D%2260%22%20viewBox%3D%220%200%2060%2060%22%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%3E%3Cg%20fill%3D%22none%22%20fill-rule%3D%22evenodd%22%3E%3Cg%20fill%3D%22%239C92AC%22%20fill-opacity%3D%220.05%22%3E%3Ccircle%20cx%3D%2230%22%20cy%3D%2230%22%20r%3D%222%22/%3E%3C/g%3E%3C/g%3E%3C/svg%3E')] opacity-40 animate-pulse"}),a.jsx("div",{className:"absolute top-20 left-20 w-32 h-32 bg-primary/10 rounded-full blur-xl animate-pulse"}),a.jsx("div",{className:"absolute bottom-20 right-20 w-24 h-24 bg-secondary/10 rounded-full blur-xl animate-pulse delay-1000"}),a.jsx("div",{className:"absolute top-1/2 left-10 w-16 h-16 bg-accent/10 rounded-full blur-xl animate-pulse delay-500"}),a.jsx("div",{className:"absolute top-4 right-4 z-20",children:a.jsx(As,{})}),a.jsxs(Ee,{className:`w-full max-w-md relative z-10 transition-all duration-300 hover:shadow-2xl ${x.effects.glassmorphism?"bg-white/10 backdrop-blur-xl border-white/20 shadow-2xl":"bg-card shadow-xl"} ${f?"animate-shake":""}`,children:[a.jsxs(Ae,{className:"text-center space-y-6 pb-8",children:[a.jsx("div",{className:"flex justify-center",children:a.jsx("div",{className:`w-20 h-20 rounded-3xl flex items-center justify-center shadow-2xl transition-all duration-300 hover:scale-110 hover:rotate-6 ${x.effects.gradients?"bg-gradient-to-br from-primary via-primary/80 to-primary/60":"bg-primary"}`,children:a.jsx(Ns,{className:"h-10 w-10 text-primary-foreground animate-bounce-in"})})}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Fe,{className:`text-3xl font-bold transition-all duration-300 ${x.effects.gradients?"bg-gradient-to-r from-primary via-primary/80 to-primary/60 bg-clip-text text-transparent":"text-primary"}`,children:"Nova Senha"}),a.jsx(Ge,{className:"text-muted-foreground text-base",children:u?"Senha redefinida com sucesso!":"Digite sua nova senha segura"})]})]}),a.jsx(Se,{className:"space-y-6 px-8 pb-8",children:u?a.jsxs("div",{className:"space-y-6 text-center",children:[a.jsx("div",{className:"flex justify-center",children:a.jsx("div",{className:"w-16 h-16 bg-success/20 rounded-full flex items-center justify-center animate-pulse",children:a.jsx(Dt,{className:"h-8 w-8 text-success"})})}),a.jsxs("div",{className:"space-y-3",children:[a.jsx("h3",{className:"text-xl font-semibold text-success",children:"Senha Redefinida!"}),a.jsx("p",{className:"text-muted-foreground text-sm",children:d}),a.jsx("p",{className:"text-xs text-muted-foreground",children:"Você será redirecionado para o login em alguns segundos..."})]})]}):a.jsxs("form",{onSubmit:N,className:"space-y-6",children:[a.jsxs("div",{className:"space-y-3",children:[a.jsxs(fe,{htmlFor:"password",className:"flex items-center gap-2 text-sm font-medium",children:[a.jsx(hn,{className:"h-4 w-4"}),"Nova Senha"]}),a.jsxs("div",{className:"relative",children:[a.jsx(Re,{id:"password",name:"password",type:r?"text":"password",value:e.password,onChange:y,placeholder:"••••••••",autoComplete:"new-password",required:!0,disabled:o,className:`w-full h-12 px-4 pr-12 transition-all duration-200 focus:ring-2 focus:ring-primary/50 focus:border-primary ${x.effects.glassmorphism?"bg-white/20 backdrop-blur-sm border-white/30":"bg-background"} ${o?"opacity-50":""}`}),a.jsx("button",{type:"button",onClick:A,className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-muted-foreground hover:text-foreground transition-colors duration-200",disabled:o,children:r?a.jsx(la,{className:"h-5 w-5"}):a.jsx(Pt,{className:"h-5 w-5"})})]}),e.password&&W&&a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center justify-between text-xs",children:[a.jsx("span",{className:"text-muted-foreground",children:"Força da senha:"}),a.jsx("span",{className:`font-medium ${W.color==="red"?"text-red-600":W.color==="orange"?"text-orange-600":W.color==="yellow"?"text-yellow-600":W.color==="lightgreen"?"text-green-600":"text-green-700"}`,children:W.label})]}),a.jsx("div",{className:"w-full bg-muted rounded-full h-2",children:a.jsx("div",{className:`h-2 rounded-full transition-all duration-300 ${W.color==="red"?"bg-red-500":W.color==="orange"?"bg-orange-500":W.color==="yellow"?"bg-yellow-500":W.color==="lightgreen"?"bg-green-500":"bg-green-600"}`,style:{width:`${W.score}%`}})})]})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs(fe,{htmlFor:"confirmPassword",className:"flex items-center gap-2 text-sm font-medium",children:[a.jsx(Ns,{className:"h-4 w-4"}),"Confirmar Nova Senha"]}),a.jsxs("div",{className:"relative",children:[a.jsx(Re,{id:"confirmPassword",name:"confirmPassword",type:n?"text":"password",value:e.confirmPassword,onChange:y,placeholder:"••••••••",autoComplete:"new-password",required:!0,disabled:o,className:`w-full h-12 px-4 pr-12 transition-all duration-200 focus:ring-2 focus:ring-primary/50 focus:border-primary ${x.effects.glassmorphism?"bg-white/20 backdrop-blur-sm border-white/30":"bg-background"} ${o?"opacity-50":""}`}),a.jsx("button",{type:"button",onClick:B,className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-muted-foreground hover:text-foreground transition-colors duration-200",disabled:o,children:n?a.jsx(la,{className:"h-5 w-5"}):a.jsx(Pt,{className:"h-5 w-5"})})]}),e.confirmPassword&&C!==null&&a.jsx("div",{className:"flex items-center gap-2 text-xs",children:C?a.jsxs(a.Fragment,{children:[a.jsx(Dt,{className:"h-4 w-4 text-success"}),a.jsx("span",{className:"text-success",children:"Senhas coincidem"})]}):a.jsxs(a.Fragment,{children:[a.jsx(at,{className:"h-4 w-4 text-destructive"}),a.jsx("span",{className:"text-destructive",children:"Senhas não coincidem"})]})})]}),d&&a.jsxs("div",{className:`flex items-center gap-2 p-4 rounded-xl border transition-all duration-300 ${f?"animate-shake":""} ${x.effects.glassmorphism?u?"bg-success/20 backdrop-blur-sm border-success/30":"bg-destructive/20 backdrop-blur-sm border-destructive/30":u?"bg-success/10 border-success/20":"bg-destructive/10 border-destructive/20"}`,children:[u?a.jsx(Dt,{className:"h-5 w-5 text-success flex-shrink-0"}):a.jsx(at,{className:"h-5 w-5 text-destructive flex-shrink-0"}),a.jsx("span",{className:`text-sm font-medium ${u?"text-success":"text-destructive"}`,children:d})]}),a.jsx(Q,{type:"submit",disabled:o||!e.password||!e.confirmPassword||C===!1,className:`w-full h-14 text-base font-semibold transition-all duration-300 hover:scale-105 hover:shadow-lg ${x.effects.gradients?"bg-gradient-to-r from-primary to-primary/80 hover:from-primary/90 hover:to-primary/70":"bg-primary hover:bg-primary/90"} ${o?"animate-pulse":""}`,children:o?a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Mr,{className:"w-4 h-4 animate-spin"}),"Redefinindo..."]}):"Redefinir Senha"})]})})]})]})}async function yo(e){try{const{data:t,error:r}=await Ce.from("system_config").select("config_value").eq("config_key",e).single();return r?(console.error("Erro ao buscar configuração:",r),r.code==="PGRST116"||r.message.includes('relation "system_config" does not exist')?(console.warn("Tabela system_config não existe. Retornando valor padrão."),yl(e)):null):(t==null?void 0:t.config_value)||null}catch(t){return console.error("Erro ao buscar configuração:",t),yl(e)}}function yl(e){return{rh_nova_vaga_enabled:"false",rh_edit_enabled:"false",rh_delete_enabled:"false"}[e]||"false"}async function No(e,t){try{const{data:r,error:s}=await Ce.from("system_config").select("id").eq("config_key",e).single();s&&s.code!=="PGRST116"&&console.error("Erro ao verificar configuração existente:",s);let n;if(r){const{error:i}=await Ce.from("system_config").update({config_value:t,updated_at:new Date().toISOString()}).eq("config_key",e);n=i}else{const{error:i}=await Ce.from("system_config").insert({config_key:e,config_value:t,updated_at:new Date().toISOString()});n=i}if(n)throw console.error("Erro ao atualizar configuração:",n),n.code==="PGRST116"||n.message.includes('relation "system_config" does not exist')?(console.error("ERRO: Tabela system_config não existe. Execute a migração do banco de dados primeiro."),new Error("Tabela system_config não existe. Execute a migração do banco de dados primeiro.")):new Error(`Erro ao atualizar configuração: ${n.message}`);return!0}catch(r){throw console.error("Erro ao atualizar configuração:",r),r}}async function jo(e,t,r){try{const{data:s,error:n}=await Ce.from("system_config").select("id").eq("config_key",e).single();if(n&&n.code==="PGRST116"){const{error:i}=await Ce.from("system_config").insert({config_key:e,config_value:t,description:r||"",created_at:new Date().toISOString(),updated_at:new Date().toISOString()});return i?(console.error("Erro ao criar configuração:",i),!1):(console.log(`Configuração ${e} criada com valor padrão: ${t}`),!0)}else return n?(console.error("Erro ao verificar configuração existente:",n),!1):(console.log(`Configuração ${e} já existe`),!0)}catch(s){return console.error("Erro ao criar configuração:",s),!1}}async function xu(){return await yo("rh_nova_vaga_enabled")==="true"}async function gu(){return await yo("rh_edit_enabled")==="true"}async function pu(){return await yo("rh_delete_enabled")==="true"}async function Lg(e){return await No("rh_nova_vaga_enabled",e.toString())}async function Bg(e){return await No("rh_edit_enabled",e.toString())}async function Ug(e){return await No("rh_delete_enabled",e.toString())}function vu(){const[e,t]=p.useState(!1),[r,s]=p.useState(!0),[n,i]=p.useState(null),o=async()=>{s(!0),i(null);try{await jo("rh_nova_vaga_enabled","false","Habilita acesso à página Nova Oportunidade para usuários RH");const d=await xu();t(d)}catch(d){i(d.message)}finally{s(!1)}},l=async d=>{try{const c=await Lg(d);return c&&t(d),c}catch(c){return i(c.message),console.error("Erro ao alternar acesso RH Nova Vaga:",c),!1}};return p.useEffect(()=>{o()},[]),{isEnabled:e,loading:r,error:n,toggleAccess:l,loadAccessStatus:o}}function $g(){const[e,t]=p.useState(!1),[r,s]=p.useState(!0),[n,i]=p.useState(null),o=async()=>{s(!0),i(null);try{await jo("rh_edit_enabled","false","Habilita funcionalidade de edição de vagas para usuários RH");const d=await gu();t(d)}catch(d){i(d.message)}finally{s(!1)}},l=async d=>{try{const c=await Bg(d);return c&&t(d),c}catch(c){return i(c.message),console.error("Erro ao alternar acesso RH Edit:",c),!1}};return p.useEffect(()=>{o()},[]),{isEnabled:e,loading:r,error:n,toggleAccess:l,loadAccessStatus:o}}function zg(){const[e,t]=p.useState(!1),[r,s]=p.useState(!0),[n,i]=p.useState(null),o=async()=>{s(!0),i(null);try{await jo("rh_delete_enabled","false","Habilita funcionalidade de exclusão de vagas para usuários RH");const d=await pu();t(d)}catch(d){i(d.message)}finally{s(!1)}},l=async d=>{try{const c=await Ug(d);return c&&t(d),c}catch(c){return i(c.message),console.error("Erro ao alternar acesso RH Delete:",c),!1}};return p.useEffect(()=>{o()},[]),{isEnabled:e,loading:r,error:n,toggleAccess:l,loadAccessStatus:o}}function Vg(e={}){const{checkOnMount:t=!0,checkInterval:r=0,showModalDelay:s=2e3,autoCheckOnFocus:n=!0}=e,[i,o]=p.useState(!1),[l,d]=p.useState(!1),[c,u]=p.useState(!1),[h,f]=p.useState(null),[m,v]=p.useState(null),g=p.useRef(!1),x=p.useCallback(async(y=!1)=>{if(g.current)return console.log("⏳ Verificação já em andamento, aguardando..."),!1;g.current=!0,d(!0);try{console.log("🔍 Iniciando verificação de atualizações...");const A=await ed();return o(A),f(new Date),A&&(y||!c)&&(console.log("🆕 Nova versão encontrada, mostrando modal em",s,"ms"),setTimeout(()=>{u(!0)},s)),console.log("✅ Verificação concluída. Nova versão:",A?"SIM":"NÃO"),A}catch(A){return console.error("❌ Erro ao verificar atualizações:",A),!1}finally{d(!1),g.current=!1}},[c,s]),b=p.useCallback(()=>{console.log("🚀 Iniciando atualização da aplicação..."),td()},[]),N=p.useCallback(()=>{console.log("❌ Modal de atualização fechado pelo usuário"),u(!1)},[]);return p.useEffect(()=>{if(t){const y=setTimeout(()=>{x()},1e3);return()=>clearTimeout(y)}},[t,x]),p.useEffect(()=>{if(r>0){console.log(`⏰ Configurando verificação automática a cada ${r}ms`);const y=setInterval(()=>{x()},r);return()=>{console.log("🛑 Parando verificação automática"),clearInterval(y)}}},[r,x]),p.useEffect(()=>{if(!n)return;const y=()=>{console.log("👁️ Janela ganhou foco, verificando atualizações..."),setTimeout(()=>{x()},500)},A=()=>{document.hidden||(console.log("👁️ Página ficou visível, verificando atualizações..."),setTimeout(()=>{x()},500))};return window.addEventListener("focus",y),document.addEventListener("visibilitychange",A),()=>{window.removeEventListener("focus",y),document.removeEventListener("visibilitychange",A)}},[n,x]),{hasUpdate:i,isChecking:l,showModal:c,lastChecked:h,serverVersion:m,checkForUpdates:x,handleUpdate:b,handleCloseModal:N}}function Hg(){const[e,t]=p.useState({width:typeof window<"u"?window.innerWidth:1024,height:typeof window<"u"?window.innerHeight:768});return p.useEffect(()=>{if(typeof window>"u")return;const r=()=>{t({width:window.innerWidth,height:window.innerHeight})};return r(),window.addEventListener("resize",r),()=>window.removeEventListener("resize",r)},[]),{...e,isTablet:e.width>=800,isMobile:e.width<800,isDesktop:e.width>=1024}}const Ki=p.forwardRef(({children:e,isCollapsed:t,onToggle:r,className:s},n)=>{const{mode:i,profile:o}=hr();return a.jsx("div",{ref:n,className:De("relative flex h-screen flex-col border-r bg-card transition-all duration-300 ease-in-out shadow-lg",t?"w-16":"w-64",s),children:a.jsx("nav",{className:`flex-1 space-y-1 overflow-y-auto ${t?"p-2":"p-4"}`,children:e})})});Ki.displayName="Sidebar";const Wg=p.forwardRef(({children:e,isCollapsed:t,className:r},s)=>a.jsx("div",{ref:s,className:De("flex items-center rounded-xl transition-all duration-200 hover:bg-primary/10 hover:shadow-sm group",t?"justify-center px-2 py-3":"justify-start px-3 py-2.5",r),children:e}));Wg.displayName="SidebarItem";var[Wn]=_a("Tooltip",[On]),qn=On(),wu="TooltipProvider",qg=700,Yi="tooltip.open",[Gg,Eo]=Wn(wu),bu=e=>{const{__scopeTooltip:t,delayDuration:r=qg,skipDelayDuration:s=300,disableHoverableContent:n=!1,children:i}=e,o=p.useRef(!0),l=p.useRef(!1),d=p.useRef(0);return p.useEffect(()=>{const c=d.current;return()=>window.clearTimeout(c)},[]),a.jsx(Gg,{scope:t,isOpenDelayedRef:o,delayDuration:r,onOpen:p.useCallback(()=>{window.clearTimeout(d.current),o.current=!1},[]),onClose:p.useCallback(()=>{window.clearTimeout(d.current),d.current=window.setTimeout(()=>o.current=!0,s)},[s]),isPointerInTransitRef:l,onPointerInTransitChange:p.useCallback(c=>{l.current=c},[]),disableHoverableContent:n,children:i})};bu.displayName=wu;var Rs="Tooltip",[Xg,zs]=Wn(Rs),yu=e=>{const{__scopeTooltip:t,children:r,open:s,defaultOpen:n,onOpenChange:i,disableHoverableContent:o,delayDuration:l}=e,d=Eo(Rs,e.__scopeTooltip),c=qn(t),[u,h]=p.useState(null),f=ba(),m=p.useRef(0),v=o??d.disableHoverableContent,g=l??d.delayDuration,x=p.useRef(!1),[b,N]=Za({prop:s,defaultProp:n??!1,onChange:C=>{C?(d.onOpen(),document.dispatchEvent(new CustomEvent(Yi))):d.onClose(),i==null||i(C)},caller:Rs}),y=p.useMemo(()=>b?x.current?"delayed-open":"instant-open":"closed",[b]),A=p.useCallback(()=>{window.clearTimeout(m.current),m.current=0,x.current=!1,N(!0)},[N]),B=p.useCallback(()=>{window.clearTimeout(m.current),m.current=0,N(!1)},[N]),W=p.useCallback(()=>{window.clearTimeout(m.current),m.current=window.setTimeout(()=>{x.current=!0,N(!0),m.current=0},g)},[g,N]);return p.useEffect(()=>()=>{m.current&&(window.clearTimeout(m.current),m.current=0)},[]),a.jsx(no,{...c,children:a.jsx(Xg,{scope:t,contentId:f,open:b,stateAttribute:y,trigger:u,onTriggerChange:h,onTriggerEnter:p.useCallback(()=>{d.isOpenDelayedRef.current?W():A()},[d.isOpenDelayedRef,W,A]),onTriggerLeave:p.useCallback(()=>{v?B():(window.clearTimeout(m.current),m.current=0)},[B,v]),onOpen:A,onClose:B,disableHoverableContent:v,children:r})})};yu.displayName=Rs;var Ji="TooltipTrigger",Nu=p.forwardRef((e,t)=>{const{__scopeTooltip:r,...s}=e,n=zs(Ji,r),i=Eo(Ji,r),o=qn(r),l=p.useRef(null),d=Mt(t,l,n.onTriggerChange),c=p.useRef(!1),u=p.useRef(!1),h=p.useCallback(()=>c.current=!1,[]);return p.useEffect(()=>()=>document.removeEventListener("pointerup",h),[h]),a.jsx(yc,{asChild:!0,...o,children:a.jsx(nt.button,{"aria-describedby":n.open?n.contentId:void 0,"data-state":n.stateAttribute,...s,ref:d,onPointerMove:ke(e.onPointerMove,f=>{f.pointerType!=="touch"&&!u.current&&!i.isPointerInTransitRef.current&&(n.onTriggerEnter(),u.current=!0)}),onPointerLeave:ke(e.onPointerLeave,()=>{n.onTriggerLeave(),u.current=!1}),onPointerDown:ke(e.onPointerDown,()=>{n.open&&n.onClose(),c.current=!0,document.addEventListener("pointerup",h,{once:!0})}),onFocus:ke(e.onFocus,()=>{c.current||n.onOpen()}),onBlur:ke(e.onBlur,n.onClose),onClick:ke(e.onClick,n.onClose)})})});Nu.displayName=Ji;var _o="TooltipPortal",[Kg,Yg]=Wn(_o,{forceMount:void 0}),ju=e=>{const{__scopeTooltip:t,forceMount:r,children:s,container:n}=e,i=zs(_o,t);return a.jsx(Kg,{scope:t,forceMount:r,children:a.jsx(_r,{present:r||i.open,children:a.jsx(bc,{asChild:!0,container:n,children:s})})})};ju.displayName=_o;var Ya="TooltipContent",Eu=p.forwardRef((e,t)=>{const r=Yg(Ya,e.__scopeTooltip),{forceMount:s=r.forceMount,side:n="top",...i}=e,o=zs(Ya,e.__scopeTooltip);return a.jsx(_r,{present:s||o.open,children:o.disableHoverableContent?a.jsx(_u,{side:n,...i,ref:t}):a.jsx(Jg,{side:n,...i,ref:t})})}),Jg=p.forwardRef((e,t)=>{const r=zs(Ya,e.__scopeTooltip),s=Eo(Ya,e.__scopeTooltip),n=p.useRef(null),i=Mt(t,n),[o,l]=p.useState(null),{trigger:d,onClose:c}=r,u=n.current,{onPointerInTransitChange:h}=s,f=p.useCallback(()=>{l(null),h(!1)},[h]),m=p.useCallback((v,g)=>{const x=v.currentTarget,b={x:v.clientX,y:v.clientY},N=rp(b,x.getBoundingClientRect()),y=ap(b,N),A=sp(g.getBoundingClientRect()),B=ip([...y,...A]);l(B),h(!0)},[h]);return p.useEffect(()=>()=>f(),[f]),p.useEffect(()=>{if(d&&u){const v=x=>m(x,u),g=x=>m(x,d);return d.addEventListener("pointerleave",v),u.addEventListener("pointerleave",g),()=>{d.removeEventListener("pointerleave",v),u.removeEventListener("pointerleave",g)}}},[d,u,m,f]),p.useEffect(()=>{if(o){const v=g=>{const x=g.target,b={x:g.clientX,y:g.clientY},N=(d==null?void 0:d.contains(x))||(u==null?void 0:u.contains(x)),y=!np(b,o);N?f():y&&(f(),c())};return document.addEventListener("pointermove",v),()=>document.removeEventListener("pointermove",v)}},[d,u,o,c,f]),a.jsx(_u,{...e,ref:i})}),[Qg,Zg]=Wn(Rs,{isInside:!1}),ep=pf("TooltipContent"),_u=p.forwardRef((e,t)=>{const{__scopeTooltip:r,children:s,"aria-label":n,onEscapeKeyDown:i,onPointerDownOutside:o,...l}=e,d=zs(Ya,r),c=qn(r),{onClose:u}=d;return p.useEffect(()=>(document.addEventListener(Yi,u),()=>document.removeEventListener(Yi,u)),[u]),p.useEffect(()=>{if(d.trigger){const h=f=>{const m=f.target;m!=null&&m.contains(d.trigger)&&u()};return window.addEventListener("scroll",h,{capture:!0}),()=>window.removeEventListener("scroll",h,{capture:!0})}},[d.trigger,u]),a.jsx(Nc,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:i,onPointerDownOutside:o,onFocusOutside:h=>h.preventDefault(),onDismiss:u,children:a.jsxs(jc,{"data-state":d.stateAttribute,...c,...l,ref:t,style:{...l.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[a.jsx(ep,{children:s}),a.jsx(Qg,{scope:r,isInside:!0,children:a.jsx(vf,{id:d.contentId,role:"tooltip",children:n||s})})]})})});Eu.displayName=Ya;var Su="TooltipArrow",tp=p.forwardRef((e,t)=>{const{__scopeTooltip:r,...s}=e,n=qn(r);return Zg(Su,r).isInside?null:a.jsx(Ec,{...n,...s,ref:t})});tp.displayName=Su;function rp(e,t){const r=Math.abs(t.top-e.y),s=Math.abs(t.bottom-e.y),n=Math.abs(t.right-e.x),i=Math.abs(t.left-e.x);switch(Math.min(r,s,n,i)){case i:return"left";case n:return"right";case r:return"top";case s:return"bottom";default:throw new Error("unreachable")}}function ap(e,t,r=5){const s=[];switch(t){case"top":s.push({x:e.x-r,y:e.y+r},{x:e.x+r,y:e.y+r});break;case"bottom":s.push({x:e.x-r,y:e.y-r},{x:e.x+r,y:e.y-r});break;case"left":s.push({x:e.x+r,y:e.y-r},{x:e.x+r,y:e.y+r});break;case"right":s.push({x:e.x-r,y:e.y-r},{x:e.x-r,y:e.y+r});break}return s}function sp(e){const{top:t,right:r,bottom:s,left:n}=e;return[{x:n,y:t},{x:r,y:t},{x:r,y:s},{x:n,y:s}]}function np(e,t){const{x:r,y:s}=e;let n=!1;for(let i=0,o=t.length-1;i<t.length;o=i++){const l=t[i],d=t[o],c=l.x,u=l.y,h=d.x,f=d.y;u>s!=f>s&&r<(h-c)*(s-u)/(f-u)+c&&(n=!n)}return n}function ip(e){const t=e.slice();return t.sort((r,s)=>r.x<s.x?-1:r.x>s.x?1:r.y<s.y?-1:r.y>s.y?1:0),op(t)}function op(e){if(e.length<=1)return e.slice();const t=[];for(let s=0;s<e.length;s++){const n=e[s];for(;t.length>=2;){const i=t[t.length-1],o=t[t.length-2];if((i.x-o.x)*(n.y-o.y)>=(i.y-o.y)*(n.x-o.x))t.pop();else break}t.push(n)}t.pop();const r=[];for(let s=e.length-1;s>=0;s--){const n=e[s];for(;r.length>=2;){const i=r[r.length-1],o=r[r.length-2];if((i.x-o.x)*(n.y-o.y)>=(i.y-o.y)*(n.x-o.x))r.pop();else break}r.push(n)}return r.pop(),t.length===1&&r.length===1&&t[0].x===r[0].x&&t[0].y===r[0].y?t:t.concat(r)}var lp=bu,cp=yu,dp=Nu,up=ju,Cu=Eu;const hp=lp,bi=cp,yi=dp,cn=p.forwardRef(({className:e,sideOffset:t=4,...r},s)=>a.jsx(up,{children:a.jsx(Cu,{ref:s,sideOffset:t,className:De("z-50 overflow-hidden rounded-md bg-primary px-3 py-1.5 text-xs text-primary-foreground animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-tooltip-content-transform-origin]",e),...r})}));cn.displayName=Cu.displayName;const fp=uo("inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground shadow hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground shadow hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function Ve({className:e,variant:t,...r}){return a.jsx("div",{className:De(fp({variant:t}),e),...r})}const At=yf,So=Nf,mp=wf,Tu=p.forwardRef(({className:e,...t},r)=>a.jsx(_c,{ref:r,className:De("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t}));Tu.displayName=_c.displayName;const gt=p.forwardRef(({className:e,children:t,hideCloseButton:r=!1,...s},n)=>a.jsxs(mp,{children:[a.jsx(Tu,{}),a.jsxs(Sc,{ref:n,className:De("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...s,children:[t,!r&&a.jsxs(bf,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-all duration-200 hover:opacity-100 hover:scale-110 active:scale-95 hover:rotate-90 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[a.jsx(ar,{className:"h-4 w-4 transition-transform duration-200"}),a.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));gt.displayName=Sc.displayName;const pt=({className:e,...t})=>a.jsx("div",{className:De("flex flex-col space-y-1.5 text-center sm:text-left",e),...t});pt.displayName="DialogHeader";const Ir=({className:e,...t})=>a.jsx("div",{className:De("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e),...t});Ir.displayName="DialogFooter";const vt=p.forwardRef(({className:e,...t},r)=>a.jsx(Cc,{ref:r,className:De("text-lg font-semibold leading-none tracking-tight",e),...t}));vt.displayName=Cc.displayName;const yr=p.forwardRef(({className:e,...t},r)=>a.jsx(Tc,{ref:r,className:De("text-sm text-muted-foreground",e),...t}));yr.displayName=Tc.displayName;function xp({isOpen:e,onClose:t,user:r}){var T;const[s,n]=p.useState(!1),[i,o]=p.useState(null),[l,d]=p.useState(Or),[c,u]=p.useState(!1),{cache:h,loading:f,cacheStatus:m,forceInitialLoad:v,refreshAll:g}=Br(),[x,b]=p.useState(null),N=new Date().toLocaleDateString("pt-BR"),y=new Date().toLocaleTimeString("pt-BR"),A=async()=>{u(!0);try{console.log("📡 Carregando informações atualizadas do servidor...");const P=await Bn();P&&(o(P),console.log("✅ Informações do servidor carregadas:",P.version));const I=Ln();I&&d(I)}catch(P){console.error("❌ Erro ao carregar informações do servidor:",P)}finally{u(!1)}};p.useEffect(()=>{e&&A()},[e]),p.useEffect(()=>{b(new Date)},[h.lastUpdated]);const B=P=>P?a.jsx(Dt,{className:"h-4 w-4 text-green-500"}):a.jsx(ln,{className:"h-4 w-4 text-red-500"}),W=(P,I)=>a.jsxs(Ve,{variant:P?"default":"destructive",className:"ml-2",children:[I," ",P?"OK":"ERRO"]}),C=async()=>{n(!0);try{console.log("🔍 Verificando atualizações manualmente..."),await A(),await ed()?confirm("Nova versão disponível! Deseja atualizar agora?")&&td():alert("Você está usando a versão mais recente!")}catch(P){console.error("Erro ao verificar atualizações:",P),alert("Erro ao verificar atualizações. Tente novamente.")}finally{n(!1)}},L=[{name:"React",version:"18.x",icon:"⚛️"},{name:"TypeScript",version:"5.x",icon:"🔷"},{name:"Vite",version:"5.x",icon:"⚡"},{name:"Tailwind CSS",version:"3.x",icon:"🎨"},{name:"Supabase",version:"Latest",icon:"🚀"},{name:"Lucide React",version:"Latest",icon:"🎯"}];return a.jsx(At,{open:e,onOpenChange:t,children:a.jsxs(gt,{className:"max-w-2xl max-h-[80vh] overflow-y-auto",children:[a.jsx(pt,{children:a.jsxs(vt,{className:"flex items-center gap-2 text-xl page-title",children:[a.jsx(js,{className:"h-5 w-5 icon-primary"}),"Sobre o Repositório de Vagas"]})}),a.jsxs("div",{className:"space-y-6",children:[a.jsxs(Ee,{children:[a.jsx(Ae,{className:"pb-3",children:a.jsxs(Fe,{className:"text-lg flex items-center gap-2 page-title",children:[a.jsx(Hf,{className:"h-4 w-4 icon-primary"}),"Informações da Aplicação"]})}),a.jsxs(Se,{className:"space-y-3",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm field-subtitle modal-text",children:"Versão Atual"}),a.jsxs(Ve,{variant:"secondary",className:"mt-1",children:[c?a.jsx(ot,{className:"h-3 w-3 animate-spin mr-1"}):null,"v",(i==null?void 0:i.version)||Or]})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-muted-foreground",children:"Versão Armazenada"}),a.jsxs(Ve,{variant:"outline",className:"mt-1",children:["v",l]})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-muted-foreground",children:"Data do Build"}),a.jsx("p",{className:"text-sm font-medium",children:i!=null&&i.buildDate?new Date(i.buildDate).toLocaleDateString("pt-BR"):N})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-muted-foreground",children:"Ambiente"}),a.jsx(Ve,{variant:"default",children:"Produção"})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-muted-foreground",children:"Hora do Build"}),a.jsx("p",{className:"text-sm font-medium",children:i!=null&&i.buildDate?new Date(i.buildDate).toLocaleTimeString("pt-BR"):y})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-muted-foreground",children:"Status"}),a.jsx(Ve,{variant:i?"default":"secondary",children:c?"Carregando...":i?"Atualizado":"Local"})]})]}),a.jsxs("div",{className:"pt-3 border-t space-y-2",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[a.jsxs(Q,{onClick:A,disabled:c,variant:"outline",size:"sm",children:[c?a.jsx(ot,{className:"h-3 w-3 animate-spin mr-1"}):a.jsx(ot,{className:"h-3 w-3 mr-1"}),"Atualizar Info"]}),a.jsxs(Q,{onClick:C,disabled:s,variant:"outline",size:"sm",children:[s?a.jsx(ot,{className:"h-3 w-3 animate-spin mr-1"}):a.jsx(jr,{className:"h-3 w-3 mr-1"}),"Verificar Atualizações"]})]}),a.jsx("p",{className:"text-xs text-muted-foreground text-center",children:"As informações são atualizadas automaticamente ao abrir este modal"})]})]})]}),a.jsxs(Ee,{children:[a.jsx(Ae,{className:"pb-3",children:a.jsxs(Fe,{className:"text-lg flex items-center gap-2",children:[a.jsx(Es,{className:"h-4 w-4 text-primary"}),"Informações da Sessão"]})}),a.jsxs(Se,{className:"space-y-3",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-muted-foreground",children:"Usuário"}),a.jsx("p",{className:"text-sm font-medium",children:(r==null?void 0:r.name)||"Não identificado"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-muted-foreground",children:"Perfil"}),a.jsx(Ve,{variant:"outline",children:(r==null?void 0:r.role)||"N/A"})]})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-muted-foreground",children:"Sessão Ativa"}),a.jsx("p",{className:"text-sm font-medium text-green-600",children:new Date().toLocaleString("pt-BR")})]})]})]}),a.jsxs(Ee,{children:[a.jsx(Ae,{className:"pb-3",children:a.jsxs(Fe,{className:"text-lg flex items-center gap-2",children:[a.jsx(Pi,{className:"h-4 w-4 text-primary"}),"Debug Cache"]})}),a.jsxs(Se,{className:"space-y-3",children:[a.jsxs("div",{className:"text-xs text-muted-foreground",children:["Usuário: ",r==null?void 0:r.name," | Última atualização: ",x==null?void 0:x.toLocaleTimeString()]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("h4",{className:"text-sm font-medium",children:"Status das Seções:"}),a.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("span",{className:"flex items-center",children:[B(m.vagas),"Vagas"]}),W(m.vagas,h.vagas.length)]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("span",{className:"flex items-center",children:[B(m.clientes),"Clientes"]}),W(m.clientes,h.clientes.length)]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("span",{className:"flex items-center",children:[B(m.sites),"Sites"]}),W(m.sites,h.sites.length)]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("span",{className:"flex items-center",children:[B(m.categorias),"Categorias"]}),W(m.categorias,h.categorias.length)]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("span",{className:"flex items-center",children:[B(m.cargos),"Cargos"]}),W(m.cargos,h.cargos.length)]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("span",{className:"flex items-center",children:[B(m.celulas),"Células"]}),W(m.celulas,h.celulas.length)]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("span",{className:"flex items-center",children:[B(m.usuarios),"Usuários"]}),W(m.usuarios,h.usuarios.length)]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("span",{className:"flex items-center",children:[B(m.noticias),"Notícias"]}),W(m.noticias,h.noticias.length)]})]})]}),a.jsx("div",{className:"pt-2 border-t",children:a.jsxs("div",{className:"flex items-center justify-between text-xs",children:[a.jsxs("span",{className:"flex items-center",children:[f?a.jsx(ot,{className:"h-4 w-4 text-blue-500 animate-spin"}):a.jsx(Dt,{className:"h-4 w-4 text-green-500"}),"Status Geral"]}),a.jsx(Ve,{variant:f?"secondary":"default",children:f?"Carregando...":"Pronto"})]})}),a.jsx("div",{className:"pt-2 border-t space-y-2",children:a.jsxs("div",{className:"flex gap-2",children:[a.jsxs(Q,{onClick:v,variant:"outline",size:"sm",className:"flex-1 text-xs",disabled:f,children:[a.jsx(ot,{className:"h-3 w-3 mr-1"}),"Forçar Carregamento"]}),a.jsxs(Q,{onClick:g,variant:"outline",size:"sm",className:"flex-1 text-xs",disabled:f,children:[a.jsx(ot,{className:"h-3 w-3 mr-1"}),"Atualizar Cache"]})]})}),a.jsxs("div",{className:"pt-2 border-t text-xs text-muted-foreground",children:[a.jsxs("div",{children:["Cache ID: ",(T=r==null?void 0:r.name)==null?void 0:T.substring(0,8),"..."]}),a.jsxs("div",{children:["Última atualização: ",new Date(h.lastUpdated).toLocaleString()]})]})]})]}),(r==null?void 0:r.role)!=="RH"&&a.jsxs(Ee,{children:[a.jsx(Ae,{className:"pb-3",children:a.jsxs(Fe,{className:"text-lg flex items-center gap-2",children:[a.jsx(Wf,{className:"h-4 w-4 text-primary"}),"Stack Tecnológico"]})}),a.jsx(Se,{children:a.jsx("div",{className:"grid grid-cols-2 gap-3",children:L.map((P,I)=>a.jsxs("div",{className:"flex items-center gap-2 p-2 rounded-lg bg-muted/50",children:[a.jsx("span",{className:"text-lg",children:P.icon}),a.jsxs("div",{className:"flex-1",children:[a.jsx("p",{className:"text-sm font-medium",children:P.name}),a.jsx("p",{className:"text-xs text-muted-foreground",children:P.version})]})]},I))})})]}),(r==null?void 0:r.role)!=="RH"&&a.jsxs(Ee,{children:[a.jsx(Ae,{className:"pb-3",children:a.jsxs(Fe,{className:"text-lg flex items-center gap-2",children:[a.jsx(Hc,{className:"h-4 w-4 text-primary"}),"Informações de Deploy"]})}),a.jsxs(Se,{className:"space-y-3",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-muted-foreground",children:"Última Atualização"}),a.jsx("p",{className:"text-sm font-medium",children:i!=null&&i.buildDate?new Date(i.buildDate).toLocaleString("pt-BR"):"Não disponível"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-muted-foreground",children:"Status da Versão"}),a.jsx(Ve,{variant:(i==null?void 0:i.version)===l?"default":"destructive",children:(i==null?void 0:i.version)===l?"Atualizado":"Desatualizado"})]})]}),(i==null?void 0:i.description)&&a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-muted-foreground",children:"Descrição"}),a.jsx("p",{className:"text-sm font-medium bg-muted p-2 rounded",children:i.description})]})]})]}),a.jsxs(Ee,{children:[a.jsx(Ae,{className:"pb-3",children:a.jsxs(Fe,{className:"text-lg flex items-center gap-2",children:[a.jsx(Pi,{className:"h-4 w-4 text-primary"}),"Informações do Sistema"]})}),a.jsxs(Se,{className:"space-y-3",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-muted-foreground",children:"User Agent"}),a.jsxs("p",{className:"text-xs font-mono bg-muted p-2 rounded break-all",children:[navigator.userAgent.substring(0,50),"..."]})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-muted-foreground",children:"Resolução"}),a.jsxs("p",{className:"text-sm font-medium",children:[window.screen.width,"x",window.screen.height]})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-muted-foreground",children:"Plataforma"}),a.jsx("p",{className:"text-sm font-medium",children:navigator.platform})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-muted-foreground",children:"Idioma"}),a.jsx("p",{className:"text-sm font-medium",children:navigator.language})]})]})]})]}),a.jsxs(Ee,{children:[a.jsx(Ae,{className:"pb-3",children:a.jsxs(Fe,{className:"text-lg flex items-center gap-2",children:[a.jsx(hn,{className:"h-4 w-4 text-primary"}),"Segurança"]})}),a.jsxs(Se,{className:"space-y-3",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),a.jsx("span",{className:"text-sm",children:"Conexão HTTPS Ativa"})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),a.jsx("span",{className:"text-sm",children:"Autenticação Segura (Supabase Auth)"})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),a.jsx("span",{className:"text-sm",children:"Row Level Security (RLS) Habilitado"})]})]})]})]}),a.jsx("div",{className:"flex justify-end pt-4 border-t",children:a.jsx(Q,{onClick:t,variant:"outline",children:"Fechar"})})]})})}function gp({isOpen:e,onClose:t,onUpdate:r}){const[s,n]=p.useState(!1),[i,o]=p.useState(null),[l,d]=p.useState(Or);p.useEffect(()=>{if(e){Bn().then(f=>{f&&o(f)});const h=Ln();h&&d(h)}},[e]);const c=async()=>{n(!0);try{await r()}finally{n(!1)}},u=()=>{s||t()};return a.jsx(At,{open:e,onOpenChange:u,children:a.jsxs(gt,{className:"sm:max-w-md",children:[a.jsxs(pt,{children:[a.jsxs(vt,{className:"flex items-center space-x-2",children:[a.jsx(at,{className:"h-5 w-5 text-amber-600"}),a.jsx("span",{children:"Nova Versão Disponível!"})]}),a.jsxs(yr,{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-start space-x-3",children:[a.jsx("div",{className:"flex-shrink-0",children:a.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-blue-500 to-blue-600 rounded-lg flex items-center justify-center",children:a.jsx(jr,{className:"h-4 w-4 text-white"})})}),a.jsx("div",{className:"flex-1",children:a.jsx("p",{className:"text-sm text-muted-foreground",children:"Uma nova versão da aplicação está disponível. Recomendamos atualizar para obter as últimas funcionalidades, correções de bugs e melhorias de segurança."})})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"bg-muted/50 p-4 rounded-lg",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsxs("span",{className:"text-sm font-medium text-muted-foreground flex items-center",children:[a.jsx(ya,{className:"h-4 w-4 mr-1"}),"Versão atual"]}),a.jsxs(Ve,{variant:"outline",className:"font-mono",children:["v",l]})]}),a.jsx("div",{className:"text-xs text-muted-foreground",children:"Versão que você está usando atualmente"})]}),a.jsxs("div",{className:"bg-green-50 border border-green-200 p-4 rounded-lg",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsxs("span",{className:"text-sm font-medium text-green-800 flex items-center",children:[a.jsx(Dt,{className:"h-4 w-4 mr-1"}),"Nova versão disponível"]}),a.jsx(Ve,{variant:"default",className:"font-mono bg-green-600",children:i?`v${i.version}`:"Carregando..."})]}),a.jsx("div",{className:"text-xs text-green-700",children:i!=null&&i.buildDate?`Build: ${new Date(i.buildDate).toLocaleDateString("pt-BR")}`:"Versão mais recente disponível"})]})]}),a.jsx("div",{className:"bg-blue-50 border border-blue-200 p-3 rounded-lg",children:a.jsxs("div",{className:"flex items-start space-x-2",children:[a.jsx(at,{className:"h-4 w-4 text-blue-600 mt-0.5 flex-shrink-0"}),a.jsxs("div",{className:"text-xs text-blue-800",children:[a.jsx("p",{className:"font-medium mb-1",children:"Importante:"}),a.jsxs("ul",{className:"space-y-1 text-blue-700",children:[a.jsx("li",{children:"• A atualização é rápida e automática"}),a.jsx("li",{children:"• Seus dados não serão afetados"}),a.jsx("li",{children:"• Você será redirecionado para a nova versão"})]})]})]})})]})]}),a.jsxs("div",{className:"flex space-x-3 pt-4",children:[a.jsx(Q,{onClick:c,disabled:s,className:"flex-1 bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800",children:s?a.jsxs(a.Fragment,{children:[a.jsx(ot,{className:"h-4 w-4 mr-2 animate-spin"}),"Atualizando..."]}):a.jsxs(a.Fragment,{children:[a.jsx(jr,{className:"h-4 w-4 mr-2"}),"Atualizar Agora"]})}),a.jsx(Q,{onClick:u,variant:"outline",disabled:s,className:"px-6 hover:bg-muted/50",children:a.jsx(ar,{className:"h-4 w-4"})})]}),a.jsx("div",{className:"text-xs text-center text-muted-foreground pt-2 bg-muted/30 p-2 rounded",children:'💡 Você pode verificar atualizações manualmente usando o botão "Verificar Atualizações" no menu "Sobre"'})]})})}function pp({hasUpdate:e,isChecking:t,onUpdate:r,onCheckUpdate:s,className:n}){const[i,o]=p.useState(!1);return i||!e?null:a.jsx("div",{className:De("fixed top-4 right-4 z-50 max-w-sm","bg-white dark:bg-gray-800 border border-blue-200 dark:border-blue-700","rounded-lg shadow-lg p-4 animate-in slide-in-from-top-2",n),children:a.jsxs("div",{className:"flex items-start space-x-3",children:[a.jsx("div",{className:"flex-shrink-0",children:a.jsx("div",{className:"w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center",children:a.jsx($a,{className:"h-4 w-4 text-white"})})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[a.jsx("h4",{className:"text-sm font-semibold text-gray-900 dark:text-gray-100",children:"Atualização Disponível"}),a.jsx(Ve,{variant:"default",className:"bg-blue-500 text-white text-xs",children:"Nova versão"})]}),a.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400 mb-3",children:"Uma nova versão está disponível com melhorias e correções."}),a.jsxs("div",{className:"flex space-x-2",children:[a.jsxs(Q,{size:"sm",onClick:r,disabled:t,className:"flex-1 bg-blue-600 hover:bg-blue-700 text-white text-xs h-7",children:[a.jsx(jr,{className:"h-3 w-3 mr-1"}),"Atualizar"]}),a.jsx(Q,{size:"sm",variant:"outline",onClick:s,disabled:t,className:"text-xs h-7 px-2",children:"Verificar"})]})]}),a.jsx(Q,{size:"sm",variant:"ghost",onClick:()=>o(!0),className:"flex-shrink-0 h-6 w-6 p-0 hover:bg-gray-100 dark:hover:bg-gray-700",children:a.jsx(ar,{className:"h-3 w-3"})})]})})}function vp({isOpen:e,onClose:t,onSuccess:r}){const[s,n]=p.useState({currentPassword:"",newPassword:"",confirmPassword:""}),[i,o]=p.useState({current:!1,new:!1,confirm:!1}),[l,d]=p.useState(!1),[c,u]=p.useState("validate"),[h,f]=p.useState(""),[m,v]=p.useState(!1),[g,x]=p.useState(!1),{config:b}=hr(),N=T=>{const{name:P,value:I}=T.target;n(V=>({...V,[P]:I})),h&&(f(""),x(!1))},y=T=>{o(P=>({...P,[T]:!P[T]}))},A=async()=>{if(!s.currentPassword){f("Por favor, digite sua senha atual."),x(!0),setTimeout(()=>x(!1),500);return}d(!0),f("");try{const T=await ym(s.currentPassword);T.success?(u("change"),f("")):(f(T.message),x(!0),setTimeout(()=>x(!1),500))}catch{f("Erro inesperado. Tente novamente."),x(!0),setTimeout(()=>x(!1),500)}finally{d(!1)}},B=async()=>{if(!s.newPassword){f("Por favor, digite uma nova senha."),x(!0),setTimeout(()=>x(!1),500);return}if(!s.confirmPassword){f("Por favor, confirme sua nova senha."),x(!0),setTimeout(()=>x(!1),500);return}if(!xn(s.newPassword,s.confirmPassword)){f("As senhas não coincidem."),x(!0),setTimeout(()=>x(!1),500);return}const T=es(s.newPassword);if(!T.isValid){f(`Senha muito fraca. ${T.errors.join(", ")}`),x(!0),setTimeout(()=>x(!1),500);return}d(!0),f("");try{const P=await vm(s.newPassword);P.success?(v(!0),f(P.message),setTimeout(()=>{r==null||r(),W()},2e3)):(f(P.message),x(!0),setTimeout(()=>x(!1),500))}catch{f("Erro inesperado. Tente novamente."),x(!0),setTimeout(()=>x(!1),500)}finally{d(!1)}},W=()=>{n({currentPassword:"",newPassword:"",confirmPassword:""}),o({current:!1,new:!1,confirm:!1}),u("validate"),f(""),v(!1),x(!1),d(!1),t()},C=s.newPassword?Yc(s.newPassword):null,L=s.newPassword&&s.confirmPassword?xn(s.newPassword,s.confirmPassword):null;return a.jsx(At,{open:e,onOpenChange:W,children:a.jsxs(gt,{className:"sm:max-w-md",children:[a.jsxs(pt,{children:[a.jsxs(vt,{className:"flex items-center gap-2",children:[a.jsx(hn,{className:"h-5 w-5"}),"Alterar Senha"]}),a.jsx(yr,{children:c==="validate"?"Digite sua senha atual para continuar":"Digite sua nova senha segura"})]}),a.jsx("div",{className:"space-y-4",children:c==="validate"?a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"space-y-2",children:[a.jsxs(fe,{htmlFor:"currentPassword",className:"flex items-center gap-2",children:[a.jsx(Ns,{className:"h-4 w-4"}),"Senha Atual"]}),a.jsxs("div",{className:"relative",children:[a.jsx(Re,{id:"currentPassword",name:"currentPassword",type:i.current?"text":"password",value:s.currentPassword,onChange:N,placeholder:"Digite sua senha atual",autoComplete:"current-password",required:!0,disabled:l,className:`pr-12 ${l?"opacity-50":""}`}),a.jsx("button",{type:"button",onClick:()=>y("current"),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-muted-foreground hover:text-foreground transition-colors duration-200",disabled:l,children:i.current?a.jsx(la,{className:"h-4 w-4"}):a.jsx(Pt,{className:"h-4 w-4"})})]})]}),h&&a.jsxs("div",{className:`flex items-center gap-2 p-3 rounded-lg border transition-all duration-300 ${g?"animate-shake":""} ${b.effects.glassmorphism?"bg-destructive/20 backdrop-blur-sm border-destructive/30":"bg-destructive/10 border-destructive/20"}`,children:[a.jsx(at,{className:"h-4 w-4 text-destructive flex-shrink-0"}),a.jsx("span",{className:"text-destructive text-sm font-medium",children:h})]})]}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"space-y-2",children:[a.jsxs(fe,{htmlFor:"newPassword",className:"flex items-center gap-2",children:[a.jsx(hn,{className:"h-4 w-4"}),"Nova Senha"]}),a.jsxs("div",{className:"relative",children:[a.jsx(Re,{id:"newPassword",name:"newPassword",type:i.new?"text":"password",value:s.newPassword,onChange:N,placeholder:"Digite sua nova senha",autoComplete:"new-password",required:!0,disabled:l,className:`pr-12 ${l?"opacity-50":""}`}),a.jsx("button",{type:"button",onClick:()=>y("new"),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-muted-foreground hover:text-foreground transition-colors duration-200",disabled:l,children:i.new?a.jsx(la,{className:"h-4 w-4"}):a.jsx(Pt,{className:"h-4 w-4"})})]}),s.newPassword&&C&&a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center justify-between text-xs",children:[a.jsx("span",{className:"text-muted-foreground",children:"Força:"}),a.jsx("span",{className:`font-medium ${C.color==="red"?"text-red-600":C.color==="orange"?"text-orange-600":C.color==="yellow"?"text-yellow-600":C.color==="lightgreen"?"text-green-600":"text-green-700"}`,children:C.label})]}),a.jsx("div",{className:"w-full bg-muted rounded-full h-2",children:a.jsx("div",{className:`h-2 rounded-full transition-all duration-300 ${C.color==="red"?"bg-red-500":C.color==="orange"?"bg-orange-500":C.color==="yellow"?"bg-yellow-500":C.color==="lightgreen"?"bg-green-500":"bg-green-600"}`,style:{width:`${C.score}%`}})})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs(fe,{htmlFor:"confirmPassword",className:"flex items-center gap-2",children:[a.jsx(Ns,{className:"h-4 w-4"}),"Confirmar Nova Senha"]}),a.jsxs("div",{className:"relative",children:[a.jsx(Re,{id:"confirmPassword",name:"confirmPassword",type:i.confirm?"text":"password",value:s.confirmPassword,onChange:N,placeholder:"Confirme sua nova senha",autoComplete:"new-password",required:!0,disabled:l,className:`pr-12 ${l?"opacity-50":""}`}),a.jsx("button",{type:"button",onClick:()=>y("confirm"),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-muted-foreground hover:text-foreground transition-colors duration-200",disabled:l,children:i.confirm?a.jsx(la,{className:"h-4 w-4"}):a.jsx(Pt,{className:"h-4 w-4"})})]}),s.confirmPassword&&L!==null&&a.jsx("div",{className:"flex items-center gap-2 text-xs",children:L?a.jsxs(a.Fragment,{children:[a.jsx(Dt,{className:"h-4 w-4 text-success"}),a.jsx("span",{className:"text-success",children:"Senhas coincidem"})]}):a.jsxs(a.Fragment,{children:[a.jsx(at,{className:"h-4 w-4 text-destructive"}),a.jsx("span",{className:"text-destructive",children:"Senhas não coincidem"})]})})]}),h&&a.jsxs("div",{className:`flex items-center gap-2 p-3 rounded-lg border transition-all duration-300 ${g?"animate-shake":""} ${b.effects.glassmorphism?m?"bg-success/20 backdrop-blur-sm border-success/30":"bg-destructive/20 backdrop-blur-sm border-destructive/30":m?"bg-success/10 border-success/20":"bg-destructive/10 border-destructive/20"}`,children:[m?a.jsx(Dt,{className:"h-4 w-4 text-success flex-shrink-0"}):a.jsx(at,{className:"h-4 w-4 text-destructive flex-shrink-0"}),a.jsx("span",{className:`text-sm font-medium ${m?"text-success":"text-destructive"}`,children:h})]})]})}),a.jsxs(Ir,{className:"flex gap-2",children:[a.jsx(Q,{type:"button",variant:"outline",onClick:W,disabled:l,children:"Cancelar"}),c==="validate"?a.jsx(Q,{type:"button",onClick:A,disabled:l||!s.currentPassword,children:l?a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Mr,{className:"w-4 h-4 animate-spin"}),"Validando..."]}):"Continuar"}):a.jsx(Q,{type:"button",onClick:B,disabled:l||!s.newPassword||!s.confirmPassword||L===!1,children:l?a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Mr,{className:"w-4 h-4 animate-spin"}),"Alterando..."]}):"Alterar Senha"})]})]})})}function wp(e,t){return p.useReducer((r,s)=>t[r][s]??r,e)}var Co="ScrollArea",[Au]=_a(Co),[bp,fr]=Au(Co),Ru=p.forwardRef((e,t)=>{const{__scopeScrollArea:r,type:s="hover",dir:n,scrollHideDelay:i=600,...o}=e,[l,d]=p.useState(null),[c,u]=p.useState(null),[h,f]=p.useState(null),[m,v]=p.useState(null),[g,x]=p.useState(null),[b,N]=p.useState(0),[y,A]=p.useState(0),[B,W]=p.useState(!1),[C,L]=p.useState(!1),T=Mt(t,I=>d(I)),P=In(n);return a.jsx(bp,{scope:r,type:s,dir:P,scrollHideDelay:i,scrollArea:l,viewport:c,onViewportChange:u,content:h,onContentChange:f,scrollbarX:m,onScrollbarXChange:v,scrollbarXEnabled:B,onScrollbarXEnabledChange:W,scrollbarY:g,onScrollbarYChange:x,scrollbarYEnabled:C,onScrollbarYEnabledChange:L,onCornerWidthChange:N,onCornerHeightChange:A,children:a.jsx(nt.div,{dir:P,...o,ref:T,style:{position:"relative","--radix-scroll-area-corner-width":b+"px","--radix-scroll-area-corner-height":y+"px",...e.style}})})});Ru.displayName=Co;var Fu="ScrollAreaViewport",ku=p.forwardRef((e,t)=>{const{__scopeScrollArea:r,children:s,nonce:n,...i}=e,o=fr(Fu,r),l=p.useRef(null),d=Mt(t,l,o.onViewportChange);return a.jsxs(a.Fragment,{children:[a.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-scroll-area-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-scroll-area-viewport]::-webkit-scrollbar{display:none}"},nonce:n}),a.jsx(nt.div,{"data-radix-scroll-area-viewport":"",...i,ref:d,style:{overflowX:o.scrollbarXEnabled?"scroll":"hidden",overflowY:o.scrollbarYEnabled?"scroll":"hidden",...e.style},children:a.jsx("div",{ref:o.onContentChange,style:{minWidth:"100%",display:"table"},children:s})})]})});ku.displayName=Fu;var Ur="ScrollAreaScrollbar",To=p.forwardRef((e,t)=>{const{forceMount:r,...s}=e,n=fr(Ur,e.__scopeScrollArea),{onScrollbarXEnabledChange:i,onScrollbarYEnabledChange:o}=n,l=e.orientation==="horizontal";return p.useEffect(()=>(l?i(!0):o(!0),()=>{l?i(!1):o(!1)}),[l,i,o]),n.type==="hover"?a.jsx(yp,{...s,ref:t,forceMount:r}):n.type==="scroll"?a.jsx(Np,{...s,ref:t,forceMount:r}):n.type==="auto"?a.jsx(Du,{...s,ref:t,forceMount:r}):n.type==="always"?a.jsx(Ao,{...s,ref:t}):null});To.displayName=Ur;var yp=p.forwardRef((e,t)=>{const{forceMount:r,...s}=e,n=fr(Ur,e.__scopeScrollArea),[i,o]=p.useState(!1);return p.useEffect(()=>{const l=n.scrollArea;let d=0;if(l){const c=()=>{window.clearTimeout(d),o(!0)},u=()=>{d=window.setTimeout(()=>o(!1),n.scrollHideDelay)};return l.addEventListener("pointerenter",c),l.addEventListener("pointerleave",u),()=>{window.clearTimeout(d),l.removeEventListener("pointerenter",c),l.removeEventListener("pointerleave",u)}}},[n.scrollArea,n.scrollHideDelay]),a.jsx(_r,{present:r||i,children:a.jsx(Du,{"data-state":i?"visible":"hidden",...s,ref:t})})}),Np=p.forwardRef((e,t)=>{const{forceMount:r,...s}=e,n=fr(Ur,e.__scopeScrollArea),i=e.orientation==="horizontal",o=Xn(()=>d("SCROLL_END"),100),[l,d]=wp("hidden",{hidden:{SCROLL:"scrolling"},scrolling:{SCROLL_END:"idle",POINTER_ENTER:"interacting"},interacting:{SCROLL:"interacting",POINTER_LEAVE:"idle"},idle:{HIDE:"hidden",SCROLL:"scrolling",POINTER_ENTER:"interacting"}});return p.useEffect(()=>{if(l==="idle"){const c=window.setTimeout(()=>d("HIDE"),n.scrollHideDelay);return()=>window.clearTimeout(c)}},[l,n.scrollHideDelay,d]),p.useEffect(()=>{const c=n.viewport,u=i?"scrollLeft":"scrollTop";if(c){let h=c[u];const f=()=>{const m=c[u];h!==m&&(d("SCROLL"),o()),h=m};return c.addEventListener("scroll",f),()=>c.removeEventListener("scroll",f)}},[n.viewport,i,d,o]),a.jsx(_r,{present:r||l!=="hidden",children:a.jsx(Ao,{"data-state":l==="hidden"?"hidden":"visible",...s,ref:t,onPointerEnter:ke(e.onPointerEnter,()=>d("POINTER_ENTER")),onPointerLeave:ke(e.onPointerLeave,()=>d("POINTER_LEAVE"))})})}),Du=p.forwardRef((e,t)=>{const r=fr(Ur,e.__scopeScrollArea),{forceMount:s,...n}=e,[i,o]=p.useState(!1),l=e.orientation==="horizontal",d=Xn(()=>{if(r.viewport){const c=r.viewport.offsetWidth<r.viewport.scrollWidth,u=r.viewport.offsetHeight<r.viewport.scrollHeight;o(l?c:u)}},10);return Ja(r.viewport,d),Ja(r.content,d),a.jsx(_r,{present:s||i,children:a.jsx(Ao,{"data-state":i?"visible":"hidden",...n,ref:t})})}),Ao=p.forwardRef((e,t)=>{const{orientation:r="vertical",...s}=e,n=fr(Ur,e.__scopeScrollArea),i=p.useRef(null),o=p.useRef(0),[l,d]=p.useState({content:0,viewport:0,scrollbar:{size:0,paddingStart:0,paddingEnd:0}}),c=Lu(l.viewport,l.content),u={...s,sizes:l,onSizesChange:d,hasThumb:c>0&&c<1,onThumbChange:f=>i.current=f,onThumbPointerUp:()=>o.current=0,onThumbPointerDown:f=>o.current=f};function h(f,m){return Tp(f,o.current,l,m)}return r==="horizontal"?a.jsx(jp,{...u,ref:t,onThumbPositionChange:()=>{if(n.viewport&&i.current){const f=n.viewport.scrollLeft,m=Nl(f,l,n.dir);i.current.style.transform=`translate3d(${m}px, 0, 0)`}},onWheelScroll:f=>{n.viewport&&(n.viewport.scrollLeft=f)},onDragScroll:f=>{n.viewport&&(n.viewport.scrollLeft=h(f,n.dir))}}):r==="vertical"?a.jsx(Ep,{...u,ref:t,onThumbPositionChange:()=>{if(n.viewport&&i.current){const f=n.viewport.scrollTop,m=Nl(f,l);i.current.style.transform=`translate3d(0, ${m}px, 0)`}},onWheelScroll:f=>{n.viewport&&(n.viewport.scrollTop=f)},onDragScroll:f=>{n.viewport&&(n.viewport.scrollTop=h(f))}}):null}),jp=p.forwardRef((e,t)=>{const{sizes:r,onSizesChange:s,...n}=e,i=fr(Ur,e.__scopeScrollArea),[o,l]=p.useState(),d=p.useRef(null),c=Mt(t,d,i.onScrollbarXChange);return p.useEffect(()=>{d.current&&l(getComputedStyle(d.current))},[d]),a.jsx(Iu,{"data-orientation":"horizontal",...n,ref:c,sizes:r,style:{bottom:0,left:i.dir==="rtl"?"var(--radix-scroll-area-corner-width)":0,right:i.dir==="ltr"?"var(--radix-scroll-area-corner-width)":0,"--radix-scroll-area-thumb-width":Gn(r)+"px",...e.style},onThumbPointerDown:u=>e.onThumbPointerDown(u.x),onDragScroll:u=>e.onDragScroll(u.x),onWheelScroll:(u,h)=>{if(i.viewport){const f=i.viewport.scrollLeft+u.deltaX;e.onWheelScroll(f),Uu(f,h)&&u.preventDefault()}},onResize:()=>{d.current&&i.viewport&&o&&s({content:i.viewport.scrollWidth,viewport:i.viewport.offsetWidth,scrollbar:{size:d.current.clientWidth,paddingStart:wn(o.paddingLeft),paddingEnd:wn(o.paddingRight)}})}})}),Ep=p.forwardRef((e,t)=>{const{sizes:r,onSizesChange:s,...n}=e,i=fr(Ur,e.__scopeScrollArea),[o,l]=p.useState(),d=p.useRef(null),c=Mt(t,d,i.onScrollbarYChange);return p.useEffect(()=>{d.current&&l(getComputedStyle(d.current))},[d]),a.jsx(Iu,{"data-orientation":"vertical",...n,ref:c,sizes:r,style:{top:0,right:i.dir==="ltr"?0:void 0,left:i.dir==="rtl"?0:void 0,bottom:"var(--radix-scroll-area-corner-height)","--radix-scroll-area-thumb-height":Gn(r)+"px",...e.style},onThumbPointerDown:u=>e.onThumbPointerDown(u.y),onDragScroll:u=>e.onDragScroll(u.y),onWheelScroll:(u,h)=>{if(i.viewport){const f=i.viewport.scrollTop+u.deltaY;e.onWheelScroll(f),Uu(f,h)&&u.preventDefault()}},onResize:()=>{d.current&&i.viewport&&o&&s({content:i.viewport.scrollHeight,viewport:i.viewport.offsetHeight,scrollbar:{size:d.current.clientHeight,paddingStart:wn(o.paddingTop),paddingEnd:wn(o.paddingBottom)}})}})}),[_p,Pu]=Au(Ur),Iu=p.forwardRef((e,t)=>{const{__scopeScrollArea:r,sizes:s,hasThumb:n,onThumbChange:i,onThumbPointerUp:o,onThumbPointerDown:l,onThumbPositionChange:d,onDragScroll:c,onWheelScroll:u,onResize:h,...f}=e,m=fr(Ur,r),[v,g]=p.useState(null),x=Mt(t,T=>g(T)),b=p.useRef(null),N=p.useRef(""),y=m.viewport,A=s.content-s.viewport,B=wr(u),W=wr(d),C=Xn(h,10);function L(T){if(b.current){const P=T.clientX-b.current.left,I=T.clientY-b.current.top;c({x:P,y:I})}}return p.useEffect(()=>{const T=P=>{const I=P.target;(v==null?void 0:v.contains(I))&&B(P,A)};return document.addEventListener("wheel",T,{passive:!1}),()=>document.removeEventListener("wheel",T,{passive:!1})},[y,v,A,B]),p.useEffect(W,[s,W]),Ja(v,C),Ja(m.content,C),a.jsx(_p,{scope:r,scrollbar:v,hasThumb:n,onThumbChange:wr(i),onThumbPointerUp:wr(o),onThumbPositionChange:W,onThumbPointerDown:wr(l),children:a.jsx(nt.div,{...f,ref:x,style:{position:"absolute",...f.style},onPointerDown:ke(e.onPointerDown,T=>{T.button===0&&(T.target.setPointerCapture(T.pointerId),b.current=v.getBoundingClientRect(),N.current=document.body.style.webkitUserSelect,document.body.style.webkitUserSelect="none",m.viewport&&(m.viewport.style.scrollBehavior="auto"),L(T))}),onPointerMove:ke(e.onPointerMove,L),onPointerUp:ke(e.onPointerUp,T=>{const P=T.target;P.hasPointerCapture(T.pointerId)&&P.releasePointerCapture(T.pointerId),document.body.style.webkitUserSelect=N.current,m.viewport&&(m.viewport.style.scrollBehavior=""),b.current=null})})})}),vn="ScrollAreaThumb",Ou=p.forwardRef((e,t)=>{const{forceMount:r,...s}=e,n=Pu(vn,e.__scopeScrollArea);return a.jsx(_r,{present:r||n.hasThumb,children:a.jsx(Sp,{ref:t,...s})})}),Sp=p.forwardRef((e,t)=>{const{__scopeScrollArea:r,style:s,...n}=e,i=fr(vn,r),o=Pu(vn,r),{onThumbPositionChange:l}=o,d=Mt(t,h=>o.onThumbChange(h)),c=p.useRef(void 0),u=Xn(()=>{c.current&&(c.current(),c.current=void 0)},100);return p.useEffect(()=>{const h=i.viewport;if(h){const f=()=>{if(u(),!c.current){const m=Ap(h,l);c.current=m,l()}};return l(),h.addEventListener("scroll",f),()=>h.removeEventListener("scroll",f)}},[i.viewport,u,l]),a.jsx(nt.div,{"data-state":o.hasThumb?"visible":"hidden",...n,ref:d,style:{width:"var(--radix-scroll-area-thumb-width)",height:"var(--radix-scroll-area-thumb-height)",...s},onPointerDownCapture:ke(e.onPointerDownCapture,h=>{const m=h.target.getBoundingClientRect(),v=h.clientX-m.left,g=h.clientY-m.top;o.onThumbPointerDown({x:v,y:g})}),onPointerUp:ke(e.onPointerUp,o.onThumbPointerUp)})});Ou.displayName=vn;var Ro="ScrollAreaCorner",Mu=p.forwardRef((e,t)=>{const r=fr(Ro,e.__scopeScrollArea),s=!!(r.scrollbarX&&r.scrollbarY);return r.type!=="scroll"&&s?a.jsx(Cp,{...e,ref:t}):null});Mu.displayName=Ro;var Cp=p.forwardRef((e,t)=>{const{__scopeScrollArea:r,...s}=e,n=fr(Ro,r),[i,o]=p.useState(0),[l,d]=p.useState(0),c=!!(i&&l);return Ja(n.scrollbarX,()=>{var h;const u=((h=n.scrollbarX)==null?void 0:h.offsetHeight)||0;n.onCornerHeightChange(u),d(u)}),Ja(n.scrollbarY,()=>{var h;const u=((h=n.scrollbarY)==null?void 0:h.offsetWidth)||0;n.onCornerWidthChange(u),o(u)}),c?a.jsx(nt.div,{...s,ref:t,style:{width:i,height:l,position:"absolute",right:n.dir==="ltr"?0:void 0,left:n.dir==="rtl"?0:void 0,bottom:0,...e.style}}):null});function wn(e){return e?parseInt(e,10):0}function Lu(e,t){const r=e/t;return isNaN(r)?0:r}function Gn(e){const t=Lu(e.viewport,e.content),r=e.scrollbar.paddingStart+e.scrollbar.paddingEnd,s=(e.scrollbar.size-r)*t;return Math.max(s,18)}function Tp(e,t,r,s="ltr"){const n=Gn(r),i=n/2,o=t||i,l=n-o,d=r.scrollbar.paddingStart+o,c=r.scrollbar.size-r.scrollbar.paddingEnd-l,u=r.content-r.viewport,h=s==="ltr"?[0,u]:[u*-1,0];return Bu([d,c],h)(e)}function Nl(e,t,r="ltr"){const s=Gn(t),n=t.scrollbar.paddingStart+t.scrollbar.paddingEnd,i=t.scrollbar.size-n,o=t.content-t.viewport,l=i-s,d=r==="ltr"?[0,o]:[o*-1,0],c=Ef(e,d);return Bu([0,o],[0,l])(c)}function Bu(e,t){return r=>{if(e[0]===e[1]||t[0]===t[1])return t[0];const s=(t[1]-t[0])/(e[1]-e[0]);return t[0]+s*(r-e[0])}}function Uu(e,t){return e>0&&e<t}var Ap=(e,t=()=>{})=>{let r={left:e.scrollLeft,top:e.scrollTop},s=0;return function n(){const i={left:e.scrollLeft,top:e.scrollTop},o=r.left!==i.left,l=r.top!==i.top;(o||l)&&t(),r=i,s=window.requestAnimationFrame(n)}(),()=>window.cancelAnimationFrame(s)};function Xn(e,t){const r=wr(e),s=p.useRef(0);return p.useEffect(()=>()=>window.clearTimeout(s.current),[]),p.useCallback(()=>{window.clearTimeout(s.current),s.current=window.setTimeout(r,t)},[r,t])}function Ja(e,t){const r=wr(t);jf(()=>{let s=0;if(e){const n=new ResizeObserver(()=>{cancelAnimationFrame(s),s=window.requestAnimationFrame(r)});return n.observe(e),()=>{window.cancelAnimationFrame(s),n.unobserve(e)}}},[e,r])}var $u=Ru,Rp=ku,Fp=Mu;const zu=p.forwardRef(({className:e,children:t,...r},s)=>a.jsxs($u,{ref:s,className:De("relative overflow-hidden",e),...r,children:[a.jsx(Rp,{className:"h-full w-full rounded-[inherit]",children:t}),a.jsx(Vu,{}),a.jsx(Fp,{})]}));zu.displayName=$u.displayName;const Vu=p.forwardRef(({className:e,orientation:t="vertical",...r},s)=>a.jsx(To,{ref:s,orientation:t,className:De("flex touch-none select-none transition-colors",t==="vertical"&&"h-full w-2.5 border-l border-l-transparent p-[1px]",t==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",e),...r,children:a.jsx(Ou,{className:"relative flex-1 rounded-full bg-border"})}));Vu.displayName=To.displayName;var kp="Separator",jl="horizontal",Dp=["horizontal","vertical"],Hu=p.forwardRef((e,t)=>{const{decorative:r,orientation:s=jl,...n}=e,i=Pp(s)?s:jl,l=r?{role:"none"}:{"aria-orientation":i==="vertical"?i:void 0,role:"separator"};return a.jsx(nt.div,{"data-orientation":i,...l,...n,ref:t})});Hu.displayName=kp;function Pp(e){return Dp.includes(e)}var Wu=Hu;const Fo=p.forwardRef(({className:e,orientation:t="horizontal",decorative:r=!0,...s},n)=>a.jsx(Wu,{ref:n,decorative:r,orientation:t,className:De("shrink-0 bg-border",t==="horizontal"?"h-[1px] w-full":"h-full w-[1px]",e),...s}));Fo.displayName=Wu.displayName;const Qs=43200,El=1440,_l=Symbol.for("constructDateFrom");function ko(e,t){return typeof e=="function"?e(t):e&&typeof e=="object"&&_l in e?e[_l](t):e instanceof Date?new e.constructor(t):new Date(t)}function ca(e,t){return ko(e,e)}let Ip={};function Op(){return Ip}function Sl(e){const t=ca(e),r=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return r.setUTCFullYear(t.getFullYear()),+e-+r}function Do(e,...t){const r=ko.bind(null,e||t.find(s=>typeof s=="object"));return t.map(r)}function dn(e,t){const r=+ca(e)-+ca(t);return r<0?-1:r>0?1:r}function Mp(e){return ko(e,Date.now())}function Lp(e,t,r){const[s,n]=Do(r==null?void 0:r.in,e,t),i=s.getFullYear()-n.getFullYear(),o=s.getMonth()-n.getMonth();return i*12+o}function Bp(e){return t=>{const s=(e?Math[e]:Math.trunc)(t);return s===0?0:s}}function Up(e,t){return+ca(e)-+ca(t)}function $p(e,t){const r=ca(e);return r.setHours(23,59,59,999),r}function zp(e,t){const r=ca(e),s=r.getMonth();return r.setFullYear(r.getFullYear(),s+1,0),r.setHours(23,59,59,999),r}function Vp(e,t){const r=ca(e);return+$p(r)==+zp(r)}function Hp(e,t,r){const[s,n,i]=Do(r==null?void 0:r.in,e,e,t),o=dn(n,i),l=Math.abs(Lp(n,i));if(l<1)return 0;n.getMonth()===1&&n.getDate()>27&&n.setDate(30),n.setMonth(n.getMonth()-o*l);let d=dn(n,i)===-o;Vp(s)&&l===1&&dn(s,i)===1&&(d=!1);const c=o*(l-+d);return c===0?0:c}function Wp(e,t,r){const s=Up(e,t)/1e3;return Bp(r==null?void 0:r.roundingMethod)(s)}const qp={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},Gp=(e,t,r)=>{let s;const n=qp[e];return typeof n=="string"?s=n:t===1?s=n.one:s=n.other.replace("{{count}}",t.toString()),r!=null&&r.addSuffix?r.comparison&&r.comparison>0?"in "+s:s+" ago":s};function Va(e){return(t={})=>{const r=t.width?String(t.width):e.defaultWidth;return e.formats[r]||e.formats[e.defaultWidth]}}const Xp={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},Kp={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},Yp={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},Jp={date:Va({formats:Xp,defaultWidth:"full"}),time:Va({formats:Kp,defaultWidth:"full"}),dateTime:Va({formats:Yp,defaultWidth:"full"})},Qp={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},Zp=(e,t,r,s)=>Qp[e];function Dr(e){return(t,r)=>{const s=r!=null&&r.context?String(r.context):"standalone";let n;if(s==="formatting"&&e.formattingValues){const o=e.defaultFormattingWidth||e.defaultWidth,l=r!=null&&r.width?String(r.width):o;n=e.formattingValues[l]||e.formattingValues[o]}else{const o=e.defaultWidth,l=r!=null&&r.width?String(r.width):e.defaultWidth;n=e.values[l]||e.values[o]}const i=e.argumentCallback?e.argumentCallback(t):t;return n[i]}}const ev={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},tv={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},rv={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},av={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},sv={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},nv={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},iv=(e,t)=>{const r=Number(e),s=r%100;if(s>20||s<10)switch(s%10){case 1:return r+"st";case 2:return r+"nd";case 3:return r+"rd"}return r+"th"},ov={ordinalNumber:iv,era:Dr({values:ev,defaultWidth:"wide"}),quarter:Dr({values:tv,defaultWidth:"wide",argumentCallback:e=>e-1}),month:Dr({values:rv,defaultWidth:"wide"}),day:Dr({values:av,defaultWidth:"wide"}),dayPeriod:Dr({values:sv,defaultWidth:"wide",formattingValues:nv,defaultFormattingWidth:"wide"})};function Pr(e){return(t,r={})=>{const s=r.width,n=s&&e.matchPatterns[s]||e.matchPatterns[e.defaultMatchWidth],i=t.match(n);if(!i)return null;const o=i[0],l=s&&e.parsePatterns[s]||e.parsePatterns[e.defaultParseWidth],d=Array.isArray(l)?cv(l,h=>h.test(o)):lv(l,h=>h.test(o));let c;c=e.valueCallback?e.valueCallback(d):d,c=r.valueCallback?r.valueCallback(c):c;const u=t.slice(o.length);return{value:c,rest:u}}}function lv(e,t){for(const r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&t(e[r]))return r}function cv(e,t){for(let r=0;r<e.length;r++)if(t(e[r]))return r}function qu(e){return(t,r={})=>{const s=t.match(e.matchPattern);if(!s)return null;const n=s[0],i=t.match(e.parsePattern);if(!i)return null;let o=e.valueCallback?e.valueCallback(i[0]):i[0];o=r.valueCallback?r.valueCallback(o):o;const l=t.slice(n.length);return{value:o,rest:l}}}const dv=/^(\d+)(th|st|nd|rd)?/i,uv=/\d+/i,hv={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},fv={any:[/^b/i,/^(a|c)/i]},mv={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},xv={any:[/1/i,/2/i,/3/i,/4/i]},gv={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},pv={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},vv={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},wv={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},bv={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},yv={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},Nv={ordinalNumber:qu({matchPattern:dv,parsePattern:uv,valueCallback:e=>parseInt(e,10)}),era:Pr({matchPatterns:hv,defaultMatchWidth:"wide",parsePatterns:fv,defaultParseWidth:"any"}),quarter:Pr({matchPatterns:mv,defaultMatchWidth:"wide",parsePatterns:xv,defaultParseWidth:"any",valueCallback:e=>e+1}),month:Pr({matchPatterns:gv,defaultMatchWidth:"wide",parsePatterns:pv,defaultParseWidth:"any"}),day:Pr({matchPatterns:vv,defaultMatchWidth:"wide",parsePatterns:wv,defaultParseWidth:"any"}),dayPeriod:Pr({matchPatterns:bv,defaultMatchWidth:"any",parsePatterns:yv,defaultParseWidth:"any"})},jv={code:"en-US",formatDistance:Gp,formatLong:Jp,formatRelative:Zp,localize:ov,match:Nv,options:{weekStartsOn:0,firstWeekContainsDate:1}};function Ev(e,t,r){const s=Op(),n=(r==null?void 0:r.locale)??s.locale??jv,i=2520,o=dn(e,t);if(isNaN(o))throw new RangeError("Invalid time value");const l=Object.assign({},r,{addSuffix:r==null?void 0:r.addSuffix,comparison:o}),[d,c]=Do(r==null?void 0:r.in,...o>0?[t,e]:[e,t]),u=Wp(c,d),h=(Sl(c)-Sl(d))/1e3,f=Math.round((u-h)/60);let m;if(f<2)return r!=null&&r.includeSeconds?u<5?n.formatDistance("lessThanXSeconds",5,l):u<10?n.formatDistance("lessThanXSeconds",10,l):u<20?n.formatDistance("lessThanXSeconds",20,l):u<40?n.formatDistance("halfAMinute",0,l):u<60?n.formatDistance("lessThanXMinutes",1,l):n.formatDistance("xMinutes",1,l):f===0?n.formatDistance("lessThanXMinutes",1,l):n.formatDistance("xMinutes",f,l);if(f<45)return n.formatDistance("xMinutes",f,l);if(f<90)return n.formatDistance("aboutXHours",1,l);if(f<El){const v=Math.round(f/60);return n.formatDistance("aboutXHours",v,l)}else{if(f<i)return n.formatDistance("xDays",1,l);if(f<Qs){const v=Math.round(f/El);return n.formatDistance("xDays",v,l)}else if(f<Qs*2)return m=Math.round(f/Qs),n.formatDistance("aboutXMonths",m,l)}if(m=Hp(c,d),m<12){const v=Math.round(f/Qs);return n.formatDistance("xMonths",v,l)}else{const v=m%12,g=Math.trunc(m/12);return v<3?n.formatDistance("aboutXYears",g,l):v<9?n.formatDistance("overXYears",g,l):n.formatDistance("almostXYears",g+1,l)}}function _v(e,t){return Ev(e,Mp(e),t)}const Sv={lessThanXSeconds:{one:"menos de um segundo",other:"menos de {{count}} segundos"},xSeconds:{one:"1 segundo",other:"{{count}} segundos"},halfAMinute:"meio minuto",lessThanXMinutes:{one:"menos de um minuto",other:"menos de {{count}} minutos"},xMinutes:{one:"1 minuto",other:"{{count}} minutos"},aboutXHours:{one:"cerca de 1 hora",other:"cerca de {{count}} horas"},xHours:{one:"1 hora",other:"{{count}} horas"},xDays:{one:"1 dia",other:"{{count}} dias"},aboutXWeeks:{one:"cerca de 1 semana",other:"cerca de {{count}} semanas"},xWeeks:{one:"1 semana",other:"{{count}} semanas"},aboutXMonths:{one:"cerca de 1 mês",other:"cerca de {{count}} meses"},xMonths:{one:"1 mês",other:"{{count}} meses"},aboutXYears:{one:"cerca de 1 ano",other:"cerca de {{count}} anos"},xYears:{one:"1 ano",other:"{{count}} anos"},overXYears:{one:"mais de 1 ano",other:"mais de {{count}} anos"},almostXYears:{one:"quase 1 ano",other:"quase {{count}} anos"}},Cv=(e,t,r)=>{let s;const n=Sv[e];return typeof n=="string"?s=n:t===1?s=n.one:s=n.other.replace("{{count}}",String(t)),r!=null&&r.addSuffix?r.comparison&&r.comparison>0?"em "+s:"há "+s:s},Tv={full:"EEEE, d 'de' MMMM 'de' y",long:"d 'de' MMMM 'de' y",medium:"d MMM y",short:"dd/MM/yyyy"},Av={full:"HH:mm:ss zzzz",long:"HH:mm:ss z",medium:"HH:mm:ss",short:"HH:mm"},Rv={full:"{{date}} 'às' {{time}}",long:"{{date}} 'às' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},Fv={date:Va({formats:Tv,defaultWidth:"full"}),time:Va({formats:Av,defaultWidth:"full"}),dateTime:Va({formats:Rv,defaultWidth:"full"})},kv={lastWeek:e=>{const t=e.getDay();return"'"+(t===0||t===6?"último":"última")+"' eeee 'às' p"},yesterday:"'ontem às' p",today:"'hoje às' p",tomorrow:"'amanhã às' p",nextWeek:"eeee 'às' p",other:"P"},Dv=(e,t,r,s)=>{const n=kv[e];return typeof n=="function"?n(t):n},Pv={narrow:["AC","DC"],abbreviated:["AC","DC"],wide:["antes de cristo","depois de cristo"]},Iv={narrow:["1","2","3","4"],abbreviated:["T1","T2","T3","T4"],wide:["1º trimestre","2º trimestre","3º trimestre","4º trimestre"]},Ov={narrow:["j","f","m","a","m","j","j","a","s","o","n","d"],abbreviated:["jan","fev","mar","abr","mai","jun","jul","ago","set","out","nov","dez"],wide:["janeiro","fevereiro","março","abril","maio","junho","julho","agosto","setembro","outubro","novembro","dezembro"]},Mv={narrow:["D","S","T","Q","Q","S","S"],short:["dom","seg","ter","qua","qui","sex","sab"],abbreviated:["domingo","segunda","terça","quarta","quinta","sexta","sábado"],wide:["domingo","segunda-feira","terça-feira","quarta-feira","quinta-feira","sexta-feira","sábado"]},Lv={narrow:{am:"a",pm:"p",midnight:"mn",noon:"md",morning:"manhã",afternoon:"tarde",evening:"tarde",night:"noite"},abbreviated:{am:"AM",pm:"PM",midnight:"meia-noite",noon:"meio-dia",morning:"manhã",afternoon:"tarde",evening:"tarde",night:"noite"},wide:{am:"a.m.",pm:"p.m.",midnight:"meia-noite",noon:"meio-dia",morning:"manhã",afternoon:"tarde",evening:"tarde",night:"noite"}},Bv={narrow:{am:"a",pm:"p",midnight:"mn",noon:"md",morning:"da manhã",afternoon:"da tarde",evening:"da tarde",night:"da noite"},abbreviated:{am:"AM",pm:"PM",midnight:"meia-noite",noon:"meio-dia",morning:"da manhã",afternoon:"da tarde",evening:"da tarde",night:"da noite"},wide:{am:"a.m.",pm:"p.m.",midnight:"meia-noite",noon:"meio-dia",morning:"da manhã",afternoon:"da tarde",evening:"da tarde",night:"da noite"}},Uv=(e,t)=>{const r=Number(e);return(t==null?void 0:t.unit)==="week"?r+"ª":r+"º"},$v={ordinalNumber:Uv,era:Dr({values:Pv,defaultWidth:"wide"}),quarter:Dr({values:Iv,defaultWidth:"wide",argumentCallback:e=>e-1}),month:Dr({values:Ov,defaultWidth:"wide"}),day:Dr({values:Mv,defaultWidth:"wide"}),dayPeriod:Dr({values:Lv,defaultWidth:"wide",formattingValues:Bv,defaultFormattingWidth:"wide"})},zv=/^(\d+)[ºªo]?/i,Vv=/\d+/i,Hv={narrow:/^(ac|dc|a|d)/i,abbreviated:/^(a\.?\s?c\.?|d\.?\s?c\.?)/i,wide:/^(antes de cristo|depois de cristo)/i},Wv={any:[/^ac/i,/^dc/i],wide:[/^antes de cristo/i,/^depois de cristo/i]},qv={narrow:/^[1234]/i,abbreviated:/^T[1234]/i,wide:/^[1234](º)? trimestre/i},Gv={any:[/1/i,/2/i,/3/i,/4/i]},Xv={narrow:/^[jfmajsond]/i,abbreviated:/^(jan|fev|mar|abr|mai|jun|jul|ago|set|out|nov|dez)/i,wide:/^(janeiro|fevereiro|março|abril|maio|junho|julho|agosto|setembro|outubro|novembro|dezembro)/i},Kv={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^fev/i,/^mar/i,/^abr/i,/^mai/i,/^jun/i,/^jul/i,/^ago/i,/^set/i,/^out/i,/^nov/i,/^dez/i]},Yv={narrow:/^(dom|[23456]ª?|s[aá]b)/i,short:/^(dom|[23456]ª?|s[aá]b)/i,abbreviated:/^(dom|seg|ter|qua|qui|sex|s[aá]b)/i,wide:/^(domingo|(segunda|ter[cç]a|quarta|quinta|sexta)([- ]feira)?|s[aá]bado)/i},Jv={short:[/^d/i,/^2/i,/^3/i,/^4/i,/^5/i,/^6/i,/^s[aá]/i],narrow:[/^d/i,/^2/i,/^3/i,/^4/i,/^5/i,/^6/i,/^s[aá]/i],any:[/^d/i,/^seg/i,/^t/i,/^qua/i,/^qui/i,/^sex/i,/^s[aá]b/i]},Qv={narrow:/^(a|p|mn|md|(da) (manhã|tarde|noite))/i,any:/^([ap]\.?\s?m\.?|meia[-\s]noite|meio[-\s]dia|(da) (manhã|tarde|noite))/i},Zv={any:{am:/^a/i,pm:/^p/i,midnight:/^mn|^meia[-\s]noite/i,noon:/^md|^meio[-\s]dia/i,morning:/manhã/i,afternoon:/tarde/i,evening:/tarde/i,night:/noite/i}},e1={ordinalNumber:qu({matchPattern:zv,parsePattern:Vv,valueCallback:e=>parseInt(e,10)}),era:Pr({matchPatterns:Hv,defaultMatchWidth:"wide",parsePatterns:Wv,defaultParseWidth:"any"}),quarter:Pr({matchPatterns:qv,defaultMatchWidth:"wide",parsePatterns:Gv,defaultParseWidth:"any",valueCallback:e=>e+1}),month:Pr({matchPatterns:Xv,defaultMatchWidth:"wide",parsePatterns:Kv,defaultParseWidth:"any"}),day:Pr({matchPatterns:Yv,defaultMatchWidth:"wide",parsePatterns:Jv,defaultParseWidth:"any"}),dayPeriod:Pr({matchPatterns:Qv,defaultMatchWidth:"any",parsePatterns:Zv,defaultParseWidth:"any"})},t1={code:"pt-BR",formatDistance:Cv,formatLong:Fv,formatRelative:Dv,localize:$v,match:e1,options:{weekStartsOn:0,firstWeekContainsDate:1}};function r1({pendingReports:e,isLoading:t,onRefresh:r}){const[s,n]=p.useState(!1),i=nr(),o=u=>{try{return _v(new Date(u),{addSuffix:!0,locale:t1})}catch{return"Data inválida"}},l=u=>({site:"Site",categoria:"Categoria",cargo:"Cargo",cliente:"Cliente",titulo:"Título",descricao_vaga:"Descrição da vaga",responsabilidades_atribuicoes:"Responsabilidades e atribuições",requisitos_qualificacoes:"Requisitos e qualificações",salario:"Salário",horario_trabalho:"Horário de Trabalho",jornada_trabalho:"Jornada de Trabalho",beneficios:"Benefícios",local_trabalho:"Local de Trabalho",etapas_processo:"Etapas do processo"})[u]||u,d=()=>{n(!1),i("/dashboard/reports")},c=u=>{n(!1),i(`/dashboard/reports?report=${u}`)};return a.jsxs(At,{open:s,onOpenChange:n,children:[a.jsx(So,{asChild:!0,children:a.jsxs(Q,{variant:"ghost",size:"sm",className:"relative h-8 w-8 p-0 hover:bg-orange-100 hover:text-orange-600 transition-all duration-200",children:[a.jsx($a,{className:"h-4 w-4"}),e.length>0&&a.jsx(Ve,{variant:"destructive",className:"absolute -top-1 -right-1 h-5 w-5 rounded-full p-0 flex items-center justify-center text-xs font-bold",children:e.length>99?"99+":e.length})]})}),a.jsxs(gt,{className:"w-[90vw] max-w-4xl h-[85vh] max-h-[600px] flex flex-col",children:[a.jsx(pt,{className:"flex-shrink-0",children:a.jsxs(vt,{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx($a,{className:"h-5 w-5 text-orange-500"}),"Notificações de Reports",e.length>0&&a.jsxs(Ve,{variant:"secondary",className:"ml-2",children:[e.length," pendente",e.length>1?"s":""]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs(Q,{variant:"outline",size:"sm",onClick:r,disabled:t,className:"flex items-center gap-2",children:[t?a.jsx("div",{className:"h-4 w-4 border-2 border-gray-400 border-t-transparent rounded-full animate-spin"}):a.jsx(Pt,{className:"h-4 w-4"}),"Atualizar"]}),a.jsxs(Q,{variant:"default",size:"sm",onClick:d,className:"flex items-center gap-2 bg-blue-600 hover:bg-blue-700",children:[a.jsx(Ii,{className:"h-4 w-4"}),"Ver Todos"]})]})]})}),a.jsx("div",{className:"flex-1 flex flex-col min-h-0",children:a.jsx(zu,{className:"flex-1",children:t?a.jsx("div",{className:"flex items-center justify-center py-12",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"h-8 w-8 border-4 border-orange-500 border-t-transparent rounded-full animate-spin mx-auto mb-2"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"Carregando reports..."})]})}):e.length===0?a.jsxs("div",{className:"text-center py-12",children:[a.jsx($a,{className:"h-16 w-16 text-muted-foreground mx-auto mb-4"}),a.jsx("p",{className:"text-lg font-medium text-muted-foreground mb-2",children:"Nenhum report pendente"}),a.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Você será notificado quando houver novos reports"}),a.jsxs(Q,{variant:"outline",onClick:d,className:"flex items-center gap-2",children:[a.jsx(Ii,{className:"h-4 w-4"}),"Ir para Reports"]})]}):a.jsx("div",{className:"space-y-3 pr-2",children:e.map((u,h)=>{var f,m,v,g,x;return a.jsxs("div",{children:[a.jsx("div",{className:"p-4 border rounded-lg hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors cursor-pointer group",onClick:()=>c(u.id),children:a.jsx("div",{className:"flex items-start justify-between",children:a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[a.jsx(Wc,{className:"h-4 w-4 text-blue-500"}),a.jsx("span",{className:"font-medium text-sm",children:l(u.field_name)}),a.jsx(Ve,{variant:"outline",className:"text-xs",children:u.status}),a.jsx(qf,{className:"h-3 w-3 text-muted-foreground opacity-0 group-hover:opacity-100 transition-opacity"})]}),a.jsxs("div",{className:"mb-3",children:[a.jsx("p",{className:"font-semibold text-sm mb-1 line-clamp-1",children:((f=u.vaga)==null?void 0:f.titulo)||((m=u.vaga)==null?void 0:m.cargo)||"Vaga sem título"}),a.jsxs("p",{className:"text-xs text-muted-foreground",children:[(v=u.vaga)==null?void 0:v.cliente," • ",(g=u.vaga)==null?void 0:g.site]})]}),a.jsx("div",{className:"mb-3",children:a.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300 line-clamp-3",children:u.suggested_changes})}),a.jsxs("div",{className:"flex items-center justify-between text-xs text-muted-foreground",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(Es,{className:"h-3 w-3"}),a.jsx("span",{children:(x=u.reporter)==null?void 0:x.name})]}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(ya,{className:"h-3 w-3"}),a.jsx("span",{children:o(u.created_at)})]})]}),a.jsx("span",{className:"text-xs text-blue-600 group-hover:text-blue-700",children:"Clique para ver detalhes"})]})]})})}),h<e.length-1&&a.jsx(Fo,{className:"my-2"})]},u.id)})})})})]})]})}async function a1(e){try{console.log("📝 Criando report:",{reportData:e});const{data:{user:t},error:r}=await Ce.auth.getUser();if(r||!t)throw console.error("❌ Usuário não autenticado:",r),new Error("Usuário não autenticado");const{data:s,error:n}=await ct.from("users").select("id, email, role").eq("email",t.email).single();if(n||!s)throw console.error("❌ Usuário não encontrado na tabela users:",n),new Error("Usuário não encontrado na tabela users");console.log("👤 Usuário encontrado na tabela users:",s);const i=s.id,{data:o,error:l}=await ct.from("vagas").select("*").eq("id",e.vaga_id).single();if(l)throw console.error("❌ Erro ao buscar vaga:",l),new Error(`Erro ao buscar vaga: ${l.message}`);const d=o[e.field_name]||"Não informado";console.log("📋 Valor atual:",d);const{data:c,error:u}=await ct.from("reports").insert({vaga_id:e.vaga_id,reported_by:i,assigned_to:e.assigned_to,field_name:e.field_name,current_value:d,suggested_changes:e.suggested_changes,status:"pending"}).select("*").single();if(u)throw console.error("❌ Erro ao criar report:",u),u;console.log("✅ Report criado com sucesso:",c);const{data:h,error:f}=await ct.from("reports").select("*").eq("id",c.id).single();return f?console.error("⚠️ Erro ao verificar report criado:",f):console.log("✅ Report verificado no banco:",h),c}catch(t){throw console.error("❌ Erro ao criar report:",t),t}}async function s1(e){try{const{data:t,error:r}=await ct.from("reports").select(`
        *,
        vaga:vagas(*),
        reporter:users!reports_reported_by_fkey(*),
        assignee:users!reports_assigned_to_fkey(*)
      `).eq("id",e).single();if(r){if(r.code==="PGRST116")return null;throw new Error(`Erro ao buscar report: ${r.message}`)}return t}catch(t){throw console.error("❌ Erro ao buscar report por ID:",t),t}}async function n1(e,t){try{console.log("🔍 [getReportsByUser] Buscando reports para:",{userId:e,userRole:t});const{data:r,error:s}=await ct.from("reports").select("*").order("created_at",{ascending:!1}).limit(10);console.log("🔍 [getReportsByUser] Total de reports na tabela:",(r==null?void 0:r.length)||0),r&&r.length>0&&console.log("📋 [getReportsByUser] Últimos reports na tabela:",r.map(l=>({id:l.id,reported_by:l.reported_by,status:l.status,created_at:l.created_at})));let n=ct.from("reports").select(`
      *,
      vaga:vagas(*),
      reporter:users!reports_reported_by_fkey(*),
      assignee:users!reports_assigned_to_fkey(*)
    `);if(t==="RH"){n=n.eq("reported_by",e),console.log("🔍 [getReportsByUser] Aplicando filtro RH para reported_by:",e);const{data:l,error:d}=await ct.from("reports").select("*").eq("reported_by",e).order("created_at",{ascending:!1});console.log("🔍 [getReportsByUser] Reports diretos para usuário:",(l==null?void 0:l.length)||0),l&&l.length>0&&console.log("📋 [getReportsByUser] Reports do usuário:",l.map(c=>({id:c.id,status:c.status,created_at:c.created_at,field_name:c.field_name})))}const{data:i,error:o}=await n.order("created_at",{ascending:!1});if(o)throw console.error("❌ [getReportsByUser] Erro ao buscar reports:",o),console.error("❌ [getReportsByUser] Detalhes do erro:",o.code,o.message,o.details),o;return console.log("✅ [getReportsByUser] Reports encontrados:",(i==null?void 0:i.length)||0),console.log("📊 [getReportsByUser] Dados dos reports:",i),i||[]}catch(r){throw console.error("❌ [getReportsByUser] Erro detalhado ao buscar reports:",r),r}}async function i1(e){try{const{data:t,error:r}=await ct.from("reports").select(`
        *,
        vaga:vagas(*),
        reporter:users!reports_reported_by_fkey(*),
        assignee:users!reports_assigned_to_fkey(*)
      `).eq("assigned_to",e).eq("status","pending").order("created_at",{ascending:!1});if(r)throw console.error("Erro ao buscar reports pendentes:",r),r;return t||[]}catch(t){throw console.error("Erro detalhado ao buscar reports pendentes:",t),t}}async function ms(e,t,r){try{const s={status:t,updated_at:new Date().toISOString()};r&&(s.admin_notes=r),(t==="completed"||t==="rejected")&&(s.completed_at=new Date().toISOString());const{data:n,error:i}=await ct.from("reports").update(s).eq("id",e).select().single();if(i)throw console.error("Erro ao atualizar status do report:",i),i;return n}catch(s){throw console.error("Erro detalhado ao atualizar status do report:",s),s}}async function o1(e){try{console.log("🗑️ [deleteReport] Deletando report:",e);const{error:t}=await ct.from("reports").delete().eq("id",e);if(t)throw console.error("❌ [deleteReport] Erro ao deletar report:",t),t;return console.log("✅ [deleteReport] Report deletado com sucesso"),!0}catch(t){throw console.error("❌ [deleteReport] Erro detalhado ao deletar report:",t),t}}async function l1(){try{const{data:e,error:t}=await ct.from("users").select("id, name, email").eq("role","ADMIN");if(t)throw console.error("Erro ao buscar administradores:",t),t;return e||[]}catch(e){throw console.error("Erro detalhado ao buscar administradores:",e),e}}function c1({onNewReport:e,onReportUpdate:t}){const{user:r}=tt(),[s,n]=p.useState(!1);return p.useEffect(()=>{if(!r||r.role!=="ADMIN")return;console.log("🔔 Iniciando notificações em tempo real para admin:",r.email);const i=Ce.channel("reports_changes").on("postgres_changes",{event:"*",schema:"public",table:"reports"},async o=>{var l,d,c,u;console.log("🔔 Mudança detectada em reports:",o);try{const{data:h,error:f}=await Ce.from("reports").select(`
                *,
                vaga:vagas(*),
                reporter:users!reports_reported_by_fkey(*),
                assignee:users!reports_assigned_to_fkey(*)
              `).eq("id",((l=o.new)==null?void 0:l.id)||((d=o.old)==null?void 0:d.id)).single();if(f){console.error("Erro ao buscar report:",f);return}if(h&&h.assigned_to===r.id)switch(o.eventType){case"INSERT":console.log("🔔 Novo report recebido:",h),e==null||e(h),"Notification"in window&&Notification.permission==="granted"&&new Notification("Novo Report Recebido",{body:`Report de ${(c=h.reporter)==null?void 0:c.name} sobre ${(u=h.vaga)==null?void 0:u.titulo}`,icon:"/favicon.ico",tag:`report-${h.id}`});break;case"UPDATE":console.log("🔔 Report atualizado:",h),t==null||t(h);break;case"DELETE":console.log("🔔 Report deletado:",o.old);break}}catch(h){console.error("Erro ao processar mudança em tempo real:",h)}}).subscribe(o=>{console.log("🔔 Status da subscription:",o),n(o==="SUBSCRIBED")});return"Notification"in window&&Notification.permission==="default"&&Notification.requestPermission().then(o=>{console.log("🔔 Permissão de notificação:",o)}),()=>{console.log("🔔 Desconectando notificações em tempo real"),i.unsubscribe()}},[r,e,t]),null}function d1(){const[e,t]=p.useState([]),[r,s]=p.useState(!1),{user:n}=tt(),i=async()=>{if(!(!n||n.role!=="ADMIN"))try{s(!0);const d=await i1(n.id);t(d)}catch(d){console.error("Erro ao carregar reports pendentes:",d)}finally{s(!1)}},o=d=>{t(c=>[d,...c])},l=d=>{t(c=>c.map(u=>u.id===d.id?d:u))};return p.useEffect(()=>{i()},[n==null?void 0:n.id]),{pendingReports:e,isLoading:r,loadPendingReports:i,handleNewReport:o,handleReportUpdate:l}}function Ar({children:e}){var we,be;const[t,r]=p.useState(!1),[s,n]=p.useState(!1),[i,o]=p.useState(!1),[l,d]=p.useState(!1),{user:c,logout:u}=tt(),{config:h}=hr(),{isTablet:f,isMobile:m}=Hg(),{isEnabled:v}=vu(),g=nr(),x=Of(),{pendingReports:b,isLoading:N,loadPendingReports:y,handleNewReport:A,handleReportUpdate:B}=d1(),{hasUpdate:W,isChecking:C,showModal:L,handleUpdate:T,handleCloseModal:P,checkForUpdates:I}=Vg({checkOnMount:!0,checkInterval:30*60*1e3,showModalDelay:2e3,autoCheckOnFocus:!1});p.useEffect(()=>{f&&n(!1)},[f]);const V=()=>{g("/login"),setTimeout(()=>{u().catch(J=>{console.warn("Erro durante logout em segundo plano:",J)})},100)},ae=()=>{confirm("⚠️ ATENÇÃO: Isso irá limpar todos os caches e recarregar a página. Continuar?")&&(localStorage.clear(),sessionStorage.clear(),"caches"in window&&caches.keys().then(J=>{J.forEach(Z=>{(Z.includes("supabase")||Z.includes("auth"))&&caches.delete(Z)})}).catch(()=>{}),window.location.reload())},_e=[{icon:Bc,label:"Repo Comunica",href:"/dashboard",show:!0},{icon:io,label:"Oportunidades",href:"/dashboard/clientes",show:!0},{icon:qc,label:"Comparativo",href:"/dashboard/comparativo",show:!0},{icon:oo,label:"Nova Oportunidade",href:"/dashboard/nova-vaga",show:(c==null?void 0:c.role)==="ADMIN"||(c==null?void 0:c.role)==="RH"&&v},{icon:Xr,label:"Contato",href:"/dashboard/contato",show:!0},{icon:lo,label:"Tira Dúvidas",href:"/dashboard/tira-duvidas",show:(c==null?void 0:c.role)==="RH"},{icon:oa,label:"Reports",href:"/dashboard/reports",show:(c==null?void 0:c.role)==="ADMIN"},{icon:Gf,label:"Configurações",href:"/dashboard/configuracoes",show:(c==null?void 0:c.role)==="ADMIN"}],ve=J=>x.pathname===J;return a.jsxs(hp,{children:[a.jsxs("div",{className:"flex h-screen bg-background",children:[f&&a.jsx("div",{className:`flex transition-all duration-300 ${t?"w-16":"w-64"}`,style:{minWidth:t?"64px":"256px",maxWidth:t?"64px":"256px"},children:a.jsx(Ki,{isCollapsed:t,onToggle:()=>r(!t),children:a.jsxs("div",{className:"flex flex-col h-full",children:[a.jsxs("div",{className:`flex items-center justify-between py-4 border-b border-border/50 ${t?"px-2":"px-4"}`,children:[t?a.jsx("div",{className:"flex items-center justify-center w-full",children:a.jsx(fs,{variant:"icon",width:48,height:48})}):a.jsx("div",{className:"flex items-center w-full",children:a.jsx(fs,{variant:"principal",width:250,height:90})}),a.jsx(Q,{variant:"ghost",size:"icon",onClick:()=>r(!t),className:"h-8 w-8 hover:bg-primary/10 transition-colors flex-shrink-0 ml-auto",children:t?a.jsx(ys,{className:"h-4 w-4"}):a.jsx(Oi,{className:"h-4 w-4"})})]}),a.jsx("div",{className:`flex-1 space-y-1 ${t?"p-2 flex flex-col items-center":"p-4"}`,children:_e.map((J,Z)=>{if(!J.show)return null;const ue=J.icon,me=ve(J.href);return a.jsxs(bi,{children:[a.jsx(yi,{asChild:!0,children:a.jsxs(Q,{variant:"ghost",className:`transition-all duration-200 rounded-lg hover-modern ${t?"justify-center p-3 h-11 w-11":"justify-start px-3 py-2.5 w-full h-11"} ${me?"bg-primary text-primary-foreground shadow-sm hover:bg-primary/90":"hover:bg-primary/10 dark:hover:bg-primary/20 hover:text-primary"}`,onClick:()=>g(J.href),children:[a.jsx(ue,{className:`${t?"h-5 w-5":"h-4 w-4"} ${me?"text-primary-foreground":""}`}),!t&&a.jsx("span",{className:`ml-3 text-sm font-medium ${me?"text-primary-foreground":""}`,children:J.label})]})}),t&&a.jsx(cn,{side:"right",className:"ml-2",children:a.jsx("p",{children:J.label})})]},Z)})}),a.jsxs("div",{className:`border-t border-border/50 mt-auto ${t?"p-2 space-y-2 flex flex-col items-center":"p-4 space-y-3"}`,children:[a.jsxs("div",{className:`w-full flex items-center space-x-3 rounded-lg p-3 hover:bg-accent/50 transition-all duration-200 cursor-pointer ${t?"justify-center":"justify-start"}`,onClick:()=>o(!0),title:t?`${(c==null?void 0:c.name)||"Usuário"} - ${c==null?void 0:c.role}`:void 0,children:[a.jsx("div",{className:`${t?"w-10 h-10":"w-8 h-8"} bg-primary rounded-full flex items-center justify-center flex-shrink-0 shadow-sm`,children:a.jsx("span",{className:"text-primary-foreground font-bold text-sm",children:((we=c==null?void 0:c.name)==null?void 0:we.charAt(0).toUpperCase())||"U"})}),!t&&a.jsxs("div",{className:"flex flex-col min-w-0",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("p",{className:"text-sm font-medium text-foreground truncate",children:(c==null?void 0:c.name)||"Usuário"}),W&&a.jsx(Ve,{variant:"default",className:"bg-blue-500 text-white text-xs animate-pulse",children:"Atualização"})]}),a.jsx(Ve,{variant:"outline",className:"text-xs w-fit bg-primary/10 dark:bg-primary/20 text-primary border-primary/20",children:c==null?void 0:c.role})]})]}),a.jsxs(bi,{children:[a.jsx(yi,{asChild:!0,children:a.jsxs(Q,{variant:"ghost",className:`w-full text-orange-600 hover:text-orange-700 hover:bg-orange-50 dark:hover:bg-orange-900/20 transition-all duration-200 rounded-lg hover-button ${t?"justify-center p-3 h-11 w-11":"justify-start px-3 py-2.5 h-11"}`,onClick:ae,children:[a.jsx(oa,{className:`${t?"h-5 w-5":"h-4 w-4"}`}),!t&&a.jsx("span",{className:"ml-3 text-sm font-medium",children:"Recarregar"})]})}),t&&a.jsx(cn,{side:"right",className:"ml-2",children:a.jsx("p",{children:"Recarregar Aplicação"})})]}),a.jsxs(bi,{children:[a.jsx(yi,{asChild:!0,children:a.jsxs(Q,{variant:"ghost",className:`w-full text-destructive hover:text-destructive hover:bg-destructive/10 transition-all duration-200 rounded-lg hover-button ${t?"justify-center p-3 h-11 w-11":"justify-start px-3 py-2.5 h-11"}`,onClick:V,children:[a.jsx(il,{className:`${t?"h-5 w-5":"h-4 w-4"}`}),!t&&a.jsx("span",{className:"ml-3 text-sm font-medium",children:"Sair"})]})}),t&&a.jsx(cn,{side:"right",className:"ml-2",children:a.jsx("p",{children:"Sair"})})]})]})]})})}),s&&m&&a.jsx("div",{className:"fixed inset-0 z-50 bg-black/50",onClick:()=>n(!1),children:a.jsx("div",{className:"fixed left-0 top-0 h-full w-64 bg-card shadow-2xl",onClick:J=>J.stopPropagation(),children:a.jsxs(Ki,{isCollapsed:!1,onToggle:()=>{},children:[a.jsxs("div",{className:"flex items-center justify-between py-4 px-4 border-b border-border/50",children:[a.jsx("div",{className:"flex items-center space-x-3",children:a.jsx(fs,{variant:"principal",width:250,height:90})}),a.jsx(Q,{variant:"ghost",size:"icon",onClick:()=>n(!1),className:"h-8 w-8 hover:bg-primary/10 transition-colors",children:a.jsx(Oi,{className:"h-4 w-4"})})]}),a.jsx("div",{className:"flex-1 p-4 space-y-1",children:_e.map((J,Z)=>{if(!J.show)return null;const ue=J.icon,me=ve(J.href);return a.jsxs(Q,{variant:"ghost",className:`w-full justify-start px-3 py-2.5 h-11 transition-all duration-200 rounded-lg hover-modern ${me?"bg-primary text-primary-foreground shadow-sm hover:bg-primary/90":"hover:bg-primary/10 dark:hover:bg-primary/20 hover:text-primary"}`,onClick:()=>{g(J.href),n(!1)},children:[a.jsx(ue,{className:"h-4 w-4"}),a.jsx("span",{className:"ml-3 text-sm font-medium",children:J.label})]},Z)})}),a.jsxs("div",{className:"p-4 border-t border-border/50 space-y-3",children:[a.jsxs("div",{className:"flex items-center space-x-3 p-3 rounded-lg hover:bg-accent/50 transition-all duration-200 cursor-pointer",onClick:()=>o(!0),children:[a.jsx("div",{className:"w-8 h-8 bg-primary rounded-full flex items-center justify-center shadow-sm",children:a.jsx("span",{className:"text-primary-foreground font-bold text-sm",children:((be=c==null?void 0:c.name)==null?void 0:be.charAt(0).toUpperCase())||"U"})}),a.jsxs("div",{className:"flex flex-col min-w-0",children:[a.jsxs("p",{className:"text-sm font-medium text-foreground truncate",children:["Olá, ",c==null?void 0:c.name]}),a.jsx(Ve,{variant:"outline",className:"text-xs w-fit bg-primary/10 dark:bg-primary/20 text-primary border-primary/20",children:c==null?void 0:c.role})]})]}),a.jsxs(Q,{variant:"ghost",className:"w-full justify-start px-3 py-2.5 h-11 text-foreground hover:text-primary hover:bg-primary/10 dark:hover:bg-primary/20 transition-all duration-200 rounded-lg mb-2",onClick:()=>d(!0),children:[a.jsx(Gc,{className:"h-4 w-4"}),a.jsx("span",{className:"ml-3 text-sm font-medium",children:"Alterar Senha"})]}),a.jsxs(Q,{variant:"ghost",className:"w-full justify-start px-3 py-2.5 h-11 text-orange-600 hover:text-orange-700 hover:bg-orange-50 dark:hover:bg-orange-900/20 transition-all duration-200 rounded-lg mb-2",onClick:ae,children:[a.jsx(oa,{className:"h-4 w-4"}),a.jsx("span",{className:"ml-3 text-sm font-medium",children:"Recarregar Aplicação"})]}),a.jsxs(Q,{variant:"ghost",className:"w-full justify-start px-3 py-2.5 h-11 text-destructive hover:text-destructive hover:bg-destructive/10 transition-all duration-200 rounded-lg",onClick:V,children:[a.jsx(il,{className:"h-4 w-4"}),a.jsx("span",{className:"ml-3 text-sm font-medium",children:"Sair"})]})]})]})})}),a.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[m&&a.jsx("div",{className:"fixed top-4 left-4 z-50",children:a.jsx(Q,{variant:"ghost",size:"icon",className:"hover-scale bg-card/80 shadow-lg",onClick:()=>n(!0),children:a.jsx(ys,{className:"h-5 w-5"})})}),a.jsxs("div",{className:"fixed top-4 right-4 z-50 flex items-center gap-2",children:[a.jsx(c1,{onNewReport:A,onReportUpdate:B}),a.jsx(r1,{pendingReports:b,isLoading:N,onRefresh:y}),a.jsx(As,{})]}),a.jsx("main",{className:"flex-1 overflow-auto bg-background",children:a.jsx("div",{className:"max-w-7xl mx-auto p-3 tablet:p-4 laptop:p-6",children:a.jsx("div",{className:"animate-fade-in",children:e})})})]})]}),a.jsx(xp,{isOpen:i,onClose:()=>o(!1),user:c}),a.jsx(gp,{isOpen:L,onClose:P,onUpdate:T}),a.jsx(pp,{hasUpdate:W,isChecking:C,onUpdate:T,onCheckUpdate:I}),a.jsx(vp,{isOpen:l,onClose:()=>d(!1),onSuccess:()=>{console.log("Senha alterada com sucesso!")}})]})}function cs({className:e,...t}){return a.jsx("div",{className:De("animate-pulse rounded-md bg-primary/10",e),...t})}function u1({showIcon:e=!0,showMetrics:t=!0,className:r=""}){return a.jsxs(Ee,{className:`animate-pulse ${r}`,children:[a.jsxs(Ae,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[a.jsx(cs,{className:"h-4 w-24"}),e&&a.jsx(cs,{className:"h-8 w-8 rounded-lg"})]}),a.jsx(Se,{children:t&&a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx(cs,{className:"h-8 w-16"}),a.jsx(cs,{className:"h-4 w-12"})]}),a.jsx(cs,{className:"h-3 w-32"})]})})]})}function h1({count:e=4,className:t=""}){return a.jsx("div",{className:`grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 ${t}`,children:Array.from({length:e}).map((r,s)=>a.jsx(u1,{},s))})}function f1({icon:e,title:t,description:r,action:s,className:n=""}){return a.jsx(Ee,{className:`text-center py-12 ${n}`,children:a.jsxs(Se,{className:"flex flex-col items-center space-y-4",children:[a.jsx("div",{className:"w-16 h-16 rounded-full bg-muted/50 flex items-center justify-center",children:a.jsx(e,{className:"h-8 w-8 text-muted-foreground"})}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("h3",{className:"text-lg font-semibold text-foreground",children:t}),a.jsx("p",{className:"text-sm text-muted-foreground max-w-sm",children:r})]}),s&&a.jsx(Q,{onClick:s.onClick,className:"mt-4",children:s.label})]})})}function Gu(e){const{cache:t,refreshVagas:r,cacheStatus:s,loading:n}=Br();return{vagas:p.useMemo(()=>t.vagas.length?t.vagas:[],[t.vagas,e]),loading:n||!s.vagas&&t.vagas.length===0,refresh:r,hasData:s.vagas,lastUpdated:t.lastUpdated}}function m1(){const{cache:e,refreshClientes:t,cacheStatus:r}=Br();return{clientes:e.clientes,loading:!r.clientes&&e.clientes.length===0,refresh:t,hasData:r.clientes}}function x1(){const{cache:e,refreshSites:t,cacheStatus:r}=Br();return{sites:e.sites,loading:!r.sites&&e.sites.length===0,refresh:t,hasData:r.sites}}function g1(){const{cache:e,refreshUsuarios:t,cacheStatus:r}=Br();return{usuarios:e.usuarios,loading:!r.usuarios&&e.usuarios.length===0,refresh:t,hasData:r.usuarios}}function Xu(){const{cache:e,refreshNoticias:t,cacheStatus:r}=Br();return{noticias:p.useMemo(()=>e.noticias.filter(n=>n.ativa).sort((n,i)=>{const o={alta:3,media:2,baixa:1},l=o[n.prioridade]||1,d=o[i.prioridade]||1;return l!==d?d-l:new Date(i.created_at).getTime()-new Date(n.created_at).getTime()}),[e.noticias]),loading:!r.noticias&&e.noticias.length===0,refresh:t,hasData:r.noticias}}function p1(){const e=Gu(),t=m1(),r=x1(),s=g1(),n=Xu(),i=p.useMemo(()=>{const l=new Date,d=new Date(l.getTime()-7*24*60*60*1e3),c=e.vagas.filter(h=>new Date(h.created_at)>d).length,u=n.noticias.length;return{totalVagas:e.vagas.length,totalClientes:t.clientes.length,totalSites:r.sites.length,totalUsuarios:s.usuarios.length,vagasAtivas:e.vagas.length,vagasRecentes:c,noticiasAtivas:u}},[e.vagas,t.clientes,r.sites,s.usuarios,n.noticias]),o=p.useMemo(()=>e.loading||t.loading||r.loading||s.loading||n.loading,[e.loading,t.loading,r.loading,s.loading,n.loading]);return{stats:i,loading:o}}function v1(){const{user:e}=tt(),{config:t}=hr(),{stats:r,loading:s}=p1(),{noticias:n}=Xu(),{refreshAll:i}=Br(),[o,l]=p.useState(new Set),[d,c]=p.useState(!1),u=n.slice(0,9),h=b=>{const N=new Set(o);N.has(b)?N.delete(b):N.add(b),l(N)},f=async()=>{"vibrate"in navigator&&navigator.vibrate([50,30,50]),c(!0);try{const b=i(),N=new Promise((y,A)=>{setTimeout(()=>A(new Error("Refresh timeout")),1e4)});await Promise.race([b,N]),"vibrate"in navigator&&navigator.vibrate([100])}catch(b){console.error("Erro ao atualizar:",b),"vibrate"in navigator&&navigator.vibrate([200,100,200])}finally{setTimeout(()=>{c(!1)},1e3)}},m=b=>{switch(b){case"alerta":return a.jsx(at,{className:"h-4 w-4"});case"anuncio":return a.jsx(fn,{className:"h-4 w-4"});default:return a.jsx(js,{className:"h-4 w-4"})}},v=b=>{switch(b){case"alerta":return"bg-red-500/10 text-red-600 dark:text-red-400 border-red-200 dark:border-red-800";case"anuncio":return"bg-blue-500/10 text-blue-600 dark:text-blue-400 border-blue-200 dark:border-blue-800";default:return"bg-green-500/10 text-green-600 dark:text-green-400 border-green-200 dark:border-green-800"}},g=b=>{switch(b){case"alta":return"bg-red-500";case"media":return"bg-yellow-500";default:return"bg-green-500"}},x=b=>new Date(b).toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric"});return s?a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx("div",{className:"h-8 w-48 bg-muted rounded animate-pulse"}),a.jsx("div",{className:"h-4 w-64 bg-muted rounded animate-pulse"})]}),a.jsxs("div",{className:"flex space-x-2",children:[a.jsx("div",{className:"h-9 w-24 bg-muted rounded animate-pulse"}),a.jsx("div",{className:"h-9 w-32 bg-muted rounded animate-pulse"}),a.jsx("div",{className:"h-9 w-28 bg-muted rounded animate-pulse"})]})]}),a.jsx(h1,{count:4}),a.jsxs(Ee,{children:[a.jsxs(Ae,{children:[a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("div",{className:"h-8 w-8 bg-muted rounded animate-pulse"}),a.jsx("div",{className:"h-6 w-48 bg-muted rounded animate-pulse"})]}),a.jsx("div",{className:"h-4 w-96 bg-muted rounded animate-pulse"})]}),a.jsx(Se,{children:a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:Array.from({length:6}).map((b,N)=>a.jsxs(Ee,{className:"animate-pulse",children:[a.jsxs(Ae,{className:"pb-3",children:[a.jsxs("div",{className:"flex items-start justify-between mb-3",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("div",{className:"h-6 w-6 bg-muted rounded"}),a.jsx("div",{className:"h-5 w-16 bg-muted rounded"})]}),a.jsx("div",{className:"h-3 w-12 bg-muted rounded"})]}),a.jsx("div",{className:"h-5 w-full bg-muted rounded"})]}),a.jsxs(Se,{className:"pt-0",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx("div",{className:"h-3 w-full bg-muted rounded"}),a.jsx("div",{className:"h-3 w-3/4 bg-muted rounded"}),a.jsx("div",{className:"h-3 w-1/2 bg-muted rounded"})]}),a.jsxs("div",{className:"flex items-center justify-between mt-4 pt-3 border-t",children:[a.jsx("div",{className:"h-3 w-20 bg-muted rounded"}),a.jsx("div",{className:"h-3 w-16 bg-muted rounded"})]})]})]},N))})})]})]}):a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex flex-col tablet:flex-row tablet:items-center justify-between gap-3 tablet:gap-4",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl tablet:text-3xl laptop:text-4xl font-bold bg-gradient-to-r from-primary to-primary/70 bg-clip-text text-transparent page-title",children:"Repo Comunica"}),a.jsx("p",{className:"page-subtitle text-sm tablet:text-base laptop:text-lg",children:"Visão geral do sistema e notícias importantes"})]}),a.jsx("div",{className:"flex flex-col tablet:flex-row gap-2",children:a.jsxs(Q,{onClick:f,variant:"outline",size:"sm",disabled:d,className:"transition-all duration-200 hover:scale-105 active:scale-95 hover:shadow-md",children:[a.jsx(ot,{className:`h-4 w-4 mr-2 transition-transform duration-500 ${d?"animate-spin":"hover:rotate-180"}`}),d?"Atualizando...":"Atualizar"]})})]}),a.jsxs("div",{className:"grid grid-cols-1 tablet:grid-cols-2 laptop:grid-cols-4 gap-4 tablet:gap-6",children:[a.jsxs(Ee,{className:`card-3d hover-lift-3d transition-all duration-300 ${t.effects.glassmorphism?"bg-white/10 backdrop-blur-xl border-white/20":""}`,children:[a.jsxs(Ae,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[a.jsx(Fe,{className:"text-sm font-medium text-foreground",children:"Total de Oportunidades"}),a.jsx("div",{className:`p-2 rounded-lg ${t.effects.gradients?"bg-gradient-to-br from-blue-500 to-blue-600":"bg-blue-500"} shadow-lg`,children:a.jsx(io,{className:"h-4 w-4 text-white"})})]}),a.jsxs(Se,{children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("div",{className:"text-3xl font-bold text-foreground",children:r.totalVagas}),a.jsxs("div",{className:"flex items-center text-green-600 dark:text-green-400 text-sm",children:[a.jsx(Xf,{className:"h-4 w-4 mr-1"}),a.jsxs("span",{className:"font-medium",children:["+",r.vagasRecentes]})]})]}),a.jsxs("p",{className:"text-xs text-muted-foreground mt-2",children:[r.vagasRecentes," novas esta semana"]})]})]}),a.jsxs(Ee,{className:`card-3d hover-lift-3d transition-all duration-300 ${t.effects.glassmorphism?"bg-white/10 backdrop-blur-xl border-white/20":""}`,children:[a.jsxs(Ae,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[a.jsx(Fe,{className:"text-sm font-medium text-foreground",children:"Clientes Únicos"}),a.jsx("div",{className:`p-2 rounded-lg ${t.effects.gradients?"bg-gradient-to-br from-green-500 to-green-600":"bg-green-500"} shadow-lg`,children:a.jsx(Xa,{className:"h-4 w-4 text-white"})})]}),a.jsxs(Se,{children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("div",{className:"text-3xl font-bold text-foreground",children:r.totalClientes}),a.jsxs("div",{className:"flex items-center text-blue-600 dark:text-blue-400 text-sm",children:[a.jsx(Kf,{className:"h-4 w-4 mr-1"}),a.jsx("span",{className:"font-medium",children:"Ativo"})]})]}),a.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:"Empresas parceiras"})]})]}),a.jsxs(Ee,{className:`card-3d hover-lift-3d transition-all duration-300 ${t.effects.glassmorphism?"bg-white/10 backdrop-blur-xl border-white/20":""}`,children:[a.jsxs(Ae,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[a.jsx(Fe,{className:"text-sm font-medium text-foreground",children:"Sites Ativos"}),a.jsx("div",{className:`p-2 rounded-lg ${t.effects.gradients?"bg-gradient-to-br from-purple-500 to-purple-600":"bg-purple-500"} shadow-lg`,children:a.jsx(Hc,{className:"h-4 w-4 text-white"})})]}),a.jsxs(Se,{children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("div",{className:"text-3xl font-bold text-foreground",children:r.totalSites}),a.jsxs("div",{className:"flex items-center text-purple-600 text-sm",children:[a.jsx(Yf,{className:"h-4 w-4 mr-1"}),a.jsx("span",{className:"font-medium",children:"Online"})]})]}),a.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:"Locais de trabalho"})]})]}),a.jsxs(Ee,{className:`card-3d hover-lift-3d transition-all duration-300 ${t.effects.glassmorphism?"bg-white/10 backdrop-blur-xl border-white/20":""}`,children:[a.jsxs(Ae,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[a.jsx(Fe,{className:"text-sm font-medium text-foreground",children:"Usuários Ativos"}),a.jsx("div",{className:`p-2 rounded-lg ${t.effects.gradients?"bg-gradient-to-br from-orange-500 to-orange-600":"bg-orange-500"} shadow-lg`,children:a.jsx(Xa,{className:"h-4 w-4 text-white"})})]}),a.jsxs(Se,{children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("div",{className:"text-3xl font-bold text-foreground",children:r.totalUsuarios}),a.jsxs("div",{className:"flex items-center text-orange-600 text-sm",children:[a.jsx(Jf,{className:"h-4 w-4 mr-1"}),a.jsx("span",{className:"font-medium",children:"Logado"})]})]}),a.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:(e==null?void 0:e.role)==="ADMIN"?"Admins + RH":"Usuários do sistema"})]})]})]}),a.jsxs(Ee,{className:`transition-all duration-300 ${t.effects.glassmorphism?"bg-white/10 backdrop-blur-xl border-white/20":""}`,children:[a.jsxs(Ae,{children:[a.jsxs(Fe,{className:"flex items-center",children:[a.jsx("div",{className:`p-2 rounded-lg mr-3 ${t.effects.gradients?"bg-gradient-to-br from-purple-500 to-purple-600":"bg-purple-500"} shadow-lg`,children:a.jsx(Pt,{className:"h-5 w-5 text-white"})}),a.jsx("span",{className:"text-xl font-bold",children:"Mural de Notícias"})]}),a.jsxs(Ge,{className:"text-base",children:["Avisos, anúncios e informações importantes do sistema",u.length>=9&&a.jsx("span",{className:"block mt-2 text-amber-600 text-sm font-medium animate-pulse-glow",children:"⚠️ Mural completo! Para adicionar nova notícia, faça backup e remova uma notícia ativa nas Configurações."})]})]}),a.jsx(Se,{children:u.length===0?a.jsx(f1,{icon:fn,title:"Nenhuma notícia ativa",description:"Não há notícias ou avisos no momento. As notícias aparecerão aqui quando forem adicionadas.",action:{label:"Adicionar Notícia",onClick:()=>{window.location.href="/dashboard/configuracoes"}}}):a.jsx("div",{className:"grid grid-cols-1 tablet:grid-cols-2 laptop:grid-cols-3 gap-4 tablet:gap-6",children:u.map((b,N)=>{const y=o.has(N),A=b.conteudo.length>150;return a.jsxs(Ee,{className:`card-3d hover-lift-3d transition-all duration-300 animate-fade-in ${t.effects.glassmorphism?"bg-white/5 backdrop-blur-sm border-white/10":""} ${y?"ring-2 ring-primary/20":""}`,style:{animationDelay:`${N*100}ms`},children:[a.jsxs(Ae,{className:"pb-3",children:[a.jsxs("div",{className:"flex items-start justify-between mb-3",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("div",{className:`p-2 rounded-lg ${v(b.tipo)} shadow-md`,children:m(b.tipo)}),a.jsx(Ve,{variant:"outline",className:`text-xs font-medium ${v(b.tipo)}`,children:b.tipo})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("div",{className:`w-3 h-3 rounded-full ${g(b.prioridade)} animate-pulse`}),a.jsx("span",{className:"text-xs text-muted-foreground font-medium",children:b.prioridade})]})]}),a.jsx(Fe,{className:"text-lg leading-tight text-foreground hover:text-primary transition-colors duration-200",children:b.titulo})]}),a.jsxs(Se,{className:"pt-0",children:[a.jsx("div",{className:`text-sm text-muted-foreground mb-4 leading-relaxed transition-all duration-300 ${y?"":"line-clamp-3"}`,children:b.conteudo}),A&&a.jsx("div",{className:"mb-4",children:a.jsx(Q,{variant:"ghost",size:"sm",onClick:()=>h(N),className:"w-full text-xs text-muted-foreground hover:text-foreground transition-all duration-200 hover:scale-105 active:scale-95 hover:shadow-sm",children:y?a.jsxs(a.Fragment,{children:[a.jsx(_s,{className:"h-3 w-3 mr-1"}),"Ver menos"]}):a.jsxs(a.Fragment,{children:[a.jsx(Ka,{className:"h-3 w-3 mr-1"}),"Ver mais"]})})}),a.jsxs("div",{className:"flex items-center justify-between text-xs text-muted-foreground pt-3 border-t border-border/50",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(Qf,{className:"h-3 w-3"}),a.jsx("span",{className:"font-medium",children:x(b.created_at)})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(ya,{className:"h-3 w-3"}),a.jsx("span",{className:"font-medium",children:new Date(b.created_at).toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"})})]})]})]})]},b.id)})})})]})]})}/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var bn={};bn.version="0.18.5";var Ku=1252,w1=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Yu=function(e){w1.indexOf(e)!=-1&&(Ku=e)};function b1(){Yu(1252)}var Fs=function(e){Yu(e)};function y1(){Fs(1200),b1()}var Zs=function(t){return String.fromCharCode(t)},Cl=function(t){return String.fromCharCode(t)},yn,na="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function ks(e){for(var t="",r=0,s=0,n=0,i=0,o=0,l=0,d=0,c=0;c<e.length;)r=e.charCodeAt(c++),i=r>>2,s=e.charCodeAt(c++),o=(r&3)<<4|s>>4,n=e.charCodeAt(c++),l=(s&15)<<2|n>>6,d=n&63,isNaN(s)?l=d=64:isNaN(n)&&(d=64),t+=na.charAt(i)+na.charAt(o)+na.charAt(l)+na.charAt(d);return t}function Yr(e){var t="",r=0,s=0,n=0,i=0,o=0,l=0,d=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var c=0;c<e.length;)i=na.indexOf(e.charAt(c++)),o=na.indexOf(e.charAt(c++)),r=i<<2|o>>4,t+=String.fromCharCode(r),l=na.indexOf(e.charAt(c++)),s=(o&15)<<4|l>>2,l!==64&&(t+=String.fromCharCode(s)),d=na.indexOf(e.charAt(c++)),n=(l&3)<<6|d,d!==64&&(t+=String.fromCharCode(n));return t}var ze=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Qr=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function Na(e){return ze?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function Tl(e){return ze?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var br=function(t){return ze?Qr(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function Kn(e){if(typeof ArrayBuffer>"u")return br(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),s=0;s!=e.length;++s)r[s]=e.charCodeAt(s)&255;return t}function Vs(e){if(Array.isArray(e))return e.map(function(s){return String.fromCharCode(s)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function N1(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}var Ct=ze?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:Qr(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var s=new Uint8Array(r),n=0;for(t=0,r=0;t<e.length;r+=n,++t)if(n=e[t].length,e[t]instanceof Uint8Array)s.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";s.set(new Uint8Array(e[t]),r)}return s}return[].concat.apply([],e.map(function(i){return Array.isArray(i)?i:[].slice.call(i)}))};function j1(e){for(var t=[],r=0,s=e.length+250,n=Na(e.length+255),i=0;i<e.length;++i){var o=e.charCodeAt(i);if(o<128)n[r++]=o;else if(o<2048)n[r++]=192|o>>6&31,n[r++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var l=e.charCodeAt(++i)&1023;n[r++]=240|o>>8&7,n[r++]=128|o>>2&63,n[r++]=128|l>>6&15|(o&3)<<4,n[r++]=128|l&63}else n[r++]=224|o>>12&15,n[r++]=128|o>>6&63,n[r++]=128|o&63;r>s&&(t.push(n.slice(0,r)),r=0,n=Na(65535),s=65530)}return t.push(n.slice(0,r)),Ct(t)}var xs=/\u0000/g,en=/[\u0001-\u0006]/g;function Ha(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function Nr(e,t){var r=""+e;return r.length>=t?r:rt("0",t-r.length)+r}function Po(e,t){var r=""+e;return r.length>=t?r:rt(" ",t-r.length)+r}function Nn(e,t){var r=""+e;return r.length>=t?r:r+rt(" ",t-r.length)}function E1(e,t){var r=""+Math.round(e);return r.length>=t?r:rt("0",t-r.length)+r}function _1(e,t){var r=""+e;return r.length>=t?r:rt("0",t-r.length)+r}var Al=Math.pow(2,32);function Ia(e,t){if(e>Al||e<-Al)return E1(e,t);var r=Math.round(e);return _1(r,t)}function jn(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var Rl=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Ni=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function S1(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"上午/下午 "hh"時"mm"分"ss"秒 "',e}var st={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"上午/下午 "hh"時"mm"分"ss"秒 "'},Fl={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},C1={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function En(e,t,r){for(var s=e<0?-1:1,n=e*s,i=0,o=1,l=0,d=1,c=0,u=0,h=Math.floor(n);c<t&&(h=Math.floor(n),l=h*o+i,u=h*c+d,!(n-h<5e-8));)n=1/(n-h),i=o,o=l,d=c,c=u;if(u>t&&(c>t?(u=d,l=i):(u=c,l=o)),!r)return[0,s*l,u];var f=Math.floor(s*l/u);return[f,s*l-f*u,u]}function tn(e,t,r){if(e>2958465||e<0)return null;var s=e|0,n=Math.floor(86400*(e-s)),i=0,o=[],l={D:s,T:n,u:86400*(e-s)-n,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(l.u)<1e-6&&(l.u=0),t&&t.date1904&&(s+=1462),l.u>.9999&&(l.u=0,++n==86400&&(l.T=n=0,++s,++l.D)),s===60)o=r?[1317,10,29]:[1900,2,29],i=3;else if(s===0)o=r?[1317,8,29]:[1900,1,0],i=6;else{s>60&&--s;var d=new Date(1900,0,1);d.setDate(d.getDate()+s-1),o=[d.getFullYear(),d.getMonth()+1,d.getDate()],i=d.getDay(),s<60&&(i=(i+6)%7),r&&(i=P1(d,o))}return l.y=o[0],l.m=o[1],l.d=o[2],l.S=n%60,n=Math.floor(n/60),l.M=n%60,n=Math.floor(n/60),l.H=n,l.q=i,l}var Ju=new Date(1899,11,31,0,0,0),T1=Ju.getTime(),A1=new Date(1900,2,1,0,0,0);function Qu(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=A1&&(r+=24*60*60*1e3),(r-(T1+(e.getTimezoneOffset()-Ju.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function Io(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function R1(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function F1(e){var t=e<0?12:11,r=Io(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function k1(e){var t=Io(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function D1(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=F1(e):t===10?r=e.toFixed(10).substr(0,12):r=k1(e),Io(R1(r.toUpperCase()))}function Qi(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):D1(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return da(14,Qu(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function P1(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function I1(e,t,r,s){var n="",i=0,o=0,l=r.y,d,c=0;switch(e){case 98:l=r.y+543;case 121:switch(t.length){case 1:case 2:d=l%100,c=2;break;default:d=l%1e4,c=4;break}break;case 109:switch(t.length){case 1:case 2:d=r.m,c=t.length;break;case 3:return Ni[r.m-1][1];case 5:return Ni[r.m-1][0];default:return Ni[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:d=r.d,c=t.length;break;case 3:return Rl[r.q][0];default:return Rl[r.q][1]}break;case 104:switch(t.length){case 1:case 2:d=1+(r.H+11)%12,c=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:d=r.H,c=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:d=r.M,c=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?Nr(r.S,t.length):(s>=2?o=s===3?1e3:100:o=s===1?10:1,i=Math.round(o*(r.S+r.u)),i>=60*o&&(i=0),t==="s"?i===0?"0":""+i/o:(n=Nr(i,2+s),t==="ss"?n.substr(0,2):"."+n.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":d=r.D*24+r.H;break;case"[m]":case"[mm]":d=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":d=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}c=t.length===3?1:2;break;case 101:d=l,c=1;break}var u=c>0?Nr(d,c):"";return u}function ia(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,s=e.substr(0,r);r!=e.length;r+=t)s+=(s.length>0?",":"")+e.substr(r,t);return s}var Zu=/%/g;function O1(e,t,r){var s=t.replace(Zu,""),n=t.length-s.length;return Wr(e,s,r*Math.pow(10,2*n))+rt("%",n)}function M1(e,t,r){for(var s=t.length-1;t.charCodeAt(s-1)===44;)--s;return Wr(e,t.substr(0,s),r/Math.pow(10,3*(t.length-s)))}function e0(e,t){var r,s=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+e0(e,-t);var n=e.indexOf(".");n===-1&&(n=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%n;if(i<0&&(i+=n),r=(t/Math.pow(10,i)).toPrecision(s+1+(n+i)%n),r.indexOf("e")===-1){var o=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+i):r+="E+"+(o-i);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,n)+"."+r.substr(2+n),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,d,c,u){return d+c+u.substr(0,(n+i)%n)+"."+u.substr(i)+"E"})}else r=t.toExponential(s);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var t0=/# (\?+)( ?)\/( ?)(\d+)/;function L1(e,t,r){var s=parseInt(e[4],10),n=Math.round(t*s),i=Math.floor(n/s),o=n-i*s,l=s;return r+(i===0?"":""+i)+" "+(o===0?rt(" ",e[1].length+1+e[4].length):Po(o,e[1].length)+e[2]+"/"+e[3]+Nr(l,e[4].length))}function B1(e,t,r){return r+(t===0?"":""+t)+rt(" ",e[1].length+2+e[4].length)}var r0=/^#*0*\.([0#]+)/,a0=/\).*[0#]/,s0=/\(###\) ###\\?-####/;function Ut(e){for(var t="",r,s=0;s!=e.length;++s)switch(r=e.charCodeAt(s)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function kl(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function Dl(e,t){var r=e-Math.floor(e),s=Math.pow(10,t);return t<(""+Math.round(r*s)).length?0:Math.round(r*s)}function U1(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function $1(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function cr(e,t,r){if(e.charCodeAt(0)===40&&!t.match(a0)){var s=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?cr("n",s,r):"("+cr("n",s,-r)+")"}if(t.charCodeAt(t.length-1)===44)return M1(e,t,r);if(t.indexOf("%")!==-1)return O1(e,t,r);if(t.indexOf("E")!==-1)return e0(t,r);if(t.charCodeAt(0)===36)return"$"+cr(e,t.substr(t.charAt(1)==" "?2:1),r);var n,i,o,l,d=Math.abs(r),c=r<0?"-":"";if(t.match(/^00+$/))return c+Ia(d,t.length);if(t.match(/^[#?]+$/))return n=Ia(r,0),n==="0"&&(n=""),n.length>t.length?n:Ut(t.substr(0,t.length-n.length))+n;if(i=t.match(t0))return L1(i,d,c);if(t.match(/^#+0+$/))return c+Ia(d,t.length-t.indexOf("0"));if(i=t.match(r0))return n=kl(r,i[1].length).replace(/^([^\.]+)$/,"$1."+Ut(i[1])).replace(/\.$/,"."+Ut(i[1])).replace(/\.(\d*)$/,function(v,g){return"."+g+rt("0",Ut(i[1]).length-g.length)}),t.indexOf("0.")!==-1?n:n.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return c+kl(d,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return c+ia(Ia(d,0));if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+cr(e,t,-r):ia(""+(Math.floor(r)+U1(r,i[1].length)))+"."+Nr(Dl(r,i[1].length),i[1].length);if(i=t.match(/^#,#*,#0/))return cr(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return n=Ha(cr(e,t.replace(/[\\-]/g,""),r)),o=0,Ha(Ha(t.replace(/\\/g,"")).replace(/[0#]/g,function(v){return o<n.length?n.charAt(o++):v==="0"?"0":""}));if(t.match(s0))return n=cr(e,"##########",r),"("+n.substr(0,3)+") "+n.substr(3,3)+"-"+n.substr(6);var u="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(i[4].length,7),l=En(d,Math.pow(10,o)-1,!1),n=""+c,u=Wr("n",i[1],l[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),n+=u+i[2]+"/"+i[3],u=Nn(l[2],o),u.length<i[4].length&&(u=Ut(i[4].substr(i[4].length-u.length))+u),n+=u,n;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(i[1].length,i[4].length),7),l=En(d,Math.pow(10,o)-1,!0),c+(l[0]||(l[1]?"":"0"))+" "+(l[1]?Po(l[1],o)+i[2]+"/"+i[3]+Nn(l[2],o):rt(" ",2*o+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return n=Ia(r,0),t.length<=n.length?n:Ut(t.substr(0,t.length-n.length))+n;if(i=t.match(/^([#0?]+)\.([#0]+)$/)){n=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),o=n.indexOf(".");var h=t.indexOf(".")-o,f=t.length-n.length-h;return Ut(t.substr(0,h)+n+t.substr(t.length-f))}if(i=t.match(/^00,000\.([#0]*0)$/))return o=Dl(r,i[1].length),r<0?"-"+cr(e,t,-r):ia($1(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(v){return"00,"+(v.length<3?Nr(0,3-v.length):"")+v})+"."+Nr(o,i[1].length);switch(t){case"###,##0.00":return cr(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var m=ia(Ia(d,0));return m!=="0"?c+m:"";case"###,###.00":return cr(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return cr(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function z1(e,t,r){for(var s=t.length-1;t.charCodeAt(s-1)===44;)--s;return Wr(e,t.substr(0,s),r/Math.pow(10,3*(t.length-s)))}function V1(e,t,r){var s=t.replace(Zu,""),n=t.length-s.length;return Wr(e,s,r*Math.pow(10,2*n))+rt("%",n)}function n0(e,t){var r,s=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+n0(e,-t);var n=e.indexOf(".");n===-1&&(n=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%n;if(i<0&&(i+=n),r=(t/Math.pow(10,i)).toPrecision(s+1+(n+i)%n),!r.match(/[Ee]/)){var o=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+i):r+="E+"+(o-i),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,d,c,u){return d+c+u.substr(0,(n+i)%n)+"."+u.substr(i)+"E"})}else r=t.toExponential(s);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Fr(e,t,r){if(e.charCodeAt(0)===40&&!t.match(a0)){var s=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Fr("n",s,r):"("+Fr("n",s,-r)+")"}if(t.charCodeAt(t.length-1)===44)return z1(e,t,r);if(t.indexOf("%")!==-1)return V1(e,t,r);if(t.indexOf("E")!==-1)return n0(t,r);if(t.charCodeAt(0)===36)return"$"+Fr(e,t.substr(t.charAt(1)==" "?2:1),r);var n,i,o,l,d=Math.abs(r),c=r<0?"-":"";if(t.match(/^00+$/))return c+Nr(d,t.length);if(t.match(/^[#?]+$/))return n=""+r,r===0&&(n=""),n.length>t.length?n:Ut(t.substr(0,t.length-n.length))+n;if(i=t.match(t0))return B1(i,d,c);if(t.match(/^#+0+$/))return c+Nr(d,t.length-t.indexOf("0"));if(i=t.match(r0))return n=(""+r).replace(/^([^\.]+)$/,"$1."+Ut(i[1])).replace(/\.$/,"."+Ut(i[1])),n=n.replace(/\.(\d*)$/,function(v,g){return"."+g+rt("0",Ut(i[1]).length-g.length)}),t.indexOf("0.")!==-1?n:n.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return c+(""+d).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return c+ia(""+d);if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Fr(e,t,-r):ia(""+r)+"."+rt("0",i[1].length);if(i=t.match(/^#,#*,#0/))return Fr(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return n=Ha(Fr(e,t.replace(/[\\-]/g,""),r)),o=0,Ha(Ha(t.replace(/\\/g,"")).replace(/[0#]/g,function(v){return o<n.length?n.charAt(o++):v==="0"?"0":""}));if(t.match(s0))return n=Fr(e,"##########",r),"("+n.substr(0,3)+") "+n.substr(3,3)+"-"+n.substr(6);var u="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(i[4].length,7),l=En(d,Math.pow(10,o)-1,!1),n=""+c,u=Wr("n",i[1],l[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),n+=u+i[2]+"/"+i[3],u=Nn(l[2],o),u.length<i[4].length&&(u=Ut(i[4].substr(i[4].length-u.length))+u),n+=u,n;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(i[1].length,i[4].length),7),l=En(d,Math.pow(10,o)-1,!0),c+(l[0]||(l[1]?"":"0"))+" "+(l[1]?Po(l[1],o)+i[2]+"/"+i[3]+Nn(l[2],o):rt(" ",2*o+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return n=""+r,t.length<=n.length?n:Ut(t.substr(0,t.length-n.length))+n;if(i=t.match(/^([#0]+)\.([#0]+)$/)){n=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),o=n.indexOf(".");var h=t.indexOf(".")-o,f=t.length-n.length-h;return Ut(t.substr(0,h)+n+t.substr(t.length-f))}if(i=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Fr(e,t,-r):ia(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(v){return"00,"+(v.length<3?Nr(0,3-v.length):"")+v})+"."+Nr(0,i[1].length);switch(t){case"###,###":case"##,###":case"#,###":var m=ia(""+d);return m!=="0"?c+m:"";default:if(t.match(/\.[0#?]*$/))return Fr(e,t.slice(0,t.lastIndexOf(".")),r)+Ut(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function Wr(e,t,r){return(r|0)===r?Fr(e,t,r):cr(e,t,r)}function H1(e){for(var t=[],r=!1,s=0,n=0;s<e.length;++s)switch(e.charCodeAt(s)){case 34:r=!r;break;case 95:case 42:case 92:++s;break;case 59:t[t.length]=e.substr(n,s-n),n=s+1}if(t[t.length]=e.substr(n),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var i0=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function o0(e){for(var t=0,r="",s="";t<e.length;)switch(r=e.charAt(t)){case"G":jn(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"上":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="上午/下午")return!0;++t;break;case"[":for(s=r;e.charAt(t++)!=="]"&&t<e.length;)s+=e.charAt(t);if(s.match(i0))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function W1(e,t,r,s){for(var n=[],i="",o=0,l="",d="t",c,u,h,f="H";o<e.length;)switch(l=e.charAt(o)){case"G":if(!jn(e,o))throw new Error("unrecognized character "+l+" in "+e);n[n.length]={t:"G",v:"General"},o+=7;break;case'"':for(i="";(h=e.charCodeAt(++o))!==34&&o<e.length;)i+=String.fromCharCode(h);n[n.length]={t:"t",v:i},++o;break;case"\\":var m=e.charAt(++o),v=m==="("||m===")"?m:"t";n[n.length]={t:v,v:m},++o;break;case"_":n[n.length]={t:"t",v:" "},o+=2;break;case"@":n[n.length]={t:"T",v:t},++o;break;case"B":case"b":if(e.charAt(o+1)==="1"||e.charAt(o+1)==="2"){if(c==null&&(c=tn(t,r,e.charAt(o+1)==="2"),c==null))return"";n[n.length]={t:"X",v:e.substr(o,2)},d=l,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":l=l.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||c==null&&(c=tn(t,r),c==null))return"";for(i=l;++o<e.length&&e.charAt(o).toLowerCase()===l;)i+=l;l==="m"&&d.toLowerCase()==="h"&&(l="M"),l==="h"&&(l=f),n[n.length]={t:l,v:i},d=l;break;case"A":case"a":case"上":var g={t:l,v:l};if(c==null&&(c=tn(t,r)),e.substr(o,3).toUpperCase()==="A/P"?(c!=null&&(g.v=c.H>=12?"P":"A"),g.t="T",f="h",o+=3):e.substr(o,5).toUpperCase()==="AM/PM"?(c!=null&&(g.v=c.H>=12?"PM":"AM"),g.t="T",o+=5,f="h"):e.substr(o,5).toUpperCase()==="上午/下午"?(c!=null&&(g.v=c.H>=12?"下午":"上午"),g.t="T",o+=5,f="h"):(g.t="t",++o),c==null&&g.t==="T")return"";n[n.length]=g,d=l;break;case"[":for(i=l;e.charAt(o++)!=="]"&&o<e.length;)i+=e.charAt(o);if(i.slice(-1)!=="]")throw'unterminated "[" block: |'+i+"|";if(i.match(i0)){if(c==null&&(c=tn(t,r),c==null))return"";n[n.length]={t:"Z",v:i.toLowerCase()},d=i.charAt(1)}else i.indexOf("$")>-1&&(i=(i.match(/\$([^-\[\]]*)/)||[])[1]||"$",o0(e)||(n[n.length]={t:"t",v:i}));break;case".":if(c!=null){for(i=l;++o<e.length&&(l=e.charAt(o))==="0";)i+=l;n[n.length]={t:"s",v:i};break}case"0":case"#":for(i=l;++o<e.length&&"0#?.,E+-%".indexOf(l=e.charAt(o))>-1;)i+=l;n[n.length]={t:"n",v:i};break;case"?":for(i=l;e.charAt(++o)===l;)i+=l;n[n.length]={t:l,v:i},d=l;break;case"*":++o,(e.charAt(o)==" "||e.charAt(o)=="*")&&++o;break;case"(":case")":n[n.length]={t:s===1?"t":l,v:l},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(i=l;o<e.length&&"0123456789".indexOf(e.charAt(++o))>-1;)i+=e.charAt(o);n[n.length]={t:"D",v:i};break;case" ":n[n.length]={t:l,v:l},++o;break;case"$":n[n.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP".indexOf(l)===-1)throw new Error("unrecognized character "+l+" in "+e);n[n.length]={t:"t",v:l},++o;break}var x=0,b=0,N;for(o=n.length-1,d="t";o>=0;--o)switch(n[o].t){case"h":case"H":n[o].t=f,d="h",x<1&&(x=1);break;case"s":(N=n[o].v.match(/\.0+$/))&&(b=Math.max(b,N[0].length-1)),x<3&&(x=3);case"d":case"y":case"M":case"e":d=n[o].t;break;case"m":d==="s"&&(n[o].t="M",x<2&&(x=2));break;case"X":break;case"Z":x<1&&n[o].v.match(/[Hh]/)&&(x=1),x<2&&n[o].v.match(/[Mm]/)&&(x=2),x<3&&n[o].v.match(/[Ss]/)&&(x=3)}switch(x){case 0:break;case 1:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M),c.M>=60&&(c.M=0,++c.H);break;case 2:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M);break}var y="",A;for(o=0;o<n.length;++o)switch(n[o].t){case"t":case"T":case" ":case"D":break;case"X":n[o].v="",n[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":n[o].v=I1(n[o].t.charCodeAt(0),n[o].v,c,b),n[o].t="t";break;case"n":case"?":for(A=o+1;n[A]!=null&&((l=n[A].t)==="?"||l==="D"||(l===" "||l==="t")&&n[A+1]!=null&&(n[A+1].t==="?"||n[A+1].t==="t"&&n[A+1].v==="/")||n[o].t==="("&&(l===" "||l==="n"||l===")")||l==="t"&&(n[A].v==="/"||n[A].v===" "&&n[A+1]!=null&&n[A+1].t=="?"));)n[o].v+=n[A].v,n[A]={v:"",t:";"},++A;y+=n[o].v,o=A-1;break;case"G":n[o].t="t",n[o].v=Qi(t,r);break}var B="",W,C;if(y.length>0){y.charCodeAt(0)==40?(W=t<0&&y.charCodeAt(0)===45?-t:t,C=Wr("n",y,W)):(W=t<0&&s>1?-t:t,C=Wr("n",y,W),W<0&&n[0]&&n[0].t=="t"&&(C=C.substr(1),n[0].v="-"+n[0].v)),A=C.length-1;var L=n.length;for(o=0;o<n.length;++o)if(n[o]!=null&&n[o].t!="t"&&n[o].v.indexOf(".")>-1){L=o;break}var T=n.length;if(L===n.length&&C.indexOf("E")===-1){for(o=n.length-1;o>=0;--o)n[o]==null||"n?".indexOf(n[o].t)===-1||(A>=n[o].v.length-1?(A-=n[o].v.length,n[o].v=C.substr(A+1,n[o].v.length)):A<0?n[o].v="":(n[o].v=C.substr(0,A+1),A=-1),n[o].t="t",T=o);A>=0&&T<n.length&&(n[T].v=C.substr(0,A+1)+n[T].v)}else if(L!==n.length&&C.indexOf("E")===-1){for(A=C.indexOf(".")-1,o=L;o>=0;--o)if(!(n[o]==null||"n?".indexOf(n[o].t)===-1)){for(u=n[o].v.indexOf(".")>-1&&o===L?n[o].v.indexOf(".")-1:n[o].v.length-1,B=n[o].v.substr(u+1);u>=0;--u)A>=0&&(n[o].v.charAt(u)==="0"||n[o].v.charAt(u)==="#")&&(B=C.charAt(A--)+B);n[o].v=B,n[o].t="t",T=o}for(A>=0&&T<n.length&&(n[T].v=C.substr(0,A+1)+n[T].v),A=C.indexOf(".")+1,o=L;o<n.length;++o)if(!(n[o]==null||"n?(".indexOf(n[o].t)===-1&&o!==L)){for(u=n[o].v.indexOf(".")>-1&&o===L?n[o].v.indexOf(".")+1:0,B=n[o].v.substr(0,u);u<n[o].v.length;++u)A<C.length&&(B+=C.charAt(A++));n[o].v=B,n[o].t="t",T=o}}}for(o=0;o<n.length;++o)n[o]!=null&&"n?".indexOf(n[o].t)>-1&&(W=s>1&&t<0&&o>0&&n[o-1].v==="-"?-t:t,n[o].v=Wr(n[o].t,n[o].v,W),n[o].t="t");var P="";for(o=0;o!==n.length;++o)n[o]!=null&&(P+=n[o].v);return P}var Pl=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Il(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function q1(e,t){var r=H1(e),s=r.length,n=r[s-1].indexOf("@");if(s<4&&n>-1&&--s,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||n>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=n>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=n>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=n>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var i=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[s,i];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var o=r[0].match(Pl),l=r[1].match(Pl);return Il(t,o)?[s,r[0]]:Il(t,l)?[s,r[1]]:[s,r[o!=null&&l!=null?2:1]]}return[s,i]}function da(e,t,r){r==null&&(r={});var s="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?s=r.dateNF:s=e;break;case"number":e==14&&r.dateNF?s=r.dateNF:s=(r.table!=null?r.table:st)[e],s==null&&(s=r.table&&r.table[Fl[e]]||st[Fl[e]]),s==null&&(s=C1[e]||"General");break}if(jn(s,0))return Qi(t,r);t instanceof Date&&(t=Qu(t,r.date1904));var n=q1(s,t);if(jn(n[1]))return Qi(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return W1(n[1],t,r,n[0])}function l0(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(st[r]==null){t<0&&(t=r);continue}if(st[r]==e){t=r;break}}t<0&&(t=391)}return st[t]=e,t}function Yn(e){for(var t=0;t!=392;++t)e[t]!==void 0&&l0(e[t],t)}function Jn(){st=S1()}var c0=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function G1(e){var t=typeof e=="number"?st[e]:e;return t=t.replace(c0,"(\\d+)"),new RegExp("^"+t+"$")}function X1(e,t,r){var s=-1,n=-1,i=-1,o=-1,l=-1,d=-1;(t.match(c0)||[]).forEach(function(h,f){var m=parseInt(r[f+1],10);switch(h.toLowerCase().charAt(0)){case"y":s=m;break;case"d":i=m;break;case"h":o=m;break;case"s":d=m;break;case"m":o>=0?l=m:n=m;break}}),d>=0&&l==-1&&n>=0&&(l=n,n=-1);var c=(""+(s>=0?s:new Date().getFullYear())).slice(-4)+"-"+("00"+(n>=1?n:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);c.length==7&&(c="0"+c),c.length==8&&(c="20"+c);var u=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(d>=0?d:0)).slice(-2);return o==-1&&l==-1&&d==-1?c:s==-1&&n==-1&&i==-1?u:c+"T"+u}var K1=function(){var e={};e.version="1.2.0";function t(){for(var C=0,L=new Array(256),T=0;T!=256;++T)C=T,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,L[T]=C;return typeof Int32Array<"u"?new Int32Array(L):L}var r=t();function s(C){var L=0,T=0,P=0,I=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(P=0;P!=256;++P)I[P]=C[P];for(P=0;P!=256;++P)for(T=C[P],L=256+P;L<4096;L+=256)T=I[L]=T>>>8^C[T&255];var V=[];for(P=1;P!=16;++P)V[P-1]=typeof Int32Array<"u"?I.subarray(P*256,P*256+256):I.slice(P*256,P*256+256);return V}var n=s(r),i=n[0],o=n[1],l=n[2],d=n[3],c=n[4],u=n[5],h=n[6],f=n[7],m=n[8],v=n[9],g=n[10],x=n[11],b=n[12],N=n[13],y=n[14];function A(C,L){for(var T=L^-1,P=0,I=C.length;P<I;)T=T>>>8^r[(T^C.charCodeAt(P++))&255];return~T}function B(C,L){for(var T=L^-1,P=C.length-15,I=0;I<P;)T=y[C[I++]^T&255]^N[C[I++]^T>>8&255]^b[C[I++]^T>>16&255]^x[C[I++]^T>>>24]^g[C[I++]]^v[C[I++]]^m[C[I++]]^f[C[I++]]^h[C[I++]]^u[C[I++]]^c[C[I++]]^d[C[I++]]^l[C[I++]]^o[C[I++]]^i[C[I++]]^r[C[I++]];for(P+=15;I<P;)T=T>>>8^r[(T^C[I++])&255];return~T}function W(C,L){for(var T=L^-1,P=0,I=C.length,V=0,ae=0;P<I;)V=C.charCodeAt(P++),V<128?T=T>>>8^r[(T^V)&255]:V<2048?(T=T>>>8^r[(T^(192|V>>6&31))&255],T=T>>>8^r[(T^(128|V&63))&255]):V>=55296&&V<57344?(V=(V&1023)+64,ae=C.charCodeAt(P++)&1023,T=T>>>8^r[(T^(240|V>>8&7))&255],T=T>>>8^r[(T^(128|V>>2&63))&255],T=T>>>8^r[(T^(128|ae>>6&15|(V&3)<<4))&255],T=T>>>8^r[(T^(128|ae&63))&255]):(T=T>>>8^r[(T^(224|V>>12&15))&255],T=T>>>8^r[(T^(128|V>>6&63))&255],T=T>>>8^r[(T^(128|V&63))&255]);return~T}return e.table=r,e.bstr=A,e.buf=B,e.str=W,e}(),Ye=function(){var t={};t.version="1.2.1";function r(w,_){for(var j=w.split("/"),E=_.split("/"),S=0,F=0,X=Math.min(j.length,E.length);S<X;++S){if(F=j[S].length-E[S].length)return F;if(j[S]!=E[S])return j[S]<E[S]?-1:1}return j.length-E.length}function s(w){if(w.charAt(w.length-1)=="/")return w.slice(0,-1).indexOf("/")===-1?w:s(w.slice(0,-1));var _=w.lastIndexOf("/");return _===-1?w:w.slice(0,_+1)}function n(w){if(w.charAt(w.length-1)=="/")return n(w.slice(0,-1));var _=w.lastIndexOf("/");return _===-1?w:w.slice(_+1)}function i(w,_){typeof _=="string"&&(_=new Date(_));var j=_.getHours();j=j<<6|_.getMinutes(),j=j<<5|_.getSeconds()>>>1,w.write_shift(2,j);var E=_.getFullYear()-1980;E=E<<4|_.getMonth()+1,E=E<<5|_.getDate(),w.write_shift(2,E)}function o(w){var _=w.read_shift(2)&65535,j=w.read_shift(2)&65535,E=new Date,S=j&31;j>>>=5;var F=j&15;j>>>=4,E.setMilliseconds(0),E.setFullYear(j+1980),E.setMonth(F-1),E.setDate(S);var X=_&31;_>>>=5;var re=_&63;return _>>>=6,E.setHours(_),E.setMinutes(re),E.setSeconds(X<<1),E}function l(w){Zt(w,0);for(var _={},j=0;w.l<=w.length-4;){var E=w.read_shift(2),S=w.read_shift(2),F=w.l+S,X={};switch(E){case 21589:j=w.read_shift(1),j&1&&(X.mtime=w.read_shift(4)),S>5&&(j&2&&(X.atime=w.read_shift(4)),j&4&&(X.ctime=w.read_shift(4))),X.mtime&&(X.mt=new Date(X.mtime*1e3));break}w.l=F,_[E]=X}return _}var d;function c(){return d||(d={})}function u(w,_){if(w[0]==80&&w[1]==75)return je(w,_);if((w[0]|32)==109&&(w[1]|32)==105)return af(w,_);if(w.length<512)throw new Error("CFB file size "+w.length+" < 512");var j=3,E=512,S=0,F=0,X=0,re=0,H=0,K=[],Y=w.slice(0,512);Zt(Y,0);var oe=h(Y);switch(j=oe[0],j){case 3:E=512;break;case 4:E=4096;break;case 0:if(oe[1]==0)return je(w,_);default:throw new Error("Major Version: Expected 3 or 4 saw "+j)}E!==512&&(Y=w.slice(0,E),Zt(Y,28));var he=w.slice(0,E);f(Y,j);var Ne=Y.read_shift(4,"i");if(j===3&&Ne!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Ne);Y.l+=4,X=Y.read_shift(4,"i"),Y.l+=4,Y.chk("00100000","Mini Stream Cutoff Size: "),re=Y.read_shift(4,"i"),S=Y.read_shift(4,"i"),H=Y.read_shift(4,"i"),F=Y.read_shift(4,"i");for(var le=-1,xe=0;xe<109&&(le=Y.read_shift(4,"i"),!(le<0));++xe)K[xe]=le;var Pe=m(w,E);x(H,F,Pe,E,K);var Ze=N(Pe,X,K,E);Ze[X].name="!Directory",S>0&&re!==ae&&(Ze[re].name="!MiniFAT"),Ze[K[0]].name="!FAT",Ze.fat_addrs=K,Ze.ssz=E;var et={},kt=[],is=[],os=[];y(X,Ze,Pe,kt,S,et,is,re),v(is,os,kt),kt.shift();var ls={FileIndex:is,FullPaths:os};return _&&_.raw&&(ls.raw={header:he,sectors:Pe}),ls}function h(w){if(w[w.l]==80&&w[w.l+1]==75)return[0,0];w.chk(_e,"Header Signature: "),w.l+=16;var _=w.read_shift(2,"u");return[w.read_shift(2,"u"),_]}function f(w,_){var j=9;switch(w.l+=2,j=w.read_shift(2)){case 9:if(_!=3)throw new Error("Sector Shift: Expected 9 saw "+j);break;case 12:if(_!=4)throw new Error("Sector Shift: Expected 12 saw "+j);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+j)}w.chk("0600","Mini Sector Shift: "),w.chk("000000000000","Reserved: ")}function m(w,_){for(var j=Math.ceil(w.length/_)-1,E=[],S=1;S<j;++S)E[S-1]=w.slice(S*_,(S+1)*_);return E[j-1]=w.slice(j*_),E}function v(w,_,j){for(var E=0,S=0,F=0,X=0,re=0,H=j.length,K=[],Y=[];E<H;++E)K[E]=Y[E]=E,_[E]=j[E];for(;re<Y.length;++re)E=Y[re],S=w[E].L,F=w[E].R,X=w[E].C,K[E]===E&&(S!==-1&&K[S]!==S&&(K[E]=K[S]),F!==-1&&K[F]!==F&&(K[E]=K[F])),X!==-1&&(K[X]=E),S!==-1&&E!=K[E]&&(K[S]=K[E],Y.lastIndexOf(S)<re&&Y.push(S)),F!==-1&&E!=K[E]&&(K[F]=K[E],Y.lastIndexOf(F)<re&&Y.push(F));for(E=1;E<H;++E)K[E]===E&&(F!==-1&&K[F]!==F?K[E]=K[F]:S!==-1&&K[S]!==S&&(K[E]=K[S]));for(E=1;E<H;++E)if(w[E].type!==0){if(re=E,re!=K[re])do re=K[re],_[E]=_[re]+"/"+_[E];while(re!==0&&K[re]!==-1&&re!=K[re]);K[E]=-1}for(_[0]+="/",E=1;E<H;++E)w[E].type!==2&&(_[E]+="/")}function g(w,_,j){for(var E=w.start,S=w.size,F=[],X=E;j&&S>0&&X>=0;)F.push(_.slice(X*V,X*V+V)),S-=V,X=pa(j,X*4);return F.length===0?te(0):Ct(F).slice(0,w.size)}function x(w,_,j,E,S){var F=ae;if(w===ae){if(_!==0)throw new Error("DIFAT chain shorter than expected")}else if(w!==-1){var X=j[w],re=(E>>>2)-1;if(!X)return;for(var H=0;H<re&&(F=pa(X,H*4))!==ae;++H)S.push(F);x(pa(X,E-4),_-1,j,E,S)}}function b(w,_,j,E,S){var F=[],X=[];S||(S=[]);var re=E-1,H=0,K=0;for(H=_;H>=0;){S[H]=!0,F[F.length]=H,X.push(w[H]);var Y=j[Math.floor(H*4/E)];if(K=H*4&re,E<4+K)throw new Error("FAT boundary crossed: "+H+" 4 "+E);if(!w[Y])break;H=pa(w[Y],K)}return{nodes:F,data:Vl([X])}}function N(w,_,j,E){var S=w.length,F=[],X=[],re=[],H=[],K=E-1,Y=0,oe=0,he=0,Ne=0;for(Y=0;Y<S;++Y)if(re=[],he=Y+_,he>=S&&(he-=S),!X[he]){H=[];var le=[];for(oe=he;oe>=0;){le[oe]=!0,X[oe]=!0,re[re.length]=oe,H.push(w[oe]);var xe=j[Math.floor(oe*4/E)];if(Ne=oe*4&K,E<4+Ne)throw new Error("FAT boundary crossed: "+oe+" 4 "+E);if(!w[xe]||(oe=pa(w[xe],Ne),le[oe]))break}F[he]={nodes:re,data:Vl([H])}}return F}function y(w,_,j,E,S,F,X,re){for(var H=0,K=E.length?2:0,Y=_[w].data,oe=0,he=0,Ne;oe<Y.length;oe+=128){var le=Y.slice(oe,oe+128);Zt(le,64),he=le.read_shift(2),Ne=Uo(le,0,he-K),E.push(Ne);var xe={name:Ne,type:le.read_shift(1),color:le.read_shift(1),L:le.read_shift(4,"i"),R:le.read_shift(4,"i"),C:le.read_shift(4,"i"),clsid:le.read_shift(16),state:le.read_shift(4,"i"),start:0,size:0},Pe=le.read_shift(2)+le.read_shift(2)+le.read_shift(2)+le.read_shift(2);Pe!==0&&(xe.ct=A(le,le.l-8));var Ze=le.read_shift(2)+le.read_shift(2)+le.read_shift(2)+le.read_shift(2);Ze!==0&&(xe.mt=A(le,le.l-8)),xe.start=le.read_shift(4,"i"),xe.size=le.read_shift(4,"i"),xe.size<0&&xe.start<0&&(xe.size=xe.type=0,xe.start=ae,xe.name=""),xe.type===5?(H=xe.start,S>0&&H!==ae&&(_[H].name="!StreamData")):xe.size>=4096?(xe.storage="fat",_[xe.start]===void 0&&(_[xe.start]=b(j,xe.start,_.fat_addrs,_.ssz)),_[xe.start].name=xe.name,xe.content=_[xe.start].data.slice(0,xe.size)):(xe.storage="minifat",xe.size<0?xe.size=0:H!==ae&&xe.start!==ae&&_[H]&&(xe.content=g(xe,_[H].data,(_[re]||{}).data))),xe.content&&Zt(xe.content,0),F[Ne]=xe,X.push(xe)}}function A(w,_){return new Date((tr(w,_+4)/1e7*Math.pow(2,32)+tr(w,_)/1e7-11644473600)*1e3)}function B(w,_){return c(),u(d.readFileSync(w),_)}function W(w,_){var j=_&&_.type;switch(j||ze&&Buffer.isBuffer(w)&&(j="buffer"),j||"base64"){case"file":return B(w,_);case"base64":return u(br(Yr(w)),_);case"binary":return u(br(w),_)}return u(w,_)}function C(w,_){var j=_||{},E=j.root||"Root Entry";if(w.FullPaths||(w.FullPaths=[]),w.FileIndex||(w.FileIndex=[]),w.FullPaths.length!==w.FileIndex.length)throw new Error("inconsistent CFB structure");w.FullPaths.length===0&&(w.FullPaths[0]=E+"/",w.FileIndex[0]={name:E,type:5}),j.CLSID&&(w.FileIndex[0].clsid=j.CLSID),L(w)}function L(w){var _="Sh33tJ5";if(!Ye.find(w,"/"+_)){var j=te(4);j[0]=55,j[1]=j[3]=50,j[2]=54,w.FileIndex.push({name:_,type:2,content:j,size:4,L:69,R:69,C:69}),w.FullPaths.push(w.FullPaths[0]+_),T(w)}}function T(w,_){C(w);for(var j=!1,E=!1,S=w.FullPaths.length-1;S>=0;--S){var F=w.FileIndex[S];switch(F.type){case 0:E?j=!0:(w.FileIndex.pop(),w.FullPaths.pop());break;case 1:case 2:case 5:E=!0,isNaN(F.R*F.L*F.C)&&(j=!0),F.R>-1&&F.L>-1&&F.R==F.L&&(j=!0);break;default:j=!0;break}}if(!(!j&&!_)){var X=new Date(1987,1,19),re=0,H=Object.create?Object.create(null):{},K=[];for(S=0;S<w.FullPaths.length;++S)H[w.FullPaths[S]]=!0,w.FileIndex[S].type!==0&&K.push([w.FullPaths[S],w.FileIndex[S]]);for(S=0;S<K.length;++S){var Y=s(K[S][0]);E=H[Y],E||(K.push([Y,{name:n(Y).replace("/",""),type:1,clsid:we,ct:X,mt:X,content:null}]),H[Y]=!0)}for(K.sort(function(Ne,le){return r(Ne[0],le[0])}),w.FullPaths=[],w.FileIndex=[],S=0;S<K.length;++S)w.FullPaths[S]=K[S][0],w.FileIndex[S]=K[S][1];for(S=0;S<K.length;++S){var oe=w.FileIndex[S],he=w.FullPaths[S];if(oe.name=n(he).replace("/",""),oe.L=oe.R=oe.C=-(oe.color=1),oe.size=oe.content?oe.content.length:0,oe.start=0,oe.clsid=oe.clsid||we,S===0)oe.C=K.length>1?1:-1,oe.size=0,oe.type=5;else if(he.slice(-1)=="/"){for(re=S+1;re<K.length&&s(w.FullPaths[re])!=he;++re);for(oe.C=re>=K.length?-1:re,re=S+1;re<K.length&&s(w.FullPaths[re])!=s(he);++re);oe.R=re>=K.length?-1:re,oe.type=1}else s(w.FullPaths[S+1]||"")==s(he)&&(oe.R=S+1),oe.type=2}}}function P(w,_){var j=_||{};if(j.fileType=="mad")return sf(w,j);switch(T(w),j.fileType){case"zip":return Je(w,j)}var E=function(Ne){for(var le=0,xe=0,Pe=0;Pe<Ne.FileIndex.length;++Pe){var Ze=Ne.FileIndex[Pe];if(Ze.content){var et=Ze.content.length;et>0&&(et<4096?le+=et+63>>6:xe+=et+511>>9)}}for(var kt=Ne.FullPaths.length+3>>2,is=le+7>>3,os=le+127>>7,ls=is+xe+kt+os,ga=ls+127>>7,ci=ga<=109?0:Math.ceil((ga-109)/127);ls+ga+ci+127>>7>ga;)ci=++ga<=109?0:Math.ceil((ga-109)/127);var $r=[1,ci,ga,os,kt,xe,le,0];return Ne.FileIndex[0].size=le<<6,$r[7]=(Ne.FileIndex[0].start=$r[0]+$r[1]+$r[2]+$r[3]+$r[4]+$r[5])+($r[6]+7>>3),$r}(w),S=te(E[7]<<9),F=0,X=0;{for(F=0;F<8;++F)S.write_shift(1,ve[F]);for(F=0;F<8;++F)S.write_shift(2,0);for(S.write_shift(2,62),S.write_shift(2,3),S.write_shift(2,65534),S.write_shift(2,9),S.write_shift(2,6),F=0;F<3;++F)S.write_shift(2,0);for(S.write_shift(4,0),S.write_shift(4,E[2]),S.write_shift(4,E[0]+E[1]+E[2]+E[3]-1),S.write_shift(4,0),S.write_shift(4,4096),S.write_shift(4,E[3]?E[0]+E[1]+E[2]-1:ae),S.write_shift(4,E[3]),S.write_shift(-4,E[1]?E[0]-1:ae),S.write_shift(4,E[1]),F=0;F<109;++F)S.write_shift(-4,F<E[2]?E[1]+F:-1)}if(E[1])for(X=0;X<E[1];++X){for(;F<236+X*127;++F)S.write_shift(-4,F<E[2]?E[1]+F:-1);S.write_shift(-4,X===E[1]-1?ae:X+1)}var re=function(Ne){for(X+=Ne;F<X-1;++F)S.write_shift(-4,F+1);Ne&&(++F,S.write_shift(-4,ae))};for(X=F=0,X+=E[1];F<X;++F)S.write_shift(-4,be.DIFSECT);for(X+=E[2];F<X;++F)S.write_shift(-4,be.FATSECT);re(E[3]),re(E[4]);for(var H=0,K=0,Y=w.FileIndex[0];H<w.FileIndex.length;++H)Y=w.FileIndex[H],Y.content&&(K=Y.content.length,!(K<4096)&&(Y.start=X,re(K+511>>9)));for(re(E[6]+7>>3);S.l&511;)S.write_shift(-4,be.ENDOFCHAIN);for(X=F=0,H=0;H<w.FileIndex.length;++H)Y=w.FileIndex[H],Y.content&&(K=Y.content.length,!(!K||K>=4096)&&(Y.start=X,re(K+63>>6)));for(;S.l&511;)S.write_shift(-4,be.ENDOFCHAIN);for(F=0;F<E[4]<<2;++F){var oe=w.FullPaths[F];if(!oe||oe.length===0){for(H=0;H<17;++H)S.write_shift(4,0);for(H=0;H<3;++H)S.write_shift(4,-1);for(H=0;H<12;++H)S.write_shift(4,0);continue}Y=w.FileIndex[F],F===0&&(Y.start=Y.size?Y.start-1:ae);var he=F===0&&j.root||Y.name;if(K=2*(he.length+1),S.write_shift(64,he,"utf16le"),S.write_shift(2,K),S.write_shift(1,Y.type),S.write_shift(1,Y.color),S.write_shift(-4,Y.L),S.write_shift(-4,Y.R),S.write_shift(-4,Y.C),Y.clsid)S.write_shift(16,Y.clsid,"hex");else for(H=0;H<4;++H)S.write_shift(4,0);S.write_shift(4,Y.state||0),S.write_shift(4,0),S.write_shift(4,0),S.write_shift(4,0),S.write_shift(4,0),S.write_shift(4,Y.start),S.write_shift(4,Y.size),S.write_shift(4,0)}for(F=1;F<w.FileIndex.length;++F)if(Y=w.FileIndex[F],Y.size>=4096)if(S.l=Y.start+1<<9,ze&&Buffer.isBuffer(Y.content))Y.content.copy(S,S.l,0,Y.size),S.l+=Y.size+511&-512;else{for(H=0;H<Y.size;++H)S.write_shift(1,Y.content[H]);for(;H&511;++H)S.write_shift(1,0)}for(F=1;F<w.FileIndex.length;++F)if(Y=w.FileIndex[F],Y.size>0&&Y.size<4096)if(ze&&Buffer.isBuffer(Y.content))Y.content.copy(S,S.l,0,Y.size),S.l+=Y.size+63&-64;else{for(H=0;H<Y.size;++H)S.write_shift(1,Y.content[H]);for(;H&63;++H)S.write_shift(1,0)}if(ze)S.l=S.length;else for(;S.l<S.length;)S.write_shift(1,0);return S}function I(w,_){var j=w.FullPaths.map(function(H){return H.toUpperCase()}),E=j.map(function(H){var K=H.split("/");return K[K.length-(H.slice(-1)=="/"?2:1)]}),S=!1;_.charCodeAt(0)===47?(S=!0,_=j[0].slice(0,-1)+_):S=_.indexOf("/")!==-1;var F=_.toUpperCase(),X=S===!0?j.indexOf(F):E.indexOf(F);if(X!==-1)return w.FileIndex[X];var re=!F.match(en);for(F=F.replace(xs,""),re&&(F=F.replace(en,"!")),X=0;X<j.length;++X)if((re?j[X].replace(en,"!"):j[X]).replace(xs,"")==F||(re?E[X].replace(en,"!"):E[X]).replace(xs,"")==F)return w.FileIndex[X];return null}var V=64,ae=-2,_e="d0cf11e0a1b11ae1",ve=[208,207,17,224,161,177,26,225],we="00000000000000000000000000000000",be={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:ae,FREESECT:-1,HEADER_SIGNATURE:_e,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:we,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function J(w,_,j){c();var E=P(w,j);d.writeFileSync(_,E)}function Z(w){for(var _=new Array(w.length),j=0;j<w.length;++j)_[j]=String.fromCharCode(w[j]);return _.join("")}function ue(w,_){var j=P(w,_);switch(_&&_.type||"buffer"){case"file":return c(),d.writeFileSync(_.filename,j),j;case"binary":return typeof j=="string"?j:Z(j);case"base64":return ks(typeof j=="string"?j:Z(j));case"buffer":if(ze)return Buffer.isBuffer(j)?j:Qr(j);case"array":return typeof j=="string"?br(j):j}return j}var me;function k(w){try{var _=w.InflateRaw,j=new _;if(j._processChunk(new Uint8Array([3,0]),j._finishFlushFlag),j.bytesRead)me=w;else throw new Error("zlib does not expose bytesRead")}catch(E){console.error("cannot use native zlib: "+(E.message||E))}}function M(w,_){if(!me)return Ys(w,_);var j=me.InflateRaw,E=new j,S=E._processChunk(w.slice(w.l),E._finishFlushFlag);return w.l+=E.bytesRead,S}function O(w){return me?me.deflateRawSync(w):U(w)}var R=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],q=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],z=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function D(w){var _=(w<<1|w<<11)&139536|(w<<5|w<<15)&558144;return(_>>16|_>>8|_)&255}for(var G=typeof Uint8Array<"u",ee=G?new Uint8Array(256):[],ge=0;ge<256;++ge)ee[ge]=D(ge);function Te(w,_){var j=ee[w&255];return _<=8?j>>>8-_:(j=j<<8|ee[w>>8&255],_<=16?j>>>16-_:(j=j<<8|ee[w>>16&255],j>>>24-_))}function Me(w,_){var j=_&7,E=_>>>3;return(w[E]|(j<=6?0:w[E+1]<<8))>>>j&3}function pe(w,_){var j=_&7,E=_>>>3;return(w[E]|(j<=5?0:w[E+1]<<8))>>>j&7}function it(w,_){var j=_&7,E=_>>>3;return(w[E]|(j<=4?0:w[E+1]<<8))>>>j&15}function Le(w,_){var j=_&7,E=_>>>3;return(w[E]|(j<=3?0:w[E+1]<<8))>>>j&31}function ye(w,_){var j=_&7,E=_>>>3;return(w[E]|(j<=1?0:w[E+1]<<8))>>>j&127}function mt(w,_,j){var E=_&7,S=_>>>3,F=(1<<j)-1,X=w[S]>>>E;return j<8-E||(X|=w[S+1]<<8-E,j<16-E)||(X|=w[S+2]<<16-E,j<24-E)||(X|=w[S+3]<<24-E),X&F}function yt(w,_,j){var E=_&7,S=_>>>3;return E<=5?w[S]|=(j&7)<<E:(w[S]|=j<<E&255,w[S+1]=(j&7)>>8-E),_+3}function xr(w,_,j){var E=_&7,S=_>>>3;return j=(j&1)<<E,w[S]|=j,_+1}function Sr(w,_,j){var E=_&7,S=_>>>3;return j<<=E,w[S]|=j&255,j>>>=8,w[S+1]=j,_+8}function ka(w,_,j){var E=_&7,S=_>>>3;return j<<=E,w[S]|=j&255,j>>>=8,w[S+1]=j&255,w[S+2]=j>>>8,_+16}function xa(w,_){var j=w.length,E=2*j>_?2*j:_+5,S=0;if(j>=_)return w;if(ze){var F=Tl(E);if(w.copy)w.copy(F);else for(;S<w.length;++S)F[S]=w[S];return F}else if(G){var X=new Uint8Array(E);if(X.set)X.set(w);else for(;S<j;++S)X[S]=w[S];return X}return w.length=E,w}function Wt(w){for(var _=new Array(w),j=0;j<w;++j)_[j]=0;return _}function Nt(w,_,j){var E=1,S=0,F=0,X=0,re=0,H=w.length,K=G?new Uint16Array(32):Wt(32);for(F=0;F<32;++F)K[F]=0;for(F=H;F<j;++F)w[F]=0;H=w.length;var Y=G?new Uint16Array(H):Wt(H);for(F=0;F<H;++F)K[S=w[F]]++,E<S&&(E=S),Y[F]=0;for(K[0]=0,F=1;F<=E;++F)K[F+16]=re=re+K[F-1]<<1;for(F=0;F<H;++F)re=w[F],re!=0&&(Y[F]=K[re+16]++);var oe=0;for(F=0;F<H;++F)if(oe=w[F],oe!=0)for(re=Te(Y[F],E)>>E-oe,X=(1<<E+4-oe)-1;X>=0;--X)_[re|X<<oe]=oe&15|F<<4;return E}var Cr=G?new Uint16Array(512):Wt(512),Zr=G?new Uint16Array(32):Wt(32);if(!G){for(var ir=0;ir<512;++ir)Cr[ir]=0;for(ir=0;ir<32;++ir)Zr[ir]=0}(function(){for(var w=[],_=0;_<32;_++)w.push(5);Nt(w,Zr,32);var j=[];for(_=0;_<=143;_++)j.push(8);for(;_<=255;_++)j.push(9);for(;_<=279;_++)j.push(7);for(;_<=287;_++)j.push(8);Nt(j,Cr,288)})();var Da=function(){for(var _=G?new Uint8Array(32768):[],j=0,E=0;j<z.length-1;++j)for(;E<z[j+1];++E)_[E]=j;for(;E<32768;++E)_[E]=29;var S=G?new Uint8Array(259):[];for(j=0,E=0;j<q.length-1;++j)for(;E<q[j+1];++E)S[E]=j;function F(re,H){for(var K=0;K<re.length;){var Y=Math.min(65535,re.length-K),oe=K+Y==re.length;for(H.write_shift(1,+oe),H.write_shift(2,Y),H.write_shift(2,~Y&65535);Y-- >0;)H[H.l++]=re[K++]}return H.l}function X(re,H){for(var K=0,Y=0,oe=G?new Uint16Array(32768):[];Y<re.length;){var he=Math.min(65535,re.length-Y);if(he<10){for(K=yt(H,K,+(Y+he==re.length)),K&7&&(K+=8-(K&7)),H.l=K/8|0,H.write_shift(2,he),H.write_shift(2,~he&65535);he-- >0;)H[H.l++]=re[Y++];K=H.l*8;continue}K=yt(H,K,+(Y+he==re.length)+2);for(var Ne=0;he-- >0;){var le=re[Y];Ne=(Ne<<5^le)&32767;var xe=-1,Pe=0;if((xe=oe[Ne])&&(xe|=Y&-32768,xe>Y&&(xe-=32768),xe<Y))for(;re[xe+Pe]==re[Y+Pe]&&Pe<250;)++Pe;if(Pe>2){le=S[Pe],le<=22?K=Sr(H,K,ee[le+1]>>1)-1:(Sr(H,K,3),K+=5,Sr(H,K,ee[le-23]>>5),K+=3);var Ze=le<8?0:le-4>>2;Ze>0&&(ka(H,K,Pe-q[le]),K+=Ze),le=_[Y-xe],K=Sr(H,K,ee[le]>>3),K-=3;var et=le<4?0:le-2>>1;et>0&&(ka(H,K,Y-xe-z[le]),K+=et);for(var kt=0;kt<Pe;++kt)oe[Ne]=Y&32767,Ne=(Ne<<5^re[Y])&32767,++Y;he-=Pe-1}else le<=143?le=le+48:K=xr(H,K,1),K=Sr(H,K,ee[le]),oe[Ne]=Y&32767,++Y}K=Sr(H,K,0)-1}return H.l=(K+7)/8|0,H.l}return function(H,K){return H.length<8?F(H,K):X(H,K)}}();function U(w){var _=te(50+Math.floor(w.length*1.1)),j=Da(w,_);return _.slice(0,j)}var ne=G?new Uint16Array(32768):Wt(32768),Be=G?new Uint16Array(32768):Wt(32768),or=G?new Uint16Array(128):Wt(128),gr=1,jt=1;function ea(w,_){var j=Le(w,_)+257;_+=5;var E=Le(w,_)+1;_+=5;var S=it(w,_)+4;_+=4;for(var F=0,X=G?new Uint8Array(19):Wt(19),re=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],H=1,K=G?new Uint8Array(8):Wt(8),Y=G?new Uint8Array(8):Wt(8),oe=X.length,he=0;he<S;++he)X[R[he]]=F=pe(w,_),H<F&&(H=F),K[F]++,_+=3;var Ne=0;for(K[0]=0,he=1;he<=H;++he)Y[he]=Ne=Ne+K[he-1]<<1;for(he=0;he<oe;++he)(Ne=X[he])!=0&&(re[he]=Y[Ne]++);var le=0;for(he=0;he<oe;++he)if(le=X[he],le!=0){Ne=ee[re[he]]>>8-le;for(var xe=(1<<7-le)-1;xe>=0;--xe)or[Ne|xe<<le]=le&7|he<<3}var Pe=[];for(H=1;Pe.length<j+E;)switch(Ne=or[ye(w,_)],_+=Ne&7,Ne>>>=3){case 16:for(F=3+Me(w,_),_+=2,Ne=Pe[Pe.length-1];F-- >0;)Pe.push(Ne);break;case 17:for(F=3+pe(w,_),_+=3;F-- >0;)Pe.push(0);break;case 18:for(F=11+ye(w,_),_+=7;F-- >0;)Pe.push(0);break;default:Pe.push(Ne),H<Ne&&(H=Ne);break}var Ze=Pe.slice(0,j),et=Pe.slice(j);for(he=j;he<286;++he)Ze[he]=0;for(he=E;he<30;++he)et[he]=0;return gr=Nt(Ze,ne,286),jt=Nt(et,Be,30),_}function lr(w,_){if(w[0]==3&&!(w[1]&3))return[Na(_),2];for(var j=0,E=0,S=Tl(_||1<<18),F=0,X=S.length>>>0,re=0,H=0;!(E&1);){if(E=pe(w,j),j+=3,E>>>1)E>>1==1?(re=9,H=5):(j=ea(w,j),re=gr,H=jt);else{j&7&&(j+=8-(j&7));var K=w[j>>>3]|w[(j>>>3)+1]<<8;if(j+=32,K>0)for(!_&&X<F+K&&(S=xa(S,F+K),X=S.length);K-- >0;)S[F++]=w[j>>>3],j+=8;continue}for(;;){!_&&X<F+32767&&(S=xa(S,F+32767),X=S.length);var Y=mt(w,j,re),oe=E>>>1==1?Cr[Y]:ne[Y];if(j+=oe&15,oe>>>=4,!(oe>>>8&255))S[F++]=oe;else{if(oe==256)break;oe-=257;var he=oe<8?0:oe-4>>2;he>5&&(he=0);var Ne=F+q[oe];he>0&&(Ne+=mt(w,j,he),j+=he),Y=mt(w,j,H),oe=E>>>1==1?Zr[Y]:Be[Y],j+=oe&15,oe>>>=4;var le=oe<4?0:oe-2>>1,xe=z[oe];for(le>0&&(xe+=mt(w,j,le),j+=le),!_&&X<Ne&&(S=xa(S,Ne+100),X=S.length);F<Ne;)S[F]=S[F-xe],++F}}}return _?[S,j+7>>>3]:[S.slice(0,F),j+7>>>3]}function Ys(w,_){var j=w.slice(w.l||0),E=lr(j,_);return w.l+=E[1],E[0]}function ie(w,_){if(w)typeof console<"u"&&console.error(_);else throw new Error(_)}function je(w,_){var j=w;Zt(j,0);var E=[],S=[],F={FileIndex:E,FullPaths:S};C(F,{root:_.root});for(var X=j.length-4;(j[X]!=80||j[X+1]!=75||j[X+2]!=5||j[X+3]!=6)&&X>=0;)--X;j.l=X+4,j.l+=4;var re=j.read_shift(2);j.l+=6;var H=j.read_shift(4);for(j.l=H,X=0;X<re;++X){j.l+=20;var K=j.read_shift(4),Y=j.read_shift(4),oe=j.read_shift(2),he=j.read_shift(2),Ne=j.read_shift(2);j.l+=8;var le=j.read_shift(4),xe=l(j.slice(j.l+oe,j.l+oe+he));j.l+=oe+he+Ne;var Pe=j.l;j.l=le+4,$e(j,K,Y,F,xe),j.l=Pe}return F}function $e(w,_,j,E,S){w.l+=2;var F=w.read_shift(2),X=w.read_shift(2),re=o(w);if(F&8257)throw new Error("Unsupported ZIP encryption");for(var H=w.read_shift(4),K=w.read_shift(4),Y=w.read_shift(4),oe=w.read_shift(2),he=w.read_shift(2),Ne="",le=0;le<oe;++le)Ne+=String.fromCharCode(w[w.l++]);if(he){var xe=l(w.slice(w.l,w.l+he));(xe[21589]||{}).mt&&(re=xe[21589].mt),((S||{})[21589]||{}).mt&&(re=S[21589].mt)}w.l+=he;var Pe=w.slice(w.l,w.l+K);switch(X){case 8:Pe=M(w,Y);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+X)}var Ze=!1;F&8&&(H=w.read_shift(4),H==134695760&&(H=w.read_shift(4),Ze=!0),K=w.read_shift(4),Y=w.read_shift(4)),K!=_&&ie(Ze,"Bad compressed size: "+_+" != "+K),Y!=j&&ie(Ze,"Bad uncompressed size: "+j+" != "+Y),li(E,Ne,Pe,{unsafe:!0,mt:re})}function Je(w,_){var j=_||{},E=[],S=[],F=te(1),X=j.compression?8:0,re=0,H=0,K=0,Y=0,oe=0,he=w.FullPaths[0],Ne=he,le=w.FileIndex[0],xe=[],Pe=0;for(H=1;H<w.FullPaths.length;++H)if(Ne=w.FullPaths[H].slice(he.length),le=w.FileIndex[H],!(!le.size||!le.content||Ne=="Sh33tJ5")){var Ze=Y,et=te(Ne.length);for(K=0;K<Ne.length;++K)et.write_shift(1,Ne.charCodeAt(K)&127);et=et.slice(0,et.l),xe[oe]=K1.buf(le.content,0);var kt=le.content;X==8&&(kt=O(kt)),F=te(30),F.write_shift(4,67324752),F.write_shift(2,20),F.write_shift(2,re),F.write_shift(2,X),le.mt?i(F,le.mt):F.write_shift(4,0),F.write_shift(-4,xe[oe]),F.write_shift(4,kt.length),F.write_shift(4,le.content.length),F.write_shift(2,et.length),F.write_shift(2,0),Y+=F.length,E.push(F),Y+=et.length,E.push(et),Y+=kt.length,E.push(kt),F=te(46),F.write_shift(4,33639248),F.write_shift(2,0),F.write_shift(2,20),F.write_shift(2,re),F.write_shift(2,X),F.write_shift(4,0),F.write_shift(-4,xe[oe]),F.write_shift(4,kt.length),F.write_shift(4,le.content.length),F.write_shift(2,et.length),F.write_shift(2,0),F.write_shift(2,0),F.write_shift(2,0),F.write_shift(2,0),F.write_shift(4,0),F.write_shift(4,Ze),Pe+=F.l,S.push(F),Pe+=et.length,S.push(et),++oe}return F=te(22),F.write_shift(4,101010256),F.write_shift(2,0),F.write_shift(2,0),F.write_shift(2,oe),F.write_shift(2,oe),F.write_shift(4,Pe),F.write_shift(4,Y),F.write_shift(2,0),Ct([Ct(E),Ct(S),F])}var He={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function oi(w,_){if(w.ctype)return w.ctype;var j=w.name||"",E=j.match(/\.([^\.]+)$/);return E&&He[E[1]]||_&&(E=(j=_).match(/[\.\\]([^\.\\])+$/),E&&He[E[1]])?He[E[1]]:"application/octet-stream"}function ns(w){for(var _=ks(w),j=[],E=0;E<_.length;E+=76)j.push(_.slice(E,E+76));return j.join(`\r
`)+`\r
`}function ef(w){var _=w.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(K){var Y=K.charCodeAt(0).toString(16).toUpperCase();return"="+(Y.length==1?"0"+Y:Y)});_=_.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),_.charAt(0)==`
`&&(_="=0D"+_.slice(1)),_=_.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var j=[],E=_.split(`\r
`),S=0;S<E.length;++S){var F=E[S];if(F.length==0){j.push("");continue}for(var X=0;X<F.length;){var re=76,H=F.slice(X,X+re);H.charAt(re-1)=="="?re--:H.charAt(re-2)=="="?re-=2:H.charAt(re-3)=="="&&(re-=3),H=F.slice(X,X+re),X+=re,X<F.length&&(H+="="),j.push(H)}}return j.join(`\r
`)}function tf(w){for(var _=[],j=0;j<w.length;++j){for(var E=w[j];j<=w.length&&E.charAt(E.length-1)=="=";)E=E.slice(0,E.length-1)+w[++j];_.push(E)}for(var S=0;S<_.length;++S)_[S]=_[S].replace(/[=][0-9A-Fa-f]{2}/g,function(F){return String.fromCharCode(parseInt(F.slice(1),16))});return br(_.join(`\r
`))}function rf(w,_,j){for(var E="",S="",F="",X,re=0;re<10;++re){var H=_[re];if(!H||H.match(/^\s*$/))break;var K=H.match(/^(.*?):\s*([^\s].*)$/);if(K)switch(K[1].toLowerCase()){case"content-location":E=K[2].trim();break;case"content-type":F=K[2].trim();break;case"content-transfer-encoding":S=K[2].trim();break}}switch(++re,S.toLowerCase()){case"base64":X=br(Yr(_.slice(re).join("")));break;case"quoted-printable":X=tf(_.slice(re));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+S)}var Y=li(w,E.slice(j.length),X,{unsafe:!0});F&&(Y.ctype=F)}function af(w,_){if(Z(w.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var j=_&&_.root||"",E=(ze&&Buffer.isBuffer(w)?w.toString("binary"):Z(w)).split(`\r
`),S=0,F="";for(S=0;S<E.length;++S)if(F=E[S],!!/^Content-Location:/i.test(F)&&(F=F.slice(F.indexOf("file")),j||(j=F.slice(0,F.lastIndexOf("/")+1)),F.slice(0,j.length)!=j))for(;j.length>0&&(j=j.slice(0,j.length-1),j=j.slice(0,j.lastIndexOf("/")+1),F.slice(0,j.length)!=j););var X=(E[1]||"").match(/boundary="(.*?)"/);if(!X)throw new Error("MAD cannot find boundary");var re="--"+(X[1]||""),H=[],K=[],Y={FileIndex:H,FullPaths:K};C(Y);var oe,he=0;for(S=0;S<E.length;++S){var Ne=E[S];Ne!==re&&Ne!==re+"--"||(he++&&rf(Y,E.slice(oe,S),j),oe=S)}return Y}function sf(w,_){var j=_||{},E=j.boundary||"SheetJS";E="------="+E;for(var S=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+E.slice(2)+'"',"","",""],F=w.FullPaths[0],X=F,re=w.FileIndex[0],H=1;H<w.FullPaths.length;++H)if(X=w.FullPaths[H].slice(F.length),re=w.FileIndex[H],!(!re.size||!re.content||X=="Sh33tJ5")){X=X.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Pe){return"_x"+Pe.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Pe){return"_u"+Pe.charCodeAt(0).toString(16)+"_"});for(var K=re.content,Y=ze&&Buffer.isBuffer(K)?K.toString("binary"):Z(K),oe=0,he=Math.min(1024,Y.length),Ne=0,le=0;le<=he;++le)(Ne=Y.charCodeAt(le))>=32&&Ne<128&&++oe;var xe=oe>=he*4/5;S.push(E),S.push("Content-Location: "+(j.root||"file:///C:/SheetJS/")+X),S.push("Content-Transfer-Encoding: "+(xe?"quoted-printable":"base64")),S.push("Content-Type: "+oi(re,X)),S.push(""),S.push(xe?ef(Y):ns(Y))}return S.push(E+`--\r
`),S.join(`\r
`)}function nf(w){var _={};return C(_,w),_}function li(w,_,j,E){var S=E&&E.unsafe;S||C(w);var F=!S&&Ye.find(w,_);if(!F){var X=w.FullPaths[0];_.slice(0,X.length)==X?X=_:(X.slice(-1)!="/"&&(X+="/"),X=(X+_).replace("//","/")),F={name:n(_),type:2},w.FileIndex.push(F),w.FullPaths.push(X),S||Ye.utils.cfb_gc(w)}return F.content=j,F.size=j?j.length:0,E&&(E.CLSID&&(F.clsid=E.CLSID),E.mt&&(F.mt=E.mt),E.ct&&(F.ct=E.ct)),F}function of(w,_){C(w);var j=Ye.find(w,_);if(j){for(var E=0;E<w.FileIndex.length;++E)if(w.FileIndex[E]==j)return w.FileIndex.splice(E,1),w.FullPaths.splice(E,1),!0}return!1}function lf(w,_,j){C(w);var E=Ye.find(w,_);if(E){for(var S=0;S<w.FileIndex.length;++S)if(w.FileIndex[S]==E)return w.FileIndex[S].name=n(j),w.FullPaths[S]=j,!0}return!1}function cf(w){T(w,!0)}return t.find=I,t.read=W,t.parse=u,t.write=ue,t.writeFile=J,t.utils={cfb_new:nf,cfb_add:li,cfb_del:of,cfb_mov:lf,cfb_gc:cf,ReadShift:ps,CheckField:C0,prep_blob:Zt,bconcat:Ct,use_zlib:k,_deflateRaw:U,_inflateRaw:Ys,consts:be},t}();function Y1(e){return typeof e=="string"?Kn(e):Array.isArray(e)?N1(e):e}function Hs(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=Kn(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var s=r=="utf8"?Ps(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(s,e);if(typeof Blob<"u"){var n=new Blob([Y1(s)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(n,e);if(typeof saveAs<"u")return saveAs(n,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var i=URL.createObjectURL(n);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),chrome.downloads.download({url:i,filename:e,saveAs:!0});var o=document.createElement("a");if(o.download!=null)return o.download=e,o.href=i,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),i}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var l=File(e);return l.open("w"),l.encoding="binary",Array.isArray(t)&&(t=Vs(t)),l.write(t),l.close(),t}catch(d){if(!d.message||!d.message.match(/onstruct/))throw d}throw new Error("cannot save file "+e)}function Ft(e){for(var t=Object.keys(e),r=[],s=0;s<t.length;++s)Object.prototype.hasOwnProperty.call(e,t[s])&&r.push(t[s]);return r}function Ol(e,t){for(var r=[],s=Ft(e),n=0;n!==s.length;++n)r[e[s[n]][t]]==null&&(r[e[s[n]][t]]=s[n]);return r}function Oo(e){for(var t=[],r=Ft(e),s=0;s!==r.length;++s)t[e[r[s]]]=r[s];return t}function Qn(e){for(var t=[],r=Ft(e),s=0;s!==r.length;++s)t[e[r[s]]]=parseInt(r[s],10);return t}function J1(e){for(var t=[],r=Ft(e),s=0;s!==r.length;++s)t[e[r[s]]]==null&&(t[e[r[s]]]=[]),t[e[r[s]]].push(r[s]);return t}var _n=new Date(1899,11,30,0,0,0);function Yt(e,t){var r=e.getTime(),s=_n.getTime()+(e.getTimezoneOffset()-_n.getTimezoneOffset())*6e4;return(r-s)/(24*60*60*1e3)}var d0=new Date,Q1=_n.getTime()+(d0.getTimezoneOffset()-_n.getTimezoneOffset())*6e4,Ml=d0.getTimezoneOffset();function u0(e){var t=new Date;return t.setTime(e*24*60*60*1e3+Q1),t.getTimezoneOffset()!==Ml&&t.setTime(t.getTime()+(t.getTimezoneOffset()-Ml)*6e4),t}var Ll=new Date("2017-02-19T19:06:09.000Z"),h0=isNaN(Ll.getFullYear())?new Date("2/19/17"):Ll,Z1=h0.getFullYear()==2017;function Ht(e,t){var r=new Date(e);if(Z1)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(h0.getFullYear()==1917&&!isNaN(r.getFullYear())){var s=r.getFullYear();return e.indexOf(""+s)>-1||r.setFullYear(r.getFullYear()+100),r}var n=e.match(/\d+/g)||["2017","2","19","0","0","0"],i=new Date(+n[0],+n[1]-1,+n[2],+n[3]||0,+n[4]||0,+n[5]||0);return e.indexOf("Z")>-1&&(i=new Date(i.getTime()-i.getTimezoneOffset()*60*1e3)),i}function Zn(e,t){if(ze&&Buffer.isBuffer(e))return e.toString("binary");if(typeof TextDecoder<"u")try{var r={"€":"","‚":"",ƒ:"","„":"","…":"","†":"","‡":"","ˆ":"","‰":"",Š:"","‹":"",Œ:"",Ž:"","‘":"","’":"","“":"","”":"","•":"","–":"","—":"","˜":"","™":"",š:"","›":"",œ:"",ž:"",Ÿ:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™š›œžŸ]/g,function(i){return r[i]||i})}catch{}for(var s=[],n=0;n!=e.length;++n)s.push(String.fromCharCode(e[n]));return s.join("")}function Jt(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=Jt(e[r]));return t}function rt(e,t){for(var r="";r.length<t;)r+=e;return r}function qr(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,s=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(s))||(s=s.replace(/[(](.*)[)]/,function(n,i){return r=-r,i}),!isNaN(t=Number(s)))?t/r:t}var ew=["january","february","march","april","may","june","july","august","september","october","november","december"];function Ds(e){var t=new Date(e),r=new Date(NaN),s=t.getYear(),n=t.getMonth(),i=t.getDate();if(isNaN(i))return r;var o=e.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&ew.indexOf(o)==-1)return r}else if(o.match(/[a-z]/))return r;return s<0||s>8099?r:(n>0||i>1)&&s!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}function Ie(e,t,r){if(e.FullPaths){if(typeof r=="string"){var s;return ze?s=Qr(r):s=j1(r),Ye.utils.cfb_add(e,t,s)}Ye.utils.cfb_add(e,t,r)}else e.file(t,r)}function Mo(){return Ye.utils.cfb_new()}var ut=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,tw={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Lo=Oo(tw),Bo=/[&<>'"]/g,rw=/[\u0000-\u0008\u000b-\u001f]/g;function Xe(e){var t=e+"";return t.replace(Bo,function(r){return Lo[r]}).replace(rw,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function Bl(e){return Xe(e).replace(/ /g,"_x0020_")}var f0=/[\u0000-\u001f]/g;function aw(e){var t=e+"";return t.replace(Bo,function(r){return Lo[r]}).replace(/\n/g,"<br/>").replace(f0,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function sw(e){var t=e+"";return t.replace(Bo,function(r){return Lo[r]}).replace(f0,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}function nw(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function iw(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function ji(e){for(var t="",r=0,s=0,n=0,i=0,o=0,l=0;r<e.length;){if(s=e.charCodeAt(r++),s<128){t+=String.fromCharCode(s);continue}if(n=e.charCodeAt(r++),s>191&&s<224){o=(s&31)<<6,o|=n&63,t+=String.fromCharCode(o);continue}if(i=e.charCodeAt(r++),s<240){t+=String.fromCharCode((s&15)<<12|(n&63)<<6|i&63);continue}o=e.charCodeAt(r++),l=((s&7)<<18|(n&63)<<12|(i&63)<<6|o&63)-65536,t+=String.fromCharCode(55296+(l>>>10&1023)),t+=String.fromCharCode(56320+(l&1023))}return t}function Ul(e){var t=Na(2*e.length),r,s,n=1,i=0,o=0,l;for(s=0;s<e.length;s+=n)n=1,(l=e.charCodeAt(s))<128?r=l:l<224?(r=(l&31)*64+(e.charCodeAt(s+1)&63),n=2):l<240?(r=(l&15)*4096+(e.charCodeAt(s+1)&63)*64+(e.charCodeAt(s+2)&63),n=3):(n=4,r=(l&7)*262144+(e.charCodeAt(s+1)&63)*4096+(e.charCodeAt(s+2)&63)*64+(e.charCodeAt(s+3)&63),r-=65536,o=55296+(r>>>10&1023),r=56320+(r&1023)),o!==0&&(t[i++]=o&255,t[i++]=o>>>8,o=0),t[i++]=r%256,t[i++]=r>>>8;return t.slice(0,i).toString("ucs2")}function $l(e){return Qr(e,"binary").toString("utf8")}var rn="foo bar bazâð£",gs=ze&&($l(rn)==ji(rn)&&$l||Ul(rn)==ji(rn)&&Ul)||ji,Ps=ze?function(e){return Qr(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,s=0,n=0;r<e.length;)switch(s=e.charCodeAt(r++),!0){case s<128:t.push(String.fromCharCode(s));break;case s<2048:t.push(String.fromCharCode(192+(s>>6))),t.push(String.fromCharCode(128+(s&63)));break;case(s>=55296&&s<57344):s-=55296,n=e.charCodeAt(r++)-56320+(s<<10),t.push(String.fromCharCode(240+(n>>18&7))),t.push(String.fromCharCode(144+(n>>12&63))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)));break;default:t.push(String.fromCharCode(224+(s>>12))),t.push(String.fromCharCode(128+(s>>6&63))),t.push(String.fromCharCode(128+(s&63)))}return t.join("")},ow=function(){var e=[["nbsp"," "],["middot","·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var s=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),n=0;n<e.length;++n)s=s.replace(e[n][0],e[n][1]);return s}}(),m0=/(^\s|\s$|\n)/;function Tt(e,t){return"<"+e+(t.match(m0)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function Is(e){return Ft(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function ce(e,t,r){return"<"+e+(r!=null?Is(r):"")+(t!=null?(t.match(m0)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function Zi(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function lw(e,t){switch(typeof e){case"string":var r=ce("vt:lpwstr",Xe(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return ce((e|0)==e?"vt:i4":"vt:r8",Xe(String(e)));case"boolean":return ce("vt:bool",e?"true":"false")}if(e instanceof Date)return ce("vt:filetime",Zi(e));throw new Error("Unable to serialize "+e)}var xt={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},ts=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],er={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function cw(e,t){for(var r=1-2*(e[t+7]>>>7),s=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),n=e[t+6]&15,i=5;i>=0;--i)n=n*256+e[t+i];return s==2047?n==0?r*(1/0):NaN:(s==0?s=-1022:(s-=1023,n+=Math.pow(2,52)),r*Math.pow(2,s-52)*n)}function dw(e,t,r){var s=(t<0||1/t==-1/0?1:0)<<7,n=0,i=0,o=s?-t:t;isFinite(o)?o==0?n=i=0:(n=Math.floor(Math.log(o)/Math.LN2),i=o*Math.pow(2,52-n),n<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?n=-1022:(i-=Math.pow(2,52),n+=1023)):(n=2047,i=isNaN(t)?26985:0);for(var l=0;l<=5;++l,i/=256)e[r+l]=i&255;e[r+6]=(n&15)<<4|i&15,e[r+7]=n>>4|s}var zl=function(e){for(var t=[],r=10240,s=0;s<e[0].length;++s)if(e[0][s])for(var n=0,i=e[0][s].length;n<i;n+=r)t.push.apply(t,e[0][s].slice(n,n+r));return t},Vl=ze?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:Qr(t)})):zl(e)}:zl,Hl=function(e,t,r){for(var s=[],n=t;n<r;n+=2)s.push(String.fromCharCode(hs(e,n)));return s.join("").replace(xs,"")},Uo=ze?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(xs,""):Hl(e,t,r)}:Hl,Wl=function(e,t,r){for(var s=[],n=t;n<t+r;++n)s.push(("0"+e[n].toString(16)).slice(-2));return s.join("")},x0=ze?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):Wl(e,t,r)}:Wl,ql=function(e,t,r){for(var s=[],n=t;n<r;n++)s.push(String.fromCharCode(La(e,n)));return s.join("")},Ws=ze?function(t,r,s){return Buffer.isBuffer(t)?t.toString("utf8",r,s):ql(t,r,s)}:ql,g0=function(e,t){var r=tr(e,t);return r>0?Ws(e,t+4,t+4+r-1):""},p0=g0,v0=function(e,t){var r=tr(e,t);return r>0?Ws(e,t+4,t+4+r-1):""},w0=v0,b0=function(e,t){var r=2*tr(e,t);return r>0?Ws(e,t+4,t+4+r-1):""},y0=b0,N0=function(t,r){var s=tr(t,r);return s>0?Uo(t,r+4,r+4+s):""},j0=N0,E0=function(e,t){var r=tr(e,t);return r>0?Ws(e,t+4,t+4+r):""},_0=E0,S0=function(e,t){return cw(e,t)},Sn=S0,$o=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};ze&&(p0=function(t,r){if(!Buffer.isBuffer(t))return g0(t,r);var s=t.readUInt32LE(r);return s>0?t.toString("utf8",r+4,r+4+s-1):""},w0=function(t,r){if(!Buffer.isBuffer(t))return v0(t,r);var s=t.readUInt32LE(r);return s>0?t.toString("utf8",r+4,r+4+s-1):""},y0=function(t,r){if(!Buffer.isBuffer(t))return b0(t,r);var s=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+s-1)},j0=function(t,r){if(!Buffer.isBuffer(t))return N0(t,r);var s=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+s)},_0=function(t,r){if(!Buffer.isBuffer(t))return E0(t,r);var s=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+s)},Sn=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):S0(t,r)},$o=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var La=function(e,t){return e[t]},hs=function(e,t){return e[t+1]*256+e[t]},uw=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},tr=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},pa=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},hw=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function ps(e,t){var r="",s,n,i=[],o,l,d,c;switch(t){case"dbcs":if(c=this.l,ze&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(d=0;d<e;++d)r+=String.fromCharCode(hs(this,c)),c+=2;e*=2;break;case"utf8":r=Ws(this,this.l,this.l+e);break;case"utf16le":e*=2,r=Uo(this,this.l,this.l+e);break;case"wstr":return ps.call(this,e,"dbcs");case"lpstr-ansi":r=p0(this,this.l),e=4+tr(this,this.l);break;case"lpstr-cp":r=w0(this,this.l),e=4+tr(this,this.l);break;case"lpwstr":r=y0(this,this.l),e=4+2*tr(this,this.l);break;case"lpp4":e=4+tr(this,this.l),r=j0(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+tr(this,this.l),r=_0(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(o=La(this,this.l+e++))!==0;)i.push(Zs(o));r=i.join("");break;case"_wstr":for(e=0,r="";(o=hs(this,this.l+e))!==0;)i.push(Zs(o)),e+=2;e+=2,r=i.join("");break;case"dbcs-cont":for(r="",c=this.l,d=0;d<e;++d){if(this.lens&&this.lens.indexOf(c)!==-1)return o=La(this,c),this.l=c+1,l=ps.call(this,e-d,o?"dbcs-cont":"sbcs-cont"),i.join("")+l;i.push(Zs(hs(this,c))),c+=2}r=i.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",c=this.l,d=0;d!=e;++d){if(this.lens&&this.lens.indexOf(c)!==-1)return o=La(this,c),this.l=c+1,l=ps.call(this,e-d,o?"dbcs-cont":"sbcs-cont"),i.join("")+l;i.push(Zs(La(this,c))),c+=1}r=i.join("");break;default:switch(e){case 1:return s=La(this,this.l),this.l++,s;case 2:return s=(t==="i"?uw:hs)(this,this.l),this.l+=2,s;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(s=(e>0?pa:hw)(this,this.l),this.l+=4,s):(n=tr(this,this.l),this.l+=4,n);case 8:case-8:if(t==="f")return e==8?n=Sn(this,this.l):n=Sn([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,n;e=8;case 16:r=x0(this,this.l,e);break}}return this.l+=e,r}var fw=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},mw=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},xw=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function gw(e,t,r){var s=0,n=0;if(r==="dbcs"){for(n=0;n!=t.length;++n)xw(this,t.charCodeAt(n),this.l+2*n);s=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),n=0;n!=t.length;++n)this[this.l+n]=t.charCodeAt(n)&255;s=t.length}else if(r==="hex"){for(;n<e;++n)this[this.l++]=parseInt(t.slice(2*n,2*n+2),16)||0;return this}else if(r==="utf16le"){var i=Math.min(this.l+e,this.length);for(n=0;n<Math.min(t.length,e);++n){var o=t.charCodeAt(n);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<i;)this[this.l++]=0;return this}else switch(e){case 1:s=1,this[this.l]=t&255;break;case 2:s=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:s=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:s=4,fw(this,t,this.l);break;case 8:if(s=8,r==="f"){dw(this,t,this.l);break}case 16:break;case-4:s=4,mw(this,t,this.l);break}return this.l+=s,this}function C0(e,t){var r=x0(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function Zt(e,t){e.l=t,e.read_shift=ps,e.chk=C0,e.write_shift=gw}function Lr(e,t){e.l+=t}function te(e){var t=Na(e);return Zt(t,0),t}function Kt(){var e=[],t=ze?256:2048,r=function(c){var u=te(c);return Zt(u,0),u},s=r(t),n=function(){s&&(s.length>s.l&&(s=s.slice(0,s.l),s.l=s.length),s.length>0&&e.push(s),s=null)},i=function(c){return s&&c<s.length-s.l?s:(n(),s=r(Math.max(c+1,t)))},o=function(){return n(),Ct(e)},l=function(c){n(),s=c,s.l==null&&(s.l=s.length),i(t)};return{next:i,push:l,end:o,_bufs:e}}function se(e,t,r,s){var n=+t,i;if(!isNaN(n)){s||(s=cE[n].p||(r||[]).length||0),i=1+(n>=128?1:0)+1,s>=128&&++i,s>=16384&&++i,s>=2097152&&++i;var o=e.next(i);n<=127?o.write_shift(1,n):(o.write_shift(1,(n&127)+128),o.write_shift(1,n>>7));for(var l=0;l!=4;++l)if(s>=128)o.write_shift(1,(s&127)+128),s>>=7;else{o.write_shift(1,s);break}s>0&&$o(r)&&e.push(r)}}function vs(e,t,r){var s=Jt(e);if(t.s?(s.cRel&&(s.c+=t.s.c),s.rRel&&(s.r+=t.s.r)):(s.cRel&&(s.c+=t.c),s.rRel&&(s.r+=t.r)),!r||r.biff<12){for(;s.c>=256;)s.c-=256;for(;s.r>=65536;)s.r-=65536}return s}function Gl(e,t,r){var s=Jt(e);return s.s=vs(s.s,t.s,r),s.e=vs(s.e,t.s,r),s}function ws(e,t){if(e.cRel&&e.c<0)for(e=Jt(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=Jt(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=Ke(e);return!e.cRel&&e.cRel!=null&&(r=ww(r)),!e.rRel&&e.rRel!=null&&(r=pw(r)),r}function Ei(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+It(e.s.c)+":"+(e.e.cRel?"":"$")+It(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+Rt(e.s.r)+":"+(e.e.rRel?"":"$")+Rt(e.e.r):ws(e.s,t.biff)+":"+ws(e.e,t.biff)}function zo(e){return parseInt(vw(e),10)-1}function Rt(e){return""+(e+1)}function pw(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function vw(e){return e.replace(/\$(\d+)$/,"$1")}function Vo(e){for(var t=bw(e),r=0,s=0;s!==t.length;++s)r=26*r+t.charCodeAt(s)-64;return r-1}function It(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function ww(e){return e.replace(/^([A-Z])/,"$$$1")}function bw(e){return e.replace(/^\$([A-Z])/,"$1")}function yw(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function wt(e){for(var t=0,r=0,s=0;s<e.length;++s){var n=e.charCodeAt(s);n>=48&&n<=57?t=10*t+(n-48):n>=65&&n<=90&&(r=26*r+(n-64))}return{c:r-1,r:t-1}}function Ke(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function sr(e){var t=e.indexOf(":");return t==-1?{s:wt(e),e:wt(e)}:{s:wt(e.slice(0,t)),e:wt(e.slice(t+1))}}function dt(e,t){return typeof t>"u"||typeof t=="number"?dt(e.s,e.e):(typeof e!="string"&&(e=Ke(e)),typeof t!="string"&&(t=Ke(t)),e==t?e:e+":"+t)}function Qe(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,s=0,n=0,i=e.length;for(r=0;s<i&&!((n=e.charCodeAt(s)-64)<1||n>26);++s)r=26*r+n;for(t.s.c=--r,r=0;s<i&&!((n=e.charCodeAt(s)-48)<0||n>9);++s)r=10*r+n;if(t.s.r=--r,s===i||n!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++s,r=0;s!=i&&!((n=e.charCodeAt(s)-64)<1||n>26);++s)r=26*r+n;for(t.e.c=--r,r=0;s!=i&&!((n=e.charCodeAt(s)-48)<0||n>9);++s)r=10*r+n;return t.e.r=--r,t}function Xl(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=da(e.z,r?Yt(t):t)}catch{}try{return e.w=da((e.XF||{}).numFmtId||(r?14:0),r?Yt(t):t)}catch{return""+t}}function Jr(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?qs[e.v]||e.v:t==null?Xl(e,e.v):Xl(e,t))}function Ca(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",s={};return s[r]=e,{SheetNames:[r],Sheets:s}}function T0(e,t,r){var s=r||{},n=e?Array.isArray(e):s.dense,i=e||(n?[]:{}),o=0,l=0;if(i&&s.origin!=null){if(typeof s.origin=="number")o=s.origin;else{var d=typeof s.origin=="string"?wt(s.origin):s.origin;o=d.r,l=d.c}i["!ref"]||(i["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var u=Qe(i["!ref"]);c.s.c=u.s.c,c.s.r=u.s.r,c.e.c=Math.max(c.e.c,u.e.c),c.e.r=Math.max(c.e.r,u.e.r),o==-1&&(c.e.r=o=u.e.r+1)}for(var h=0;h!=t.length;++h)if(t[h]){if(!Array.isArray(t[h]))throw new Error("aoa_to_sheet expects an array of arrays");for(var f=0;f!=t[h].length;++f)if(!(typeof t[h][f]>"u")){var m={v:t[h][f]},v=o+h,g=l+f;if(c.s.r>v&&(c.s.r=v),c.s.c>g&&(c.s.c=g),c.e.r<v&&(c.e.r=v),c.e.c<g&&(c.e.c=g),t[h][f]&&typeof t[h][f]=="object"&&!Array.isArray(t[h][f])&&!(t[h][f]instanceof Date))m=t[h][f];else if(Array.isArray(m.v)&&(m.f=t[h][f][1],m.v=m.v[0]),m.v===null)if(m.f)m.t="n";else if(s.nullError)m.t="e",m.v=0;else if(s.sheetStubs)m.t="z";else continue;else typeof m.v=="number"?m.t="n":typeof m.v=="boolean"?m.t="b":m.v instanceof Date?(m.z=s.dateNF||st[14],s.cellDates?(m.t="d",m.w=da(m.z,Yt(m.v))):(m.t="n",m.v=Yt(m.v),m.w=da(m.z,m.v))):m.t="s";if(n)i[v]||(i[v]=[]),i[v][g]&&i[v][g].z&&(m.z=i[v][g].z),i[v][g]=m;else{var x=Ke({c:g,r:v});i[x]&&i[x].z&&(m.z=i[x].z),i[x]=m}}}return c.s.c<1e7&&(i["!ref"]=dt(c)),i}function rs(e,t){return T0(null,e,t)}function Nw(e){return e.read_shift(4,"i")}function Er(e,t){return t||(t=te(4)),t.write_shift(4,e),t}function Ot(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function bt(e,t){var r=!1;return t==null&&(r=!0,t=te(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function jw(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function Ew(e,t){return t||(t=te(4)),t.write_shift(2,0),t.write_shift(2,0),t}function Ho(e,t){var r=e.l,s=e.read_shift(1),n=Ot(e),i=[],o={t:n,h:n};if(s&1){for(var l=e.read_shift(4),d=0;d!=l;++d)i.push(jw(e));o.r=i}else o.r=[{ich:0,ifnt:0}];return e.l=r+t,o}function _w(e,t){var r=!1;return t==null&&(r=!0,t=te(15+4*e.t.length)),t.write_shift(1,0),bt(e.t,t),r?t.slice(0,t.l):t}var Sw=Ho;function Cw(e,t){var r=!1;return t==null&&(r=!0,t=te(23+4*e.t.length)),t.write_shift(1,1),bt(e.t,t),t.write_shift(4,1),Ew({},t),r?t.slice(0,t.l):t}function mr(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function Ta(e,t){return t==null&&(t=te(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function Aa(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function Ra(e,t){return t==null&&(t=te(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var Tw=Ot,A0=bt;function Wo(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function Cn(e,t){var r=!1;return t==null&&(r=!0,t=te(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var Aw=Ot,eo=Wo,qo=Cn;function R0(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,s=t[0]&2;e.l+=4;var n=s===0?Sn([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):pa(t,0)>>2;return r?n/100:n}function F0(e,t){t==null&&(t=te(4));var r=0,s=0,n=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?s=1:n==(n|0)&&n>=-536870912&&n<1<<29&&(s=1,r=1),s)t.write_shift(-4,((r?n:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function k0(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function Rw(e,t){return t||(t=te(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var Fa=k0,as=Rw;function ss(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function ja(e,t){return(t||te(8)).write_shift(8,e,"f")}function Fw(e){var t={},r=e.read_shift(1),s=r>>>1,n=e.read_shift(1),i=e.read_shift(2,"i"),o=e.read_shift(1),l=e.read_shift(1),d=e.read_shift(1);switch(e.l++,s){case 0:t.auto=1;break;case 1:t.index=n;var c=Uw[n];c&&(t.rgb=nc(c));break;case 2:t.rgb=nc([o,l,d]);break;case 3:t.theme=n;break}return i!=0&&(t.tint=i>0?i/32767:i/32768),t}function Tn(e,t){if(t||(t=te(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var s=e.rgb||"FFFFFF";typeof s=="number"&&(s=("000000"+s.toString(16)).slice(-6)),t.write_shift(1,parseInt(s.slice(0,2),16)),t.write_shift(1,parseInt(s.slice(2,4),16)),t.write_shift(1,parseInt(s.slice(4,6),16)),t.write_shift(1,255)}return t}function kw(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function Dw(e,t){t||(t=te(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}var D0=2,Qt=3,an=11,An=19,sn=64,Pw=65,Iw=71,Ow=4108,Mw=4126,St=80,Kl={1:{n:"CodePage",t:D0},2:{n:"Category",t:St},3:{n:"PresentationFormat",t:St},4:{n:"ByteCount",t:Qt},5:{n:"LineCount",t:Qt},6:{n:"ParagraphCount",t:Qt},7:{n:"SlideCount",t:Qt},8:{n:"NoteCount",t:Qt},9:{n:"HiddenCount",t:Qt},10:{n:"MultimediaClipCount",t:Qt},11:{n:"ScaleCrop",t:an},12:{n:"HeadingPairs",t:Ow},13:{n:"TitlesOfParts",t:Mw},14:{n:"Manager",t:St},15:{n:"Company",t:St},16:{n:"LinksUpToDate",t:an},17:{n:"CharacterCount",t:Qt},19:{n:"SharedDoc",t:an},22:{n:"HyperlinksChanged",t:an},23:{n:"AppVersion",t:Qt,p:"version"},24:{n:"DigSig",t:Pw},26:{n:"ContentType",t:St},27:{n:"ContentStatus",t:St},28:{n:"Language",t:St},29:{n:"Version",t:St},255:{},2147483648:{n:"Locale",t:An},2147483651:{n:"Behavior",t:An},1919054434:{}},Yl={1:{n:"CodePage",t:D0},2:{n:"Title",t:St},3:{n:"Subject",t:St},4:{n:"Author",t:St},5:{n:"Keywords",t:St},6:{n:"Comments",t:St},7:{n:"Template",t:St},8:{n:"LastAuthor",t:St},9:{n:"RevNumber",t:St},10:{n:"EditTime",t:sn},11:{n:"LastPrinted",t:sn},12:{n:"CreatedDate",t:sn},13:{n:"ModifiedDate",t:sn},14:{n:"PageCount",t:Qt},15:{n:"WordCount",t:Qt},16:{n:"CharCount",t:Qt},17:{n:"Thumbnail",t:Iw},18:{n:"Application",t:St},19:{n:"DocSecurity",t:Qt},255:{},2147483648:{n:"Locale",t:An},2147483651:{n:"Behavior",t:An},1919054434:{}};function Lw(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var Bw=Lw([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Uw=Jt(Bw),qs={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},$w={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},nn={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function P0(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function I0(e,t){var r=J1($w),s=[],n;s[s.length]=ut,s[s.length]=ce("Types",null,{xmlns:xt.CT,"xmlns:xsd":xt.xsd,"xmlns:xsi":xt.xsi}),s=s.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(d){return ce("Default",null,{Extension:d[0],ContentType:d[1]})}));var i=function(d){e[d]&&e[d].length>0&&(n=e[d][0],s[s.length]=ce("Override",null,{PartName:(n[0]=="/"?"":"/")+n,ContentType:nn[d][t.bookType]||nn[d].xlsx}))},o=function(d){(e[d]||[]).forEach(function(c){s[s.length]=ce("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:nn[d][t.bookType]||nn[d].xlsx})})},l=function(d){(e[d]||[]).forEach(function(c){s[s.length]=ce("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:r[d][0]})})};return i("workbooks"),o("sheets"),o("charts"),l("themes"),["strs","styles"].forEach(i),["coreprops","extprops","custprops"].forEach(l),l("vba"),l("comments"),l("threadedcomments"),l("drawings"),o("metadata"),l("people"),s.length>2&&(s[s.length]="</Types>",s[1]=s[1].replace("/>",">")),s.join("")}var Ue={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function O0(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Wa(e){var t=[ut,ce("Relationships",null,{xmlns:xt.RELS})];return Ft(e["!id"]).forEach(function(r){t[t.length]=ce("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function qe(e,t,r,s,n,i){if(n||(n={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,n.Id="rId"+t,n.Type=s,n.Target=r,[Ue.HLINK,Ue.XPATH,Ue.XMISS].indexOf(n.Type)>-1&&(n.TargetMode="External"),e["!id"][n.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][n.Id]=n,e[("/"+n.Target).replace("//","/")]=n,t}function zw(e){var t=[ut];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function Jl(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function Vw(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function Hw(e){var t=[ut];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(Jl(e[r][0],e[r][1])),t.push(Vw("",e[r][0]));return t.push(Jl("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function M0(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+bn.version+"</meta:generator></office:meta></office:document-meta>"}var wa=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function _i(e,t,r,s,n){n[e]!=null||t==null||t===""||(n[e]=t,t=Xe(t),s[s.length]=r?ce(e,t,r):Tt(e,t))}function L0(e,t){var r=t||{},s=[ut,ce("cp:coreProperties",null,{"xmlns:cp":xt.CORE_PROPS,"xmlns:dc":xt.dc,"xmlns:dcterms":xt.dcterms,"xmlns:dcmitype":xt.dcmitype,"xmlns:xsi":xt.xsi})],n={};if(!e&&!r.Props)return s.join("");e&&(e.CreatedDate!=null&&_i("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:Zi(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},s,n),e.ModifiedDate!=null&&_i("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:Zi(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},s,n));for(var i=0;i!=wa.length;++i){var o=wa[i],l=r.Props&&r.Props[o[1]]!=null?r.Props[o[1]]:e?e[o[1]]:null;l===!0?l="1":l===!1?l="0":typeof l=="number"&&(l=String(l)),l!=null&&_i(o[0],l,null,s,n)}return s.length>2&&(s[s.length]="</cp:coreProperties>",s[1]=s[1].replace("/>",">")),s.join("")}var qa=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],B0=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function U0(e){var t=[],r=ce;return e||(e={}),e.Application="SheetJS",t[t.length]=ut,t[t.length]=ce("Properties",null,{xmlns:xt.EXT_PROPS,"xmlns:vt":xt.vt}),qa.forEach(function(s){if(e[s[1]]!==void 0){var n;switch(s[2]){case"string":n=Xe(String(e[s[1]]));break;case"bool":n=e[s[1]]?"true":"false";break}n!==void 0&&(t[t.length]=r(s[0],n))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(s){return"<vt:lpstr>"+Xe(s)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}function $0(e){var t=[ut,ce("Properties",null,{xmlns:xt.CUST_PROPS,"xmlns:vt":xt.vt})];if(!e)return t.join("");var r=1;return Ft(e).forEach(function(n){++r,t[t.length]=ce("property",lw(e[n]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:Xe(n)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var Ql={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function Ww(e,t){var r=[];return Ft(Ql).map(function(s){for(var n=0;n<wa.length;++n)if(wa[n][1]==s)return wa[n];for(n=0;n<qa.length;++n)if(qa[n][1]==s)return qa[n];throw s}).forEach(function(s){if(e[s[1]]!=null){var n=t&&t.Props&&t.Props[s[1]]!=null?t.Props[s[1]]:e[s[1]];switch(s[2]){case"date":n=new Date(n).toISOString().replace(/\.\d*Z/,"Z");break}typeof n=="number"?n=String(n):n===!0||n===!1?n=n?"1":"0":n instanceof Date&&(n=new Date(n).toISOString().replace(/\.\d*Z/,"")),r.push(Tt(Ql[s[1]]||s[1],n))}}),ce("DocumentProperties",r.join(""),{xmlns:er.o})}function qw(e,t){var r=["Worksheets","SheetNames"],s="CustomDocumentProperties",n=[];return e&&Ft(e).forEach(function(i){if(Object.prototype.hasOwnProperty.call(e,i)){for(var o=0;o<wa.length;++o)if(i==wa[o][1])return;for(o=0;o<qa.length;++o)if(i==qa[o][1])return;for(o=0;o<r.length;++o)if(i==r[o])return;var l=e[i],d="string";typeof l=="number"?(d="float",l=String(l)):l===!0||l===!1?(d="boolean",l=l?"1":"0"):l=String(l),n.push(ce(Bl(i),l,{"dt:dt":d}))}}),t&&Ft(t).forEach(function(i){if(Object.prototype.hasOwnProperty.call(t,i)&&!(e&&Object.prototype.hasOwnProperty.call(e,i))){var o=t[i],l="string";typeof o=="number"?(l="float",o=String(o)):o===!0||o===!1?(l="boolean",o=o?"1":"0"):o instanceof Date?(l="dateTime.tz",o=o.toISOString()):o=String(o),n.push(ce(Bl(i),o,{"dt:dt":l}))}}),"<"+s+' xmlns="'+er.o+'">'+n.join("")+"</"+s+">"}function Gw(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,s=r%Math.pow(2,32),n=(r-s)/Math.pow(2,32);s*=1e7,n*=1e7;var i=s/Math.pow(2,32)|0;i>0&&(s=s%Math.pow(2,32),n+=i);var o=te(8);return o.write_shift(4,s),o.write_shift(4,n),o}function Zl(e,t){var r=te(4),s=te(4);switch(r.write_shift(4,e==80?31:e),e){case 3:s.write_shift(-4,t);break;case 5:s=te(8),s.write_shift(8,t,"f");break;case 11:s.write_shift(4,t?1:0);break;case 64:s=Gw(t);break;case 31:case 80:for(s=te(4+2*(t.length+1)+(t.length%2?0:2)),s.write_shift(4,t.length+1),s.write_shift(0,t,"dbcs");s.l!=s.length;)s.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return Ct([r,s])}var z0=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function Xw(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function ec(e,t,r){var s=te(8),n=[],i=[],o=8,l=0,d=te(8),c=te(8);if(d.write_shift(4,2),d.write_shift(4,1200),c.write_shift(4,1),i.push(d),n.push(c),o+=8+d.length,!t){c=te(8),c.write_shift(4,0),n.unshift(c);var u=[te(4)];for(u[0].write_shift(4,e.length),l=0;l<e.length;++l){var h=e[l][0];for(d=te(8+2*(h.length+1)+(h.length%2?0:2)),d.write_shift(4,l+2),d.write_shift(4,h.length+1),d.write_shift(0,h,"dbcs");d.l!=d.length;)d.write_shift(1,0);u.push(d)}d=Ct(u),i.unshift(d),o+=8+d.length}for(l=0;l<e.length;++l)if(!(t&&!t[e[l][0]])&&!(z0.indexOf(e[l][0])>-1||B0.indexOf(e[l][0])>-1)&&e[l][1]!=null){var f=e[l][1],m=0;if(t){m=+t[e[l][0]];var v=r[m];if(v.p=="version"&&typeof f=="string"){var g=f.split(".");f=(+g[0]<<16)+(+g[1]||0)}d=Zl(v.t,f)}else{var x=Xw(f);x==-1&&(x=31,f=String(f)),d=Zl(x,f)}i.push(d),c=te(8),c.write_shift(4,t?m:2+l),n.push(c),o+=8+d.length}var b=8*(i.length+1);for(l=0;l<i.length;++l)n[l].write_shift(4,b),b+=i[l].length;return s.write_shift(4,o),s.write_shift(4,i.length),Ct([s].concat(n).concat(i))}function tc(e,t,r,s,n,i){var o=te(n?68:48),l=[o];o.write_shift(2,65534),o.write_shift(2,0),o.write_shift(4,842412599),o.write_shift(16,Ye.utils.consts.HEADER_CLSID,"hex"),o.write_shift(4,n?2:1),o.write_shift(16,t,"hex"),o.write_shift(4,n?68:48);var d=ec(e,r,s);if(l.push(d),n){var c=ec(n,null,null);o.write_shift(16,i,"hex"),o.write_shift(4,68+d.length),l.push(c)}return Ct(l)}function Kw(e,t){t||(t=te(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function Yw(e,t){return e.read_shift(t)===1}function $t(e,t){return t||(t=te(2)),t.write_shift(2,+!!e),t}function V0(e){return e.read_shift(2,"u")}function dr(e,t){return t||(t=te(2)),t.write_shift(2,e),t}function H0(e,t,r){return r||(r=te(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function W0(e,t,r){var s=e.read_shift(r&&r.biff>=12?2:1),n="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var i=e.read_shift(1);i&&(n="dbcs-cont")}else r.biff==12&&(n="wstr");r.biff>=2&&r.biff<=5&&(n="cpstr");var o=s?e.read_shift(s,n):"";return o}function Jw(e){var t=e.t||"",r=te(3);r.write_shift(2,t.length),r.write_shift(1,1);var s=te(2*t.length);s.write_shift(2*t.length,t,"utf16le");var n=[r,s];return Ct(n)}function Qw(e,t,r){var s;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var n=e.read_shift(1);return n===0?s=e.read_shift(t,"sbcs-cont"):s=e.read_shift(t,"dbcs-cont"),s}function Zw(e,t,r){var s=e.read_shift(r&&r.biff==2?1:2);return s===0?(e.l++,""):Qw(e,s,r)}function e2(e,t,r){if(r.biff>5)return Zw(e,t,r);var s=e.read_shift(1);return s===0?(e.l++,""):e.read_shift(s,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function q0(e,t,r){return r||(r=te(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function rc(e,t){t||(t=te(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function t2(e){var t=te(512),r=0,s=e.Target;s.slice(0,7)=="file://"&&(s=s.slice(7));var n=s.indexOf("#"),i=n>-1?31:23;switch(s.charAt(0)){case"#":i=28;break;case".":i&=-3;break}t.write_shift(4,2),t.write_shift(4,i);var o=[8,6815827,6619237,4849780,83];for(r=0;r<o.length;++r)t.write_shift(4,o[r]);if(i==28)s=s.slice(1),rc(s,t);else if(i&2){for(o="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<o.length;++r)t.write_shift(1,parseInt(o[r],16));var l=n>-1?s.slice(0,n):s;for(t.write_shift(4,2*(l.length+1)),r=0;r<l.length;++r)t.write_shift(2,l.charCodeAt(r));t.write_shift(2,0),i&8&&rc(n>-1?s.slice(n+1):"",t)}else{for(o="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<o.length;++r)t.write_shift(1,parseInt(o[r],16));for(var d=0;s.slice(d*3,d*3+3)=="../"||s.slice(d*3,d*3+3)=="..\\";)++d;for(t.write_shift(2,d),t.write_shift(4,s.length-3*d+1),r=0;r<s.length-3*d;++r)t.write_shift(1,s.charCodeAt(r+3*d)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function Ea(e,t,r,s){return s||(s=te(6)),s.write_shift(2,e),s.write_shift(2,t),s.write_shift(2,r||0),s}function r2(e,t,r){var s=r.biff>8?4:2,n=e.read_shift(s),i=e.read_shift(s,"i"),o=e.read_shift(s,"i");return[n,i,o]}function a2(e){var t=e.read_shift(2),r=e.read_shift(2),s=e.read_shift(2),n=e.read_shift(2);return{s:{c:s,r:t},e:{c:n,r}}}function G0(e,t){return t||(t=te(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function Go(e,t,r){var s=1536,n=16;switch(r.bookType){case"biff8":break;case"biff5":s=1280,n=8;break;case"biff4":s=4,n=6;break;case"biff3":s=3,n=6;break;case"biff2":s=2,n=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var i=te(n);return i.write_shift(2,s),i.write_shift(2,t),n>4&&i.write_shift(2,29282),n>6&&i.write_shift(2,1997),n>8&&(i.write_shift(2,49161),i.write_shift(2,1),i.write_shift(2,1798),i.write_shift(2,0)),i}function s2(e,t){var r=!t||t.biff==8,s=te(r?112:54);for(s.write_shift(t.biff==8?2:1,7),r&&s.write_shift(1,0),s.write_shift(4,859007059),s.write_shift(4,5458548|(r?0:536870912));s.l<s.length;)s.write_shift(1,r?0:32);return s}function n2(e,t){var r=!t||t.biff>=8?2:1,s=te(8+r*e.name.length);s.write_shift(4,e.pos),s.write_shift(1,e.hs||0),s.write_shift(1,e.dt),s.write_shift(1,e.name.length),t.biff>=8&&s.write_shift(1,1),s.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var n=s.slice(0,s.l);return n.l=s.l,n}function i2(e,t){var r=te(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var s=[],n=0;n<e.length;++n)s[n]=Jw(e[n]);var i=Ct([r].concat(s));return i.parts=[r.length].concat(s.map(function(o){return o.length})),i}function o2(){var e=te(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function l2(e){var t=te(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function c2(e,t){var r=e.name||"Arial",s=t&&t.biff==5,n=s?15+r.length:16+2*r.length,i=te(n);return i.write_shift(2,e.sz*20),i.write_shift(4,0),i.write_shift(2,400),i.write_shift(4,0),i.write_shift(2,0),i.write_shift(1,r.length),s||i.write_shift(1,1),i.write_shift((s?1:2)*r.length,r,s?"sbcs":"utf16le"),i}function d2(e,t,r,s){var n=te(10);return Ea(e,t,s,n),n.write_shift(4,r),n}function u2(e,t,r,s,n){var i=!n||n.biff==8,o=te(8+ +i+(1+i)*r.length);return Ea(e,t,s,o),o.write_shift(2,r.length),i&&o.write_shift(1,1),o.write_shift((1+i)*r.length,r,i?"utf16le":"sbcs"),o}function h2(e,t,r,s){var n=r&&r.biff==5;s||(s=te(n?3+t.length:5+2*t.length)),s.write_shift(2,e),s.write_shift(n?1:2,t.length),n||s.write_shift(1,1),s.write_shift((n?1:2)*t.length,t,n?"sbcs":"utf16le");var i=s.length>s.l?s.slice(0,s.l):s;return i.l==null&&(i.l=i.length),i}function f2(e,t){var r=t.biff==8||!t.biff?4:2,s=te(2*r+6);return s.write_shift(r,e.s.r),s.write_shift(r,e.e.r+1),s.write_shift(2,e.s.c),s.write_shift(2,e.e.c+1),s.write_shift(2,0),s}function ac(e,t,r,s){var n=r&&r.biff==5;s||(s=te(n?16:20)),s.write_shift(2,0),e.style?(s.write_shift(2,e.numFmtId||0),s.write_shift(2,65524)):(s.write_shift(2,e.numFmtId||0),s.write_shift(2,t<<4));var i=0;return e.numFmtId>0&&n&&(i|=1024),s.write_shift(4,i),s.write_shift(4,0),n||s.write_shift(4,0),s.write_shift(2,0),s}function m2(e){var t=te(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function x2(e,t,r,s,n,i){var o=te(8);return Ea(e,t,s,o),H0(r,i,o),o}function g2(e,t,r,s){var n=te(14);return Ea(e,t,s,n),ja(r,n),n}function p2(e,t,r){if(r.biff<8)return v2(e,t,r);for(var s=[],n=e.l+t,i=e.read_shift(r.biff>8?4:2);i--!==0;)s.push(r2(e,r.biff>8?12:6,r));if(e.l!=n)throw new Error("Bad ExternSheet: "+e.l+" != "+n);return s}function v2(e,t,r){e[e.l+1]==3&&e[e.l]++;var s=W0(e,t,r);return s.charCodeAt(0)==3?s.slice(1):s}function w2(e){var t=te(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)G0(e[r],t);return t}function b2(e){var t=te(24),r=wt(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var s="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),n=0;n<16;++n)t.write_shift(1,parseInt(s[n],16));return Ct([t,t2(e[1])])}function y2(e){var t=e[1].Tooltip,r=te(10+2*(t.length+1));r.write_shift(2,2048);var s=wt(e[0]);r.write_shift(2,s.r),r.write_shift(2,s.r),r.write_shift(2,s.c),r.write_shift(2,s.c);for(var n=0;n<t.length;++n)r.write_shift(2,t.charCodeAt(n));return r.write_shift(2,0),r}function N2(e){return e||(e=te(4)),e.write_shift(2,1),e.write_shift(2,1),e}function j2(e,t,r){if(!r.cellStyles)return Lr(e,t);var s=r&&r.biff>=12?4:2,n=e.read_shift(s),i=e.read_shift(s),o=e.read_shift(s),l=e.read_shift(s),d=e.read_shift(2);s==2&&(e.l+=2);var c={s:n,e:i,w:o,ixfe:l,flags:d};return(r.biff>=5||!r.biff)&&(c.level=d>>8&7),c}function E2(e,t){var r=te(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var s=0;return e.hidden&&(s|=1),r.write_shift(1,s),s=e.level||0,r.write_shift(1,s),r.write_shift(2,0),r}function _2(e){for(var t=te(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}function S2(e,t,r){var s=te(15);return Xs(s,e,t),s.write_shift(8,r,"f"),s}function C2(e,t,r){var s=te(9);return Xs(s,e,t),s.write_shift(2,r),s}var T2=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=Oo({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(l,d){var c=[],u=Na(1);switch(d.type){case"base64":u=br(Yr(l));break;case"binary":u=br(l);break;case"buffer":case"array":u=l;break}Zt(u,0);var h=u.read_shift(1),f=!!(h&136),m=!1,v=!1;switch(h){case 2:break;case 3:break;case 48:m=!0,f=!0;break;case 49:m=!0,f=!0;break;case 131:break;case 139:break;case 140:v=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+h.toString(16))}var g=0,x=521;h==2&&(g=u.read_shift(2)),u.l+=3,h!=2&&(g=u.read_shift(4)),g>1048576&&(g=1e6),h!=2&&(x=u.read_shift(2));var b=u.read_shift(2),N=d.codepage||1252;h!=2&&(u.l+=16,u.read_shift(1),u[u.l]!==0&&(N=e[u[u.l]]),u.l+=1,u.l+=2),v&&(u.l+=36);for(var y=[],A={},B=Math.min(u.length,h==2?521:x-10-(m?264:0)),W=v?32:11;u.l<B&&u[u.l]!=13;)switch(A={},A.name=yn.utils.decode(N,u.slice(u.l,u.l+W)).replace(/[\u0000\r\n].*$/g,""),u.l+=W,A.type=String.fromCharCode(u.read_shift(1)),h!=2&&!v&&(A.offset=u.read_shift(4)),A.len=u.read_shift(1),h==2&&(A.offset=u.read_shift(2)),A.dec=u.read_shift(1),A.name.length&&y.push(A),h!=2&&(u.l+=v?13:14),A.type){case"B":(!m||A.len!=8)&&d.WTF&&console.log("Skipping "+A.name+":"+A.type);break;case"G":case"P":d.WTF&&console.log("Skipping "+A.name+":"+A.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+A.type)}if(u[u.l]!==13&&(u.l=x-1),u.read_shift(1)!==13)throw new Error("DBF Terminator not found "+u.l+" "+u[u.l]);u.l=x;var C=0,L=0;for(c[0]=[],L=0;L!=y.length;++L)c[0][L]=y[L].name;for(;g-- >0;){if(u[u.l]===42){u.l+=b;continue}for(++u.l,c[++C]=[],L=0,L=0;L!=y.length;++L){var T=u.slice(u.l,u.l+y[L].len);u.l+=y[L].len,Zt(T,0);var P=yn.utils.decode(N,T);switch(y[L].type){case"C":P.trim().length&&(c[C][L]=P.replace(/\s+$/,""));break;case"D":P.length===8?c[C][L]=new Date(+P.slice(0,4),+P.slice(4,6)-1,+P.slice(6,8)):c[C][L]=P;break;case"F":c[C][L]=parseFloat(P.trim());break;case"+":case"I":c[C][L]=v?T.read_shift(-4,"i")^2147483648:T.read_shift(4,"i");break;case"L":switch(P.trim().toUpperCase()){case"Y":case"T":c[C][L]=!0;break;case"N":case"F":c[C][L]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+P+"|")}break;case"M":if(!f)throw new Error("DBF Unexpected MEMO for type "+h.toString(16));c[C][L]="##MEMO##"+(v?parseInt(P.trim(),10):T.read_shift(4));break;case"N":P=P.replace(/\u0000/g,"").trim(),P&&P!="."&&(c[C][L]=+P||0);break;case"@":c[C][L]=new Date(T.read_shift(-8,"f")-621356832e5);break;case"T":c[C][L]=new Date((T.read_shift(4)-2440588)*864e5+T.read_shift(4));break;case"Y":c[C][L]=T.read_shift(4,"i")/1e4+T.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":c[C][L]=-T.read_shift(-8,"f");break;case"B":if(m&&y[L].len==8){c[C][L]=T.read_shift(8,"f");break}case"G":case"P":T.l+=y[L].len;break;case"0":if(y[L].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+y[L].type)}}}if(h!=2&&u.l<u.length&&u[u.l++]!=26)throw new Error("DBF EOF Marker missing "+(u.l-1)+" of "+u.length+" "+u[u.l-1].toString(16));return d&&d.sheetRows&&(c=c.slice(0,d.sheetRows)),d.DBF=y,c}function s(l,d){var c=d||{};c.dateNF||(c.dateNF="yyyymmdd");var u=rs(r(l,c),c);return u["!cols"]=c.DBF.map(function(h){return{wch:h.len,DBF:h}}),delete c.DBF,u}function n(l,d){try{return Ca(s(l,d),d)}catch(c){if(d&&d.WTF)throw c}return{SheetNames:[],Sheets:{}}}var i={B:8,C:250,L:1,D:8,"?":0,"":0};function o(l,d){var c=d||{};if(+c.codepage>=0&&Fs(+c.codepage),c.type=="string")throw new Error("Cannot write DBF to JS string");var u=Kt(),h=Pn(l,{header:1,raw:!0,cellDates:!0}),f=h[0],m=h.slice(1),v=l["!cols"]||[],g=0,x=0,b=0,N=1;for(g=0;g<f.length;++g){if(((v[g]||{}).DBF||{}).name){f[g]=v[g].DBF.name,++b;continue}if(f[g]!=null){if(++b,typeof f[g]=="number"&&(f[g]=f[g].toString(10)),typeof f[g]!="string")throw new Error("DBF Invalid column name "+f[g]+" |"+typeof f[g]+"|");if(f.indexOf(f[g])!==g){for(x=0;x<1024;++x)if(f.indexOf(f[g]+"_"+x)==-1){f[g]+="_"+x;break}}}}var y=Qe(l["!ref"]),A=[],B=[],W=[];for(g=0;g<=y.e.c-y.s.c;++g){var C="",L="",T=0,P=[];for(x=0;x<m.length;++x)m[x][g]!=null&&P.push(m[x][g]);if(P.length==0||f[g]==null){A[g]="?";continue}for(x=0;x<P.length;++x){switch(typeof P[x]){case"number":L="B";break;case"string":L="C";break;case"boolean":L="L";break;case"object":L=P[x]instanceof Date?"D":"C";break;default:L="C"}T=Math.max(T,String(P[x]).length),C=C&&C!=L?"C":L}T>250&&(T=250),L=((v[g]||{}).DBF||{}).type,L=="C"&&v[g].DBF.len>T&&(T=v[g].DBF.len),C=="B"&&L=="N"&&(C="N",W[g]=v[g].DBF.dec,T=v[g].DBF.len),B[g]=C=="C"||L=="N"?T:i[C]||0,N+=B[g],A[g]=C}var I=u.next(32);for(I.write_shift(4,318902576),I.write_shift(4,m.length),I.write_shift(2,296+32*b),I.write_shift(2,N),g=0;g<4;++g)I.write_shift(4,0);for(I.write_shift(4,0|(+t[Ku]||3)<<8),g=0,x=0;g<f.length;++g)if(f[g]!=null){var V=u.next(32),ae=(f[g].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);V.write_shift(1,ae,"sbcs"),V.write_shift(1,A[g]=="?"?"C":A[g],"sbcs"),V.write_shift(4,x),V.write_shift(1,B[g]||i[A[g]]||0),V.write_shift(1,W[g]||0),V.write_shift(1,2),V.write_shift(4,0),V.write_shift(1,0),V.write_shift(4,0),V.write_shift(4,0),x+=B[g]||i[A[g]]||0}var _e=u.next(264);for(_e.write_shift(4,13),g=0;g<65;++g)_e.write_shift(4,0);for(g=0;g<m.length;++g){var ve=u.next(N);for(ve.write_shift(1,0),x=0;x<f.length;++x)if(f[x]!=null)switch(A[x]){case"L":ve.write_shift(1,m[g][x]==null?63:m[g][x]?84:70);break;case"B":ve.write_shift(8,m[g][x]||0,"f");break;case"N":var we="0";for(typeof m[g][x]=="number"&&(we=m[g][x].toFixed(W[x]||0)),b=0;b<B[x]-we.length;++b)ve.write_shift(1,32);ve.write_shift(1,we,"sbcs");break;case"D":m[g][x]?(ve.write_shift(4,("0000"+m[g][x].getFullYear()).slice(-4),"sbcs"),ve.write_shift(2,("00"+(m[g][x].getMonth()+1)).slice(-2),"sbcs"),ve.write_shift(2,("00"+m[g][x].getDate()).slice(-2),"sbcs")):ve.write_shift(8,"00000000","sbcs");break;case"C":var be=String(m[g][x]!=null?m[g][x]:"").slice(0,B[x]);for(ve.write_shift(1,be,"sbcs"),b=0;b<B[x]-be.length;++b)ve.write_shift(1,32);break}}return u.next(1).write_shift(1,26),u.end()}return{to_workbook:n,to_sheet:s,from_sheet:o}}(),A2=function(){var e={AA:"À",BA:"Á",CA:"Â",DA:195,HA:"Ä",JA:197,AE:"È",BE:"É",CE:"Ê",HE:"Ë",AI:"Ì",BI:"Í",CI:"Î",HI:"Ï",AO:"Ò",BO:"Ó",CO:"Ô",DO:213,HO:"Ö",AU:"Ù",BU:"Ú",CU:"Û",HU:"Ü",Aa:"à",Ba:"á",Ca:"â",Da:227,Ha:"ä",Ja:229,Ae:"è",Be:"é",Ce:"ê",He:"ë",Ai:"ì",Bi:"í",Ci:"î",Hi:"ï",Ao:"ò",Bo:"ó",Co:"ô",Do:245,Ho:"ö",Au:"ù",Bu:"ú",Cu:"û",Hu:"ü",KC:"Ç",Kc:"ç",q:"æ",z:"œ",a:"Æ",j:"Œ",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+Ft(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(f,m){var v=e[m];return typeof v=="number"?Cl(v):v},s=function(f,m,v){var g=m.charCodeAt(0)-32<<4|v.charCodeAt(0)-48;return g==59?f:Cl(g)};e["|"]=254;function n(f,m){switch(m.type){case"base64":return i(Yr(f),m);case"binary":return i(f,m);case"buffer":return i(ze&&Buffer.isBuffer(f)?f.toString("binary"):Vs(f),m);case"array":return i(Zn(f),m)}throw new Error("Unrecognized type "+m.type)}function i(f,m){var v=f.split(/[\n\r]+/),g=-1,x=-1,b=0,N=0,y=[],A=[],B=null,W={},C=[],L=[],T=[],P=0,I;for(+m.codepage>=0&&Fs(+m.codepage);b!==v.length;++b){P=0;var V=v[b].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,s).replace(t,r),ae=V.replace(/;;/g,"\0").split(";").map(function(R){return R.replace(/\u0000/g,";")}),_e=ae[0],ve;if(V.length>0)switch(_e){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":ae[1].charAt(0)=="P"&&A.push(V.slice(3).replace(/;;/g,";"));break;case"C":var we=!1,be=!1,J=!1,Z=!1,ue=-1,me=-1;for(N=1;N<ae.length;++N)switch(ae[N].charAt(0)){case"A":break;case"X":x=parseInt(ae[N].slice(1))-1,be=!0;break;case"Y":for(g=parseInt(ae[N].slice(1))-1,be||(x=0),I=y.length;I<=g;++I)y[I]=[];break;case"K":ve=ae[N].slice(1),ve.charAt(0)==='"'?ve=ve.slice(1,ve.length-1):ve==="TRUE"?ve=!0:ve==="FALSE"?ve=!1:isNaN(qr(ve))?isNaN(Ds(ve).getDate())||(ve=Ht(ve)):(ve=qr(ve),B!==null&&o0(B)&&(ve=u0(ve))),we=!0;break;case"E":Z=!0;var k=Cb(ae[N].slice(1),{r:g,c:x});y[g][x]=[y[g][x],k];break;case"S":J=!0,y[g][x]=[y[g][x],"S5S"];break;case"G":break;case"R":ue=parseInt(ae[N].slice(1))-1;break;case"C":me=parseInt(ae[N].slice(1))-1;break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+V)}if(we&&(y[g][x]&&y[g][x].length==2?y[g][x][0]=ve:y[g][x]=ve,B=null),J){if(Z)throw new Error("SYLK shared formula cannot have own formula");var M=ue>-1&&y[ue][me];if(!M||!M[1])throw new Error("SYLK shared formula cannot find base");y[g][x][1]=Tb(M[1],{r:g-ue,c:x-me})}break;case"F":var O=0;for(N=1;N<ae.length;++N)switch(ae[N].charAt(0)){case"X":x=parseInt(ae[N].slice(1))-1,++O;break;case"Y":for(g=parseInt(ae[N].slice(1))-1,I=y.length;I<=g;++I)y[I]=[];break;case"M":P=parseInt(ae[N].slice(1))/20;break;case"F":break;case"G":break;case"P":B=A[parseInt(ae[N].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(T=ae[N].slice(1).split(" "),I=parseInt(T[0],10);I<=parseInt(T[1],10);++I)P=parseInt(T[2],10),L[I-1]=P===0?{hidden:!0}:{wch:P},Xo(L[I-1]);break;case"C":x=parseInt(ae[N].slice(1))-1,L[x]||(L[x]={});break;case"R":g=parseInt(ae[N].slice(1))-1,C[g]||(C[g]={}),P>0?(C[g].hpt=P,C[g].hpx=Q0(P)):P===0&&(C[g].hidden=!0);break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+V)}O<1&&(B=null);break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+V)}}return C.length>0&&(W["!rows"]=C),L.length>0&&(W["!cols"]=L),m&&m.sheetRows&&(y=y.slice(0,m.sheetRows)),[y,W]}function o(f,m){var v=n(f,m),g=v[0],x=v[1],b=rs(g,m);return Ft(x).forEach(function(N){b[N]=x[N]}),b}function l(f,m){return Ca(o(f,m),m)}function d(f,m,v,g){var x="C;Y"+(v+1)+";X"+(g+1)+";K";switch(f.t){case"n":x+=f.v||0,f.f&&!f.F&&(x+=";E"+Yo(f.f,{r:v,c:g}));break;case"b":x+=f.v?"TRUE":"FALSE";break;case"e":x+=f.w||f.v;break;case"d":x+='"'+(f.w||f.v)+'"';break;case"s":x+='"'+f.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return x}function c(f,m){m.forEach(function(v,g){var x="F;W"+(g+1)+" "+(g+1)+" ";v.hidden?x+="0":(typeof v.width=="number"&&!v.wpx&&(v.wpx=Rn(v.width)),typeof v.wpx=="number"&&!v.wch&&(v.wch=Fn(v.wpx)),typeof v.wch=="number"&&(x+=Math.round(v.wch))),x.charAt(x.length-1)!=" "&&f.push(x)})}function u(f,m){m.forEach(function(v,g){var x="F;";v.hidden?x+="M0;":v.hpt?x+="M"+20*v.hpt+";":v.hpx&&(x+="M"+20*kn(v.hpx)+";"),x.length>2&&f.push(x+"R"+(g+1))})}function h(f,m){var v=["ID;PWXL;N;E"],g=[],x=Qe(f["!ref"]),b,N=Array.isArray(f),y=`\r
`;v.push("P;PGeneral"),v.push("F;P0;DG0G8;M255"),f["!cols"]&&c(v,f["!cols"]),f["!rows"]&&u(v,f["!rows"]),v.push("B;Y"+(x.e.r-x.s.r+1)+";X"+(x.e.c-x.s.c+1)+";D"+[x.s.c,x.s.r,x.e.c,x.e.r].join(" "));for(var A=x.s.r;A<=x.e.r;++A)for(var B=x.s.c;B<=x.e.c;++B){var W=Ke({r:A,c:B});b=N?(f[A]||[])[B]:f[W],!(!b||b.v==null&&(!b.f||b.F))&&g.push(d(b,f,A,B))}return v.join(y)+y+g.join(y)+y+"E"+y}return{to_workbook:l,to_sheet:o,from_sheet:h}}(),R2=function(){function e(i,o){switch(o.type){case"base64":return t(Yr(i),o);case"binary":return t(i,o);case"buffer":return t(ze&&Buffer.isBuffer(i)?i.toString("binary"):Vs(i),o);case"array":return t(Zn(i),o)}throw new Error("Unrecognized type "+o.type)}function t(i,o){for(var l=i.split(`
`),d=-1,c=-1,u=0,h=[];u!==l.length;++u){if(l[u].trim()==="BOT"){h[++d]=[],c=0;continue}if(!(d<0)){var f=l[u].trim().split(","),m=f[0],v=f[1];++u;for(var g=l[u]||"";(g.match(/["]/g)||[]).length&1&&u<l.length-1;)g+=`
`+l[++u];switch(g=g.trim(),+m){case-1:if(g==="BOT"){h[++d]=[],c=0;continue}else if(g!=="EOD")throw new Error("Unrecognized DIF special command "+g);break;case 0:g==="TRUE"?h[d][c]=!0:g==="FALSE"?h[d][c]=!1:isNaN(qr(v))?isNaN(Ds(v).getDate())?h[d][c]=v:h[d][c]=Ht(v):h[d][c]=qr(v),++c;break;case 1:g=g.slice(1,g.length-1),g=g.replace(/""/g,'"'),g&&g.match(/^=".*"$/)&&(g=g.slice(2,-1)),h[d][c++]=g!==""?g:null;break}if(g==="EOD")break}}return o&&o.sheetRows&&(h=h.slice(0,o.sheetRows)),h}function r(i,o){return rs(e(i,o),o)}function s(i,o){return Ca(r(i,o),o)}var n=function(){var i=function(d,c,u,h,f){d.push(c),d.push(u+","+h),d.push('"'+f.replace(/"/g,'""')+'"')},o=function(d,c,u,h){d.push(c+","+u),d.push(c==1?'"'+h.replace(/"/g,'""')+'"':h)};return function(d){var c=[],u=Qe(d["!ref"]),h,f=Array.isArray(d);i(c,"TABLE",0,1,"sheetjs"),i(c,"VECTORS",0,u.e.r-u.s.r+1,""),i(c,"TUPLES",0,u.e.c-u.s.c+1,""),i(c,"DATA",0,0,"");for(var m=u.s.r;m<=u.e.r;++m){o(c,-1,0,"BOT");for(var v=u.s.c;v<=u.e.c;++v){var g=Ke({r:m,c:v});if(h=f?(d[m]||[])[v]:d[g],!h){o(c,1,0,"");continue}switch(h.t){case"n":var x=h.w;!x&&h.v!=null&&(x=h.v),x==null?h.f&&!h.F?o(c,1,0,"="+h.f):o(c,1,0,""):o(c,0,x,"V");break;case"b":o(c,0,h.v?1:0,h.v?"TRUE":"FALSE");break;case"s":o(c,1,0,isNaN(h.v)?h.v:'="'+h.v+'"');break;case"d":h.w||(h.w=da(h.z||st[14],Yt(Ht(h.v)))),o(c,0,h.w,"V");break;default:o(c,1,0,"")}}}o(c,-1,0,"EOD");var b=`\r
`,N=c.join(b);return N}}();return{to_workbook:s,to_sheet:r,from_sheet:n}}(),X0=function(){function e(h){return h.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(h){return h.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(h,f){for(var m=h.split(`
`),v=-1,g=-1,x=0,b=[];x!==m.length;++x){var N=m[x].trim().split(":");if(N[0]==="cell"){var y=wt(N[1]);if(b.length<=y.r)for(v=b.length;v<=y.r;++v)b[v]||(b[v]=[]);switch(v=y.r,g=y.c,N[2]){case"t":b[v][g]=e(N[3]);break;case"v":b[v][g]=+N[3];break;case"vtf":var A=N[N.length-1];case"vtc":switch(N[3]){case"nl":b[v][g]=!!+N[4];break;default:b[v][g]=+N[4];break}N[2]=="vtf"&&(b[v][g]=[b[v][g],A])}}}return f&&f.sheetRows&&(b=b.slice(0,f.sheetRows)),b}function s(h,f){return rs(r(h,f),f)}function n(h,f){return Ca(s(h,f),f)}var i=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,l=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),d="--SocialCalcSpreadsheetControlSave--";function c(h){if(!h||!h["!ref"])return"";for(var f=[],m=[],v,g="",x=sr(h["!ref"]),b=Array.isArray(h),N=x.s.r;N<=x.e.r;++N)for(var y=x.s.c;y<=x.e.c;++y)if(g=Ke({r:N,c:y}),v=b?(h[N]||[])[y]:h[g],!(!v||v.v==null||v.t==="z")){switch(m=["cell",g,"t"],v.t){case"s":case"str":m.push(t(v.v));break;case"n":v.f?(m[2]="vtf",m[3]="n",m[4]=v.v,m[5]=t(v.f)):(m[2]="v",m[3]=v.v);break;case"b":m[2]="vt"+(v.f?"f":"c"),m[3]="nl",m[4]=v.v?"1":"0",m[5]=t(v.f||(v.v?"TRUE":"FALSE"));break;case"d":var A=Yt(Ht(v.v));m[2]="vtc",m[3]="nd",m[4]=""+A,m[5]=v.w||da(v.z||st[14],A);break;case"e":continue}f.push(m.join(":"))}return f.push("sheet:c:"+(x.e.c-x.s.c+1)+":r:"+(x.e.r-x.s.r+1)+":tvf:1"),f.push("valueformat:1:text-wiki"),f.join(`
`)}function u(h){return[i,o,l,o,c(h),d].join(`
`)}return{to_workbook:n,to_sheet:s,from_sheet:u}}(),F2=function(){function e(u,h,f,m,v){v.raw?h[f][m]=u:u===""||(u==="TRUE"?h[f][m]=!0:u==="FALSE"?h[f][m]=!1:isNaN(qr(u))?isNaN(Ds(u).getDate())?h[f][m]=u:h[f][m]=Ht(u):h[f][m]=qr(u))}function t(u,h){var f=h||{},m=[];if(!u||u.length===0)return m;for(var v=u.split(/[\r\n]/),g=v.length-1;g>=0&&v[g].length===0;)--g;for(var x=10,b=0,N=0;N<=g;++N)b=v[N].indexOf(" "),b==-1?b=v[N].length:b++,x=Math.max(x,b);for(N=0;N<=g;++N){m[N]=[];var y=0;for(e(v[N].slice(0,x).trim(),m,N,y,f),y=1;y<=(v[N].length-x)/10+1;++y)e(v[N].slice(x+(y-1)*10,x+y*10).trim(),m,N,y,f)}return f.sheetRows&&(m=m.slice(0,f.sheetRows)),m}var r={44:",",9:"	",59:";",124:"|"},s={44:3,9:2,59:1,124:0};function n(u){for(var h={},f=!1,m=0,v=0;m<u.length;++m)(v=u.charCodeAt(m))==34?f=!f:!f&&v in r&&(h[v]=(h[v]||0)+1);v=[];for(m in h)Object.prototype.hasOwnProperty.call(h,m)&&v.push([h[m],m]);if(!v.length){h=s;for(m in h)Object.prototype.hasOwnProperty.call(h,m)&&v.push([h[m],m])}return v.sort(function(g,x){return g[0]-x[0]||s[g[1]]-s[x[1]]}),r[v.pop()[1]]||44}function i(u,h){var f=h||{},m="",v=f.dense?[]:{},g={s:{c:0,r:0},e:{c:0,r:0}};u.slice(0,4)=="sep="?u.charCodeAt(5)==13&&u.charCodeAt(6)==10?(m=u.charAt(4),u=u.slice(7)):u.charCodeAt(5)==13||u.charCodeAt(5)==10?(m=u.charAt(4),u=u.slice(6)):m=n(u.slice(0,1024)):f&&f.FS?m=f.FS:m=n(u.slice(0,1024));var x=0,b=0,N=0,y=0,A=0,B=m.charCodeAt(0),W=!1,C=0,L=u.charCodeAt(0);u=u.replace(/\r\n/mg,`
`);var T=f.dateNF!=null?G1(f.dateNF):null;function P(){var I=u.slice(y,A),V={};if(I.charAt(0)=='"'&&I.charAt(I.length-1)=='"'&&(I=I.slice(1,-1).replace(/""/g,'"')),I.length===0)V.t="z";else if(f.raw)V.t="s",V.v=I;else if(I.trim().length===0)V.t="s",V.v=I;else if(I.charCodeAt(0)==61)I.charCodeAt(1)==34&&I.charCodeAt(I.length-1)==34?(V.t="s",V.v=I.slice(2,-1).replace(/""/g,'"')):Ab(I)?(V.t="n",V.f=I.slice(1)):(V.t="s",V.v=I);else if(I=="TRUE")V.t="b",V.v=!0;else if(I=="FALSE")V.t="b",V.v=!1;else if(!isNaN(N=qr(I)))V.t="n",f.cellText!==!1&&(V.w=I),V.v=N;else if(!isNaN(Ds(I).getDate())||T&&I.match(T)){V.z=f.dateNF||st[14];var ae=0;T&&I.match(T)&&(I=X1(I,f.dateNF,I.match(T)||[]),ae=1),f.cellDates?(V.t="d",V.v=Ht(I,ae)):(V.t="n",V.v=Yt(Ht(I,ae))),f.cellText!==!1&&(V.w=da(V.z,V.v instanceof Date?Yt(V.v):V.v)),f.cellNF||delete V.z}else V.t="s",V.v=I;if(V.t=="z"||(f.dense?(v[x]||(v[x]=[]),v[x][b]=V):v[Ke({c:b,r:x})]=V),y=A+1,L=u.charCodeAt(y),g.e.c<b&&(g.e.c=b),g.e.r<x&&(g.e.r=x),C==B)++b;else if(b=0,++x,f.sheetRows&&f.sheetRows<=x)return!0}e:for(;A<u.length;++A)switch(C=u.charCodeAt(A)){case 34:L===34&&(W=!W);break;case B:case 10:case 13:if(!W&&P())break e;break}return A-y>0&&P(),v["!ref"]=dt(g),v}function o(u,h){return!(h&&h.PRN)||h.FS||u.slice(0,4)=="sep="||u.indexOf("	")>=0||u.indexOf(",")>=0||u.indexOf(";")>=0?i(u,h):rs(t(u,h),h)}function l(u,h){var f="",m=h.type=="string"?[0,0,0,0]:VE(u,h);switch(h.type){case"base64":f=Yr(u);break;case"binary":f=u;break;case"buffer":h.codepage==65001?f=u.toString("utf8"):h.codepage&&typeof yn<"u"||(f=ze&&Buffer.isBuffer(u)?u.toString("binary"):Vs(u));break;case"array":f=Zn(u);break;case"string":f=u;break;default:throw new Error("Unrecognized type "+h.type)}return m[0]==239&&m[1]==187&&m[2]==191?f=gs(f.slice(3)):h.type!="string"&&h.type!="buffer"&&h.codepage==65001?f=gs(f):h.type=="binary"&&typeof yn<"u",f.slice(0,19)=="socialcalc:version:"?X0.to_sheet(h.type=="string"?f:gs(f),h):o(f,h)}function d(u,h){return Ca(l(u,h),h)}function c(u){for(var h=[],f=Qe(u["!ref"]),m,v=Array.isArray(u),g=f.s.r;g<=f.e.r;++g){for(var x=[],b=f.s.c;b<=f.e.c;++b){var N=Ke({r:g,c:b});if(m=v?(u[g]||[])[b]:u[N],!m||m.v==null){x.push("          ");continue}for(var y=(m.w||(Jr(m),m.w)||"").slice(0,10);y.length<10;)y+=" ";x.push(y+(b===0?" ":""))}h.push(x.join(""))}return h.join(`
`)}return{to_workbook:d,to_sheet:l,from_sheet:c}}(),sc=function(){function e(k,M,O){if(k){Zt(k,k.l||0);for(var R=O.Enum||ue;k.l<k.length;){var q=k.read_shift(2),z=R[q]||R[65535],D=k.read_shift(2),G=k.l+D,ee=z.f&&z.f(k,D,O);if(k.l=G,M(ee,z,q))return}}}function t(k,M){switch(M.type){case"base64":return r(br(Yr(k)),M);case"binary":return r(br(k),M);case"buffer":case"array":return r(k,M)}throw"Unsupported type "+M.type}function r(k,M){if(!k)return k;var O=M||{},R=O.dense?[]:{},q="Sheet1",z="",D=0,G={},ee=[],ge=[],Te={s:{r:0,c:0},e:{r:0,c:0}},Me=O.sheetRows||0;if(k[2]==0&&(k[3]==8||k[3]==9)&&k.length>=16&&k[14]==5&&k[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(k[2]==2)O.Enum=ue,e(k,function(ye,mt,yt){switch(yt){case 0:O.vers=ye,ye>=4096&&(O.qpro=!0);break;case 6:Te=ye;break;case 204:ye&&(z=ye);break;case 222:z=ye;break;case 15:case 51:O.qpro||(ye[1].v=ye[1].v.slice(1));case 13:case 14:case 16:yt==14&&(ye[2]&112)==112&&(ye[2]&15)>1&&(ye[2]&15)<15&&(ye[1].z=O.dateNF||st[14],O.cellDates&&(ye[1].t="d",ye[1].v=u0(ye[1].v))),O.qpro&&ye[3]>D&&(R["!ref"]=dt(Te),G[q]=R,ee.push(q),R=O.dense?[]:{},Te={s:{r:0,c:0},e:{r:0,c:0}},D=ye[3],q=z||"Sheet"+(D+1),z="");var xr=O.dense?(R[ye[0].r]||[])[ye[0].c]:R[Ke(ye[0])];if(xr){xr.t=ye[1].t,xr.v=ye[1].v,ye[1].z!=null&&(xr.z=ye[1].z),ye[1].f!=null&&(xr.f=ye[1].f);break}O.dense?(R[ye[0].r]||(R[ye[0].r]=[]),R[ye[0].r][ye[0].c]=ye[1]):R[Ke(ye[0])]=ye[1];break}},O);else if(k[2]==26||k[2]==14)O.Enum=me,k[2]==14&&(O.qpro=!0,k.l=0),e(k,function(ye,mt,yt){switch(yt){case 204:q=ye;break;case 22:ye[1].v=ye[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(ye[3]>D&&(R["!ref"]=dt(Te),G[q]=R,ee.push(q),R=O.dense?[]:{},Te={s:{r:0,c:0},e:{r:0,c:0}},D=ye[3],q="Sheet"+(D+1)),Me>0&&ye[0].r>=Me)break;O.dense?(R[ye[0].r]||(R[ye[0].r]=[]),R[ye[0].r][ye[0].c]=ye[1]):R[Ke(ye[0])]=ye[1],Te.e.c<ye[0].c&&(Te.e.c=ye[0].c),Te.e.r<ye[0].r&&(Te.e.r=ye[0].r);break;case 27:ye[14e3]&&(ge[ye[14e3][0]]=ye[14e3][1]);break;case 1537:ge[ye[0]]=ye[1],ye[0]==D&&(q=ye[1]);break}},O);else throw new Error("Unrecognized LOTUS BOF "+k[2]);if(R["!ref"]=dt(Te),G[z||q]=R,ee.push(z||q),!ge.length)return{SheetNames:ee,Sheets:G};for(var pe={},it=[],Le=0;Le<ge.length;++Le)G[ee[Le]]?(it.push(ge[Le]||ee[Le]),pe[ge[Le]]=G[ge[Le]]||G[ee[Le]]):(it.push(ge[Le]),pe[ge[Le]]={"!ref":"A1"});return{SheetNames:it,Sheets:pe}}function s(k,M){var O=M||{};if(+O.codepage>=0&&Fs(+O.codepage),O.type=="string")throw new Error("Cannot write WK1 to JS string");var R=Kt(),q=Qe(k["!ref"]),z=Array.isArray(k),D=[];de(R,0,i(1030)),de(R,6,d(q));for(var G=Math.min(q.e.r,8191),ee=q.s.r;ee<=G;++ee)for(var ge=Rt(ee),Te=q.s.c;Te<=q.e.c;++Te){ee===q.s.r&&(D[Te]=It(Te));var Me=D[Te]+ge,pe=z?(k[ee]||[])[Te]:k[Me];if(!(!pe||pe.t=="z"))if(pe.t=="n")(pe.v|0)==pe.v&&pe.v>=-32768&&pe.v<=32767?de(R,13,m(ee,Te,pe.v)):de(R,14,g(ee,Te,pe.v));else{var it=Jr(pe);de(R,15,h(ee,Te,it.slice(0,239)))}}return de(R,1),R.end()}function n(k,M){var O=M||{};if(+O.codepage>=0&&Fs(+O.codepage),O.type=="string")throw new Error("Cannot write WK3 to JS string");var R=Kt();de(R,0,o(k));for(var q=0,z=0;q<k.SheetNames.length;++q)(k.Sheets[k.SheetNames[q]]||{})["!ref"]&&de(R,27,Z(k.SheetNames[q],z++));var D=0;for(q=0;q<k.SheetNames.length;++q){var G=k.Sheets[k.SheetNames[q]];if(!(!G||!G["!ref"])){for(var ee=Qe(G["!ref"]),ge=Array.isArray(G),Te=[],Me=Math.min(ee.e.r,8191),pe=ee.s.r;pe<=Me;++pe)for(var it=Rt(pe),Le=ee.s.c;Le<=ee.e.c;++Le){pe===ee.s.r&&(Te[Le]=It(Le));var ye=Te[Le]+it,mt=ge?(G[pe]||[])[Le]:G[ye];if(!(!mt||mt.t=="z"))if(mt.t=="n")de(R,23,P(pe,Le,D,mt.v));else{var yt=Jr(mt);de(R,22,C(pe,Le,D,yt.slice(0,239)))}}++D}}return de(R,1),R.end()}function i(k){var M=te(2);return M.write_shift(2,k),M}function o(k){var M=te(26);M.write_shift(2,4096),M.write_shift(2,4),M.write_shift(4,0);for(var O=0,R=0,q=0,z=0;z<k.SheetNames.length;++z){var D=k.SheetNames[z],G=k.Sheets[D];if(!(!G||!G["!ref"])){++q;var ee=sr(G["!ref"]);O<ee.e.r&&(O=ee.e.r),R<ee.e.c&&(R=ee.e.c)}}return O>8191&&(O=8191),M.write_shift(2,O),M.write_shift(1,q),M.write_shift(1,R),M.write_shift(2,0),M.write_shift(2,0),M.write_shift(1,1),M.write_shift(1,2),M.write_shift(4,0),M.write_shift(4,0),M}function l(k,M,O){var R={s:{c:0,r:0},e:{c:0,r:0}};return M==8&&O.qpro?(R.s.c=k.read_shift(1),k.l++,R.s.r=k.read_shift(2),R.e.c=k.read_shift(1),k.l++,R.e.r=k.read_shift(2),R):(R.s.c=k.read_shift(2),R.s.r=k.read_shift(2),M==12&&O.qpro&&(k.l+=2),R.e.c=k.read_shift(2),R.e.r=k.read_shift(2),M==12&&O.qpro&&(k.l+=2),R.s.c==65535&&(R.s.c=R.e.c=R.s.r=R.e.r=0),R)}function d(k){var M=te(8);return M.write_shift(2,k.s.c),M.write_shift(2,k.s.r),M.write_shift(2,k.e.c),M.write_shift(2,k.e.r),M}function c(k,M,O){var R=[{c:0,r:0},{t:"n",v:0},0,0];return O.qpro&&O.vers!=20768?(R[0].c=k.read_shift(1),R[3]=k.read_shift(1),R[0].r=k.read_shift(2),k.l+=2):(R[2]=k.read_shift(1),R[0].c=k.read_shift(2),R[0].r=k.read_shift(2)),R}function u(k,M,O){var R=k.l+M,q=c(k,M,O);if(q[1].t="s",O.vers==20768){k.l++;var z=k.read_shift(1);return q[1].v=k.read_shift(z,"utf8"),q}return O.qpro&&k.l++,q[1].v=k.read_shift(R-k.l,"cstr"),q}function h(k,M,O){var R=te(7+O.length);R.write_shift(1,255),R.write_shift(2,M),R.write_shift(2,k),R.write_shift(1,39);for(var q=0;q<R.length;++q){var z=O.charCodeAt(q);R.write_shift(1,z>=128?95:z)}return R.write_shift(1,0),R}function f(k,M,O){var R=c(k,M,O);return R[1].v=k.read_shift(2,"i"),R}function m(k,M,O){var R=te(7);return R.write_shift(1,255),R.write_shift(2,M),R.write_shift(2,k),R.write_shift(2,O,"i"),R}function v(k,M,O){var R=c(k,M,O);return R[1].v=k.read_shift(8,"f"),R}function g(k,M,O){var R=te(13);return R.write_shift(1,255),R.write_shift(2,M),R.write_shift(2,k),R.write_shift(8,O,"f"),R}function x(k,M,O){var R=k.l+M,q=c(k,M,O);if(q[1].v=k.read_shift(8,"f"),O.qpro)k.l=R;else{var z=k.read_shift(2);A(k.slice(k.l,k.l+z),q),k.l+=z}return q}function b(k,M,O){var R=M&32768;return M&=-32769,M=(R?k:0)+(M>=8192?M-16384:M),(R?"":"$")+(O?It(M):Rt(M))}var N={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},y=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function A(k,M){Zt(k,0);for(var O=[],R=0,q="",z="",D="",G="";k.l<k.length;){var ee=k[k.l++];switch(ee){case 0:O.push(k.read_shift(8,"f"));break;case 1:z=b(M[0].c,k.read_shift(2),!0),q=b(M[0].r,k.read_shift(2),!1),O.push(z+q);break;case 2:{var ge=b(M[0].c,k.read_shift(2),!0),Te=b(M[0].r,k.read_shift(2),!1);z=b(M[0].c,k.read_shift(2),!0),q=b(M[0].r,k.read_shift(2),!1),O.push(ge+Te+":"+z+q)}break;case 3:if(k.l<k.length){console.error("WK1 premature formula end");return}break;case 4:O.push("("+O.pop()+")");break;case 5:O.push(k.read_shift(2));break;case 6:{for(var Me="";ee=k[k.l++];)Me+=String.fromCharCode(ee);O.push('"'+Me.replace(/"/g,'""')+'"')}break;case 8:O.push("-"+O.pop());break;case 23:O.push("+"+O.pop());break;case 22:O.push("NOT("+O.pop()+")");break;case 20:case 21:G=O.pop(),D=O.pop(),O.push(["AND","OR"][ee-20]+"("+D+","+G+")");break;default:if(ee<32&&y[ee])G=O.pop(),D=O.pop(),O.push(D+y[ee]+G);else if(N[ee]){if(R=N[ee][1],R==69&&(R=k[k.l++]),R>O.length){console.error("WK1 bad formula parse 0x"+ee.toString(16)+":|"+O.join("|")+"|");return}var pe=O.slice(-R);O.length-=R,O.push(N[ee][0]+"("+pe.join(",")+")")}else return ee<=7?console.error("WK1 invalid opcode "+ee.toString(16)):ee<=24?console.error("WK1 unsupported op "+ee.toString(16)):ee<=30?console.error("WK1 invalid opcode "+ee.toString(16)):ee<=115?console.error("WK1 unsupported function opcode "+ee.toString(16)):console.error("WK1 unrecognized opcode "+ee.toString(16))}}O.length==1?M[1].f=""+O[0]:console.error("WK1 bad formula parse |"+O.join("|")+"|")}function B(k){var M=[{c:0,r:0},{t:"n",v:0},0];return M[0].r=k.read_shift(2),M[3]=k[k.l++],M[0].c=k[k.l++],M}function W(k,M){var O=B(k);return O[1].t="s",O[1].v=k.read_shift(M-4,"cstr"),O}function C(k,M,O,R){var q=te(6+R.length);q.write_shift(2,k),q.write_shift(1,O),q.write_shift(1,M),q.write_shift(1,39);for(var z=0;z<R.length;++z){var D=R.charCodeAt(z);q.write_shift(1,D>=128?95:D)}return q.write_shift(1,0),q}function L(k,M){var O=B(k);O[1].v=k.read_shift(2);var R=O[1].v>>1;if(O[1].v&1)switch(R&7){case 0:R=(R>>3)*5e3;break;case 1:R=(R>>3)*500;break;case 2:R=(R>>3)/20;break;case 3:R=(R>>3)/200;break;case 4:R=(R>>3)/2e3;break;case 5:R=(R>>3)/2e4;break;case 6:R=(R>>3)/16;break;case 7:R=(R>>3)/64;break}return O[1].v=R,O}function T(k,M){var O=B(k),R=k.read_shift(4),q=k.read_shift(4),z=k.read_shift(2);if(z==65535)return R===0&&q===3221225472?(O[1].t="e",O[1].v=15):R===0&&q===3489660928?(O[1].t="e",O[1].v=42):O[1].v=0,O;var D=z&32768;return z=(z&32767)-16446,O[1].v=(1-D*2)*(q*Math.pow(2,z+32)+R*Math.pow(2,z)),O}function P(k,M,O,R){var q=te(14);if(q.write_shift(2,k),q.write_shift(1,O),q.write_shift(1,M),R==0)return q.write_shift(4,0),q.write_shift(4,0),q.write_shift(2,65535),q;var z=0,D=0,G=0,ee=0;return R<0&&(z=1,R=-R),D=Math.log2(R)|0,R/=Math.pow(2,D-31),ee=R>>>0,ee&2147483648||(R/=2,++D,ee=R>>>0),R-=ee,ee|=2147483648,ee>>>=0,R*=Math.pow(2,32),G=R>>>0,q.write_shift(4,G),q.write_shift(4,ee),D+=16383+(z?32768:0),q.write_shift(2,D),q}function I(k,M){var O=T(k);return k.l+=M-14,O}function V(k,M){var O=B(k),R=k.read_shift(4);return O[1].v=R>>6,O}function ae(k,M){var O=B(k),R=k.read_shift(8,"f");return O[1].v=R,O}function _e(k,M){var O=ae(k);return k.l+=M-10,O}function ve(k,M){return k[k.l+M-1]==0?k.read_shift(M,"cstr"):""}function we(k,M){var O=k[k.l++];O>M-1&&(O=M-1);for(var R="";R.length<O;)R+=String.fromCharCode(k[k.l++]);return R}function be(k,M,O){if(!(!O.qpro||M<21)){var R=k.read_shift(1);k.l+=17,k.l+=1,k.l+=2;var q=k.read_shift(M-21,"cstr");return[R,q]}}function J(k,M){for(var O={},R=k.l+M;k.l<R;){var q=k.read_shift(2);if(q==14e3){for(O[q]=[0,""],O[q][0]=k.read_shift(2);k[k.l];)O[q][1]+=String.fromCharCode(k[k.l]),k.l++;k.l++}}return O}function Z(k,M){var O=te(5+k.length);O.write_shift(2,14e3),O.write_shift(2,M);for(var R=0;R<k.length;++R){var q=k.charCodeAt(R);O[O.l++]=q>127?95:q}return O[O.l++]=0,O}var ue={0:{n:"BOF",f:V0},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:l},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f},14:{n:"NUMBER",f:v},15:{n:"LABEL",f:u},16:{n:"FORMULA",f:x},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:u},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:ve},222:{n:"SHEETNAMELP",f:we},65535:{n:""}},me={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:W},23:{n:"NUMBER17",f:T},24:{n:"NUMBER18",f:L},25:{n:"FORMULA19",f:I},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:J},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:V},38:{n:"??"},39:{n:"NUMBER27",f:ae},40:{n:"FORMULA28",f:_e},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:ve},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:be},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:s,book_to_wk3:n,to_workbook:t}}(),k2=/^\s|\s$|[\t\n\r]/;function K0(e,t){if(!t.bookSST)return"";var r=[ut];r[r.length]=ce("sst",null,{xmlns:ts[0],count:e.Count,uniqueCount:e.Unique});for(var s=0;s!=e.length;++s)if(e[s]!=null){var n=e[s],i="<si>";n.r?i+=n.r:(i+="<t",n.t||(n.t=""),n.t.match(k2)&&(i+=' xml:space="preserve"'),i+=">"+Xe(n.t)+"</t>"),i+="</si>",r[r.length]=i}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function D2(e){return[e.read_shift(4),e.read_shift(4)]}function P2(e,t){return t||(t=te(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var I2=_w;function O2(e){var t=Kt();se(t,159,P2(e));for(var r=0;r<e.length;++r)se(t,19,I2(e[r]));return se(t,160),t.end()}function M2(e){for(var t=[],r=e.split(""),s=0;s<r.length;++s)t[s]=r[s].charCodeAt(0);return t}function Y0(e){var t=0,r,s=M2(e),n=s.length+1,i,o,l,d,c;for(r=Na(n),r[0]=s.length,i=1;i!=n;++i)r[i]=s[i-1];for(i=n-1;i>=0;--i)o=r[i],l=t&16384?1:0,d=t<<1&32767,c=l|d,t=c^o;return t^52811}var L2=function(){function e(n,i){switch(i.type){case"base64":return t(Yr(n),i);case"binary":return t(n,i);case"buffer":return t(ze&&Buffer.isBuffer(n)?n.toString("binary"):Vs(n),i);case"array":return t(Zn(n),i)}throw new Error("Unrecognized type "+i.type)}function t(n,i){var o=i||{},l=o.dense?[]:{},d=n.match(/\\trowd.*?\\row\b/g);if(!d.length)throw new Error("RTF missing table");var c={s:{c:0,r:0},e:{c:0,r:d.length-1}};return d.forEach(function(u,h){Array.isArray(l)&&(l[h]=[]);for(var f=/\\\w+\b/g,m=0,v,g=-1;v=f.exec(u);){switch(v[0]){case"\\cell":var x=u.slice(m,f.lastIndex-v[0].length);if(x[0]==" "&&(x=x.slice(1)),++g,x.length){var b={v:x,t:"s"};Array.isArray(l)?l[h][g]=b:l[Ke({r:h,c:g})]=b}break}m=f.lastIndex}g>c.e.c&&(c.e.c=g)}),l["!ref"]=dt(c),l}function r(n,i){return Ca(e(n,i),i)}function s(n){for(var i=["{\\rtf1\\ansi"],o=Qe(n["!ref"]),l,d=Array.isArray(n),c=o.s.r;c<=o.e.r;++c){i.push("\\trowd\\trautofit1");for(var u=o.s.c;u<=o.e.c;++u)i.push("\\cellx"+(u+1));for(i.push("\\pard\\intbl"),u=o.s.c;u<=o.e.c;++u){var h=Ke({r:c,c:u});l=d?(n[c]||[])[u]:n[h],!(!l||l.v==null&&(!l.f||l.F))&&(i.push(" "+(l.w||(Jr(l),l.w))),i.push("\\cell"))}i.push("\\pard\\intbl\\row")}return i.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:s}}();function nc(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}var B2=6,Gr=B2;function Rn(e){return Math.floor((e+Math.round(128/Gr)/256)*Gr)}function Fn(e){return Math.floor((e-5)/Gr*100+.5)/100}function to(e){return Math.round((e*Gr+5)/Gr*256)/256}function Xo(e){e.width?(e.wpx=Rn(e.width),e.wch=Fn(e.wpx),e.MDW=Gr):e.wpx?(e.wch=Fn(e.wpx),e.width=to(e.wch),e.MDW=Gr):typeof e.wch=="number"&&(e.width=to(e.wch),e.wpx=Rn(e.width),e.MDW=Gr),e.customWidth&&delete e.customWidth}var U2=96,J0=U2;function kn(e){return e*96/J0}function Q0(e){return e*J0/96}function $2(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var s=r[0];s<=r[1];++s)e[s]!=null&&(t[t.length]=ce("numFmt",null,{numFmtId:s,formatCode:Xe(e[s])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=ce("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}function z2(e){var t=[];return t[t.length]=ce("cellXfs",null),e.forEach(function(r){t[t.length]=ce("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=ce("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}function Z0(e,t){var r=[ut,ce("styleSheet",null,{xmlns:ts[0],"xmlns:vt":xt.vt})],s;return e.SSF&&(s=$2(e.SSF))!=null&&(r[r.length]=s),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(s=z2(t.cellXfs))&&(r[r.length]=s),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function V2(e,t){var r=e.read_shift(2),s=Ot(e);return[r,s]}function H2(e,t,r){r||(r=te(6+4*t.length)),r.write_shift(2,e),bt(t,r);var s=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),s}function W2(e,t,r){var s={};s.sz=e.read_shift(2)/20;var n=kw(e);n.fItalic&&(s.italic=1),n.fCondense&&(s.condense=1),n.fExtend&&(s.extend=1),n.fShadow&&(s.shadow=1),n.fOutline&&(s.outline=1),n.fStrikeout&&(s.strike=1);var i=e.read_shift(2);switch(i===700&&(s.bold=1),e.read_shift(2)){case 1:s.vertAlign="superscript";break;case 2:s.vertAlign="subscript";break}var o=e.read_shift(1);o!=0&&(s.underline=o);var l=e.read_shift(1);l>0&&(s.family=l);var d=e.read_shift(1);switch(d>0&&(s.charset=d),e.l++,s.color=Fw(e),e.read_shift(1)){case 1:s.scheme="major";break;case 2:s.scheme="minor";break}return s.name=Ot(e),s}function q2(e,t){t||(t=te(25+4*32)),t.write_shift(2,e.sz*20),Dw(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),Tn(e.color,t);var s=0;return s=2,t.write_shift(1,s),bt(e.name,t),t.length>t.l?t.slice(0,t.l):t}var G2=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Si,X2=Lr;function ic(e,t){t||(t=te(4*3+8*7+16*1)),Si||(Si=Oo(G2));var r=Si[e.patternType];r==null&&(r=40),t.write_shift(4,r);var s=0;if(r!=40)for(Tn({auto:1},t),Tn({auto:1},t);s<12;++s)t.write_shift(4,0);else{for(;s<4;++s)t.write_shift(4,0);for(;s<12;++s)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function K2(e,t){var r=e.l+t,s=e.read_shift(2),n=e.read_shift(2);return e.l=r,{ixfe:s,numFmtId:n}}function eh(e,t,r){r||(r=te(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var s=0;return r.write_shift(1,s),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function ds(e,t){return t||(t=te(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var Y2=Lr;function J2(e,t){return t||(t=te(51)),t.write_shift(1,0),ds(null,t),ds(null,t),ds(null,t),ds(null,t),ds(null,t),t.length>t.l?t.slice(0,t.l):t}function Q2(e,t){return t||(t=te(12+4*10)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),Cn(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function Z2(e,t,r){var s=te(2052);return s.write_shift(4,e),Cn(t,s),Cn(r,s),s.length>s.l?s.slice(0,s.l):s}function eb(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(s){for(var n=s[0];n<=s[1];++n)t[n]!=null&&++r}),r!=0&&(se(e,615,Er(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(s){for(var n=s[0];n<=s[1];++n)t[n]!=null&&se(e,44,H2(n,t[n]))}),se(e,616))}}function tb(e){var t=1;se(e,611,Er(t)),se(e,43,q2({sz:12,color:{theme:1},name:"Calibri",family:2})),se(e,612)}function rb(e){var t=2;se(e,603,Er(t)),se(e,45,ic({patternType:"none"})),se(e,45,ic({patternType:"gray125"})),se(e,604)}function ab(e){var t=1;se(e,613,Er(t)),se(e,46,J2()),se(e,614)}function sb(e){var t=1;se(e,626,Er(t)),se(e,47,eh({numFmtId:0},65535)),se(e,627)}function nb(e,t){se(e,617,Er(t.length)),t.forEach(function(r){se(e,47,eh(r,0))}),se(e,618)}function ib(e){var t=1;se(e,619,Er(t)),se(e,48,Q2({xfId:0,name:"Normal"})),se(e,620)}function ob(e){var t=0;se(e,505,Er(t)),se(e,506)}function lb(e){var t=0;se(e,508,Z2(t,"TableStyleMedium9","PivotStyleMedium4")),se(e,509)}function cb(e,t){var r=Kt();return se(r,278),eb(r,e.SSF),tb(r),rb(r),ab(r),sb(r),nb(r,t.cellXfs),ib(r),ob(r),lb(r),se(r,279),r.end()}function th(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[ut];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',r[r.length]='<a:font script="Hang" typeface="맑은 고딕"/>',r[r.length]='<a:font script="Hans" typeface="宋体"/>',r[r.length]='<a:font script="Hant" typeface="新細明體"/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',r[r.length]='<a:font script="Hang" typeface="맑은 고딕"/>',r[r.length]='<a:font script="Hans" typeface="宋体"/>',r[r.length]='<a:font script="Hant" typeface="新細明體"/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function db(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:Ot(e)}}function ub(e){var t=te(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),bt(e.name,t),t.slice(0,t.l)}function hb(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function fb(e){var t=te(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function mb(e,t){var r=te(8+2*t.length);return r.write_shift(4,e),bt(t,r),r.slice(0,r.l)}function xb(e){return e.l+=4,e.read_shift(4)!=0}function gb(e,t){var r=te(8);return r.write_shift(4,e),r.write_shift(4,1),r}function pb(){var e=Kt();return se(e,332),se(e,334,Er(1)),se(e,335,ub({name:"XLDAPR",version:12e4,flags:3496657072})),se(e,336),se(e,339,mb(1,"XLDAPR")),se(e,52),se(e,35,Er(514)),se(e,4096,Er(0)),se(e,4097,dr(1)),se(e,36),se(e,53),se(e,340),se(e,337,gb(1)),se(e,51,fb([[1,0]])),se(e,338),se(e,333),e.end()}function rh(){var e=[ut];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function vb(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=Ke(r);var s=e.read_shift(1);return s&2&&(t.l="1"),s&8&&(t.a="1"),t}var Ua=1024;function ah(e,t){for(var r=[21600,21600],s=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),n=[ce("xml",null,{"xmlns:v":er.v,"xmlns:o":er.o,"xmlns:x":er.x,"xmlns:mv":er.mv}).replace(/\/>/,">"),ce("o:shapelayout",ce("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),ce("v:shapetype",[ce("v:stroke",null,{joinstyle:"miter"}),ce("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:s})];Ua<e*1e3;)Ua+=1e3;return t.forEach(function(i){var o=wt(i[0]),l={color2:"#BEFF82",type:"gradient"};l.type=="gradient"&&(l.angle="-180");var d=l.type=="gradient"?ce("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,c=ce("v:fill",d,l),u={on:"t",obscured:"t"};++Ua,n=n.concat(["<v:shape"+Is({id:"_x0000_s"+Ua,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(i[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",c,ce("v:shadow",null,u),ce("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Tt("x:Anchor",[o.c+1,0,o.r+1,0,o.c+3,20,o.r+5,20].join(",")),Tt("x:AutoFill","False"),Tt("x:Row",String(o.r)),Tt("x:Column",String(o.c)),i[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),n.push("</xml>"),n.join("")}function sh(e){var t=[ut,ce("comments",null,{xmlns:ts[0]})],r=[];return t.push("<authors>"),e.forEach(function(s){s[1].forEach(function(n){var i=Xe(n.a);r.indexOf(i)==-1&&(r.push(i),t.push("<author>"+i+"</author>")),n.T&&n.ID&&r.indexOf("tc="+n.ID)==-1&&(r.push("tc="+n.ID),t.push("<author>tc="+n.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(s){var n=0,i=[];if(s[1][0]&&s[1][0].T&&s[1][0].ID?n=r.indexOf("tc="+s[1][0].ID):s[1].forEach(function(d){d.a&&(n=r.indexOf(Xe(d.a))),i.push(d.t||"")}),t.push('<comment ref="'+s[0]+'" authorId="'+n+'"><text>'),i.length<=1)t.push(Tt("t",Xe(i[0]||"")));else{for(var o=`Comment:
    `+i[0]+`
`,l=1;l<i.length;++l)o+=`Reply:
    `+i[l]+`
`;t.push(Tt("t",Xe(o)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function wb(e,t,r){var s=[ut,ce("ThreadedComments",null,{xmlns:xt.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(n){var i="";(n[1]||[]).forEach(function(o,l){if(!o.T){delete o.ID;return}o.a&&t.indexOf(o.a)==-1&&t.push(o.a);var d={ref:n[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};l==0?i=d.id:d.parentId=i,o.ID=d.id,o.a&&(d.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(o.a)).slice(-12)+"}"),s.push(ce("threadedComment",Tt("text",o.t||""),d))})}),s.push("</ThreadedComments>"),s.join("")}function bb(e){var t=[ut,ce("personList",null,{xmlns:xt.TCMNT,"xmlns:x":ts[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,s){t.push(ce("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+s).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function yb(e){var t={};t.iauthor=e.read_shift(4);var r=Fa(e);return t.rfx=r.s,t.ref=Ke(r.s),e.l+=16,t}function Nb(e,t){return t==null&&(t=te(36)),t.write_shift(4,e[1].iauthor),as(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var jb=Ot;function Eb(e){return bt(e.slice(0,54))}function _b(e){var t=Kt(),r=[];return se(t,628),se(t,630),e.forEach(function(s){s[1].forEach(function(n){r.indexOf(n.a)>-1||(r.push(n.a.slice(0,54)),se(t,632,Eb(n.a)))})}),se(t,631),se(t,633),e.forEach(function(s){s[1].forEach(function(n){n.iauthor=r.indexOf(n.a);var i={s:wt(s[0]),e:wt(s[0])};se(t,635,Nb([i,n])),n.t&&n.t.length>0&&se(t,637,Cw(n)),se(t,636),delete n.iauthor})}),se(t,634),se(t,629),t.end()}function Sb(e,t){t.FullPaths.forEach(function(r,s){if(s!=0){var n=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");n.slice(-1)!=="/"&&Ye.utils.cfb_add(e,n,t.FileIndex[s].content)}})}var nh=["xlsb","xlsm","xlam","biff8","xla"],Cb=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(s,n,i,o){var l=!1,d=!1;i.length==0?d=!0:i.charAt(0)=="["&&(d=!0,i=i.slice(1,-1)),o.length==0?l=!0:o.charAt(0)=="["&&(l=!0,o=o.slice(1,-1));var c=i.length>0?parseInt(i,10)|0:0,u=o.length>0?parseInt(o,10)|0:0;return l?u+=t.c:--u,d?c+=t.r:--c,n+(l?"":"$")+It(u)+(d?"":"$")+Rt(c)}return function(n,i){return t=i,n.replace(e,r)}}(),Ko=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,Yo=function(){return function(t,r){return t.replace(Ko,function(s,n,i,o,l,d){var c=Vo(o)-(i?0:r.c),u=zo(d)-(l?0:r.r),h=u==0?"":l?u+1:"["+u+"]",f=c==0?"":i?c+1:"["+c+"]";return n+"R"+h+"C"+f})}}();function Tb(e,t){return e.replace(Ko,function(r,s,n,i,o,l){return s+(n=="$"?n+i:It(Vo(i)+t.c))+(o=="$"?o+l:Rt(zo(l)+t.r))})}function Ab(e){return e.length!=1}function lt(e){e.l+=1}function ua(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function ih(e,t,r){var s=2;if(r){if(r.biff>=2&&r.biff<=5)return oh(e);r.biff==12&&(s=4)}var n=e.read_shift(s),i=e.read_shift(s),o=ua(e),l=ua(e);return{s:{r:n,c:o[0],cRel:o[1],rRel:o[2]},e:{r:i,c:l[0],cRel:l[1],rRel:l[2]}}}function oh(e){var t=ua(e),r=ua(e),s=e.read_shift(1),n=e.read_shift(1);return{s:{r:t[0],c:s,cRel:t[1],rRel:t[2]},e:{r:r[0],c:n,cRel:r[1],rRel:r[2]}}}function Rb(e,t,r){if(r.biff<8)return oh(e);var s=e.read_shift(r.biff==12?4:2),n=e.read_shift(r.biff==12?4:2),i=ua(e),o=ua(e);return{s:{r:s,c:i[0],cRel:i[1],rRel:i[2]},e:{r:n,c:o[0],cRel:o[1],rRel:o[2]}}}function lh(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return Fb(e);var s=e.read_shift(r&&r.biff==12?4:2),n=ua(e);return{r:s,c:n[0],cRel:n[1],rRel:n[2]}}function Fb(e){var t=ua(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function kb(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function Db(e,t,r){var s=r&&r.biff?r.biff:8;if(s>=2&&s<=5)return Pb(e);var n=e.read_shift(s>=12?4:2),i=e.read_shift(2),o=(i&16384)>>14,l=(i&32768)>>15;if(i&=16383,l==1)for(;n>524287;)n-=1048576;if(o==1)for(;i>8191;)i=i-16384;return{r:n,c:i,cRel:o,rRel:l}}function Pb(e){var t=e.read_shift(2),r=e.read_shift(1),s=(t&32768)>>15,n=(t&16384)>>14;return t&=16383,s==1&&t>=8192&&(t=t-16384),n==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:n,rRel:s}}function Ib(e,t,r){var s=(e[e.l++]&96)>>5,n=ih(e,r.biff>=2&&r.biff<=5?6:8,r);return[s,n]}function Ob(e,t,r){var s=(e[e.l++]&96)>>5,n=e.read_shift(2,"i"),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}var o=ih(e,i,r);return[s,n,o]}function Mb(e,t,r){var s=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[s]}function Lb(e,t,r){var s=(e[e.l++]&96)>>5,n=e.read_shift(2),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}return e.l+=i,[s,n]}function Bb(e,t,r){var s=(e[e.l++]&96)>>5,n=Rb(e,t-1,r);return[s,n]}function Ub(e,t,r){var s=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[s]}function oc(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function $b(e,t,r){e.l+=2;for(var s=e.read_shift(r&&r.biff==2?1:2),n=[],i=0;i<=s;++i)n.push(e.read_shift(r&&r.biff==2?1:2));return n}function zb(e,t,r){var s=e[e.l+1]&255?1:0;return e.l+=2,[s,e.read_shift(r&&r.biff==2?1:2)]}function Vb(e,t,r){var s=e[e.l+1]&255?1:0;return e.l+=2,[s,e.read_shift(r&&r.biff==2?1:2)]}function Hb(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function Wb(e,t,r){var s=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[s]}function ch(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function qb(e){return e.read_shift(2),ch(e)}function Gb(e){return e.read_shift(2),ch(e)}function Xb(e,t,r){var s=(e[e.l]&96)>>5;e.l+=1;var n=lh(e,0,r);return[s,n]}function Kb(e,t,r){var s=(e[e.l]&96)>>5;e.l+=1;var n=Db(e,0,r);return[s,n]}function Yb(e,t,r){var s=(e[e.l]&96)>>5;e.l+=1;var n=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var i=lh(e,0,r);return[s,n,i]}function Jb(e,t,r){var s=(e[e.l]&96)>>5;e.l+=1;var n=e.read_shift(r&&r.biff<=3?1:2);return[Jy[n],hh[n],s]}function Qb(e,t,r){var s=e[e.l++],n=e.read_shift(1),i=r&&r.biff<=3?[s==88?-1:0,e.read_shift(1)]:Zb(e);return[n,(i[0]===0?hh:Yy)[i[1]]]}function Zb(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function ey(e,t,r){e.l+=r&&r.biff==2?3:4}function ty(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var s=e.read_shift(2),n=e.read_shift(r&&r.biff==2?1:2);return[s,n]}function ry(e){return e.l++,qs[e.read_shift(1)]}function ay(e){return e.l++,e.read_shift(2)}function sy(e){return e.l++,e.read_shift(1)!==0}function ny(e){return e.l++,ss(e)}function iy(e,t,r){return e.l++,W0(e,t-1,r)}function oy(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Yw(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=qs[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=ss(e);break;case 2:r[1]=e2(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function ly(e,t,r){for(var s=e.read_shift(r.biff==12?4:2),n=[],i=0;i!=s;++i)n.push((r.biff==12?Fa:a2)(e));return n}function cy(e,t,r){var s=0,n=0;r.biff==12?(s=e.read_shift(4),n=e.read_shift(4)):(n=1+e.read_shift(1),s=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--s,--n==0&&(n=256));for(var i=0,o=[];i!=s&&(o[i]=[]);++i)for(var l=0;l!=n;++l)o[i][l]=oy(e,r.biff);return o}function dy(e,t,r){var s=e.read_shift(1)>>>5&3,n=!r||r.biff>=8?4:2,i=e.read_shift(n);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[s,0,i]}function uy(e,t,r){if(r.biff==5)return hy(e);var s=e.read_shift(1)>>>5&3,n=e.read_shift(2),i=e.read_shift(4);return[s,n,i]}function hy(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var s=e.read_shift(2);return e.l+=12,[t,r,s]}function fy(e,t,r){var s=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var n=e.read_shift(r&&r.biff==2?1:2);return[s,n]}function my(e,t,r){var s=e.read_shift(1)>>>5&3,n=e.read_shift(r&&r.biff==2?1:2);return[s,n]}function xy(e,t,r){var s=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[s]}function gy(e,t,r){var s=(e[e.l++]&96)>>5,n=e.read_shift(2),i=4;if(r)switch(r.biff){case 5:i=15;break;case 12:i=6;break}return e.l+=i,[s,n]}var py=Lr,vy=Lr,wy=Lr;function Gs(e,t,r){return e.l+=2,[kb(e)]}function Jo(e){return e.l+=6,[]}var by=Gs,yy=Jo,Ny=Jo,jy=Gs;function dh(e){return e.l+=2,[V0(e),e.read_shift(2)&1]}var Ey=Gs,_y=dh,Sy=Jo,Cy=Gs,Ty=Gs,Ay=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function Ry(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),s=e.read_shift(4),n=e.read_shift(2),i=e.read_shift(2),o=Ay[r>>2&31];return{ixti:t,coltype:r&3,rt:o,idx:s,c:n,C:i}}function Fy(e){return e.l+=2,[e.read_shift(4)]}function ky(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function Dy(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function Py(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function Iy(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function Oy(e){return e.l+=4,[0,0]}var lc={1:{n:"PtgExp",f:ty},2:{n:"PtgTbl",f:wy},3:{n:"PtgAdd",f:lt},4:{n:"PtgSub",f:lt},5:{n:"PtgMul",f:lt},6:{n:"PtgDiv",f:lt},7:{n:"PtgPower",f:lt},8:{n:"PtgConcat",f:lt},9:{n:"PtgLt",f:lt},10:{n:"PtgLe",f:lt},11:{n:"PtgEq",f:lt},12:{n:"PtgGe",f:lt},13:{n:"PtgGt",f:lt},14:{n:"PtgNe",f:lt},15:{n:"PtgIsect",f:lt},16:{n:"PtgUnion",f:lt},17:{n:"PtgRange",f:lt},18:{n:"PtgUplus",f:lt},19:{n:"PtgUminus",f:lt},20:{n:"PtgPercent",f:lt},21:{n:"PtgParen",f:lt},22:{n:"PtgMissArg",f:lt},23:{n:"PtgStr",f:iy},26:{n:"PtgSheet",f:ky},27:{n:"PtgEndSheet",f:Dy},28:{n:"PtgErr",f:ry},29:{n:"PtgBool",f:sy},30:{n:"PtgInt",f:ay},31:{n:"PtgNum",f:ny},32:{n:"PtgArray",f:Ub},33:{n:"PtgFunc",f:Jb},34:{n:"PtgFuncVar",f:Qb},35:{n:"PtgName",f:dy},36:{n:"PtgRef",f:Xb},37:{n:"PtgArea",f:Ib},38:{n:"PtgMemArea",f:fy},39:{n:"PtgMemErr",f:py},40:{n:"PtgMemNoMem",f:vy},41:{n:"PtgMemFunc",f:my},42:{n:"PtgRefErr",f:xy},43:{n:"PtgAreaErr",f:Mb},44:{n:"PtgRefN",f:Kb},45:{n:"PtgAreaN",f:Bb},46:{n:"PtgMemAreaN",f:Py},47:{n:"PtgMemNoMemN",f:Iy},57:{n:"PtgNameX",f:uy},58:{n:"PtgRef3d",f:Yb},59:{n:"PtgArea3d",f:Ob},60:{n:"PtgRefErr3d",f:gy},61:{n:"PtgAreaErr3d",f:Lb},255:{}},My={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},Ly={1:{n:"PtgElfLel",f:dh},2:{n:"PtgElfRw",f:Cy},3:{n:"PtgElfCol",f:by},6:{n:"PtgElfRwV",f:Ty},7:{n:"PtgElfColV",f:jy},10:{n:"PtgElfRadical",f:Ey},11:{n:"PtgElfRadicalS",f:Sy},13:{n:"PtgElfColS",f:yy},15:{n:"PtgElfColSV",f:Ny},16:{n:"PtgElfRadicalLel",f:_y},25:{n:"PtgList",f:Ry},29:{n:"PtgSxName",f:Fy},255:{}},By={0:{n:"PtgAttrNoop",f:Oy},1:{n:"PtgAttrSemi",f:Wb},2:{n:"PtgAttrIf",f:Vb},4:{n:"PtgAttrChoose",f:$b},8:{n:"PtgAttrGoto",f:zb},16:{n:"PtgAttrSum",f:ey},32:{n:"PtgAttrBaxcel",f:oc},33:{n:"PtgAttrBaxcel",f:oc},64:{n:"PtgAttrSpace",f:qb},65:{n:"PtgAttrSpaceSemi",f:Gb},128:{n:"PtgAttrIfError",f:Hb},255:{}};function Uy(e,t,r,s){if(s.biff<8)return Lr(e,t);for(var n=e.l+t,i=[],o=0;o!==r.length;++o)switch(r[o][0]){case"PtgArray":r[o][1]=cy(e,0,s),i.push(r[o][1]);break;case"PtgMemArea":r[o][2]=ly(e,r[o][1],s),i.push(r[o][2]);break;case"PtgExp":s&&s.biff==12&&(r[o][1][1]=e.read_shift(4),i.push(r[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[o][0]}return t=n-e.l,t!==0&&i.push(Lr(e,t)),i}function $y(e,t,r){for(var s=e.l+t,n,i,o=[];s!=e.l;)t=s-e.l,i=e[e.l],n=lc[i]||lc[My[i]],(i===24||i===25)&&(n=(i===24?Ly:By)[e[e.l+1]]),!n||!n.f?Lr(e,t):o.push([n.n,n.f(e,t,r)]);return o}function zy(e){for(var t=[],r=0;r<e.length;++r){for(var s=e[r],n=[],i=0;i<s.length;++i){var o=s[i];if(o)switch(o[0]){case 2:n.push('"'+o[1].replace(/"/g,'""')+'"');break;default:n.push(o[1])}else n.push("")}t.push(n.join(","))}return t.join(";")}var Vy={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function Hy(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function uh(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var s=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!s)return"SH33TJSERR1";var n="";if(r.biff>8)switch(e[s[0]][0]){case 357:return n=s[1]==-1?"#REF":e.SheetNames[s[1]],s[1]==s[2]?n:n+":"+e.SheetNames[s[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[s[0]][0];case 355:default:return"SH33TJSSRC"+e[s[0]][0]}switch(e[s[0]][0][0]){case 1025:return n=s[1]==-1?"#REF":e.SheetNames[s[1]]||"SH33TJSERR3",s[1]==s[2]?n:n+":"+e.SheetNames[s[2]];case 14849:return e[s[0]].slice(1).map(function(i){return i.Name}).join(";;");default:return e[s[0]][0][3]?(n=s[1]==-1?"#REF":e[s[0]][0][3][s[1]]||"SH33TJSERR4",s[1]==s[2]?n:n+":"+e[s[0]][0][3][s[2]]):"SH33TJSERR2"}}function cc(e,t,r){var s=uh(e,t,r);return s=="#REF"?s:Hy(s,r)}function Qa(e,t,r,s,n){var i=n&&n.biff||8,o={s:{c:0,r:0}},l=[],d,c,u,h=0,f=0,m,v="";if(!e[0]||!e[0][0])return"";for(var g=-1,x="",b=0,N=e[0].length;b<N;++b){var y=e[0][b];switch(y[0]){case"PtgUminus":l.push("-"+l.pop());break;case"PtgUplus":l.push("+"+l.pop());break;case"PtgPercent":l.push(l.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(d=l.pop(),c=l.pop(),g>=0){switch(e[0][g][1][0]){case 0:x=rt(" ",e[0][g][1][1]);break;case 1:x=rt("\r",e[0][g][1][1]);break;default:if(x="",n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][g][1][0])}c=c+x,g=-1}l.push(c+Vy[y[0]]+d);break;case"PtgIsect":d=l.pop(),c=l.pop(),l.push(c+" "+d);break;case"PtgUnion":d=l.pop(),c=l.pop(),l.push(c+","+d);break;case"PtgRange":d=l.pop(),c=l.pop(),l.push(c+":"+d);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":u=vs(y[1][1],o,n),l.push(ws(u,i));break;case"PtgRefN":u=r?vs(y[1][1],r,n):y[1][1],l.push(ws(u,i));break;case"PtgRef3d":h=y[1][1],u=vs(y[1][2],o,n),v=cc(s,h,n),l.push(v+"!"+ws(u,i));break;case"PtgFunc":case"PtgFuncVar":var A=y[1][0],B=y[1][1];A||(A=0),A&=127;var W=A==0?[]:l.slice(-A);l.length-=A,B==="User"&&(B=W.shift()),l.push(B+"("+W.join(",")+")");break;case"PtgBool":l.push(y[1]?"TRUE":"FALSE");break;case"PtgInt":l.push(y[1]);break;case"PtgNum":l.push(String(y[1]));break;case"PtgStr":l.push('"'+y[1].replace(/"/g,'""')+'"');break;case"PtgErr":l.push(y[1]);break;case"PtgAreaN":m=Gl(y[1][1],r?{s:r}:o,n),l.push(Ei(m,n));break;case"PtgArea":m=Gl(y[1][1],o,n),l.push(Ei(m,n));break;case"PtgArea3d":h=y[1][1],m=y[1][2],v=cc(s,h,n),l.push(v+"!"+Ei(m,n));break;case"PtgAttrSum":l.push("SUM("+l.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":f=y[1][2];var C=(s.names||[])[f-1]||(s[0]||[])[f],L=C?C.Name:"SH33TJSNAME"+String(f);L&&L.slice(0,6)=="_xlfn."&&!n.xlfn&&(L=L.slice(6)),l.push(L);break;case"PtgNameX":var T=y[1][1];f=y[1][2];var P;if(n.biff<=5)T<0&&(T=-T),s[T]&&(P=s[T][f]);else{var I="";if(((s[T]||[])[0]||[])[0]==14849||(((s[T]||[])[0]||[])[0]==1025?s[T][f]&&s[T][f].itab>0&&(I=s.SheetNames[s[T][f].itab-1]+"!"):I=s.SheetNames[f-1]+"!"),s[T]&&s[T][f])I+=s[T][f].Name;else if(s[0]&&s[0][f])I+=s[0][f].Name;else{var V=(uh(s,T,n)||"").split(";;");V[f-1]?I=V[f-1]:I+="SH33TJSERRX"}l.push(I);break}P||(P={Name:"SH33TJSERRY"}),l.push(P.Name);break;case"PtgParen":var ae="(",_e=")";if(g>=0){switch(x="",e[0][g][1][0]){case 2:ae=rt(" ",e[0][g][1][1])+ae;break;case 3:ae=rt("\r",e[0][g][1][1])+ae;break;case 4:_e=rt(" ",e[0][g][1][1])+_e;break;case 5:_e=rt("\r",e[0][g][1][1])+_e;break;default:if(n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][g][1][0])}g=-1}l.push(ae+l.pop()+_e);break;case"PtgRefErr":l.push("#REF!");break;case"PtgRefErr3d":l.push("#REF!");break;case"PtgExp":u={c:y[1][1],r:y[1][0]};var ve={c:r.c,r:r.r};if(s.sharedf[Ke(u)]){var we=s.sharedf[Ke(u)];l.push(Qa(we,o,ve,s,n))}else{var be=!1;for(d=0;d!=s.arrayf.length;++d)if(c=s.arrayf[d],!(u.c<c[0].s.c||u.c>c[0].e.c)&&!(u.r<c[0].s.r||u.r>c[0].e.r)){l.push(Qa(c[1],o,ve,s,n)),be=!0;break}be||l.push(y[1])}break;case"PtgArray":l.push("{"+zy(y[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":g=b;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":l.push("");break;case"PtgAreaErr":l.push("#REF!");break;case"PtgAreaErr3d":l.push("#REF!");break;case"PtgList":l.push("Table"+y[1].idx+"[#"+y[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(y));default:throw new Error("Unrecognized Formula Token: "+String(y))}var J=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(n.biff!=3&&g>=0&&J.indexOf(e[0][b][0])==-1){y=e[0][g];var Z=!0;switch(y[1][0]){case 4:Z=!1;case 0:x=rt(" ",y[1][1]);break;case 5:Z=!1;case 1:x=rt("\r",y[1][1]);break;default:if(x="",n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+y[1][0])}l.push((Z?x:"")+l.pop()+(Z?"":x)),g=-1}}if(l.length>1&&n.WTF)throw new Error("bad formula stack");return l[0]}function Wy(e){if(e==null){var t=te(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return ja(e);return ja(0)}function qy(e,t,r,s,n){var i=Ea(t,r,n),o=Wy(e.v),l=te(6),d=33;l.write_shift(2,d),l.write_shift(4,0);for(var c=te(e.bf.length),u=0;u<e.bf.length;++u)c[u]=e.bf[u];var h=Ct([i,o,l,c]);return h}function ei(e,t,r){var s=e.read_shift(4),n=$y(e,s,r),i=e.read_shift(4),o=i>0?Uy(e,i,n,r):null;return[n,o]}var Gy=ei,ti=ei,Xy=ei,Ky=ei,Yy={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},hh={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},Jy={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function Qy(e){var t="of:="+e.replace(Ko,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function Zy(e){return e.replace(/\./,"!")}var bs=typeof Map<"u";function Qo(e,t,r){var s=0,n=e.length;if(r){if(bs?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var i=bs?r.get(t):r[t];s<i.length;++s)if(e[i[s]].t===t)return e.Count++,i[s]}}else for(;s<n;++s)if(e[s].t===t)return e.Count++,s;return e[n]={t},e.Count++,e.Unique++,r&&(bs?(r.has(t)||r.set(t,[]),r.get(t).push(n)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(n))),n}function ri(e,t){var r={min:e+1,max:e+1},s=-1;return t.MDW&&(Gr=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?s=Fn(t.wpx):t.wch!=null&&(s=t.wch),s>-1?(r.width=to(s),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function fh(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function ma(e,t,r){var s=r.revssf[t.z!=null?t.z:"General"],n=60,i=e.length;if(s==null&&r.ssf){for(;n<392;++n)if(r.ssf[n]==null){l0(t.z,n),r.ssf[n]=t.z,r.revssf[t.z]=s=n;break}}for(n=0;n!=i;++n)if(e[n].numFmtId===s)return n;return e[i]={numFmtId:s,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},i}function eN(e,t,r){if(e&&e["!ref"]){var s=Qe(e["!ref"]);if(s.e.c<s.s.c||s.e.r<s.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function tN(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+dt(e[r])+'"/>';return t+"</mergeCells>"}function rN(e,t,r,s,n){var i=!1,o={},l=null;if(s.bookType!=="xlsx"&&t.vbaraw){var d=t.SheetNames[r];try{t.Workbook&&(d=t.Workbook.Sheets[r].CodeName||d)}catch{}i=!0,o.codeName=Ps(Xe(d))}if(e&&e["!outline"]){var c={summaryBelow:1,summaryRight:1};e["!outline"].above&&(c.summaryBelow=0),e["!outline"].left&&(c.summaryRight=0),l=(l||"")+ce("outlinePr",null,c)}!i&&!l||(n[n.length]=ce("sheetPr",l,o))}var aN=["objects","scenarios","selectLockedCells","selectUnlockedCells"],sN=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function nN(e){var t={sheet:1};return aN.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),sN.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=Y0(e.password).toString(16).toUpperCase()),ce("sheetProtection",null,t)}function iN(e){return fh(e),ce("pageMargins",null,e)}function oN(e,t){for(var r=["<cols>"],s,n=0;n!=t.length;++n)(s=t[n])&&(r[r.length]=ce("col",null,ri(n,s)));return r[r.length]="</cols>",r.join("")}function lN(e,t,r,s){var n=typeof e.ref=="string"?e.ref:dt(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var i=r.Workbook.Names,o=sr(n);o.s.r==o.e.r&&(o.e.r=sr(t["!ref"]).e.r,n=dt(o));for(var l=0;l<i.length;++l){var d=i[l];if(d.Name=="_xlnm._FilterDatabase"&&d.Sheet==s){d.Ref="'"+r.SheetNames[s]+"'!"+n;break}}return l==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:s,Ref:"'"+r.SheetNames[s]+"'!"+n}),ce("autoFilter",null,{ref:n})}function cN(e,t,r,s){var n={workbookViewId:"0"};return(((s||{}).Workbook||{}).Views||[])[0]&&(n.rightToLeft=s.Workbook.Views[0].RTL?"1":"0"),ce("sheetViews",ce("sheetView",null,n),{})}function dN(e,t,r,s){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var n="",i=e.t,o=e.v;if(e.t!=="z")switch(e.t){case"b":n=e.v?"1":"0";break;case"n":n=""+e.v;break;case"e":n=qs[e.v];break;case"d":s&&s.cellDates?n=Ht(e.v,-1).toISOString():(e=Jt(e),e.t="n",n=""+(e.v=Yt(Ht(e.v)))),typeof e.z>"u"&&(e.z=st[14]);break;default:n=e.v;break}var l=Tt("v",Xe(n)),d={r:t},c=ma(s.cellXfs,e,s);switch(c!==0&&(d.s=c),e.t){case"n":break;case"d":d.t="d";break;case"b":d.t="b";break;case"e":d.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(s&&s.bookSST){l=Tt("v",""+Qo(s.Strings,e.v,s.revStrings)),d.t="s";break}d.t="str";break}if(e.t!=i&&(e.t=i,e.v=o),typeof e.f=="string"&&e.f){var u=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;l=ce("f",Xe(e.f),u)+(e.v!=null?l:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(d.cm=1),ce("c",l,d)}function uN(e,t,r,s){var n=[],i=[],o=Qe(e["!ref"]),l="",d,c="",u=[],h=0,f=0,m=e["!rows"],v=Array.isArray(e),g={r:c},x,b=-1;for(f=o.s.c;f<=o.e.c;++f)u[f]=It(f);for(h=o.s.r;h<=o.e.r;++h){for(i=[],c=Rt(h),f=o.s.c;f<=o.e.c;++f){d=u[f]+c;var N=v?(e[h]||[])[f]:e[d];N!==void 0&&(l=dN(N,d,e,t))!=null&&i.push(l)}(i.length>0||m&&m[h])&&(g={r:c},m&&m[h]&&(x=m[h],x.hidden&&(g.hidden=1),b=-1,x.hpx?b=kn(x.hpx):x.hpt&&(b=x.hpt),b>-1&&(g.ht=b,g.customHeight=1),x.level&&(g.outlineLevel=x.level)),n[n.length]=ce("row",i.join(""),g))}if(m)for(;h<m.length;++h)m&&m[h]&&(g={r:h+1},x=m[h],x.hidden&&(g.hidden=1),b=-1,x.hpx?b=kn(x.hpx):x.hpt&&(b=x.hpt),b>-1&&(g.ht=b,g.customHeight=1),x.level&&(g.outlineLevel=x.level),n[n.length]=ce("row","",g));return n.join("")}function mh(e,t,r,s){var n=[ut,ce("worksheet",null,{xmlns:ts[0],"xmlns:r":xt.r})],i=r.SheetNames[e],o=0,l="",d=r.Sheets[i];d==null&&(d={});var c=d["!ref"]||"A1",u=Qe(c);if(u.e.c>16383||u.e.r>1048575){if(t.WTF)throw new Error("Range "+c+" exceeds format limit A1:XFD1048576");u.e.c=Math.min(u.e.c,16383),u.e.r=Math.min(u.e.c,1048575),c=dt(u)}s||(s={}),d["!comments"]=[];var h=[];rN(d,r,e,t,n),n[n.length]=ce("dimension",null,{ref:c}),n[n.length]=cN(d,t,e,r),t.sheetFormat&&(n[n.length]=ce("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),d["!cols"]!=null&&d["!cols"].length>0&&(n[n.length]=oN(d,d["!cols"])),n[o=n.length]="<sheetData/>",d["!links"]=[],d["!ref"]!=null&&(l=uN(d,t),l.length>0&&(n[n.length]=l)),n.length>o+1&&(n[n.length]="</sheetData>",n[o]=n[o].replace("/>",">")),d["!protect"]&&(n[n.length]=nN(d["!protect"])),d["!autofilter"]!=null&&(n[n.length]=lN(d["!autofilter"],d,r,e)),d["!merges"]!=null&&d["!merges"].length>0&&(n[n.length]=tN(d["!merges"]));var f=-1,m,v=-1;return d["!links"].length>0&&(n[n.length]="<hyperlinks>",d["!links"].forEach(function(g){g[1].Target&&(m={ref:g[0]},g[1].Target.charAt(0)!="#"&&(v=qe(s,-1,Xe(g[1].Target).replace(/#.*$/,""),Ue.HLINK),m["r:id"]="rId"+v),(f=g[1].Target.indexOf("#"))>-1&&(m.location=Xe(g[1].Target.slice(f+1))),g[1].Tooltip&&(m.tooltip=Xe(g[1].Tooltip)),n[n.length]=ce("hyperlink",null,m))}),n[n.length]="</hyperlinks>"),delete d["!links"],d["!margins"]!=null&&(n[n.length]=iN(d["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(n[n.length]=Tt("ignoredErrors",ce("ignoredError",null,{numberStoredAsText:1,sqref:c}))),h.length>0&&(v=qe(s,-1,"../drawings/drawing"+(e+1)+".xml",Ue.DRAW),n[n.length]=ce("drawing",null,{"r:id":"rId"+v}),d["!drawing"]=h),d["!comments"].length>0&&(v=qe(s,-1,"../drawings/vmlDrawing"+(e+1)+".vml",Ue.VML),n[n.length]=ce("legacyDrawing",null,{"r:id":"rId"+v}),d["!legacy"]=v),n.length>1&&(n[n.length]="</worksheet>",n[1]=n[1].replace("/>",">")),n.join("")}function hN(e,t){var r={},s=e.l+t;r.r=e.read_shift(4),e.l+=4;var n=e.read_shift(2);e.l+=1;var i=e.read_shift(1);return e.l=s,i&7&&(r.level=i&7),i&16&&(r.hidden=!0),i&32&&(r.hpt=n/20),r}function fN(e,t,r){var s=te(145),n=(r["!rows"]||[])[e]||{};s.write_shift(4,e),s.write_shift(4,0);var i=320;n.hpx?i=kn(n.hpx)*20:n.hpt&&(i=n.hpt*20),s.write_shift(2,i),s.write_shift(1,0);var o=0;n.level&&(o|=n.level),n.hidden&&(o|=16),(n.hpx||n.hpt)&&(o|=32),s.write_shift(1,o),s.write_shift(1,0);var l=0,d=s.l;s.l+=4;for(var c={r:e,c:0},u=0;u<16;++u)if(!(t.s.c>u+1<<10||t.e.c<u<<10)){for(var h=-1,f=-1,m=u<<10;m<u+1<<10;++m){c.c=m;var v=Array.isArray(r)?(r[c.r]||[])[c.c]:r[Ke(c)];v&&(h<0&&(h=m),f=m)}h<0||(++l,s.write_shift(4,h),s.write_shift(4,f))}var g=s.l;return s.l=d,s.write_shift(4,l),s.l=g,s.length>s.l?s.slice(0,s.l):s}function mN(e,t,r,s){var n=fN(s,r,t);(n.length>17||(t["!rows"]||[])[s])&&se(e,0,n)}var xN=Fa,gN=as;function pN(){}function vN(e,t){var r={},s=e[e.l];return++e.l,r.above=!(s&64),r.left=!(s&128),e.l+=18,r.name=Tw(e),r}function wN(e,t,r){r==null&&(r=te(84+4*e.length));var s=192;t&&(t.above&&(s&=-65),t.left&&(s&=-129)),r.write_shift(1,s);for(var n=1;n<3;++n)r.write_shift(1,0);return Tn({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),A0(e,r),r.slice(0,r.l)}function bN(e){var t=mr(e);return[t]}function yN(e,t,r){return r==null&&(r=te(8)),Ta(t,r)}function NN(e){var t=Aa(e);return[t]}function jN(e,t,r){return r==null&&(r=te(4)),Ra(t,r)}function EN(e){var t=mr(e),r=e.read_shift(1);return[t,r,"b"]}function _N(e,t,r){return r==null&&(r=te(9)),Ta(t,r),r.write_shift(1,e.v?1:0),r}function SN(e){var t=Aa(e),r=e.read_shift(1);return[t,r,"b"]}function CN(e,t,r){return r==null&&(r=te(5)),Ra(t,r),r.write_shift(1,e.v?1:0),r}function TN(e){var t=mr(e),r=e.read_shift(1);return[t,r,"e"]}function AN(e,t,r){return r==null&&(r=te(9)),Ta(t,r),r.write_shift(1,e.v),r}function RN(e){var t=Aa(e),r=e.read_shift(1);return[t,r,"e"]}function FN(e,t,r){return r==null&&(r=te(8)),Ra(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function kN(e){var t=mr(e),r=e.read_shift(4);return[t,r,"s"]}function DN(e,t,r){return r==null&&(r=te(12)),Ta(t,r),r.write_shift(4,t.v),r}function PN(e){var t=Aa(e),r=e.read_shift(4);return[t,r,"s"]}function IN(e,t,r){return r==null&&(r=te(8)),Ra(t,r),r.write_shift(4,t.v),r}function ON(e){var t=mr(e),r=ss(e);return[t,r,"n"]}function MN(e,t,r){return r==null&&(r=te(16)),Ta(t,r),ja(e.v,r),r}function LN(e){var t=Aa(e),r=ss(e);return[t,r,"n"]}function BN(e,t,r){return r==null&&(r=te(12)),Ra(t,r),ja(e.v,r),r}function UN(e){var t=mr(e),r=R0(e);return[t,r,"n"]}function $N(e,t,r){return r==null&&(r=te(12)),Ta(t,r),F0(e.v,r),r}function zN(e){var t=Aa(e),r=R0(e);return[t,r,"n"]}function VN(e,t,r){return r==null&&(r=te(8)),Ra(t,r),F0(e.v,r),r}function HN(e){var t=mr(e),r=Ho(e);return[t,r,"is"]}function WN(e){var t=mr(e),r=Ot(e);return[t,r,"str"]}function qN(e,t,r){return r==null&&(r=te(12+4*e.v.length)),Ta(t,r),bt(e.v,r),r.length>r.l?r.slice(0,r.l):r}function GN(e){var t=Aa(e),r=Ot(e);return[t,r,"str"]}function XN(e,t,r){return r==null&&(r=te(8+4*e.v.length)),Ra(t,r),bt(e.v,r),r.length>r.l?r.slice(0,r.l):r}function KN(e,t,r){var s=e.l+t,n=mr(e);n.r=r["!row"];var i=e.read_shift(1),o=[n,i,"b"];if(r.cellFormula){e.l+=2;var l=ti(e,s-e.l,r);o[3]=Qa(l,null,n,r.supbooks,r)}else e.l=s;return o}function YN(e,t,r){var s=e.l+t,n=mr(e);n.r=r["!row"];var i=e.read_shift(1),o=[n,i,"e"];if(r.cellFormula){e.l+=2;var l=ti(e,s-e.l,r);o[3]=Qa(l,null,n,r.supbooks,r)}else e.l=s;return o}function JN(e,t,r){var s=e.l+t,n=mr(e);n.r=r["!row"];var i=ss(e),o=[n,i,"n"];if(r.cellFormula){e.l+=2;var l=ti(e,s-e.l,r);o[3]=Qa(l,null,n,r.supbooks,r)}else e.l=s;return o}function QN(e,t,r){var s=e.l+t,n=mr(e);n.r=r["!row"];var i=Ot(e),o=[n,i,"str"];if(r.cellFormula){e.l+=2;var l=ti(e,s-e.l,r);o[3]=Qa(l,null,n,r.supbooks,r)}else e.l=s;return o}var ZN=Fa,ej=as;function tj(e,t){return t==null&&(t=te(4)),t.write_shift(4,e),t}function rj(e,t){var r=e.l+t,s=Fa(e),n=Wo(e),i=Ot(e),o=Ot(e),l=Ot(e);e.l=r;var d={rfx:s,relId:n,loc:i,display:l};return o&&(d.Tooltip=o),d}function aj(e,t){var r=te(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));as({s:wt(e[0]),e:wt(e[0])},r),qo("rId"+t,r);var s=e[1].Target.indexOf("#"),n=s==-1?"":e[1].Target.slice(s+1);return bt(n||"",r),bt(e[1].Tooltip||"",r),bt("",r),r.slice(0,r.l)}function sj(){}function nj(e,t,r){var s=e.l+t,n=k0(e),i=e.read_shift(1),o=[n];if(o[2]=i,r.cellFormula){var l=Gy(e,s-e.l,r);o[1]=l}else e.l=s;return o}function ij(e,t,r){var s=e.l+t,n=Fa(e),i=[n];if(r.cellFormula){var o=Ky(e,s-e.l,r);i[1]=o,e.l=s}else e.l=s;return i}function oj(e,t,r){r==null&&(r=te(18));var s=ri(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(s.width||10)*256),r.write_shift(4,0);var n=0;return t.hidden&&(n|=1),typeof s.width=="number"&&(n|=2),t.level&&(n|=t.level<<8),r.write_shift(2,n),r}var xh=["left","right","top","bottom","header","footer"];function lj(e){var t={};return xh.forEach(function(r){t[r]=ss(e)}),t}function cj(e,t){return t==null&&(t=te(6*8)),fh(e),xh.forEach(function(r){ja(e[r],t)}),t}function dj(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function uj(e,t,r){r==null&&(r=te(30));var s=924;return(((t||{}).Views||[])[0]||{}).RTL&&(s|=32),r.write_shift(2,s),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function hj(e){var t=te(24);return t.write_shift(4,4),t.write_shift(4,1),as(e,t),t}function fj(e,t){return t==null&&(t=te(16*4+2)),t.write_shift(2,e.password?Y0(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function mj(){}function xj(){}function gj(e,t,r,s,n,i,o){if(t.v===void 0)return!1;var l="";switch(t.t){case"b":l=t.v?"1":"0";break;case"d":t=Jt(t),t.z=t.z||st[14],t.v=Yt(Ht(t.v)),t.t="n";break;case"n":case"e":l=""+t.v;break;default:l=t.v;break}var d={r,c:s};switch(d.s=ma(n.cellXfs,t,n),t.l&&i["!links"].push([Ke(d),t.l]),t.c&&i["!comments"].push([Ke(d),t.c]),t.t){case"s":case"str":return n.bookSST?(l=Qo(n.Strings,t.v,n.revStrings),d.t="s",d.v=l,o?se(e,18,IN(t,d)):se(e,7,DN(t,d))):(d.t="str",o?se(e,17,XN(t,d)):se(e,6,qN(t,d))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?o?se(e,13,VN(t,d)):se(e,2,$N(t,d)):o?se(e,16,BN(t,d)):se(e,5,MN(t,d)),!0;case"b":return d.t="b",o?se(e,15,CN(t,d)):se(e,4,_N(t,d)),!0;case"e":return d.t="e",o?se(e,14,FN(t,d)):se(e,3,AN(t,d)),!0}return o?se(e,12,jN(t,d)):se(e,1,yN(t,d)),!0}function pj(e,t,r,s){var n=Qe(t["!ref"]||"A1"),i,o="",l=[];se(e,145);var d=Array.isArray(t),c=n.e.r;t["!rows"]&&(c=Math.max(n.e.r,t["!rows"].length-1));for(var u=n.s.r;u<=c;++u){o=Rt(u),mN(e,t,n,u);var h=!1;if(u<=n.e.r)for(var f=n.s.c;f<=n.e.c;++f){u===n.s.r&&(l[f]=It(f)),i=l[f]+o;var m=d?(t[u]||[])[f]:t[i];if(!m){h=!1;continue}h=gj(e,m,u,f,s,t,h)}}se(e,146)}function vj(e,t){!t||!t["!merges"]||(se(e,177,tj(t["!merges"].length)),t["!merges"].forEach(function(r){se(e,176,ej(r))}),se(e,178))}function wj(e,t){!t||!t["!cols"]||(se(e,390),t["!cols"].forEach(function(r,s){r&&se(e,60,oj(s,r))}),se(e,391))}function bj(e,t){!t||!t["!ref"]||(se(e,648),se(e,649,hj(Qe(t["!ref"]))),se(e,650))}function yj(e,t,r){t["!links"].forEach(function(s){if(s[1].Target){var n=qe(r,-1,s[1].Target.replace(/#.*$/,""),Ue.HLINK);se(e,494,aj(s,n))}}),delete t["!links"]}function Nj(e,t,r,s){if(t["!comments"].length>0){var n=qe(s,-1,"../drawings/vmlDrawing"+(r+1)+".vml",Ue.VML);se(e,551,qo("rId"+n)),t["!legacy"]=n}}function jj(e,t,r,s){if(t["!autofilter"]){var n=t["!autofilter"],i=typeof n.ref=="string"?n.ref:dt(n.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var o=r.Workbook.Names,l=sr(i);l.s.r==l.e.r&&(l.e.r=sr(t["!ref"]).e.r,i=dt(l));for(var d=0;d<o.length;++d){var c=o[d];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==s){c.Ref="'"+r.SheetNames[s]+"'!"+i;break}}d==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:s,Ref:"'"+r.SheetNames[s]+"'!"+i}),se(e,161,as(Qe(i))),se(e,162)}}function Ej(e,t,r){se(e,133),se(e,137,uj(t,r)),se(e,138),se(e,134)}function _j(e,t){t["!protect"]&&se(e,535,fj(t["!protect"]))}function Sj(e,t,r,s){var n=Kt(),i=r.SheetNames[e],o=r.Sheets[i]||{},l=i;try{r&&r.Workbook&&(l=r.Workbook.Sheets[e].CodeName||l)}catch{}var d=Qe(o["!ref"]||"A1");if(d.e.c>16383||d.e.r>1048575){if(t.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");d.e.c=Math.min(d.e.c,16383),d.e.r=Math.min(d.e.c,1048575)}return o["!links"]=[],o["!comments"]=[],se(n,129),(r.vbaraw||o["!outline"])&&se(n,147,wN(l,o["!outline"])),se(n,148,gN(d)),Ej(n,o,r.Workbook),wj(n,o),pj(n,o,e,t),_j(n,o),jj(n,o,r,e),vj(n,o),yj(n,o,s),o["!margins"]&&se(n,476,cj(o["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&bj(n,o),Nj(n,o,e,s),se(n,130),n.end()}function Cj(e,t){e.l+=10;var r=Ot(e);return{name:r}}var Tj=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function Aj(e){return!e.Workbook||!e.Workbook.WBProps?"false":iw(e.Workbook.WBProps.date1904)?"true":"false"}var Rj="][*?/\\".split("");function gh(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return Rj.forEach(function(s){if(e.indexOf(s)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function Fj(e,t,r){e.forEach(function(s,n){gh(s);for(var i=0;i<n;++i)if(s==e[i])throw new Error("Duplicate Sheet Name: "+s);if(r){var o=t&&t[n]&&t[n].CodeName||s;if(o.charCodeAt(0)==95&&o.length>22)throw new Error("Bad Code Name: Worksheet"+o)}})}function kj(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];Fj(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)eN(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}function ph(e){var t=[ut];t[t.length]=ce("workbook",null,{xmlns:ts[0],"xmlns:r":xt.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,s={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(Tj.forEach(function(l){e.Workbook.WBProps[l[0]]!=null&&e.Workbook.WBProps[l[0]]!=l[1]&&(s[l[0]]=e.Workbook.WBProps[l[0]])}),e.Workbook.WBProps.CodeName&&(s.codeName=e.Workbook.WBProps.CodeName,delete s.CodeName)),t[t.length]=ce("workbookPr",null,s);var n=e.Workbook&&e.Workbook.Sheets||[],i=0;if(n&&n[0]&&n[0].Hidden){for(t[t.length]="<bookViews>",i=0;i!=e.SheetNames.length&&!(!n[i]||!n[i].Hidden);++i);i==e.SheetNames.length&&(i=0),t[t.length]='<workbookView firstSheet="'+i+'" activeTab="'+i+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",i=0;i!=e.SheetNames.length;++i){var o={name:Xe(e.SheetNames[i].slice(0,31))};if(o.sheetId=""+(i+1),o["r:id"]="rId"+(i+1),n[i])switch(n[i].Hidden){case 1:o.state="hidden";break;case 2:o.state="veryHidden";break}t[t.length]=ce("sheet",null,o)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(l){var d={name:l.Name};l.Comment&&(d.comment=l.Comment),l.Sheet!=null&&(d.localSheetId=""+l.Sheet),l.Hidden&&(d.hidden="1"),l.Ref&&(t[t.length]=ce("definedName",Xe(l.Ref),d))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function Dj(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=eo(e),r.name=Ot(e),r}function Pj(e,t){return t||(t=te(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),qo(e.strRelID,t),bt(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function Ij(e,t){var r={},s=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var n=t>8?Ot(e):"";return n.length>0&&(r.CodeName=n),r.autoCompressPictures=!!(s&65536),r.backupFile=!!(s&64),r.checkCompatibility=!!(s&4096),r.date1904=!!(s&1),r.filterPrivacy=!!(s&8),r.hidePivotFieldList=!!(s&1024),r.promptedSolutions=!!(s&16),r.publishItems=!!(s&2048),r.refreshAllConnections=!!(s&262144),r.saveExternalLinkValues=!!(s&128),r.showBorderUnselectedTables=!!(s&4),r.showInkAnnotation=!!(s&32),r.showObjects=["all","placeholders","none"][s>>13&3],r.showPivotChartFilter=!!(s&32768),r.updateLinks=["userSet","never","always"][s>>8&3],r}function Oj(e,t){t||(t=te(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),A0(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function Mj(e,t,r){var s=e.l+t;e.l+=4,e.l+=1;var n=e.read_shift(4),i=Aw(e),o=Xy(e,0,r),l=Wo(e);e.l=s;var d={Name:i,Ptg:o};return n<268435455&&(d.Sheet=n),l&&(d.Comment=l),d}function Lj(e,t){se(e,143);for(var r=0;r!=t.SheetNames.length;++r){var s=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,n={Hidden:s,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};se(e,156,Pj(n))}se(e,144)}function Bj(e,t){t||(t=te(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return bt("SheetJS",t),bt(bn.version,t),bt(bn.version,t),bt("7262",t),t.length>t.l?t.slice(0,t.l):t}function Uj(e,t){t||(t=te(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function $j(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,s=0,n=-1,i=-1;s<r.length;++s)!r[s]||!r[s].Hidden&&n==-1?n=s:r[s].Hidden==1&&i==-1&&(i=s);i>n||(se(e,135),se(e,158,Uj(n)),se(e,136))}}function zj(e,t){var r=Kt();return se(r,131),se(r,128,Bj()),se(r,153,Oj(e.Workbook&&e.Workbook.WBProps||null)),$j(r,e),Lj(r,e),se(r,132),r.end()}function Vj(e,t,r){return(t.slice(-4)===".bin"?zj:ph)(e)}function Hj(e,t,r,s,n){return(t.slice(-4)===".bin"?Sj:mh)(e,r,s,n)}function Wj(e,t,r){return(t.slice(-4)===".bin"?cb:Z0)(e,r)}function qj(e,t,r){return(t.slice(-4)===".bin"?O2:K0)(e,r)}function Gj(e,t,r){return(t.slice(-4)===".bin"?_b:sh)(e)}function Xj(e){return(e.slice(-4)===".bin"?pb:rh)()}function Kj(e,t){var r=[];return e.Props&&r.push(Ww(e.Props,t)),e.Custprops&&r.push(qw(e.Props,e.Custprops)),r.join("")}function Yj(){return""}function Jj(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(s,n){var i=[];i.push(ce("NumberFormat",null,{"ss:Format":Xe(st[s.numFmtId])}));var o={"ss:ID":"s"+(21+n)};r.push(ce("Style",i.join(""),o))}),ce("Styles",r.join(""))}function vh(e){return ce("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+Yo(e.Ref,{r:0,c:0})})}function Qj(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],s=0;s<t.length;++s){var n=t[s];n.Sheet==null&&(n.Name.match(/^_xlfn\./)||r.push(vh(n)))}return ce("Names",r.join(""))}function Zj(e,t,r,s){if(!e||!((s||{}).Workbook||{}).Names)return"";for(var n=s.Workbook.Names,i=[],o=0;o<n.length;++o){var l=n[o];l.Sheet==r&&(l.Name.match(/^_xlfn\./)||i.push(vh(l)))}return i.join("")}function eE(e,t,r,s){if(!e)return"";var n=[];if(e["!margins"]&&(n.push("<PageSetup>"),e["!margins"].header&&n.push(ce("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&n.push(ce("Footer",null,{"x:Margin":e["!margins"].footer})),n.push(ce("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),n.push("</PageSetup>")),s&&s.Workbook&&s.Workbook.Sheets&&s.Workbook.Sheets[r])if(s.Workbook.Sheets[r].Hidden)n.push(ce("Visible",s.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var i=0;i<r&&!(s.Workbook.Sheets[i]&&!s.Workbook.Sheets[i].Hidden);++i);i==r&&n.push("<Selected/>")}return((((s||{}).Workbook||{}).Views||[])[0]||{}).RTL&&n.push("<DisplayRightToLeft/>"),e["!protect"]&&(n.push(Tt("ProtectContents","True")),e["!protect"].objects&&n.push(Tt("ProtectObjects","True")),e["!protect"].scenarios&&n.push(Tt("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?n.push(Tt("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&n.push(Tt("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(o){e["!protect"][o[0]]&&n.push("<"+o[1]+"/>")})),n.length==0?"":ce("WorksheetOptions",n.join(""),{xmlns:er.x})}function tE(e){return e.map(function(t){var r=nw(t.t||""),s=ce("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return ce("Comment",s,{"ss:Author":t.a})}).join("")}function rE(e,t,r,s,n,i,o){if(!e||e.v==null&&e.f==null)return"";var l={};if(e.f&&(l["ss:Formula"]="="+Xe(Yo(e.f,o))),e.F&&e.F.slice(0,t.length)==t){var d=wt(e.F.slice(t.length+1));l["ss:ArrayRange"]="RC:R"+(d.r==o.r?"":"["+(d.r-o.r)+"]")+"C"+(d.c==o.c?"":"["+(d.c-o.c)+"]")}if(e.l&&e.l.Target&&(l["ss:HRef"]=Xe(e.l.Target),e.l.Tooltip&&(l["x:HRefScreenTip"]=Xe(e.l.Tooltip))),r["!merges"])for(var c=r["!merges"],u=0;u!=c.length;++u)c[u].s.c!=o.c||c[u].s.r!=o.r||(c[u].e.c>c[u].s.c&&(l["ss:MergeAcross"]=c[u].e.c-c[u].s.c),c[u].e.r>c[u].s.r&&(l["ss:MergeDown"]=c[u].e.r-c[u].s.r));var h="",f="";switch(e.t){case"z":if(!s.sheetStubs)return"";break;case"n":h="Number",f=String(e.v);break;case"b":h="Boolean",f=e.v?"1":"0";break;case"e":h="Error",f=qs[e.v];break;case"d":h="DateTime",f=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||st[14]);break;case"s":h="String",f=sw(e.v||"");break}var m=ma(s.cellXfs,e,s);l["ss:StyleID"]="s"+(21+m),l["ss:Index"]=o.c+1;var v=e.v!=null?f:"",g=e.t=="z"?"":'<Data ss:Type="'+h+'">'+v+"</Data>";return(e.c||[]).length>0&&(g+=tE(e.c)),ce("Cell",g,l)}function aE(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=Q0(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function sE(e,t,r,s){if(!e["!ref"])return"";var n=Qe(e["!ref"]),i=e["!merges"]||[],o=0,l=[];e["!cols"]&&e["!cols"].forEach(function(x,b){Xo(x);var N=!!x.width,y=ri(b,x),A={"ss:Index":b+1};N&&(A["ss:Width"]=Rn(y.width)),x.hidden&&(A["ss:Hidden"]="1"),l.push(ce("Column",null,A))});for(var d=Array.isArray(e),c=n.s.r;c<=n.e.r;++c){for(var u=[aE(c,(e["!rows"]||[])[c])],h=n.s.c;h<=n.e.c;++h){var f=!1;for(o=0;o!=i.length;++o)if(!(i[o].s.c>h)&&!(i[o].s.r>c)&&!(i[o].e.c<h)&&!(i[o].e.r<c)){(i[o].s.c!=h||i[o].s.r!=c)&&(f=!0);break}if(!f){var m={r:c,c:h},v=Ke(m),g=d?(e[c]||[])[h]:e[v];u.push(rE(g,v,e,t,r,s,m))}}u.push("</Row>"),u.length>2&&l.push(u.join(""))}return l.join("")}function nE(e,t,r){var s=[],n=r.SheetNames[e],i=r.Sheets[n],o=i?Zj(i,t,e,r):"";return o.length>0&&s.push("<Names>"+o+"</Names>"),o=i?sE(i,t,e,r):"",o.length>0&&s.push("<Table>"+o+"</Table>"),s.push(eE(i,t,e,r)),s.join("")}function iE(e,t){t||(t={}),e.SSF||(e.SSF=Jt(st)),e.SSF&&(Jn(),Yn(e.SSF),t.revssf=Qn(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],ma(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(Kj(e,t)),r.push(Yj()),r.push(""),r.push("");for(var s=0;s<e.SheetNames.length;++s)r.push(ce("Worksheet",nE(s,t,e),{"ss:Name":Xe(e.SheetNames[s])}));return r[2]=Jj(e,t),r[3]=Qj(e),ut+ce("Workbook",r.join(""),{xmlns:er.ss,"xmlns:o":er.o,"xmlns:x":er.x,"xmlns:ss":er.ss,"xmlns:dt":er.dt,"xmlns:html":er.html})}var Ci={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function oE(e,t){var r=[],s=[],n=[],i=0,o,l=Ol(Kl,"n"),d=Ol(Yl,"n");if(e.Props)for(o=Ft(e.Props),i=0;i<o.length;++i)(Object.prototype.hasOwnProperty.call(l,o[i])?r:Object.prototype.hasOwnProperty.call(d,o[i])?s:n).push([o[i],e.Props[o[i]]]);if(e.Custprops)for(o=Ft(e.Custprops),i=0;i<o.length;++i)Object.prototype.hasOwnProperty.call(e.Props||{},o[i])||(Object.prototype.hasOwnProperty.call(l,o[i])?r:Object.prototype.hasOwnProperty.call(d,o[i])?s:n).push([o[i],e.Custprops[o[i]]]);var c=[];for(i=0;i<n.length;++i)z0.indexOf(n[i][0])>-1||B0.indexOf(n[i][0])>-1||n[i][1]!=null&&c.push(n[i]);s.length&&Ye.utils.cfb_add(t,"/SummaryInformation",tc(s,Ci.SI,d,Yl)),(r.length||c.length)&&Ye.utils.cfb_add(t,"/DocumentSummaryInformation",tc(r,Ci.DSI,l,Kl,c.length?c:null,Ci.UDI))}function lE(e,t){var r=t||{},s=Ye.utils.cfb_new({root:"R"}),n="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":n="/Workbook",r.biff=8;break;case"biff5":n="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return Ye.utils.cfb_add(s,n,wh(e,r)),r.biff==8&&(e.Props||e.Custprops)&&oE(e,s),r.biff==8&&e.vbaraw&&Sb(s,Ye.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),s}var cE={0:{f:hN},1:{f:bN},2:{f:UN},3:{f:TN},4:{f:EN},5:{f:ON},6:{f:WN},7:{f:kN},8:{f:QN},9:{f:JN},10:{f:KN},11:{f:YN},12:{f:NN},13:{f:zN},14:{f:RN},15:{f:SN},16:{f:LN},17:{f:GN},18:{f:PN},19:{f:Ho},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:Mj},40:{},42:{},43:{f:W2},44:{f:V2},45:{f:X2},46:{f:Y2},47:{f:K2},48:{},49:{f:Nw},50:{},51:{f:hb},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:j2},62:{f:HN},63:{f:vb},64:{f:mj},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Lr,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:dj},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:vN},148:{f:xN,p:16},151:{f:sj},152:{},153:{f:Ij},154:{},155:{},156:{f:Dj},157:{},158:{},159:{T:1,f:D2},160:{T:-1},161:{T:1,f:Fa},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:ZN},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:db},336:{T:-1},337:{f:xb,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:eo},357:{},358:{},359:{},360:{T:1},361:{},362:{f:p2},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:nj},427:{f:ij},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:lj},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:pN},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:rj},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:eo},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:jb},633:{T:1},634:{T:-1},635:{T:1,f:yb},636:{T:-1},637:{f:Sw},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:Cj},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:xj},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function de(e,t,r,s){var n=t;if(!isNaN(n)){var i=s||(r||[]).length||0,o=e.next(4);o.write_shift(2,n),o.write_shift(2,i),i>0&&$o(r)&&e.push(r)}}function dE(e,t,r,s){var n=(r||[]).length||0;if(n<=8224)return de(e,t,r,n);var i=t;if(!isNaN(i)){for(var o=r.parts||[],l=0,d=0,c=0;c+(o[l]||8224)<=8224;)c+=o[l]||8224,l++;var u=e.next(4);for(u.write_shift(2,i),u.write_shift(2,c),e.push(r.slice(d,d+c)),d+=c;d<n;){for(u=e.next(4),u.write_shift(2,60),c=0;c+(o[l]||8224)<=8224;)c+=o[l]||8224,l++;u.write_shift(2,c),e.push(r.slice(d,d+c)),d+=c}}}function Xs(e,t,r){return e||(e=te(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function uE(e,t,r,s){var n=te(9);return Xs(n,e,t),H0(r,s||"b",n),n}function hE(e,t,r){var s=te(8+2*r.length);return Xs(s,e,t),s.write_shift(1,r.length),s.write_shift(r.length,r,"sbcs"),s.l<s.length?s.slice(0,s.l):s}function fE(e,t,r,s){if(t.v!=null)switch(t.t){case"d":case"n":var n=t.t=="d"?Yt(Ht(t.v)):t.v;n==(n|0)&&n>=0&&n<65536?de(e,2,C2(r,s,n)):de(e,3,S2(r,s,n));return;case"b":case"e":de(e,5,uE(r,s,t.v,t.t));return;case"s":case"str":de(e,4,hE(r,s,(t.v||"").slice(0,255)));return}de(e,1,Xs(null,r,s))}function mE(e,t,r,s){var n=Array.isArray(t),i=Qe(t["!ref"]||"A1"),o,l="",d=[];if(i.e.c>255||i.e.r>16383){if(s.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");i.e.c=Math.min(i.e.c,255),i.e.r=Math.min(i.e.c,16383),o=dt(i)}for(var c=i.s.r;c<=i.e.r;++c){l=Rt(c);for(var u=i.s.c;u<=i.e.c;++u){c===i.s.r&&(d[u]=It(u)),o=d[u]+l;var h=n?(t[c]||[])[u]:t[o];h&&fE(e,h,c,u)}}}function xE(e,t){for(var r=t||{},s=Kt(),n=0,i=0;i<e.SheetNames.length;++i)e.SheetNames[i]==r.sheet&&(n=i);if(n==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return de(s,r.biff==4?1033:r.biff==3?521:9,Go(e,16,r)),mE(s,e.Sheets[e.SheetNames[n]],n,r),de(s,10),s.end()}function gE(e,t,r){de(e,49,c2({sz:12,name:"Arial"},r))}function pE(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(s){for(var n=s[0];n<=s[1];++n)t[n]!=null&&de(e,1054,h2(n,t[n],r))})}function vE(e,t){var r=te(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),de(e,2151,r),r=te(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),G0(Qe(t["!ref"]||"A1"),r),r.write_shift(4,4),de(e,2152,r)}function wE(e,t){for(var r=0;r<16;++r)de(e,224,ac({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(s){de(e,224,ac(s,0,t))})}function bE(e,t){for(var r=0;r<t["!links"].length;++r){var s=t["!links"][r];de(e,440,b2(s)),s[1].Tooltip&&de(e,2048,y2(s))}delete t["!links"]}function yE(e,t){if(t){var r=0;t.forEach(function(s,n){++r<=256&&s&&de(e,125,E2(ri(n,s),n))})}}function NE(e,t,r,s,n){var i=16+ma(n.cellXfs,t,n);if(t.v==null&&!t.bf){de(e,513,Ea(r,s,i));return}if(t.bf)de(e,6,qy(t,r,s,n,i));else switch(t.t){case"d":case"n":var o=t.t=="d"?Yt(Ht(t.v)):t.v;de(e,515,g2(r,s,o,i));break;case"b":case"e":de(e,517,x2(r,s,t.v,i,n,t.t));break;case"s":case"str":if(n.bookSST){var l=Qo(n.Strings,t.v,n.revStrings);de(e,253,d2(r,s,l,i))}else de(e,516,u2(r,s,(t.v||"").slice(0,255),i,n));break;default:de(e,513,Ea(r,s,i))}}function jE(e,t,r){var s=Kt(),n=r.SheetNames[e],i=r.Sheets[n]||{},o=(r||{}).Workbook||{},l=(o.Sheets||[])[e]||{},d=Array.isArray(i),c=t.biff==8,u,h="",f=[],m=Qe(i["!ref"]||"A1"),v=c?65536:16384;if(m.e.c>255||m.e.r>=v){if(t.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:IV16384");m.e.c=Math.min(m.e.c,255),m.e.r=Math.min(m.e.c,v-1)}de(s,2057,Go(r,16,t)),de(s,13,dr(1)),de(s,12,dr(100)),de(s,15,$t(!0)),de(s,17,$t(!1)),de(s,16,ja(.001)),de(s,95,$t(!0)),de(s,42,$t(!1)),de(s,43,$t(!1)),de(s,130,dr(1)),de(s,128,m2()),de(s,131,$t(!1)),de(s,132,$t(!1)),c&&yE(s,i["!cols"]),de(s,512,f2(m,t)),c&&(i["!links"]=[]);for(var g=m.s.r;g<=m.e.r;++g){h=Rt(g);for(var x=m.s.c;x<=m.e.c;++x){g===m.s.r&&(f[x]=It(x)),u=f[x]+h;var b=d?(i[g]||[])[x]:i[u];b&&(NE(s,b,g,x,t),c&&b.l&&i["!links"].push([u,b.l]))}}var N=l.CodeName||l.name||n;return c&&de(s,574,l2((o.Views||[])[0])),c&&(i["!merges"]||[]).length&&de(s,229,w2(i["!merges"])),c&&bE(s,i),de(s,442,q0(N)),c&&vE(s,i),de(s,10),s.end()}function EE(e,t,r){var s=Kt(),n=(e||{}).Workbook||{},i=n.Sheets||[],o=n.WBProps||{},l=r.biff==8,d=r.biff==5;if(de(s,2057,Go(e,5,r)),r.bookType=="xla"&&de(s,135),de(s,225,l?dr(1200):null),de(s,193,Kw(2)),d&&de(s,191),d&&de(s,192),de(s,226),de(s,92,s2("SheetJS",r)),de(s,66,dr(l?1200:1252)),l&&de(s,353,dr(0)),l&&de(s,448),de(s,317,_2(e.SheetNames.length)),l&&e.vbaraw&&de(s,211),l&&e.vbaraw){var c=o.CodeName||"ThisWorkbook";de(s,442,q0(c))}de(s,156,dr(17)),de(s,25,$t(!1)),de(s,18,$t(!1)),de(s,19,dr(0)),l&&de(s,431,$t(!1)),l&&de(s,444,dr(0)),de(s,61,o2()),de(s,64,$t(!1)),de(s,141,dr(0)),de(s,34,$t(Aj(e)=="true")),de(s,14,$t(!0)),l&&de(s,439,$t(!1)),de(s,218,dr(0)),gE(s,e,r),pE(s,e.SSF,r),wE(s,r),l&&de(s,352,$t(!1));var u=s.end(),h=Kt();l&&de(h,140,N2()),l&&r.Strings&&dE(h,252,i2(r.Strings)),de(h,10);var f=h.end(),m=Kt(),v=0,g=0;for(g=0;g<e.SheetNames.length;++g)v+=(l?12:11)+(l?2:1)*e.SheetNames[g].length;var x=u.length+v+f.length;for(g=0;g<e.SheetNames.length;++g){var b=i[g]||{};de(m,133,n2({pos:x,hs:b.Hidden||0,dt:0,name:e.SheetNames[g]},r)),x+=t[g].length}var N=m.end();if(v!=N.length)throw new Error("BS8 "+v+" != "+N.length);var y=[];return u.length&&y.push(u),N.length&&y.push(N),f.length&&y.push(f),Ct(y)}function _E(e,t){var r=t||{},s=[];e&&!e.SSF&&(e.SSF=Jt(st)),e&&e.SSF&&(Jn(),Yn(e.SSF),r.revssf=Qn(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,Zo(r),r.cellXfs=[],ma(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var n=0;n<e.SheetNames.length;++n)s[s.length]=jE(n,r,e);return s.unshift(EE(e,s,r)),Ct(s)}function wh(e,t){for(var r=0;r<=e.SheetNames.length;++r){var s=e.Sheets[e.SheetNames[r]];if(!(!s||!s["!ref"])){var n=sr(s["!ref"]);n.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var i=t||{};switch(i.biff||2){case 8:case 5:return _E(e,t);case 4:case 3:case 2:return xE(e,t)}throw new Error("invalid type "+i.bookType+" for BIFF")}function SE(e,t,r,s){for(var n=e["!merges"]||[],i=[],o=t.s.c;o<=t.e.c;++o){for(var l=0,d=0,c=0;c<n.length;++c)if(!(n[c].s.r>r||n[c].s.c>o)&&!(n[c].e.r<r||n[c].e.c<o)){if(n[c].s.r<r||n[c].s.c<o){l=-1;break}l=n[c].e.r-n[c].s.r+1,d=n[c].e.c-n[c].s.c+1;break}if(!(l<0)){var u=Ke({r,c:o}),h=s.dense?(e[r]||[])[o]:e[u],f=h&&h.v!=null&&(h.h||aw(h.w||(Jr(h),h.w)||""))||"",m={};l>1&&(m.rowspan=l),d>1&&(m.colspan=d),s.editable?f='<span contenteditable="true">'+f+"</span>":h&&(m["data-t"]=h&&h.t||"z",h.v!=null&&(m["data-v"]=h.v),h.z!=null&&(m["data-z"]=h.z),h.l&&(h.l.Target||"#").charAt(0)!="#"&&(f='<a href="'+h.l.Target+'">'+f+"</a>")),m.id=(s.id||"sjs")+"-"+u,i.push(ce("td",f,m))}}var v="<tr>";return v+i.join("")+"</tr>"}var CE='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',TE="</body></html>";function AE(e,t,r){var s=[];return s.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function bh(e,t){var r=t||{},s=r.header!=null?r.header:CE,n=r.footer!=null?r.footer:TE,i=[s],o=sr(e["!ref"]);r.dense=Array.isArray(e),i.push(AE(e,o,r));for(var l=o.s.r;l<=o.e.r;++l)i.push(SE(e,o,l,r));return i.push("</table>"+n),i.join("")}function yh(e,t,r){var s=r||{},n=0,i=0;if(s.origin!=null)if(typeof s.origin=="number")n=s.origin;else{var o=typeof s.origin=="string"?wt(s.origin):s.origin;n=o.r,i=o.c}var l=t.getElementsByTagName("tr"),d=Math.min(s.sheetRows||1e7,l.length),c={s:{r:0,c:0},e:{r:n,c:i}};if(e["!ref"]){var u=sr(e["!ref"]);c.s.r=Math.min(c.s.r,u.s.r),c.s.c=Math.min(c.s.c,u.s.c),c.e.r=Math.max(c.e.r,u.e.r),c.e.c=Math.max(c.e.c,u.e.c),n==-1&&(c.e.r=n=u.e.r+1)}var h=[],f=0,m=e["!rows"]||(e["!rows"]=[]),v=0,g=0,x=0,b=0,N=0,y=0;for(e["!cols"]||(e["!cols"]=[]);v<l.length&&g<d;++v){var A=l[v];if(dc(A)){if(s.display)continue;m[g]={hidden:!0}}var B=A.children;for(x=b=0;x<B.length;++x){var W=B[x];if(!(s.display&&dc(W))){var C=W.hasAttribute("data-v")?W.getAttribute("data-v"):W.hasAttribute("v")?W.getAttribute("v"):ow(W.innerHTML),L=W.getAttribute("data-z")||W.getAttribute("z");for(f=0;f<h.length;++f){var T=h[f];T.s.c==b+i&&T.s.r<g+n&&g+n<=T.e.r&&(b=T.e.c+1-i,f=-1)}y=+W.getAttribute("colspan")||1,((N=+W.getAttribute("rowspan")||1)>1||y>1)&&h.push({s:{r:g+n,c:b+i},e:{r:g+n+(N||1)-1,c:b+i+(y||1)-1}});var P={t:"s",v:C},I=W.getAttribute("data-t")||W.getAttribute("t")||"";C!=null&&(C.length==0?P.t=I||"z":s.raw||C.trim().length==0||I=="s"||(C==="TRUE"?P={t:"b",v:!0}:C==="FALSE"?P={t:"b",v:!1}:isNaN(qr(C))?isNaN(Ds(C).getDate())||(P={t:"d",v:Ht(C)},s.cellDates||(P={t:"n",v:Yt(P.v)}),P.z=s.dateNF||st[14]):P={t:"n",v:qr(C)})),P.z===void 0&&L!=null&&(P.z=L);var V="",ae=W.getElementsByTagName("A");if(ae&&ae.length)for(var _e=0;_e<ae.length&&!(ae[_e].hasAttribute("href")&&(V=ae[_e].getAttribute("href"),V.charAt(0)!="#"));++_e);V&&V.charAt(0)!="#"&&(P.l={Target:V}),s.dense?(e[g+n]||(e[g+n]=[]),e[g+n][b+i]=P):e[Ke({c:b+i,r:g+n})]=P,c.e.c<b+i&&(c.e.c=b+i),b+=y}}++g}return h.length&&(e["!merges"]=(e["!merges"]||[]).concat(h)),c.e.r=Math.max(c.e.r,g-1+n),e["!ref"]=dt(c),g>=d&&(e["!fullref"]=dt((c.e.r=l.length-v+g-1+n,c))),e}function Nh(e,t){var r=t||{},s=r.dense?[]:{};return yh(s,e,t)}function RE(e,t){return Ca(Nh(e,t),t)}function dc(e){var t="",r=FE(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function FE(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var kE=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+Is({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return ut+t}}(),uc=function(){var e=function(i){return Xe(i).replace(/  +/g,function(o){return'<text:s text:c="'+o.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,s=function(i,o,l){var d=[];d.push('      <table:table table:name="'+Xe(o.SheetNames[l])+`" table:style-name="ta1">
`);var c=0,u=0,h=sr(i["!ref"]||"A1"),f=i["!merges"]||[],m=0,v=Array.isArray(i);if(i["!cols"])for(u=0;u<=h.e.c;++u)d.push("        <table:table-column"+(i["!cols"][u]?' table:style-name="co'+i["!cols"][u].ods+'"':"")+`></table:table-column>
`);var g="",x=i["!rows"]||[];for(c=0;c<h.s.r;++c)g=x[c]?' table:style-name="ro'+x[c].ods+'"':"",d.push("        <table:table-row"+g+`></table:table-row>
`);for(;c<=h.e.r;++c){for(g=x[c]?' table:style-name="ro'+x[c].ods+'"':"",d.push("        <table:table-row"+g+`>
`),u=0;u<h.s.c;++u)d.push(t);for(;u<=h.e.c;++u){var b=!1,N={},y="";for(m=0;m!=f.length;++m)if(!(f[m].s.c>u)&&!(f[m].s.r>c)&&!(f[m].e.c<u)&&!(f[m].e.r<c)){(f[m].s.c!=u||f[m].s.r!=c)&&(b=!0),N["table:number-columns-spanned"]=f[m].e.c-f[m].s.c+1,N["table:number-rows-spanned"]=f[m].e.r-f[m].s.r+1;break}if(b){d.push(r);continue}var A=Ke({r:c,c:u}),B=v?(i[c]||[])[u]:i[A];if(B&&B.f&&(N["table:formula"]=Xe(Qy(B.f)),B.F&&B.F.slice(0,A.length)==A)){var W=sr(B.F);N["table:number-matrix-columns-spanned"]=W.e.c-W.s.c+1,N["table:number-matrix-rows-spanned"]=W.e.r-W.s.r+1}if(!B){d.push(t);continue}switch(B.t){case"b":y=B.v?"TRUE":"FALSE",N["office:value-type"]="boolean",N["office:boolean-value"]=B.v?"true":"false";break;case"n":y=B.w||String(B.v||0),N["office:value-type"]="float",N["office:value"]=B.v||0;break;case"s":case"str":y=B.v==null?"":B.v,N["office:value-type"]="string";break;case"d":y=B.w||Ht(B.v).toISOString(),N["office:value-type"]="date",N["office:date-value"]=Ht(B.v).toISOString(),N["table:style-name"]="ce1";break;default:d.push(t);continue}var C=e(y);if(B.l&&B.l.Target){var L=B.l.Target;L=L.charAt(0)=="#"?"#"+Zy(L.slice(1)):L,L.charAt(0)!="#"&&!L.match(/^\w+:/)&&(L="../"+L),C=ce("text:a",C,{"xlink:href":L.replace(/&/g,"&amp;")})}d.push("          "+ce("table:table-cell",ce("text:p",C,{}),N)+`
`)}d.push(`        </table:table-row>
`)}return d.push(`      </table:table>
`),d.join("")},n=function(i,o){i.push(` <office:automatic-styles>
`),i.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),i.push(`   <number:month number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:day number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:year/>
`),i.push(`  </number:date-style>
`);var l=0;o.SheetNames.map(function(c){return o.Sheets[c]}).forEach(function(c){if(c&&c["!cols"]){for(var u=0;u<c["!cols"].length;++u)if(c["!cols"][u]){var h=c["!cols"][u];if(h.width==null&&h.wpx==null&&h.wch==null)continue;Xo(h),h.ods=l;var f=c["!cols"][u].wpx+"px";i.push('  <style:style style:name="co'+l+`" style:family="table-column">
`),i.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+f+`"/>
`),i.push(`  </style:style>
`),++l}}});var d=0;o.SheetNames.map(function(c){return o.Sheets[c]}).forEach(function(c){if(c&&c["!rows"]){for(var u=0;u<c["!rows"].length;++u)if(c["!rows"][u]){c["!rows"][u].ods=d;var h=c["!rows"][u].hpx+"px";i.push('  <style:style style:name="ro'+d+`" style:family="table-row">
`),i.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+h+`"/>
`),i.push(`  </style:style>
`),++d}}}),i.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),i.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),i.push(`  </style:style>
`),i.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),i.push(` </office:automatic-styles>
`)};return function(o,l){var d=[ut],c=Is({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),u=Is({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});l.bookType=="fods"?(d.push("<office:document"+c+u+`>
`),d.push(M0().replace(/office:document-meta/g,"office:meta"))):d.push("<office:document-content"+c+`>
`),n(d,o),d.push(`  <office:body>
`),d.push(`    <office:spreadsheet>
`);for(var h=0;h!=o.SheetNames.length;++h)d.push(s(o.Sheets[o.SheetNames[h]],o,h));return d.push(`    </office:spreadsheet>
`),d.push(`  </office:body>
`),l.bookType=="fods"?d.push("</office:document>"):d.push("</office:document-content>"),d.join("")}}();function jh(e,t){if(t.bookType=="fods")return uc(e,t);var r=Mo(),s="",n=[],i=[];return s="mimetype",Ie(r,s,"application/vnd.oasis.opendocument.spreadsheet"),s="content.xml",Ie(r,s,uc(e,t)),n.push([s,"text/xml"]),i.push([s,"ContentFile"]),s="styles.xml",Ie(r,s,kE(e,t)),n.push([s,"text/xml"]),i.push([s,"StylesFile"]),s="meta.xml",Ie(r,s,ut+M0()),n.push([s,"text/xml"]),i.push([s,"MetadataFile"]),s="manifest.rdf",Ie(r,s,Hw(i)),n.push([s,"application/rdf+xml"]),s="META-INF/manifest.xml",Ie(r,s,zw(n)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Dn(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function DE(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):br(Ps(e))}function PE(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var s=0;s<t.length;++s)if(e[r+s]!=t[s])continue e;return!0}return!1}function ha(e){var t=e.reduce(function(n,i){return n+i.length},0),r=new Uint8Array(t),s=0;return e.forEach(function(n){r.set(n,s),s+=n.length}),r}function IE(e,t,r){var s=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,n=r/Math.pow(10,s-6176);e[t+15]|=s>>7,e[t+14]|=(s&127)<<1;for(var i=0;n>=1;++i,n/=256)e[t+i]=n&255;e[t+15]|=r>=0?0:128}function Os(e,t){var r=t?t[0]:0,s=e[r]&127;e:if(e[r++]>=128&&(s|=(e[r]&127)<<7,e[r++]<128||(s|=(e[r]&127)<<14,e[r++]<128)||(s|=(e[r]&127)<<21,e[r++]<128)||(s+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(s+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(s+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),s}function We(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function Ga(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function ht(e){for(var t=[],r=[0];r[0]<e.length;){var s=r[0],n=Os(e,r),i=n&7;n=Math.floor(n/8);var o=0,l;if(n==0)break;switch(i){case 0:{for(var d=r[0];e[r[0]++]>=128;);l=e.slice(d,r[0])}break;case 5:o=4,l=e.slice(r[0],r[0]+o),r[0]+=o;break;case 1:o=8,l=e.slice(r[0],r[0]+o),r[0]+=o;break;case 2:o=Os(e,r),l=e.slice(r[0],r[0]+o),r[0]+=o;break;case 3:case 4:default:throw new Error("PB Type ".concat(i," for Field ").concat(n," at offset ").concat(s))}var c={data:l,type:i};t[n]==null?t[n]=[c]:t[n].push(c)}return t}function _t(e){var t=[];return e.forEach(function(r,s){r.forEach(function(n){n.data&&(t.push(We(s*8+n.type)),n.type==2&&t.push(We(n.data.length)),t.push(n.data))})}),ha(t)}function pr(e){for(var t,r=[],s=[0];s[0]<e.length;){var n=Os(e,s),i=ht(e.slice(s[0],s[0]+n));s[0]+=n;var o={id:Ga(i[1][0].data),messages:[]};i[2].forEach(function(l){var d=ht(l.data),c=Ga(d[3][0].data);o.messages.push({meta:d,data:e.slice(s[0],s[0]+c)}),s[0]+=c}),(t=i[3])!=null&&t[0]&&(o.merge=Ga(i[3][0].data)>>>0>0),r.push(o)}return r}function Oa(e){var t=[];return e.forEach(function(r){var s=[];s[1]=[{data:We(r.id),type:0}],s[2]=[],r.merge!=null&&(s[3]=[{data:We(+!!r.merge),type:0}]);var n=[];r.messages.forEach(function(o){n.push(o.data),o.meta[3]=[{type:0,data:We(o.data.length)}],s[2].push({data:_t(o.meta),type:2})});var i=_t(s);t.push(We(i.length)),t.push(i),n.forEach(function(o){return t.push(o)})}),ha(t)}function OE(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],s=Os(t,r),n=[];r[0]<t.length;){var i=t[r[0]]&3;if(i==0){var o=t[r[0]++]>>2;if(o<60)++o;else{var l=o-59;o=t[r[0]],l>1&&(o|=t[r[0]+1]<<8),l>2&&(o|=t[r[0]+2]<<16),l>3&&(o|=t[r[0]+3]<<24),o>>>=0,o++,r[0]+=l}n.push(t.slice(r[0],r[0]+o)),r[0]+=o;continue}else{var d=0,c=0;if(i==1?(c=(t[r[0]]>>2&7)+4,d=(t[r[0]++]&224)<<3,d|=t[r[0]++]):(c=(t[r[0]++]>>2)+1,i==2?(d=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(d=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),n=[ha(n)],d==0)throw new Error("Invalid offset 0");if(d>n[0].length)throw new Error("Invalid offset beyond length");if(c>=d)for(n.push(n[0].slice(-d)),c-=d;c>=n[n.length-1].length;)n.push(n[n.length-1]),c-=n[n.length-1].length;n.push(n[0].slice(-d,-d+c))}}var u=ha(n);if(u.length!=s)throw new Error("Unexpected length: ".concat(u.length," != ").concat(s));return u}function vr(e){for(var t=[],r=0;r<e.length;){var s=e[r++],n=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(OE(s,e.slice(r,r+n))),r+=n}if(r!==e.length)throw new Error("data is not a valid framed stream!");return ha(t)}function Ma(e){for(var t=[],r=0;r<e.length;){var s=Math.min(e.length-r,268435455),n=new Uint8Array(4);t.push(n);var i=We(s),o=i.length;t.push(i),s<=60?(o++,t.push(new Uint8Array([s-1<<2]))):s<=256?(o+=2,t.push(new Uint8Array([240,s-1&255]))):s<=65536?(o+=3,t.push(new Uint8Array([244,s-1&255,s-1>>8&255]))):s<=16777216?(o+=4,t.push(new Uint8Array([248,s-1&255,s-1>>8&255,s-1>>16&255]))):s<=4294967296&&(o+=5,t.push(new Uint8Array([252,s-1&255,s-1>>8&255,s-1>>16&255,s-1>>>24&255]))),t.push(e.slice(r,r+s)),o+=s,n[0]=0,n[1]=o&255,n[2]=o>>8&255,n[3]=o>>16&255,r+=s}return ha(t)}function Ti(e,t){var r=new Uint8Array(32),s=Dn(r),n=12,i=0;switch(r[0]=5,e.t){case"n":r[1]=2,IE(r,n,e.v),i|=1,n+=16;break;case"b":r[1]=6,s.setFloat64(n,e.v?1:0,!0),i|=2,n+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,s.setUint32(n,t.indexOf(e.v),!0),i|=8,n+=4;break;default:throw"unsupported cell type "+e.t}return s.setUint32(8,i,!0),r.slice(0,n)}function Ai(e,t){var r=new Uint8Array(32),s=Dn(r),n=12,i=0;switch(r[0]=3,e.t){case"n":r[2]=2,s.setFloat64(n,e.v,!0),i|=32,n+=8;break;case"b":r[2]=6,s.setFloat64(n,e.v?1:0,!0),i|=32,n+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,s.setUint32(n,t.indexOf(e.v),!0),i|=16,n+=4;break;default:throw"unsupported cell type "+e.t}return s.setUint32(4,i,!0),r.slice(0,n)}function ta(e){var t=ht(e);return Os(t[1][0].data)}function ME(e,t,r){var s,n,i,o;if(!((s=e[6])!=null&&s[0])||!((n=e[7])!=null&&n[0]))throw"Mutation only works on post-BNC storages!";var l=((o=(i=e[8])==null?void 0:i[0])==null?void 0:o.data)&&Ga(e[8][0].data)>0||!1;if(l)throw"Math only works with normal offsets";for(var d=0,c=Dn(e[7][0].data),u=0,h=[],f=Dn(e[4][0].data),m=0,v=[],g=0;g<t.length;++g){if(t[g]==null){c.setUint16(g*2,65535,!0),f.setUint16(g*2,65535);continue}c.setUint16(g*2,u,!0),f.setUint16(g*2,m,!0);var x,b;switch(typeof t[g]){case"string":x=Ti({t:"s",v:t[g]},r),b=Ai({t:"s",v:t[g]},r);break;case"number":x=Ti({t:"n",v:t[g]},r),b=Ai({t:"n",v:t[g]},r);break;case"boolean":x=Ti({t:"b",v:t[g]},r),b=Ai({t:"b",v:t[g]},r);break;default:throw new Error("Unsupported value "+t[g])}h.push(x),u+=x.length,v.push(b),m+=b.length,++d}for(e[2][0].data=We(d);g<e[7][0].data.length/2;++g)c.setUint16(g*2,65535,!0),f.setUint16(g*2,65535,!0);return e[6][0].data=ha(h),e[3][0].data=ha(v),d}function LE(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var s=sr(r["!ref"]);s.s.r=s.s.c=0;var n=!1;s.e.c>9&&(n=!0,s.e.c=9),s.e.r>49&&(n=!0,s.e.r=49),n&&console.error("The Numbers writer is currently limited to ".concat(dt(s)));var i=Pn(r,{range:s,header:1}),o=["~Sh33tJ5~"];i.forEach(function(M){return M.forEach(function(O){typeof O=="string"&&o.push(O)})});var l={},d=[],c=Ye.read(t.numbers,{type:"base64"});c.FileIndex.map(function(M,O){return[M,c.FullPaths[O]]}).forEach(function(M){var O=M[0],R=M[1];if(O.type==2&&O.name.match(/\.iwa/)){var q=O.content,z=vr(q),D=pr(z);D.forEach(function(G){d.push(G.id),l[G.id]={deps:[],location:R,type:Ga(G.messages[0].meta[1][0].data)}})}}),d.sort(function(M,O){return M-O});var u=d.filter(function(M){return M>1}).map(function(M){return[M,We(M)]});c.FileIndex.map(function(M,O){return[M,c.FullPaths[O]]}).forEach(function(M){var O=M[0];if(M[1],!!O.name.match(/\.iwa/)){var R=pr(vr(O.content));R.forEach(function(q){q.messages.forEach(function(z){u.forEach(function(D){q.messages.some(function(G){return Ga(G.meta[1][0].data)!=11006&&PE(G.data,D[1])})&&l[D[0]].deps.push(q.id)})})})}});for(var h=Ye.find(c,l[1].location),f=pr(vr(h.content)),m,v=0;v<f.length;++v){var g=f[v];g.id==1&&(m=g)}var x=ta(ht(m.messages[0].data)[1][0].data);for(h=Ye.find(c,l[x].location),f=pr(vr(h.content)),v=0;v<f.length;++v)g=f[v],g.id==x&&(m=g);for(x=ta(ht(m.messages[0].data)[2][0].data),h=Ye.find(c,l[x].location),f=pr(vr(h.content)),v=0;v<f.length;++v)g=f[v],g.id==x&&(m=g);for(x=ta(ht(m.messages[0].data)[2][0].data),h=Ye.find(c,l[x].location),f=pr(vr(h.content)),v=0;v<f.length;++v)g=f[v],g.id==x&&(m=g);var b=ht(m.messages[0].data);{b[6][0].data=We(s.e.r+1),b[7][0].data=We(s.e.c+1);var N=ta(b[46][0].data),y=Ye.find(c,l[N].location),A=pr(vr(y.content));{for(var B=0;B<A.length&&A[B].id!=N;++B);if(A[B].id!=N)throw"Bad ColumnRowUIDMapArchive";var W=ht(A[B].messages[0].data);W[1]=[],W[2]=[],W[3]=[];for(var C=0;C<=s.e.c;++C){var L=[];L[1]=L[2]=[{type:0,data:We(C+420690)}],W[1].push({type:2,data:_t(L)}),W[2].push({type:0,data:We(C)}),W[3].push({type:0,data:We(C)})}W[4]=[],W[5]=[],W[6]=[];for(var T=0;T<=s.e.r;++T)L=[],L[1]=L[2]=[{type:0,data:We(T+726270)}],W[4].push({type:2,data:_t(L)}),W[5].push({type:0,data:We(T)}),W[6].push({type:0,data:We(T)});A[B].messages[0].data=_t(W)}y.content=Ma(Oa(A)),y.size=y.content.length,delete b[46];var P=ht(b[4][0].data);{P[7][0].data=We(s.e.r+1);var I=ht(P[1][0].data),V=ta(I[2][0].data);y=Ye.find(c,l[V].location),A=pr(vr(y.content));{if(A[0].id!=V)throw"Bad HeaderStorageBucket";var ae=ht(A[0].messages[0].data);for(T=0;T<i.length;++T){var _e=ht(ae[2][0].data);_e[1][0].data=We(T),_e[4][0].data=We(i[T].length),ae[2][T]={type:ae[2][0].type,data:_t(_e)}}A[0].messages[0].data=_t(ae)}y.content=Ma(Oa(A)),y.size=y.content.length;var ve=ta(P[2][0].data);y=Ye.find(c,l[ve].location),A=pr(vr(y.content));{if(A[0].id!=ve)throw"Bad HeaderStorageBucket";for(ae=ht(A[0].messages[0].data),C=0;C<=s.e.c;++C)_e=ht(ae[2][0].data),_e[1][0].data=We(C),_e[4][0].data=We(s.e.r+1),ae[2][C]={type:ae[2][0].type,data:_t(_e)};A[0].messages[0].data=_t(ae)}y.content=Ma(Oa(A)),y.size=y.content.length;var we=ta(P[4][0].data);(function(){for(var M=Ye.find(c,l[we].location),O=pr(vr(M.content)),R,q=0;q<O.length;++q){var z=O[q];z.id==we&&(R=z)}var D=ht(R.messages[0].data);{D[3]=[];var G=[];o.forEach(function(Te,Me){G[1]=[{type:0,data:We(Me)}],G[2]=[{type:0,data:We(1)}],G[3]=[{type:2,data:DE(Te)}],D[3].push({type:2,data:_t(G)})})}R.messages[0].data=_t(D);var ee=Oa(O),ge=Ma(ee);M.content=ge,M.size=M.content.length})();var be=ht(P[3][0].data);{var J=be[1][0];delete be[2];var Z=ht(J.data);{var ue=ta(Z[2][0].data);(function(){for(var M=Ye.find(c,l[ue].location),O=pr(vr(M.content)),R,q=0;q<O.length;++q){var z=O[q];z.id==ue&&(R=z)}var D=ht(R.messages[0].data);{delete D[6],delete be[7];var G=new Uint8Array(D[5][0].data);D[5]=[];for(var ee=0,ge=0;ge<=s.e.r;++ge){var Te=ht(G);ee+=ME(Te,i[ge],o),Te[1][0].data=We(ge),D[5].push({data:_t(Te),type:2})}D[1]=[{type:0,data:We(s.e.c+1)}],D[2]=[{type:0,data:We(s.e.r+1)}],D[3]=[{type:0,data:We(ee)}],D[4]=[{type:0,data:We(s.e.r+1)}]}R.messages[0].data=_t(D);var Me=Oa(O),pe=Ma(Me);M.content=pe,M.size=M.content.length})()}J.data=_t(Z)}P[3][0].data=_t(be)}b[4][0].data=_t(P)}m.messages[0].data=_t(b);var me=Oa(f),k=Ma(me);return h.content=k,h.size=h.content.length,c}function BE(e){return function(r){for(var s=0;s!=e.length;++s){var n=e[s];r[n[0]]===void 0&&(r[n[0]]=n[1]),n[2]==="n"&&(r[n[0]]=Number(r[n[0]]))}}}function Zo(e){BE([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function UE(e,t){return t.bookType=="ods"?jh(e,t):t.bookType=="numbers"?LE(e,t):t.bookType=="xlsb"?$E(e,t):zE(e,t)}function $E(e,t){Ua=1024,e&&!e.SSF&&(e.SSF=Jt(st)),e&&e.SSF&&(Jn(),Yn(e.SSF),t.revssf=Qn(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,bs?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",s=nh.indexOf(t.bookType)>-1,n=P0();Zo(t=t||{});var i=Mo(),o="",l=0;if(t.cellXfs=[],ma(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),o="docProps/core.xml",Ie(i,o,L0(e.Props,t)),n.coreprops.push(o),qe(t.rels,2,o,Ue.CORE_PROPS),o="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var d=[],c=0;c<e.SheetNames.length;++c)(e.Workbook.Sheets[c]||{}).Hidden!=2&&d.push(e.SheetNames[c]);e.Props.SheetNames=d}for(e.Props.Worksheets=e.Props.SheetNames.length,Ie(i,o,U0(e.Props)),n.extprops.push(o),qe(t.rels,3,o,Ue.EXT_PROPS),e.Custprops!==e.Props&&Ft(e.Custprops||{}).length>0&&(o="docProps/custom.xml",Ie(i,o,$0(e.Custprops)),n.custprops.push(o),qe(t.rels,4,o,Ue.CUST_PROPS)),l=1;l<=e.SheetNames.length;++l){var u={"!id":{}},h=e.Sheets[e.SheetNames[l-1]],f=(h||{})["!type"]||"sheet";switch(f){case"chart":default:o="xl/worksheets/sheet"+l+"."+r,Ie(i,o,Hj(l-1,o,t,e,u)),n.sheets.push(o),qe(t.wbrels,-1,"worksheets/sheet"+l+"."+r,Ue.WS[0])}if(h){var m=h["!comments"],v=!1,g="";m&&m.length>0&&(g="xl/comments"+l+"."+r,Ie(i,g,Gj(m,g)),n.comments.push(g),qe(u,-1,"../comments"+l+"."+r,Ue.CMNT),v=!0),h["!legacy"]&&v&&Ie(i,"xl/drawings/vmlDrawing"+l+".vml",ah(l,h["!comments"])),delete h["!comments"],delete h["!legacy"]}u["!id"].rId1&&Ie(i,O0(o),Wa(u))}return t.Strings!=null&&t.Strings.length>0&&(o="xl/sharedStrings."+r,Ie(i,o,qj(t.Strings,o,t)),n.strs.push(o),qe(t.wbrels,-1,"sharedStrings."+r,Ue.SST)),o="xl/workbook."+r,Ie(i,o,Vj(e,o)),n.workbooks.push(o),qe(t.rels,1,o,Ue.WB),o="xl/theme/theme1.xml",Ie(i,o,th(e.Themes,t)),n.themes.push(o),qe(t.wbrels,-1,"theme/theme1.xml",Ue.THEME),o="xl/styles."+r,Ie(i,o,Wj(e,o,t)),n.styles.push(o),qe(t.wbrels,-1,"styles."+r,Ue.STY),e.vbaraw&&s&&(o="xl/vbaProject.bin",Ie(i,o,e.vbaraw),n.vba.push(o),qe(t.wbrels,-1,"vbaProject.bin",Ue.VBA)),o="xl/metadata."+r,Ie(i,o,Xj(o)),n.metadata.push(o),qe(t.wbrels,-1,"metadata."+r,Ue.XLMETA),Ie(i,"[Content_Types].xml",I0(n,t)),Ie(i,"_rels/.rels",Wa(t.rels)),Ie(i,"xl/_rels/workbook."+r+".rels",Wa(t.wbrels)),delete t.revssf,delete t.ssf,i}function zE(e,t){Ua=1024,e&&!e.SSF&&(e.SSF=Jt(st)),e&&e.SSF&&(Jn(),Yn(e.SSF),t.revssf=Qn(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,bs?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",s=nh.indexOf(t.bookType)>-1,n=P0();Zo(t=t||{});var i=Mo(),o="",l=0;if(t.cellXfs=[],ma(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),o="docProps/core.xml",Ie(i,o,L0(e.Props,t)),n.coreprops.push(o),qe(t.rels,2,o,Ue.CORE_PROPS),o="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var d=[],c=0;c<e.SheetNames.length;++c)(e.Workbook.Sheets[c]||{}).Hidden!=2&&d.push(e.SheetNames[c]);e.Props.SheetNames=d}e.Props.Worksheets=e.Props.SheetNames.length,Ie(i,o,U0(e.Props)),n.extprops.push(o),qe(t.rels,3,o,Ue.EXT_PROPS),e.Custprops!==e.Props&&Ft(e.Custprops||{}).length>0&&(o="docProps/custom.xml",Ie(i,o,$0(e.Custprops)),n.custprops.push(o),qe(t.rels,4,o,Ue.CUST_PROPS));var u=["SheetJ5"];for(t.tcid=0,l=1;l<=e.SheetNames.length;++l){var h={"!id":{}},f=e.Sheets[e.SheetNames[l-1]],m=(f||{})["!type"]||"sheet";switch(m){case"chart":default:o="xl/worksheets/sheet"+l+"."+r,Ie(i,o,mh(l-1,t,e,h)),n.sheets.push(o),qe(t.wbrels,-1,"worksheets/sheet"+l+"."+r,Ue.WS[0])}if(f){var v=f["!comments"],g=!1,x="";if(v&&v.length>0){var b=!1;v.forEach(function(N){N[1].forEach(function(y){y.T==!0&&(b=!0)})}),b&&(x="xl/threadedComments/threadedComment"+l+"."+r,Ie(i,x,wb(v,u,t)),n.threadedcomments.push(x),qe(h,-1,"../threadedComments/threadedComment"+l+"."+r,Ue.TCMNT)),x="xl/comments"+l+"."+r,Ie(i,x,sh(v)),n.comments.push(x),qe(h,-1,"../comments"+l+"."+r,Ue.CMNT),g=!0}f["!legacy"]&&g&&Ie(i,"xl/drawings/vmlDrawing"+l+".vml",ah(l,f["!comments"])),delete f["!comments"],delete f["!legacy"]}h["!id"].rId1&&Ie(i,O0(o),Wa(h))}return t.Strings!=null&&t.Strings.length>0&&(o="xl/sharedStrings."+r,Ie(i,o,K0(t.Strings,t)),n.strs.push(o),qe(t.wbrels,-1,"sharedStrings."+r,Ue.SST)),o="xl/workbook."+r,Ie(i,o,ph(e)),n.workbooks.push(o),qe(t.rels,1,o,Ue.WB),o="xl/theme/theme1.xml",Ie(i,o,th(e.Themes,t)),n.themes.push(o),qe(t.wbrels,-1,"theme/theme1.xml",Ue.THEME),o="xl/styles."+r,Ie(i,o,Z0(e,t)),n.styles.push(o),qe(t.wbrels,-1,"styles."+r,Ue.STY),e.vbaraw&&s&&(o="xl/vbaProject.bin",Ie(i,o,e.vbaraw),n.vba.push(o),qe(t.wbrels,-1,"vbaProject.bin",Ue.VBA)),o="xl/metadata."+r,Ie(i,o,rh()),n.metadata.push(o),qe(t.wbrels,-1,"metadata."+r,Ue.XLMETA),u.length>1&&(o="xl/persons/person.xml",Ie(i,o,bb(u)),n.people.push(o),qe(t.wbrels,-1,"persons/person.xml",Ue.PEOPLE)),Ie(i,"[Content_Types].xml",I0(n,t)),Ie(i,"_rels/.rels",Wa(t.rels)),Ie(i,"xl/_rels/workbook."+r+".rels",Wa(t.wbrels)),delete t.revssf,delete t.ssf,i}function VE(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=Yr(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function Eh(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return Hs(t.file,Ye.write(e,{type:ze?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return Ye.write(e,t)}function HE(e,t){var r=Jt(t||{}),s=UE(e,r);return WE(s,r)}function WE(e,t){var r={},s=ze?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=s;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=s;break;default:throw new Error("Unrecognized type "+t.type)}var n=e.FullPaths?Ye.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof n=="string"){if(t.type=="binary"||t.type=="base64")return n;n=new Uint8Array(Kn(n))}return t.password&&typeof encrypt_agile<"u"?Eh(encrypt_agile(n,t.password),t):t.type==="file"?Hs(t.file,n):t.type=="string"?gs(n):n}function qE(e,t){var r=t||{},s=lE(e,r);return Eh(s,r)}function kr(e,t,r){r||(r="");var s=r+e;switch(t.type){case"base64":return ks(Ps(s));case"binary":return Ps(s);case"string":return e;case"file":return Hs(t.file,s,"utf8");case"buffer":return ze?Qr(s,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(s):kr(s,{type:"binary"}).split("").map(function(n){return n.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function GE(e,t){switch(t.type){case"base64":return ks(e);case"binary":return e;case"string":return e;case"file":return Hs(t.file,e,"binary");case"buffer":return ze?Qr(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function on(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",s=0;s<e.length;++s)r+=String.fromCharCode(e[s]);return t.type=="base64"?ks(r):t.type=="string"?gs(r):r;case"file":return Hs(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function ai(e,t){y1(),kj(e);var r=Jt(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var s=ai(e,r);return r.type="array",Kn(s)}var n=0;if(r.sheet&&(typeof r.sheet=="number"?n=r.sheet:n=e.SheetNames.indexOf(r.sheet),!e.SheetNames[n]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return kr(iE(e,r),r);case"slk":case"sylk":return kr(A2.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"htm":case"html":return kr(bh(e.Sheets[e.SheetNames[n]],r),r);case"txt":return GE(_h(e.Sheets[e.SheetNames[n]],r),r);case"csv":return kr(el(e.Sheets[e.SheetNames[n]],r),r,"\uFEFF");case"dif":return kr(R2.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"dbf":return on(T2.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"prn":return kr(F2.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"rtf":return kr(L2.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"eth":return kr(X0.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"fods":return kr(jh(e,r),r);case"wk1":return on(sc.sheet_to_wk1(e.Sheets[e.SheetNames[n]],r),r);case"wk3":return on(sc.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),on(wh(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),qE(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return HE(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function XE(e,t,r,s,n,i,o,l){var d=Rt(r),c=l.defval,u=l.raw||!Object.prototype.hasOwnProperty.call(l,"raw"),h=!0,f=n===1?[]:{};if(n!==1)if(Object.defineProperty)try{Object.defineProperty(f,"__rowNum__",{value:r,enumerable:!1})}catch{f.__rowNum__=r}else f.__rowNum__=r;if(!o||e[r])for(var m=t.s.c;m<=t.e.c;++m){var v=o?e[r][m]:e[s[m]+d];if(v===void 0||v.t===void 0){if(c===void 0)continue;i[m]!=null&&(f[i[m]]=c);continue}var g=v.v;switch(v.t){case"z":if(g==null)break;continue;case"e":g=g==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+v.t)}if(i[m]!=null){if(g==null)if(v.t=="e"&&g===null)f[i[m]]=null;else if(c!==void 0)f[i[m]]=c;else if(u&&g===null)f[i[m]]=null;else continue;else f[i[m]]=u&&(v.t!=="n"||v.t==="n"&&l.rawNumbers!==!1)?g:Jr(v,g,l);g!=null&&(h=!1)}}return{row:f,isempty:h}}function Pn(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},s=0,n=1,i=[],o=0,l="",d={s:{r:0,c:0},e:{r:0,c:0}},c=t||{},u=c.range!=null?c.range:e["!ref"];switch(c.header===1?s=1:c.header==="A"?s=2:Array.isArray(c.header)?s=3:c.header==null&&(s=0),typeof u){case"string":d=Qe(u);break;case"number":d=Qe(e["!ref"]),d.s.r=u;break;default:d=u}s>0&&(n=0);var h=Rt(d.s.r),f=[],m=[],v=0,g=0,x=Array.isArray(e),b=d.s.r,N=0,y={};x&&!e[b]&&(e[b]=[]);var A=c.skipHidden&&e["!cols"]||[],B=c.skipHidden&&e["!rows"]||[];for(N=d.s.c;N<=d.e.c;++N)if(!(A[N]||{}).hidden)switch(f[N]=It(N),r=x?e[b][N]:e[f[N]+h],s){case 1:i[N]=N-d.s.c;break;case 2:i[N]=f[N];break;case 3:i[N]=c.header[N-d.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),l=o=Jr(r,null,c),g=y[o]||0,!g)y[o]=1;else{do l=o+"_"+g++;while(y[l]);y[o]=g,y[l]=1}i[N]=l}for(b=d.s.r+n;b<=d.e.r;++b)if(!(B[b]||{}).hidden){var W=XE(e,d,b,f,s,i,x,c);(W.isempty===!1||(s===1?c.blankrows!==!1:c.blankrows))&&(m[v++]=W.row)}return m.length=v,m}var hc=/"/g;function KE(e,t,r,s,n,i,o,l){for(var d=!0,c=[],u="",h=Rt(r),f=t.s.c;f<=t.e.c;++f)if(s[f]){var m=l.dense?(e[r]||[])[f]:e[s[f]+h];if(m==null)u="";else if(m.v!=null){d=!1,u=""+(l.rawNumbers&&m.t=="n"?m.v:Jr(m,null,l));for(var v=0,g=0;v!==u.length;++v)if((g=u.charCodeAt(v))===n||g===i||g===34||l.forceQuotes){u='"'+u.replace(hc,'""')+'"';break}u=="ID"&&(u='"ID"')}else m.f!=null&&!m.F?(d=!1,u="="+m.f,u.indexOf(",")>=0&&(u='"'+u.replace(hc,'""')+'"')):u="";c.push(u)}return l.blankrows===!1&&d?null:c.join(o)}function el(e,t){var r=[],s=t??{};if(e==null||e["!ref"]==null)return"";var n=Qe(e["!ref"]),i=s.FS!==void 0?s.FS:",",o=i.charCodeAt(0),l=s.RS!==void 0?s.RS:`
`,d=l.charCodeAt(0),c=new RegExp((i=="|"?"\\|":i)+"+$"),u="",h=[];s.dense=Array.isArray(e);for(var f=s.skipHidden&&e["!cols"]||[],m=s.skipHidden&&e["!rows"]||[],v=n.s.c;v<=n.e.c;++v)(f[v]||{}).hidden||(h[v]=It(v));for(var g=0,x=n.s.r;x<=n.e.r;++x)(m[x]||{}).hidden||(u=KE(e,n,x,h,o,d,i,s),u!=null&&(s.strip&&(u=u.replace(c,"")),(u||s.blankrows!==!1)&&r.push((g++?l:"")+u)));return delete s.dense,r.join("")}function _h(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=el(e,t);return r}function YE(e){var t="",r,s="";if(e==null||e["!ref"]==null)return[];var n=Qe(e["!ref"]),i="",o=[],l,d=[],c=Array.isArray(e);for(l=n.s.c;l<=n.e.c;++l)o[l]=It(l);for(var u=n.s.r;u<=n.e.r;++u)for(i=Rt(u),l=n.s.c;l<=n.e.c;++l)if(t=o[l]+i,r=c?(e[u]||[])[l]:e[t],s="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;s=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)s=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)s=""+r.v;else if(r.t=="b")s=r.v?"TRUE":"FALSE";else if(r.w!==void 0)s="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?s="'"+r.v:s=""+r.v}}d[d.length]=t+"="+s}return d}function Sh(e,t,r){var s=r||{},n=+!s.skipHeader,i=e||{},o=0,l=0;if(i&&s.origin!=null)if(typeof s.origin=="number")o=s.origin;else{var d=typeof s.origin=="string"?wt(s.origin):s.origin;o=d.r,l=d.c}var c,u={s:{c:0,r:0},e:{c:l,r:o+t.length-1+n}};if(i["!ref"]){var h=Qe(i["!ref"]);u.e.c=Math.max(u.e.c,h.e.c),u.e.r=Math.max(u.e.r,h.e.r),o==-1&&(o=h.e.r+1,u.e.r=o+t.length-1+n)}else o==-1&&(o=0,u.e.r=t.length-1+n);var f=s.header||[],m=0;t.forEach(function(g,x){Ft(g).forEach(function(b){(m=f.indexOf(b))==-1&&(f[m=f.length]=b);var N=g[b],y="z",A="",B=Ke({c:l+m,r:o+x+n});c=Ms(i,B),N&&typeof N=="object"&&!(N instanceof Date)?i[B]=N:(typeof N=="number"?y="n":typeof N=="boolean"?y="b":typeof N=="string"?y="s":N instanceof Date?(y="d",s.cellDates||(y="n",N=Yt(N)),A=s.dateNF||st[14]):N===null&&s.nullError&&(y="e",N=0),c?(c.t=y,c.v=N,delete c.w,delete c.R,A&&(c.z=A)):i[B]=c={t:y,v:N},A&&(c.z=A))})}),u.e.c=Math.max(u.e.c,l+f.length-1);var v=Rt(o);if(n)for(m=0;m<f.length;++m)i[It(m+l)+v]={t:"s",v:f[m]};return i["!ref"]=dt(u),i}function JE(e,t){return Sh(null,e,t)}function Ms(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var s=wt(t);return e[s.r]||(e[s.r]=[]),e[s.r][s.c]||(e[s.r][s.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?Ms(e,Ke(t)):Ms(e,Ke({r:t,c:r||0}))}function QE(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function ZE(){return{SheetNames:[],Sheets:{}}}function e_(e,t,r,s){var n=1;if(!r)for(;n<=65535&&e.SheetNames.indexOf(r="Sheet"+n)!=-1;++n,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(s&&e.SheetNames.indexOf(r)>=0){var i=r.match(/(^.*?)(\d+)$/);n=i&&+i[2]||0;var o=i&&i[1]||r;for(++n;n<=65535&&e.SheetNames.indexOf(r=o+n)!=-1;++n);}if(gh(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function t_(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var s=QE(e,t);switch(e.Workbook.Sheets[s]||(e.Workbook.Sheets[s]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[s].Hidden=r}function r_(e,t){return e.z=t,e}function Ch(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function a_(e,t,r){return Ch(e,"#"+t,r)}function s_(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function n_(e,t,r,s){for(var n=typeof t!="string"?t:Qe(t),i=typeof t=="string"?t:dt(t),o=n.s.r;o<=n.e.r;++o)for(var l=n.s.c;l<=n.e.c;++l){var d=Ms(e,o,l);d.t="n",d.F=i,delete d.v,o==n.s.r&&l==n.s.c&&(d.f=r,s&&(d.D=!0))}return e}var ft={encode_col:It,encode_row:Rt,encode_cell:Ke,encode_range:dt,decode_col:Vo,decode_row:zo,split_cell:yw,decode_cell:wt,decode_range:sr,format_cell:Jr,sheet_add_aoa:T0,sheet_add_json:Sh,sheet_add_dom:yh,aoa_to_sheet:rs,json_to_sheet:JE,table_to_sheet:Nh,table_to_book:RE,sheet_to_csv:el,sheet_to_txt:_h,sheet_to_json:Pn,sheet_to_html:bh,sheet_to_formulae:YE,sheet_to_row_object_array:Pn,sheet_get_cell:Ms,book_new:ZE,book_append_sheet:e_,book_set_sheet_visibility:t_,cell_set_number_format:r_,cell_set_hyperlink:Ch,cell_set_internal_link:a_,cell_add_comment:s_,sheet_set_array_formula:n_,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};async function i_(e,t){var r,s,n;try{const{data:i,error:o}=await Ce.from("backup_logs").insert({backup_type:"manual",status:"pending",created_by:e}).select().single();if(o)throw new Error(o.message);const l={};if((r=t.data)!=null&&r.vagas){const{data:h,error:f}=await Ce.from("vagas").select("*");if(f)throw new Error(f.message);l.vagas=h}if((s=t.data)!=null&&s.users){const{data:h,error:f}=await Ce.from("users").select("*");if(f)throw new Error(f.message);l.users=h}if((n=t.data)!=null&&n.backup_logs){const{data:h,error:f}=await Ce.from("backup_logs").select("*");if(f)throw new Error(f.message);l.backup_logs=h}let d="",c=null;t.format==="excel"?(d=`backup_${new Date().toISOString().split("T")[0]}.xlsx`,c=await o_(l)):t.format==="csv"?(d=`backup_${new Date().toISOString().split("T")[0]}.csv`,c=await l_(l)):(d=`backup_${new Date().toISOString().split("T")[0]}.json`,c=JSON.stringify(l,null,2));const{error:u}=await Ce.from("backup_logs").update({backup_data:l,file_path:d,status:"success"}).eq("id",i.id);if(u)throw new Error(u.message);return{...i,backup_data:l,file_path:d,status:"success"}}catch(i){return console.error("Erro ao criar backup manual:",i),null}}async function o_(e){const t=ft.book_new();if(e.vagas&&e.vagas.length>0){const s=ft.json_to_sheet(e.vagas);ft.book_append_sheet(t,s,"Vagas")}if(e.users&&e.users.length>0){const s=ft.json_to_sheet(e.users);ft.book_append_sheet(t,s,"Usuários")}if(e.backup_logs&&e.backup_logs.length>0){const s=ft.json_to_sheet(e.backup_logs);ft.book_append_sheet(t,s,"Logs de Backup")}return ai(t,{type:"buffer",bookType:"xlsx"})}async function l_(e){let t="";return e.vagas&&e.vagas.length>0&&(t+=`=== VAGAS ===
`,t+=ft.sheet_to_csv(ft.json_to_sheet(e.vagas)),t+=`

`),e.users&&e.users.length>0&&(t+=`=== USUÁRIOS ===
`,t+=ft.sheet_to_csv(ft.json_to_sheet(e.users)),t+=`

`),e.backup_logs&&e.backup_logs.length>0&&(t+=`=== LOGS DE BACKUP ===
`,t+=ft.sheet_to_csv(ft.json_to_sheet(e.backup_logs))),t}async function c_(e,t){try{const r=ft.book_new(),s=ft.json_to_sheet(e);ft.book_append_sheet(r,s,"Dados");const n=ai(r,{type:"buffer",bookType:"xlsx"}),i=new Blob([n],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),o=window.URL.createObjectURL(i),l=document.createElement("a");l.href=o,l.download=t,l.click(),window.URL.revokeObjectURL(o)}catch(r){console.error("Erro ao exportar para Excel:",r)}}async function fc(){try{const{data:e,error:t}=await Ce.from("backup_logs").select("*").order("created_at",{ascending:!1});if(t)throw new Error(t.message);return e||[]}catch(e){return console.error("Erro ao buscar logs de backup:",e),[]}}function Ks(){const{mode:e,profile:t}=hr();return{mode:e,profile:t,getCardVariant:o=>{const l=["card-pastel-blue","card-pastel-purple","card-pastel-green","card-pastel-orange","card-pastel-pink","card-pastel-teal"];return l[o%l.length]},getGradientVariant:o=>{const l=["gradient-pastel-blue","gradient-pastel-purple","gradient-pastel-green","gradient-pastel-orange","gradient-pastel-pink","gradient-pastel-teal"];return l[o%l.length]},textClasses:{primary:e==="dark"?"text-contrast-primary":"text-gray-900",secondary:e==="dark"?"text-contrast-secondary":"text-gray-700",muted:e==="dark"?"text-contrast-muted":"text-gray-500",accent:e==="dark"?"text-contrast-accent":"text-blue-600",heading:e==="dark"?"text-xl font-bold text-contrast-primary uppercase tracking-wide":"text-xl font-bold text-gray-900 uppercase tracking-wide"},cardClasses:{base:"w-full hover-pastel transition-all duration-300",header:"cursor-pointer transition-colors"}}}function zr({title:e,content:t,children:r}){const{textClasses:s}=Ks(),n=i=>i?a.jsx("div",{className:"whitespace-pre-wrap space-y-2",children:i.split(`
`).map((o,l)=>{var c;const d=o.trim();return d?d.startsWith("•")||d.startsWith("-")||d.startsWith("*")?a.jsxs("div",{className:"flex items-start",children:[a.jsx("span",{className:"text-primary mr-2 mt-1 flex-shrink-0",children:"•"}),a.jsx("span",{className:"flex-1",children:d.substring(1).trim()})]},l):/^\d+\.\s/.test(d)?a.jsxs("div",{className:"flex items-start",children:[a.jsxs("span",{className:"text-primary mr-2 mt-1 flex-shrink-0 font-semibold",children:[(c=d.match(/^\d+/))==null?void 0:c[0],"."]}),a.jsx("span",{className:"flex-1",children:d.replace(/^\d+\.\s/,"").trim()})]},l):a.jsx("div",{className:"leading-relaxed",children:d},l):a.jsx("div",{className:"h-2"},l)})}):null;return a.jsxs("div",{className:"space-y-4",children:[a.jsx("h2",{className:`${s.primary} text-xl font-bold uppercase tracking-wide border-b border-border/50 pb-2`,children:e}),a.jsx("div",{className:`${s.primary} leading-relaxed`,children:t?n(t):r||a.jsx("p",{className:`${s.primary} italic`,children:"Informação não disponível"})})]})}function d_(e,t){const r=new Date().toLocaleString("pt-BR");switch(t.format){case"txt":return mc(e,t,r);case"json":return u_(e,t,r);default:return mc(e,t,r)}}function mc(e,t,r){let s="";return t.includeTimestamp&&(s+=`Gerado em: ${r}
`,s+="=".repeat(50)+`

`),s+=`VAGA DE EMPREGO
`,s+="=".repeat(50)+`

`,s+=`TÍTULO: ${e.titulo||e.cargo}
`,s+=`CLIENTE: ${e.cliente}
`,s+=`SITE: ${e.site}
`,s+=`CATEGORIA: ${e.categoria}
`,s+=`CARGO: ${e.cargo}
`,s+=`CÉLULA: ${e.celula}

`,e.descricao_vaga&&(s+=`DESCRIÇÃO DA VAGA:
`,s+="-".repeat(30)+`
`,s+=`${e.descricao_vaga}

`),e.responsabilidades_atribuicoes&&(s+=`RESPONSABILIDADES E ATRIBUIÇÕES:
`,s+="-".repeat(30)+`
`,s+=`${e.responsabilidades_atribuicoes}

`),e.requisitos_qualificacoes&&(s+=`REQUISITOS E QUALIFICAÇÕES:
`,s+="-".repeat(30)+`
`,s+=`${e.requisitos_qualificacoes}

`),e.salario&&(s+=`SALÁRIO: ${e.salario}
`),e.horario_trabalho&&(s+=`HORÁRIO DE TRABALHO: ${e.horario_trabalho}
`),e.jornada_trabalho&&(s+=`JORNADA DE TRABALHO: ${e.jornada_trabalho}
`),(e.salario||e.horario_trabalho||e.jornada_trabalho)&&(s+=`
`),e.beneficios&&(s+=`BENEFÍCIOS:
`,s+="-".repeat(30)+`
`,s+=`${e.beneficios}

`),e.local_trabalho&&(s+=`LOCAL DE TRABALHO:
`,s+="-".repeat(30)+`
`,s+=`${e.local_trabalho}

`),e.etapas_processo&&(s+=`ETAPAS DO PROCESSO:
`,s+="-".repeat(30)+`
`,s+=`${e.etapas_processo}

`),t.includeMetadata&&(s+=`METADADOS:
`,s+="-".repeat(30)+`
`,s+=`ID: ${e.id}
`,s+=`Criado em: ${new Date(e.created_at).toLocaleString("pt-BR")}
`,s+=`Atualizado em: ${new Date(e.updated_at).toLocaleString("pt-BR")}
`,e.created_by&&(s+=`Criado por: ${e.created_by}
`),e.updated_by&&(s+=`Atualizado por: ${e.updated_by}
`)),s}function u_(e,t,r){const s={metadata:t.includeTimestamp?{generatedAt:r,generatedBy:"Repositório de Vagas"}:void 0,vaga:{id:e.id,titulo:e.titulo,cliente:e.cliente,site:e.site,categoria:e.categoria,cargo:e.cargo,celula:e.celula,descricao_vaga:e.descricao_vaga,responsabilidades_atribuicoes:e.responsabilidades_atribuicoes,requisitos_qualificacoes:e.requisitos_qualificacoes,salario:e.salario,horario_trabalho:e.horario_trabalho,jornada_trabalho:e.jornada_trabalho,beneficios:e.beneficios,local_trabalho:e.local_trabalho,etapas_processo:e.etapas_processo,...t.includeMetadata&&{created_at:e.created_at,updated_at:e.updated_at,created_by:e.created_by,updated_by:e.updated_by}}};return JSON.stringify(s,null,2)}function h_(e,t={format:"txt",includeMetadata:!0,includeTimestamp:!0}){try{const r=d_(e,t),s=new Blob([r],{type:t.format==="json"?"application/json":"text/plain;charset=utf-8"}),n=URL.createObjectURL(s),i=document.createElement("a");i.href=n;const o=(e.titulo||e.cargo||"vaga").replace(/[^a-zA-Z0-9\s]/g,"").replace(/\s+/g,"_"),l=new Date().toISOString().split("T")[0];i.download=`${o}_${e.cliente}_${l}.${t.format}`,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(n),console.log(`📄 Arquivo ${t.format.toUpperCase()} baixado com sucesso: ${i.download}`)}catch(r){console.error("Erro ao gerar download:",r),alert("Erro ao gerar arquivo de download")}}function f_(e){h_(e,{format:"txt",includeMetadata:!0,includeTimestamp:!0})}function ro({vaga:e,onEdit:t,onDelete:r,onFocus:s,showActions:n=!1,showEditAction:i=!0,showDeleteAction:o=!0,showFocusAction:l=!0,showDownloadAction:d=!0,variantIndex:c=0,isExpanded:u}){const[h,f]=p.useState(!1),m=u!==void 0?u:h,{textClasses:v,cardClasses:g,getCardVariant:x}=Ks(),b=()=>{u===void 0&&f(!h)},N=y=>{y.stopPropagation(),f_(e)};return a.jsxs(Ee,{className:`${g.base} ${x(c)} dark:${x(c)} group`,children:[a.jsx(Ae,{className:g.header,onClick:b,children:a.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center justify-between gap-3",children:[a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs(Fe,{className:`${v.heading} mb-1 text-sm md:text-base`,children:[e.titulo||e.cargo," - ",e.cliente]}),a.jsx(Ge,{className:`text-sm md:text-lg ${v.accent} font-semibold`,children:e.celula})]}),a.jsxs("div",{className:"flex items-center justify-between lg:justify-end gap-2",children:[(n||l||d)&&a.jsxs("div",{className:"flex items-center gap-1",children:[s&&l&&a.jsxs(Q,{size:"sm",variant:"outline",onClick:y=>{y.stopPropagation(),s()},className:"flex items-center gap-1 bg-primary/10 hover:bg-primary/20 text-primary border-primary/20 transition-all duration-200 hover:scale-105 active:scale-95 hover:shadow-md",children:[a.jsx(Pt,{className:"h-3 w-3 md:h-4 md:w-4 transition-transform duration-200 hover:scale-110"}),a.jsx("span",{className:"hidden sm:inline",children:"Focar"})]}),t&&i&&a.jsxs(Q,{size:"sm",variant:"outline",onClick:y=>{y.stopPropagation(),t()},className:"flex items-center gap-1 transition-all duration-200 hover:scale-105 active:scale-95 hover:shadow-md",children:[a.jsx(va,{className:"h-3 w-3 md:h-4 md:w-4 transition-transform duration-200 hover:rotate-12"}),a.jsx("span",{className:"hidden sm:inline",children:"Editar"})]}),d&&a.jsxs(Q,{size:"sm",variant:"outline",onClick:N,className:"flex items-center gap-1 bg-green-50 hover:bg-green-100 text-green-700 border-green-200 transition-all duration-200 hover:scale-105 active:scale-95 hover:shadow-md",children:[a.jsx(jr,{className:"h-3 w-3 md:h-4 md:w-4 transition-transform duration-200 hover:scale-110"}),a.jsx("span",{className:"hidden sm:inline",children:"Download"})]}),r&&o&&a.jsxs(Q,{size:"sm",variant:"outline",onClick:y=>{y.stopPropagation(),r()},className:"text-red-600 hover:text-red-700 flex items-center gap-1 transition-all duration-200 hover:scale-105 active:scale-95 hover:shadow-md",children:[a.jsx(Kr,{className:"h-3 w-3 md:h-4 md:w-4 transition-transform duration-200 hover:rotate-12"}),a.jsx("span",{className:"hidden sm:inline",children:"Excluir"})]})]}),a.jsx("div",{className:"transition-transform duration-200 group-hover:scale-110",children:m?a.jsx(_s,{className:"h-5 w-5 md:h-6 md:w-6"}):a.jsx(Ka,{className:"h-5 w-5 md:h-6 md:w-6"})})]})]})}),m&&a.jsxs(Se,{className:"space-y-8 animate-in slide-in-from-top-2 duration-300",children:[a.jsx(zr,{title:"Descrição da oportunidade",content:e.descricao_vaga}),a.jsx(zr,{title:"Responsabilidades e atribuições",content:e.responsabilidades_atribuicoes}),a.jsx(zr,{title:"Requisitos e qualificações",content:e.requisitos_qualificacoes}),a.jsx(zr,{title:"Salário",children:e.salario?a.jsx("p",{className:`${v.primary}`,children:a.jsx("strong",{children:e.salario})}):null}),a.jsx(zr,{title:"Horário de Trabalho",content:e.horario_trabalho}),a.jsx(zr,{title:"Jornada de Trabalho",content:e.jornada_trabalho}),a.jsx(zr,{title:"Benefícios",children:e.beneficios?a.jsx("div",{className:"space-y-2",children:e.beneficios.split(";").map((y,A)=>a.jsxs("div",{className:"flex items-start",children:[a.jsx("span",{className:`${v.primary} mr-2 mt-1`,children:"•"}),a.jsx("span",{className:`${v.primary}`,children:y.trim()})]},A))}):null}),a.jsx(zr,{title:"Local de Trabalho",content:e.local_trabalho}),a.jsx(zr,{title:"Etapas do processo",children:e.etapas_processo?a.jsx("div",{className:"space-y-3",children:e.etapas_processo.split(`
`).filter(y=>y.trim()).map((y,A)=>{const B=y.trim().replace(/^Etapa\s+\d+:\s*/i,"");return a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"flex-shrink-0 w-8 h-8 bg-gray-800 dark:bg-gray-600 text-white rounded-full flex items-center justify-center text-sm font-bold mr-3",children:A+1}),a.jsx("span",{className:`${v.primary}`,children:B})]},A)})}):null})]})]})}const Gt=Rf,Xt=Ff,zt=p.forwardRef(({className:e,children:t,...r},s)=>a.jsxs(Ac,{ref:s,className:De("flex h-9 w-full items-center justify-between whitespace-nowrap rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-sm ring-offset-background data-[placeholder]:text-muted-foreground focus:outline-none focus:ring-1 focus:ring-ring disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",e),...r,children:[t,a.jsx(_f,{asChild:!0,children:a.jsx(Ka,{className:"h-4 w-4 opacity-50"})})]}));zt.displayName=Ac.displayName;const Th=p.forwardRef(({className:e,...t},r)=>a.jsx(Rc,{ref:r,className:De("flex cursor-default items-center justify-center py-1",e),...t,children:a.jsx(_s,{className:"h-4 w-4"})}));Th.displayName=Rc.displayName;const Ah=p.forwardRef(({className:e,...t},r)=>a.jsx(Fc,{ref:r,className:De("flex cursor-default items-center justify-center py-1",e),...t,children:a.jsx(Ka,{className:"h-4 w-4"})}));Ah.displayName=Fc.displayName;const Vt=p.forwardRef(({className:e,children:t,position:r="popper",...s},n)=>a.jsx(Sf,{children:a.jsxs(kc,{ref:n,className:De("relative z-50 max-h-[--radix-select-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-select-content-transform-origin]",r==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),position:r,...s,children:[a.jsx(Th,{}),a.jsx(Cf,{className:De("p-1",r==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:t}),a.jsx(Ah,{})]})}));Vt.displayName=kc.displayName;const m_=p.forwardRef(({className:e,...t},r)=>a.jsx(Dc,{ref:r,className:De("px-2 py-1.5 text-sm font-semibold",e),...t}));m_.displayName=Dc.displayName;const Oe=p.forwardRef(({className:e,children:t,...r},s)=>a.jsxs(Pc,{ref:s,className:De("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-2 pr-8 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...r,children:[a.jsx("span",{className:"absolute right-2 flex h-3.5 w-3.5 items-center justify-center",children:a.jsx(Tf,{children:a.jsx(Uc,{className:"h-4 w-4"})})}),a.jsx(Af,{children:t})]}));Oe.displayName=Pc.displayName;const x_=p.forwardRef(({className:e,...t},r)=>a.jsx(Ic,{ref:r,className:De("-mx-1 my-1 h-px bg-muted",e),...t}));x_.displayName=Ic.displayName;const rr=p.forwardRef(({className:e,...t},r)=>a.jsx("textarea",{className:De("flex min-h-[60px] w-full rounded-md border border-input bg-transparent px-3 py-2 text-base shadow-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),ref:r,...t}));rr.displayName="Textarea";const xc=[{key:"site",label:"Site"},{key:"categoria",label:"Categoria"},{key:"cargo",label:"Cargo"},{key:"cliente",label:"Cliente"},{key:"titulo",label:"Título"},{key:"descricao_vaga",label:"Descrição da vaga"},{key:"responsabilidades_atribuicoes",label:"Responsabilidades e atribuições"},{key:"requisitos_qualificacoes",label:"Requisitos e qualificações"},{key:"salario",label:"Salário"},{key:"horario_trabalho",label:"Horário de Trabalho"},{key:"jornada_trabalho",label:"Jornada de Trabalho"},{key:"beneficios",label:"Benefícios"},{key:"local_trabalho",label:"Local de Trabalho"},{key:"etapas_processo",label:"Etapas do processo"}];function Rh({isOpen:e,onClose:t,vaga:r}){const{user:s}=tt(),[n,i]=p.useState([]),[o,l]=p.useState(""),[d,c]=p.useState(""),[u,h]=p.useState(""),[f,m]=p.useState(!1),[v,g]=p.useState(!1),[x,b]=p.useState("");p.useEffect(()=>{e&&N()},[e]);const N=async()=>{g(!0);try{console.log("👥 Carregando lista de admins...");const C=await l1();console.log("✅ Admins carregados:",C),i(C)}catch(C){console.error("❌ Erro ao carregar admins:",C),b("Erro ao carregar lista de administradores")}finally{g(!1)}},y=async C=>{if(C.preventDefault(),!s||!r||!o||!d||!u.trim()){console.log("❌ Validação falhou:",{hasUser:!!s,hasVaga:!!r,hasAdmin:!!o,hasField:!!d,hasChanges:!!u.trim()}),b("Por favor, preencha todos os campos obrigatórios");return}console.log("✅ Validação passou, usuário:",s),m(!0),b("");const L=setTimeout(()=>{console.log("⏰ Timeout de segurança ativado"),m(!1),b("Timeout: O envio está demorando muito. Tente novamente.")},3e4);try{console.log("🚀 Iniciando envio do report...");const T={vaga_id:r.id,assigned_to:o,field_name:d,suggested_changes:u.trim()};console.log("📋 Dados do report:",T),console.log("👤 Usuário atual:",s);const P=await a1(T);clearTimeout(L),P?(console.log("✅ Report criado com sucesso!"),b("Report enviado com sucesso! O administrador será notificado."),window.dispatchEvent(new CustomEvent("report-created",{detail:{reportId:P.id,userId:s==null?void 0:s.id}})),setTimeout(()=>{A()},2e3)):(console.log("❌ Report retornou null"),b("Erro ao enviar report - resposta vazia"))}catch(T){clearTimeout(L),console.error("❌ Erro ao criar report:",T);let P="Erro ao enviar report";T!=null&&T.message?P=`Erro ao enviar report: ${T.message}`:T!=null&&T.code&&(P=`Erro ao enviar report (código: ${T.code})`),b(P)}finally{console.log("🏁 Finalizando envio do report..."),m(!1)}},A=()=>{l(""),c(""),h(""),b(""),t()},B=()=>!r||!d?"":r[d]||"Não informado",W=()=>{const C=xc.find(L=>L.key===d);return C?C.label:d};return r?a.jsx(At,{open:e,onOpenChange:A,children:a.jsxs(gt,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[a.jsx(pt,{children:a.jsxs(vt,{className:"flex items-center gap-2",children:[a.jsx(at,{className:"h-5 w-5 text-orange-500"}),"Reportar Problema na Oportunidade"]})}),a.jsxs("form",{onSubmit:y,className:"space-y-6",children:[a.jsx(Ee,{children:a.jsxs(Ae,{children:[a.jsx(Fe,{className:"text-sm",children:"Oportunidade Selecionada"}),a.jsxs(Ge,{children:[r.titulo||r.cargo," - ",r.cliente]})]})}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(fe,{htmlFor:"admin",children:"Administrador Responsável *"}),a.jsxs(Gt,{value:o,onValueChange:l,disabled:v,children:[a.jsx(zt,{"aria-label":"Selecionar administrador responsável",children:a.jsx(Xt,{placeholder:v?"Carregando...":"Selecione um administrador"})}),a.jsx(Vt,{children:n.map(C=>a.jsxs(Oe,{value:C.id,children:[C.name," (",C.email,")"]},C.id))})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(fe,{htmlFor:"field",children:"Campo a ser Reportado *"}),a.jsxs(Gt,{value:d,onValueChange:c,children:[a.jsx(zt,{"aria-label":"Selecionar campo a ser reportado",children:a.jsx(Xt,{placeholder:"Selecione o campo que deseja reportar"})}),a.jsx(Vt,{children:xc.map(C=>a.jsx(Oe,{value:C.key,children:C.label},C.key))})]})]}),d&&a.jsxs(Ee,{children:[a.jsx(Ae,{children:a.jsxs(Fe,{className:"text-sm",children:["Valor Atual: ",W()]})}),a.jsx(Se,{children:a.jsx("div",{className:"bg-gray-50 dark:bg-gray-800 p-3 rounded-md",children:a.jsx("p",{className:"text-sm whitespace-pre-wrap",children:B()})})})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(fe,{htmlFor:"changes",children:"Descreva as Alterações Necessárias *"}),a.jsx("p",{id:"changes-description",className:"text-sm text-gray-600",children:"Descreva detalhadamente quais informações devem ser alteradas e como devem ficar após a correção."}),a.jsx(rr,{id:"changes",value:u,onChange:C=>h(C.target.value),placeholder:"Descreva detalhadamente quais informações devem ser alteradas e como...",rows:4,className:"resize-none","aria-label":"Descrever alterações necessárias","aria-describedby":"changes-description"})]}),x&&a.jsx("div",{className:`p-3 rounded-md text-sm ${x.includes("sucesso")?"bg-green-50 text-green-700 border border-green-200":"bg-red-50 text-red-700 border border-red-200"}`,children:x}),a.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[a.jsxs(Q,{type:"button",variant:"outline",onClick:A,disabled:f,children:[a.jsx(ar,{className:"h-4 w-4 mr-2"}),"Cancelar"]}),a.jsx(Q,{type:"submit",disabled:f||!o||!d||!u.trim(),children:f?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Enviando..."]}):a.jsxs(a.Fragment,{children:[a.jsx(Xc,{className:"h-4 w-4 mr-2"}),"Reportar"]})})]})]})]})}):null}function Fh(){const{user:e}=tt(),[t,r]=p.useState(!1),[s,n]=p.useState(!1),[i,o]=p.useState(!0);return p.useEffect(()=>{(async()=>{if(!e){r(!1),n(!1),o(!1);return}if(e.role==="ADMIN"){r(!0),n(!0),o(!1);return}if(e.role==="RH")try{const[d,c]=await Promise.all([gu(),pu()]);r(d),n(c)}catch(d){console.error("Erro ao verificar permissões RH:",d),r(!1),n(!1)}o(!1)})()},[e]),{canEdit:t,canDelete:s,loading:i,isAdmin:(e==null?void 0:e.role)==="ADMIN",isRH:(e==null?void 0:e.role)==="RH"}}class g_{constructor(){this.cache=new Map,this.maxSize=100}set(t,r,s=15*60*1e3){this.cache.size>=this.maxSize&&this.evictOldest(),this.cache.set(t,{data:r,timestamp:Date.now(),ttl:s}),console.log(`💾 Dados armazenados no cache simples: ${t}`)}get(t){const r=this.cache.get(t);return r?Date.now()-r.timestamp>r.ttl?(this.cache.delete(t),null):r.data:null}has(t){return this.get(t)!==null}delete(t){this.cache.delete(t)}clear(){this.cache.clear(),console.log("🗑️ Cache simples limpo")}evictOldest(){let t="",r=Date.now();for(const[s,n]of this.cache.entries())n.timestamp<r&&(r=n.timestamp,t=s);t&&this.cache.delete(t)}getStats(){return{size:this.cache.size,maxSize:this.maxSize}}}let Ri=null;function p_(){return Ri||(Ri=new g_),Ri}function kh(){const e=p_();return{set:e.set.bind(e),get:e.get.bind(e),has:e.has.bind(e),delete:e.delete.bind(e),clear:e.clear.bind(e),getStats:e.getStats.bind(e)}}function v_(){const[e,t]=p.useState([]),[r,s]=p.useState(!1),[n,i]=p.useState(null),[o,l]=p.useState(Date.now()),[d,c]=p.useState(!1),u=kh(),h=p.useCallback(async(m=!1)=>{const v="vagas:all";try{if(s(!0),i(null),!m&&d){const x=u.get(v);if(x&&x.length>0){t(x),s(!1),console.log("📖 Vagas carregadas do cache simples");return}}console.log("🔄 Carregando vagas do servidor...");const g=await rd();if(!Array.isArray(g))throw new Error("Dados inválidos recebidos do servidor");g.length>0&&u.set(v,g,15*60*1e3),t(g),l(Date.now()),c(!0),console.log(`✅ ${g.length} vagas carregadas do servidor`)}catch(g){if(console.error("❌ Erro ao carregar vagas:",g),i(g instanceof Error?g.message:"Erro ao carregar vagas"),!d){const x=u.get(v);x&&x.length>0&&(t(x),console.log("📖 Usando dados do cache após erro"))}}finally{s(!1)}},[u,d]),f=p.useCallback(async()=>{console.log("🔄 Forçando refresh manual das vagas..."),u.delete("vagas:all"),await h(!0)},[h,u]);return p.useEffect(()=>{d||h()},[d,h]),{vagas:e,loading:r,error:n,refresh:f,lastUpdated:o}}function w_(){const[e,t]=p.useState(""),[r,s]=p.useState(!1),[n,i]=p.useState([]),[o,l]=p.useState(!1),[d,c]=p.useState([]),[u,h]=p.useState(-1),[f,m]=p.useState([]),[v,g]=p.useState(null),[x,b]=p.useState(!1),[N,y]=p.useState(!1),[A,B]=p.useState(!1),[W,C]=p.useState(1),[L,T]=p.useState(10),P=p.useRef(null),I=p.useRef(null),{user:V}=tt(),{canEdit:ae,canDelete:_e}=Fh(),ve=nr(),we=!1,be=v_(),J=Gu(),{removeVaga:Z,refreshVagas:ue,clearCache:me}=Br(),k=kh(),{vagas:M,loading:O,lastUpdated:R}=J,{textClasses:q}=Ks(),z=[{key:"cliente",label:"Cliente",icon:"🏢"},{key:"cargo",label:"Cargo",icon:"💼"},{key:"site",label:"Site",icon:"🌐"},{key:"celula",label:"Célula",icon:"📊"},{key:"categoria",label:"Categoria",icon:"📂"},{key:"titulo",label:"Título",icon:"📝"},{key:"descricao_vaga",label:"Descrição",icon:"📄"},{key:"responsabilidades_atribuicoes",label:"Responsabilidades",icon:"✅"},{key:"requisitos_qualificacoes",label:"Requisitos",icon:"🎓"},{key:"salario",label:"Salário",icon:"💰"},{key:"horario_trabalho",label:"Horário",icon:"⏰"},{key:"jornada_trabalho",label:"Jornada",icon:"📅"},{key:"beneficios",label:"Benefícios",icon:"🎁"},{key:"local_trabalho",label:"Local",icon:"📍"},{key:"etapas_processo",label:"Etapas",icon:"🔄"}],D=(ie,je)=>{const $e=je.toLowerCase();return z.some(Je=>{const He=ie[Je.key];return He?He.toString().toLowerCase().includes($e):!1})},G=(ie,je)=>je.length===0?!0:je.every($e=>{const Je=ie[$e.field];return Je?Je.toString().toLowerCase().includes($e.value.toLowerCase()):!1}),ee=ie=>{if(!ie.trim())return[];const je=[],$e=ie.toLowerCase();z.forEach(He=>{(He.label.toLowerCase().includes($e)||He.key.toLowerCase().includes($e))&&je.push({type:"field",label:`Campo: ${He.label}`,value:`${He.key}:`,icon:He.icon,description:`Buscar no campo ${He.label}`})});const Je=new Set;return M.forEach(He=>{z.forEach(oi=>{const ns=He[oi.key];ns&&ns.toString().toLowerCase().includes($e)&&Je.add(ns.toString())})}),Array.from(Je).slice(0,10).forEach(He=>{je.push({type:"value",label:He,value:He,icon:"🔍",description:"Buscar por este valor"})}),f.forEach(He=>{He.toLowerCase().includes($e)&&je.push({type:"value",label:`Histórico: ${He}`,value:He,icon:"🕒",description:"Busca anterior"})}),je.slice(0,15)},ge=p.useMemo(()=>{if(!e&&n.length===0)return M;let ie=M;return e&&!r&&(ie=ie.filter(je=>D(je,e))),r&&n.length>0&&(ie=ie.filter(je=>G(je,n))),ie},[M,e,n,r]),Te=p.useMemo(()=>{const ie=M.length,je=ge.length,$e=ie>0?(je/ie*100).toFixed(1):"0";return{total:ie,filtered:je,percentage:$e,isFiltered:e||n.length>0}},[M.length,ge.length,e,n]),Me=ge.length,pe=Math.ceil(Me/L),it=(W-1)*L,Le=it+L,ye=ge.slice(it,Le);p.useEffect(()=>{C(1)},[e,L,n]),p.useEffect(()=>{const ie=ee(e);c(ie),l(e.length>0&&ie.length>0),h(-1)},[e,M]),p.useEffect(()=>{const ie=localStorage.getItem("vagas-search-history");if(ie)try{m(JSON.parse(ie))}catch(je){console.warn("Erro ao carregar histórico de busca:",je)}},[]);const mt=ie=>{if(t(ie),ie.trim()){const je=[ie,...f.filter($e=>$e!==ie)].slice(0,10);m(je),localStorage.setItem("vagas-search-history",JSON.stringify(je))}l(!1)},yt=ie=>{var je;ie.type==="field"?(t(ie.value),(je=P.current)==null||je.focus()):mt(ie.value),l(!1)},xr=ie=>{if(o)switch(ie.key){case"ArrowDown":ie.preventDefault(),h(je=>je<d.length-1?je+1:je);break;case"ArrowUp":ie.preventDefault(),h(je=>je>0?je-1:-1);break;case"Enter":ie.preventDefault(),u>=0&&d[u]?yt(d[u]):mt(e);break;case"Escape":l(!1),h(-1);break}},Sr=()=>{var ie;t(""),i([]),s(!1),l(!1),(ie=P.current)==null||ie.focus()},ka=()=>{s(!r),r&&i([]),l(!1)},xa=()=>{if(!e.trim())return;const ie=e.split(":");if(ie.length===2){const je=ie[0].trim(),$e=ie[1].trim(),Je=z.find(He=>He.key===je);Je&&$e&&(i(He=>[...He,{field:je,value:$e,label:Je.label}]),t(""))}else i(je=>[...je,{field:"all",value:e,label:"Busca Geral"}]),t("")},Wt=ie=>{i(je=>je.filter(($e,Je)=>Je!==ie))},Nt=()=>{i([]),t(""),s(!1)},Cr=ie=>{C(Math.max(1,Math.min(ie,pe)))},Zr=()=>{Cr(W-1)},ir=()=>{Cr(W+1)},Da=ie=>{T(ie),C(1)},U=ie=>{ve(`/dashboard/nova-vaga/${ie.id}`)},ne=ie=>{g(ie),b(!0)},Be=()=>{g(null),b(!1)},or=()=>{B(!0)},gr=()=>{B(!1)},jt=async ie=>{if((V==null?void 0:V.role)!=="ADMIN"){alert("Apenas administradores podem excluir vagas");return}if(confirm("Tem certeza que deseja excluir esta vaga?"))try{await ad(ie)?Z(ie):alert("Erro ao excluir vaga")}catch(je){console.error("Erro ao excluir vaga:",je),alert("Erro ao excluir vaga")}},ea=async()=>{try{await c_(M,`vagas_${new Date().toISOString().split("T")[0]}.xlsx`)}catch(ie){console.error("Erro ao exportar:",ie),alert("Erro ao exportar dados")}},lr=async()=>{if(N)return;y(!0);const ie=3;let je=0;for(;je<ie;)try{if(console.log(`🔄 Recarregando dados da página Oportunidades... (Tentativa ${je+1}/${ie})`),we||await ue(),await new Promise(Je=>setTimeout(Je,500)),(we?be.vagas:M).length>0||je===ie-1){console.log("✅ Dados recarregados com sucesso");const Je=document.querySelector("[data-refresh-button]");Je&&(Je.style.backgroundColor="#10b981",setTimeout(()=>{Je.style.backgroundColor=""},1e3));break}else throw new Error("Dados não foram carregados corretamente")}catch($e){if(je++,console.error(`❌ Erro ao recarregar dados (tentativa ${je}):`,$e),je<ie){const Je=je*1e3;console.log(`⏳ Aguardando ${Je}ms antes da próxima tentativa...`),await new Promise(He=>setTimeout(He,Je))}else{console.error("💥 Todas as tentativas de refresh falharam");const Je=document.querySelector("[data-refresh-button]");Je&&(Je.style.backgroundColor="#ef4444",setTimeout(()=>{Je.style.backgroundColor=""},1e3))}}y(!1)},Ys=async()=>{if(!N){y(!0);try{console.log("🧹 Limpando cache completamente e forçando carregamento limpo..."),we||me(),await new Promise(ie=>setTimeout(ie,200)),we||await ue(),console.log("✅ Cache limpo e dados recarregados com sucesso")}catch(ie){console.error("❌ Erro ao limpar cache e recarregar:",ie)}finally{y(!1)}}};return O?a.jsx("div",{className:"flex items-center justify-center h-64",children:a.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[a.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-4 border-primary border-t-transparent"}),a.jsx("p",{className:"text-muted-foreground font-body",children:"Carregando oportunidades..."})]})}):a.jsxs("div",{className:"space-y-8",children:[a.jsxs("div",{className:"flex flex-col tablet:flex-row tablet:items-center justify-between gap-3 tablet:gap-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx("h1",{className:"text-2xl tablet:text-3xl laptop:text-4xl font-bold font-heading bg-gradient-to-r from-repovagas-primary to-repovagas-primary/70 bg-clip-text text-transparent page-title",children:"Repositório de Oportunidades"}),a.jsxs("p",{className:"page-subtitle text-sm tablet:text-base laptop:text-lg font-body text-repovagas-text-secondary",children:["Gerencie todas as oportunidades profissionais disponíveis",R&&a.jsxs("span",{className:"block text-xs text-muted-foreground mt-1",children:["Última atualização: ",new Date(R).toLocaleString("pt-BR")]})]})]}),a.jsxs("div",{className:"flex flex-col tablet:flex-row gap-2 tablet:gap-3",children:[a.jsxs(Q,{onClick:()=>ve("/dashboard/nova-vaga"),size:"sm",className:"h-8 tablet:h-9 btn-text transition-all duration-200 hover:scale-105 active:scale-95 hover:shadow-lg",children:[a.jsx(Ss,{className:"h-4 w-4 mr-2 icon-primary transition-transform duration-200 hover:rotate-90"}),"Nova Oportunidade"]}),a.jsxs(Q,{variant:"outline",onClick:ea,size:"sm",className:"h-8 tablet:h-9 transition-all duration-200 hover:scale-105 active:scale-95 hover:shadow-md",children:[a.jsx(jr,{className:"h-4 w-4 mr-2 transition-transform duration-200 hover:scale-110"}),a.jsx("span",{className:"hidden tablet:inline",children:"Exportar Excel"}),a.jsx("span",{className:"tablet:hidden",children:"Exportar"})]}),a.jsxs(Q,{variant:"outline",onClick:lr,disabled:N,size:"sm","data-refresh-button":!0,className:"h-8 tablet:h-9 transition-all duration-200 hover:scale-105 active:scale-95 hover:shadow-md",children:[a.jsx(ot,{className:`h-4 w-4 mr-2 transition-transform duration-300 ${N?"animate-spin":"hover:rotate-180"}`}),a.jsx("span",{className:N?"opacity-70":"",children:N?"Atualizando...":"Atualizar"})]}),a.jsxs(Q,{variant:"outline",onClick:Ys,disabled:N,size:"sm",className:"h-8 tablet:h-9 transition-all duration-200 hover:scale-105 active:scale-95 hover:shadow-md bg-orange-50 hover:bg-orange-100 border-orange-200",title:"Limpar cache e recarregar (resolve problemas de refresh)",children:[a.jsx(ot,{className:`h-4 w-4 mr-2 transition-transform duration-300 ${N?"animate-spin":"hover:rotate-180"}`}),a.jsx("span",{className:N?"opacity-70":"",children:N?"Limpando...":"Limpar Cache"})]})]})]}),a.jsxs(Ee,{className:"border-2 border-primary/20 shadow-lg",children:[a.jsx(Ae,{className:"pb-4",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsxs(Fe,{className:"flex items-center gap-2",children:[a.jsx(sa,{className:"h-5 w-5 text-primary"}),"Busca Avançada"]}),a.jsx(Ge,{children:"Busque em todas as informações das vagas com filtros inteligentes"})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs(Q,{variant:r?"default":"outline",size:"sm",onClick:ka,className:"transition-all duration-200",children:[a.jsx(za,{className:"h-4 w-4 mr-1"}),r?"Modo Simples":"Modo Avançado"]}),Te.isFiltered&&a.jsxs(Q,{variant:"ghost",size:"sm",onClick:Nt,className:"text-red-600 hover:text-red-700 hover:bg-red-50",children:[a.jsx(ar,{className:"h-4 w-4 mr-1"}),"Limpar"]})]})]})}),a.jsxs(Se,{className:"space-y-4",children:[a.jsxs("div",{className:"relative",children:[a.jsxs("div",{className:"flex gap-2",children:[a.jsxs("div",{className:"relative flex-1",children:[a.jsx(sa,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground h-5 w-5"}),a.jsx(Re,{ref:P,placeholder:r?"Digite 'campo:valor' para filtros específicos (ex: cliente:atento, salario:5000)":"Busque em todas as informações das vagas...",value:e,onChange:ie=>t(ie.target.value),onKeyDown:xr,onFocus:()=>l(e.length>0&&d.length>0),className:"pl-10 pr-10 h-12 text-base"}),e&&a.jsx(Q,{variant:"ghost",size:"sm",className:"absolute right-2 top-1/2 transform -translate-y-1/2 h-6 w-6 p-0",onClick:()=>t(""),children:a.jsx(ar,{className:"h-3 w-3"})})]}),r?a.jsxs(Q,{onClick:xa,disabled:!e.trim(),className:"px-6",children:[a.jsx(Ss,{className:"h-4 w-4 mr-1"}),"Adicionar Filtro"]}):a.jsxs(Q,{onClick:()=>mt(e),disabled:!e.trim(),className:"px-6",children:[a.jsx(sa,{className:"h-4 w-4 mr-1"}),"Buscar"]})]}),o&&d.length>0&&a.jsx("div",{ref:I,className:"absolute top-full left-0 right-0 mt-1 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg shadow-lg z-50 max-h-60 overflow-y-auto",children:d.map((ie,je)=>a.jsxs("div",{className:`flex items-center gap-3 px-4 py-3 cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-700 ${u===je?"bg-blue-50 dark:bg-blue-900/30":""}`,onClick:()=>yt(ie),children:[a.jsx("span",{className:"text-lg",children:ie.icon}),a.jsxs("div",{className:"flex-1",children:[a.jsx("div",{className:"font-medium text-sm",children:ie.label}),ie.description&&a.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:ie.description})]}),a.jsx(Ve,{variant:"outline",className:"text-xs",children:ie.type==="field"?"Campo":ie.type==="value"?"Valor":"Operador"})]},je))})]}),r&&n.length>0&&a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(za,{className:"h-4 w-4 text-primary"}),a.jsx("span",{className:"text-sm font-medium",children:"Filtros Ativos:"})]}),a.jsx("div",{className:"flex flex-wrap gap-2",children:n.map((ie,je)=>a.jsxs(Ve,{variant:"secondary",className:"flex items-center gap-2 px-3 py-1",children:[a.jsxs("span",{className:"text-xs",children:[ie.field==="all"?"Busca Geral":ie.label,": ",ie.value]}),a.jsx(Q,{variant:"ghost",size:"sm",className:"h-4 w-4 p-0 hover:bg-red-100 hover:text-red-600",onClick:()=>Wt(je),children:a.jsx(ar,{className:"h-3 w-3"})})]},je))})]}),Te.isFiltered&&a.jsxs("div",{className:"flex items-center justify-between p-3 bg-blue-50 dark:bg-blue-900/20 rounded-lg border border-blue-200 dark:border-blue-800",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Zf,{className:"h-4 w-4 text-blue-600"}),a.jsxs("span",{className:"text-sm font-medium text-blue-900 dark:text-blue-100",children:[Te.filtered," de ",Te.total," vagas"]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Mi,{className:"h-4 w-4 text-blue-600"}),a.jsxs("span",{className:"text-sm text-blue-700 dark:text-blue-300",children:[Te.percentage,"% dos resultados"]})]})]}),a.jsxs(Q,{variant:"outline",size:"sm",onClick:Sr,className:"text-blue-600 border-blue-300 hover:bg-blue-100",children:[a.jsx(ar,{className:"h-3 w-3 mr-1"}),"Limpar Busca"]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3 text-xs",children:[a.jsxs("div",{className:"flex items-start gap-2 p-2 bg-gray-50 dark:bg-gray-800 rounded",children:[a.jsx(sa,{className:"h-3 w-3 text-gray-600 mt-0.5 flex-shrink-0"}),a.jsxs("div",{children:[a.jsx("div",{className:"font-medium text-gray-900 dark:text-gray-100",children:"Busca Simples"}),a.jsx("div",{className:"text-gray-600 dark:text-gray-400",children:"Digite qualquer termo para buscar em todos os campos"})]})]}),a.jsxs("div",{className:"flex items-start gap-2 p-2 bg-gray-50 dark:bg-gray-800 rounded",children:[a.jsx(za,{className:"h-3 w-3 text-gray-600 mt-0.5 flex-shrink-0"}),a.jsxs("div",{children:[a.jsx("div",{className:"font-medium text-gray-900 dark:text-gray-100",children:"Busca Específica"}),a.jsx("div",{className:"text-gray-600 dark:text-gray-400",children:'Use "campo:valor" para buscar em campos específicos'})]})]}),a.jsxs("div",{className:"flex items-start gap-2 p-2 bg-gray-50 dark:bg-gray-800 rounded",children:[a.jsx(ya,{className:"h-3 w-3 text-gray-600 mt-0.5 flex-shrink-0"}),a.jsxs("div",{children:[a.jsx("div",{className:"font-medium text-gray-900 dark:text-gray-100",children:"Histórico"}),a.jsx("div",{className:"text-gray-600 dark:text-gray-400",children:"Suas buscas anteriores aparecem como sugestões"})]})]})]})]})]}),a.jsxs("div",{className:"grid grid-cols-1 tablet:grid-cols-2 laptop:grid-cols-3 gap-4 tablet:gap-6",children:[a.jsxs(Ee,{className:"relative overflow-hidden",children:[a.jsx("div",{className:"absolute top-0 right-0 w-20 h-20 bg-gradient-to-br from-primary/10 to-primary/5 rounded-full -translate-y-10 translate-x-10"}),a.jsx(Ae,{className:"pb-3",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-primary to-primary/70 rounded-xl flex items-center justify-center",children:a.jsx(Xa,{className:"h-5 w-5 text-primary-foreground"})}),a.jsx(Fe,{className:"text-sm font-semibold field-subtitle",children:"Total de Oportunidades"})]})}),a.jsxs(Se,{children:[a.jsx("div",{className:"text-3xl font-bold text-primary",children:Me}),a.jsx("p",{className:"text-sm info-text mt-1",children:"oportunidades cadastradas"})]})]}),a.jsxs(Ee,{className:"relative overflow-hidden",children:[a.jsx("div",{className:"absolute top-0 right-0 w-20 h-20 bg-gradient-to-br from-primary/10 to-primary/5 rounded-full -translate-y-10 translate-x-10"}),a.jsx(Ae,{className:"pb-3",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-primary to-primary/70 rounded-xl flex items-center justify-center",children:a.jsx(io,{className:"h-5 w-5 text-primary-foreground"})}),a.jsx(Fe,{className:"text-sm font-semibold text-muted-foreground",children:"Clientes Únicos"})]})}),a.jsxs(Se,{children:[a.jsx("div",{className:"text-3xl font-bold text-primary",children:new Set(M.map(ie=>ie.cliente)).size}),a.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"empresas parceiras"})]})]}),a.jsxs(Ee,{className:"relative overflow-hidden",children:[a.jsx("div",{className:"absolute top-0 right-0 w-20 h-20 bg-gradient-to-br from-primary/10 to-primary/5 rounded-full -translate-y-10 translate-x-10"}),a.jsx(Ae,{className:"pb-3",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-primary to-primary/70 rounded-xl flex items-center justify-center",children:a.jsx(Mi,{className:"h-5 w-5 text-primary-foreground"})}),a.jsx(Fe,{className:"text-sm font-semibold text-muted-foreground",children:"Sites Ativos"})]})}),a.jsxs(Se,{children:[a.jsx("div",{className:"text-3xl font-bold text-primary",children:new Set(M.map(ie=>ie.site)).size}),a.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"locais de trabalho"})]})]})]}),a.jsx("div",{className:"space-y-6",children:ye.map((ie,je)=>a.jsx(ro,{vaga:ie,showActions:(V==null?void 0:V.role)==="ADMIN"||ae||_e,showEditAction:ae,showDeleteAction:_e,showFocusAction:!0,showDownloadAction:!0,variantIndex:je,onEdit:ae?()=>U(ie):void 0,onDelete:_e?()=>jt(ie.id):void 0,onFocus:()=>ne(ie)},ie.id))}),Me>0&&a.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-4 p-4 bg-gray-50 dark:bg-gray-800 rounded-lg",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-sm text-muted-foreground",children:"Itens por página:"}),a.jsxs("select",{value:L,onChange:ie=>Da(Number(ie.target.value)),className:"px-3 py-1 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-sm focus:outline-none focus:ring-2 focus:ring-primary",children:[a.jsx("option",{value:5,children:"5"}),a.jsx("option",{value:10,children:"10"}),a.jsx("option",{value:15,children:"15"}),a.jsx("option",{value:20,children:"20"}),a.jsx("option",{value:25,children:"25"})]})]}),a.jsxs("span",{className:"text-sm text-muted-foreground",children:["Mostrando ",it+1,"-",Math.min(Le,Me)," de ",Me," vagas"]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs(Q,{variant:"outline",size:"sm",onClick:Zr,disabled:W===1,className:"flex items-center gap-1",children:[a.jsx(Oi,{className:"h-4 w-4"}),"Anterior"]}),a.jsx("div",{className:"flex items-center gap-1",children:Array.from({length:Math.min(5,pe)},(ie,je)=>{let $e;return pe<=5||W<=3?$e=je+1:W>=pe-2?$e=pe-4+je:$e=W-2+je,a.jsx(Q,{variant:W===$e?"default":"outline",size:"sm",onClick:()=>Cr($e),className:"w-8 h-8 p-0",children:$e},$e)})}),a.jsxs(Q,{variant:"outline",size:"sm",onClick:ir,disabled:W===pe,className:"flex items-center gap-1",children:["Próximo",a.jsx(ys,{className:"h-4 w-4"})]})]})]}),ge.length===0&&!O&&a.jsx("div",{className:"text-center py-12",children:a.jsx("div",{className:"text-contrast-primary text-lg",children:e?"Nenhuma vaga encontrada com os filtros aplicados":"Nenhuma vaga cadastrada"})}),a.jsx(At,{open:!!v,onOpenChange:Be,children:a.jsx(gt,{className:`${x?"max-w-none w-screen h-screen":"max-w-4xl"} p-0`,hideCloseButton:x,children:a.jsxs("div",{className:`${x?"h-screen flex flex-col":""}`,children:[a.jsx(pt,{className:`${x?"p-6 border-b bg-gradient-to-r from-primary/10 to-primary/5":"p-6 border-b"}`,children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-primary to-primary/70 rounded-lg flex items-center justify-center",children:a.jsx(Pt,{className:"h-5 w-5 text-primary-foreground"})}),a.jsxs("div",{children:[a.jsx(vt,{className:"text-xl font-bold",children:"Visualização Focada"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"Modo de estudo - apenas esta vaga está visível"})]})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsxs(Q,{variant:"outline",size:"sm",onClick:or,className:"flex items-center space-x-2 bg-orange-50 hover:bg-orange-100 border-orange-200 text-orange-700 hover:text-orange-800",children:[a.jsx(oa,{className:"h-4 w-4"}),a.jsx("span",{children:"Reportar"})]}),a.jsxs(Q,{variant:"outline",size:"sm",onClick:Be,className:"flex items-center space-x-2",children:[a.jsx(ar,{className:"h-4 w-4"}),a.jsx("span",{children:"Fechar"})]})]})]})}),a.jsx("div",{className:`${x?"flex-1 overflow-auto p-6":"p-6"}`,children:v&&a.jsxs("div",{className:"space-y-6",children:[a.jsx("div",{className:"bg-gradient-to-r from-primary/5 to-primary/10 rounded-lg p-6 border border-primary/20",children:a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("h3",{className:`text-lg font-semibold ${q.primary} mb-2`,children:v.titulo||v.cargo}),a.jsxs("p",{className:`text-sm ${q.primary}`,children:[a.jsx("strong",{children:"Cliente:"})," ",v.cliente]}),a.jsxs("p",{className:`text-sm ${q.primary}`,children:[a.jsx("strong",{children:"Célula:"})," ",v.celula]}),a.jsxs("p",{className:`text-sm ${q.primary}`,children:[a.jsx("strong",{children:"Site:"})," ",v.site]})]}),a.jsxs("div",{children:[a.jsxs("p",{className:`text-sm ${q.primary}`,children:[a.jsx("strong",{children:"Categoria:"})," ",v.categoria]}),a.jsxs("p",{className:`text-sm ${q.primary}`,children:[a.jsx("strong",{children:"Cargo:"})," ",v.cargo]}),a.jsxs("p",{className:`text-sm ${q.primary}`,children:[a.jsx("strong",{children:"Criado em:"})," ",new Date(v.created_at).toLocaleDateString("pt-BR")]})]})]})}),a.jsx(ro,{vaga:v,showActions:!1,variantIndex:0,isExpanded:!0})]})})]})})}),a.jsx(Rh,{isOpen:A,onClose:gr,vaga:v})]})}function b_(){const{textClasses:e}=Ks(),{user:t}=tt(),r=nr(),[s,n]=p.useState([]),[i,o]=p.useState([]),[l,d]=p.useState([]),[c,u]=p.useState({}),[h,f]=p.useState(new Set),[m,v]=p.useState({}),[g,x]=p.useState(null),[b,N]=p.useState(!1),[y,A]=p.useState(!1),[B,W]=p.useState(null),C=p.useRef(null),L=p.useRef(null),T=p.useRef(null),P=()=>{console.log("🔄 scrollToClientHeaders chamada");const z=document.querySelector('[data-client-headers="true"]');if(z){const D=z.getBoundingClientRect(),G=window.innerHeight;console.log("📍 Posição do container:",D.top,"Window height:",G);const ee=window.scrollY+D.top-80;console.log("🎯 Rolando para posição:",ee),window.scrollTo({top:ee,behavior:"smooth"})}else console.log("❌ Não foi possível encontrar container dos cabeçalhos")},I=z=>{console.log("🔄 scrollAfterExpand chamada"),setTimeout(()=>{const D=z.getBoundingClientRect(),G=window.innerHeight;console.log("📍 Elemento expandido - top:",D.top,"bottom:",D.bottom,"window height:",G);const ee=document.querySelector('[data-client-headers="true"]');let ge=!0;if(ee){const Te=ee.getBoundingClientRect();ge=Te.bottom>0&&Te.top<G}if(D.bottom>G||D.top<0||!ge){const Te=window.scrollY+D.top-150;console.log("🎯 Rolando após expandir para posição:",Te,"Headers visíveis:",ge),window.scrollTo({top:Te,behavior:"smooth"})}else console.log("✅ Elemento e cabeçalhos já estão visíveis, não precisa rolar")},100)};p.useEffect(()=>{let z=!0;return(async()=>{try{const[G,ee]=await Promise.all([zi(),gl()]);z&&(n(G),o(ee))}catch(G){console.error("Erro ao carregar dados:",G)}})(),()=>{z=!1}},[]),p.useEffect(()=>{const z={};l.forEach(D=>{z[D]=c[D]||{}}),u(z)},[l.length]),p.useEffect(()=>(console.log("👀 useEffect rolagem inicial - selectedClientes:",l),l.length>0&&(T.current&&clearTimeout(T.current),console.log("⏰ Agendando rolagem em 200ms..."),T.current=setTimeout(()=>{P()},200)),()=>{T.current&&clearTimeout(T.current)}),[l.length]);const V=z=>{if(l.includes(z)){d(l.filter(G=>G!==z));const D={...c};delete D[z],u(D)}else l.length<3&&d([...l,z])},ae=(z,D,G)=>{const ee=G==="all"?void 0:G;u(ge=>({...ge,[z]:{...ge[z],[D]:ee}}))},_e=()=>{u({}),d([]),f(new Set),v({}),x(null)},ve=async()=>{if(!b){N(!0);try{console.log("🔄 Recarregando dados da página Comparativo...");const[z,D]=await Promise.all([zi(),gl()]);n(z),o(D),d([]),u({}),f(new Set),v({}),x(null),console.log("✅ Dados recarregados com sucesso:",{clientes:z.length,vagas:D.length})}catch(z){console.error("❌ Erro ao recarregar dados:",z)}finally{N(!1)}}},we=z=>{u(D=>({...D,[z]:{}}))},be=(z,D)=>{const G=new Set(h),ee=!G.has(z);if(G.has(z)?(G.delete(z),x(null)):(G.add(z),x(z)),f(G),ee&&D){const ge=D.currentTarget;I(ge)}},J=z=>{v(D=>({...D,[z]:!D[z]}))},Z=z=>{r(`/dashboard/nova-vaga/${z.id}`)},ue=z=>{const D=M(z);D.length>0&&Z(D[0])},me=z=>{const D=M(z);D.length>0&&(W(D[0]),A(!0))},k=()=>{A(!1),W(null)},M=z=>{let D=i.filter(ee=>ee.cliente===z);const G=c[z]||{};return G.site&&(D=D.filter(ee=>ee.site===G.site)),G.categoria&&(D=D.filter(ee=>ee.categoria===G.categoria)),G.cargo&&(D=D.filter(ee=>ee.cargo===G.cargo)),G.celula&&(D=D.filter(ee=>ee.celula===G.celula)),D},O=(z,D,G)=>{let ee=i.filter(ge=>ge.cliente===z);return G&&(G.celula&&(ee=ee.filter(ge=>ge.celula===G.celula)),G.cargo&&(ee=ee.filter(ge=>ge.cargo===G.cargo)),G.site&&(ee=ee.filter(ge=>ge.site===G.site)),G.categoria&&(ee=ee.filter(ge=>ge.categoria===G.categoria))),[...new Set(ee.map(ge=>ge[D]).filter(Boolean))].sort()},R=(z,D)=>{const ee={descricao:z.descricao_vaga,responsabilidades:z.responsabilidades_atribuicoes,requisitos:z.requisitos_qualificacoes,salario:z.salario,horario:z.horario_trabalho,jornada:z.jornada_trabalho,beneficios:z.beneficios,local:z.local_trabalho,etapas:z.etapas_processo}[D];return ee?a.jsx("div",{className:`text-sm ${e.primary} whitespace-pre-wrap`,children:ee}):a.jsx("span",{className:e.primary,children:"Não informado"})},q=z=>{const D=c[z]||{},G=m[z]||!1,ee=O(z,"celula"),ge=O(z,"cargo",{celula:D.celula}),Te=O(z,"site",{celula:D.celula,cargo:D.cargo}),Me=O(z,"categoria",{celula:D.celula,cargo:D.cargo,site:D.site});return a.jsxs(Ee,{className:"mb-4",children:[a.jsx(Ae,{className:"cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors",onClick:()=>J(z),children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs(Fe,{className:"text-sm flex items-center",children:[a.jsx(za,{className:"h-4 w-4 mr-2"}),"Filtros para ",z]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs(Q,{variant:"outline",size:"sm",onClick:pe=>{pe.stopPropagation(),we(z)},className:"transition-all duration-200 hover:scale-105 active:scale-95 hover:shadow-md",children:[a.jsx(ol,{className:"h-3 w-3 mr-1 transition-transform duration-200 hover:rotate-180"}),"Limpar"]}),G?a.jsx(_s,{className:"h-4 w-4"}):a.jsx(Ka,{className:"h-4 w-4"})]})]})}),G&&a.jsx(Se,{children:a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsxs("label",{className:"text-sm font-medium flex items-center",children:["Célula",a.jsx("span",{className:"ml-2 px-2 py-1 text-xs bg-primary/10 text-primary rounded-full",children:"Principal"})]}),a.jsxs(Gt,{value:D.celula||"all",onValueChange:pe=>{const it=pe==="all"?void 0:pe;u(Le=>({...Le,[z]:{celula:it,cargo:void 0,site:void 0,categoria:void 0}}))},children:[a.jsx(zt,{children:a.jsx(Xt,{})}),a.jsxs(Vt,{children:[a.jsx(Oe,{value:"all",children:"Todas as Células"}),ee.map(pe=>a.jsx(Oe,{value:pe,children:pe},pe))]})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("label",{className:"text-sm font-medium flex items-center",children:["Cargo",a.jsx("span",{className:"ml-2 px-2 py-1 text-xs bg-green-500/10 text-green-600 dark:text-green-400 rounded-full",children:"Depende da Célula"})]}),a.jsxs(Gt,{value:D.cargo||"all",onValueChange:pe=>{const it=pe==="all"?void 0:pe;u(Le=>({...Le,[z]:{...Le[z],cargo:it,site:void 0,categoria:void 0}}))},children:[a.jsx(zt,{children:a.jsx(Xt,{})}),a.jsxs(Vt,{children:[a.jsx(Oe,{value:"all",children:"Todos os Cargos"}),ge.length>0?ge.map(pe=>a.jsx(Oe,{value:pe,children:pe},pe)):a.jsx(Oe,{value:"no-data",disabled:!0,children:D.celula?"Nenhum cargo disponível para esta célula":"Selecione uma célula primeiro"})]})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("label",{className:"text-sm font-medium flex items-center",children:["Site",a.jsx("span",{className:"ml-2 px-2 py-1 text-xs bg-yellow-500/10 text-yellow-600 dark:text-yellow-400 rounded-full",children:"Depende da Célula + Cargo"})]}),a.jsxs(Gt,{value:D.site||"all",onValueChange:pe=>{const it=pe==="all"?void 0:pe;u(Le=>({...Le,[z]:{...Le[z],site:it,categoria:void 0}}))},children:[a.jsx(zt,{children:a.jsx(Xt,{})}),a.jsxs(Vt,{children:[a.jsx(Oe,{value:"all",children:"Todos os Sites"}),Te.length>0?Te.map(pe=>a.jsx(Oe,{value:pe,children:pe},pe)):a.jsx(Oe,{value:"no-data",disabled:!0,children:D.celula||D.cargo?"Nenhum site disponível":"Selecione célula e cargo primeiro"})]})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("label",{className:"text-sm font-medium flex items-center",children:["Categoria",a.jsx("span",{className:"ml-2 px-2 py-1 text-xs bg-purple-100 text-purple-800 rounded-full",children:"Depende de todos"})]}),a.jsxs(Gt,{value:D.categoria||"all",onValueChange:pe=>ae(z,"categoria",pe),children:[a.jsx(zt,{children:a.jsx(Xt,{})}),a.jsxs(Vt,{children:[a.jsx(Oe,{value:"all",children:"Todas as Categorias"}),Me.length>0?Me.map(pe=>a.jsx(Oe,{value:pe,children:pe},pe)):a.jsx(Oe,{value:"no-data",disabled:!0,children:D.celula||D.cargo||D.site?"Nenhuma categoria disponível":"Selecione outros filtros primeiro"})]})]})]})]})})]})};return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex flex-col tablet:flex-row tablet:items-center justify-between gap-3 tablet:gap-4",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl tablet:text-3xl laptop:text-4xl font-bold bg-gradient-to-r from-primary to-primary/70 bg-clip-text text-transparent page-title",children:"Comparativo de Clientes"}),a.jsx("p",{className:"page-subtitle text-sm tablet:text-base laptop:text-lg",children:"Compare vagas entre diferentes clientes"}),g&&a.jsxs("div",{className:"mt-2 inline-flex items-center px-3 py-1 bg-primary/10 text-primary text-sm rounded-full border border-primary/20",children:[a.jsx("div",{className:"w-2 h-2 bg-primary rounded-full mr-2 animate-pulse"}),a.jsx("span",{className:"hidden tablet:inline",children:"Seção ativa: "}),{descricao:"Descrição da Oportunidade",responsabilidades:"Responsabilidades e Atribuições",requisitos:"Requisitos e Qualificações",salario:"Salário",horario:"Horário de Trabalho",jornada:"Jornada de Trabalho",beneficios:"Benefícios",local:"Local de Trabalho",etapas:"Etapas do Processo"}[g]||g]})]}),a.jsxs("div",{className:"flex flex-col tablet:flex-row items-stretch tablet:items-center gap-2",children:[a.jsxs(Q,{variant:"outline",onClick:ve,disabled:b,className:"flex items-center gap-2 transition-all duration-200 hover:scale-105 active:scale-95 hover:shadow-md",children:[a.jsx(ol,{className:`h-4 w-4 transition-transform duration-300 ${b?"animate-spin":"hover:rotate-180"}`}),b?"Recarregando...":"Recarregar"]}),a.jsxs(Q,{variant:"outline",onClick:_e,className:"transition-all duration-200 hover:scale-105 active:scale-95 hover:shadow-md",children:[a.jsx(ar,{className:"h-4 w-4 mr-2 transition-transform duration-200 hover:rotate-90"}),"Limpar Filtros"]})]})]}),a.jsxs(Ee,{children:[a.jsxs(Ae,{children:[a.jsx(Fe,{children:"Selecionar Clientes para Comparação"}),a.jsx(Ge,{children:"Escolha até 3 clientes para comparar"})]}),a.jsxs(Se,{children:[a.jsx("div",{className:"flex flex-wrap gap-2",children:s.map(z=>a.jsxs(Q,{variant:l.includes(z)?"default":"outline",onClick:()=>V(z),disabled:!l.includes(z)&&l.length>=3,className:"transition-all duration-200 hover:scale-105 active:scale-95 hover:shadow-md",children:[z,l.includes(z)&&a.jsx(ar,{className:"h-4 w-4 ml-2 transition-transform duration-200 hover:rotate-90"})]},z))}),l.length===0&&a.jsx("p",{className:"text-muted-foreground text-sm mt-2",children:"Selecione pelo menos um cliente para comparar"})]})]}),l.length>0&&a.jsx("div",{ref:C,className:"space-y-4",children:a.jsx("div",{"data-client-headers":"true",className:"grid grid-cols-1 tablet:grid-cols-2 laptop-lg:grid-cols-3 gap-4 tablet:gap-6",children:l.map(z=>{const D=M(z);return a.jsxs("div",{className:"space-y-3",children:[q(z),a.jsx(Ee,{ref:l.indexOf(z)===0?L:null,"data-client-header":l.indexOf(z)===0?"true":"false",className:"py-2 border-2 border-primary/20 bg-primary/10 dark:bg-primary/20 shadow-sm",children:a.jsxs(Ae,{className:"py-3",children:[a.jsxs("div",{className:"flex items-center justify-center gap-2",children:[a.jsx(Fe,{className:"text-center text-base font-semibold text-foreground",children:z}),D.length>0&&a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(Q,{variant:"ghost",size:"sm",onClick:()=>ue(z),className:"h-6 w-6 p-0 hover:bg-primary/10 hover:text-primary transition-all duration-200 hover:scale-110 active:scale-95 hover:shadow-md",title:"Editar oportunidade",children:a.jsx(va,{className:"h-3 w-3 transition-transform duration-200 hover:rotate-12"})}),(t==null?void 0:t.role)==="RH"&&a.jsx(Q,{variant:"ghost",size:"sm",onClick:()=>me(z),className:"h-6 w-6 p-0 hover:bg-orange-100 hover:text-orange-600 transition-all duration-200 hover:scale-110 active:scale-95 hover:shadow-md",title:"Reportar problema",children:a.jsx(oa,{className:"h-3 w-3 transition-transform duration-200 hover:rotate-12"})})]})]}),a.jsxs(Ge,{className:"text-center text-sm text-muted-foreground",children:[D.length," vaga(s) encontrada(s)"]})]})}),D.length===0?a.jsx(Ee,{children:a.jsx(Se,{className:"text-center py-8",children:a.jsx("p",{className:"text-muted-foreground",children:"Nenhuma vaga encontrada para este cliente"})})}):a.jsx("div",{className:"space-y-2",children:[{key:"descricao",title:"Descrição da Oportunidade"},{key:"responsabilidades",title:"Responsabilidades e Atribuições"},{key:"requisitos",title:"Requisitos e Qualificações"},{key:"salario",title:"Salário"},{key:"horario",title:"Horário de Trabalho"},{key:"jornada",title:"Jornada de Trabalho"},{key:"beneficios",title:"Benefícios"},{key:"local",title:"Local de Trabalho"},{key:"etapas",title:"Etapas do Processo"}].map(G=>{const ee=h.has(G.key),ge=g===G.key,Te=g!==null&&g!==G.key;return a.jsxs(Ee,{className:`transition-all duration-300 ${ge?"ring-2 ring-primary shadow-lg scale-[1.02]":Te?"opacity-40 grayscale-[0.3]":"hover:shadow-md"}`,children:[a.jsx(Ae,{className:`cursor-pointer transition-colors py-3 ${ge?"bg-primary/10 dark:bg-primary/20":"hover:bg-gray-50 dark:hover:bg-gray-800"}`,onClick:Me=>be(G.key,Me),children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx(Fe,{className:`text-sm ${e.primary} transition-colors ${ge?"text-primary font-semibold":""}`,children:G.title}),a.jsx("div",{className:`transition-colors ${ge?"text-primary":""}`,children:ee?a.jsx(_s,{className:"h-4 w-4"}):a.jsx(Ka,{className:"h-4 w-4"})})]})}),ee&&a.jsx(Se,{className:`transition-all duration-300 ${ge?"bg-primary/10 dark:bg-primary/20":""}`,children:D.map((Me,pe)=>a.jsxs("div",{className:"mb-4 last:mb-0",children:[D.length>1&&a.jsxs("div",{className:`text-xs ${e.secondary} mb-2 font-medium`,children:["Oportunidade ",pe+1,": ",Me.cargo," - ",Me.celula]}),R(Me,G.key)]},Me.id))})]},G.key)})})]},z)})})}),a.jsx(Rh,{isOpen:y,onClose:k,vaga:B})]})}var si="Tabs",[y_]=_a(si,[zn]),Dh=zn(),[N_,tl]=y_(si),Ph=p.forwardRef((e,t)=>{const{__scopeTabs:r,value:s,onValueChange:n,defaultValue:i,orientation:o="horizontal",dir:l,activationMode:d="automatic",...c}=e,u=In(l),[h,f]=Za({prop:s,onChange:n,defaultProp:i??"",caller:si});return a.jsx(N_,{scope:r,baseId:ba(),value:h,onValueChange:f,orientation:o,dir:u,activationMode:d,children:a.jsx(nt.div,{dir:u,"data-orientation":o,...c,ref:t})})});Ph.displayName=si;var Ih="TabsList",Oh=p.forwardRef((e,t)=>{const{__scopeTabs:r,loop:s=!0,...n}=e,i=tl(Ih,r),o=Dh(r);return a.jsx(md,{asChild:!0,...o,orientation:i.orientation,dir:i.dir,loop:s,children:a.jsx(nt.div,{role:"tablist","aria-orientation":i.orientation,...n,ref:t})})});Oh.displayName=Ih;var Mh="TabsTrigger",Lh=p.forwardRef((e,t)=>{const{__scopeTabs:r,value:s,disabled:n=!1,...i}=e,o=tl(Mh,r),l=Dh(r),d=$h(o.baseId,s),c=zh(o.baseId,s),u=s===o.value;return a.jsx(xd,{asChild:!0,...l,focusable:!n,active:u,children:a.jsx(nt.button,{type:"button",role:"tab","aria-selected":u,"aria-controls":c,"data-state":u?"active":"inactive","data-disabled":n?"":void 0,disabled:n,id:d,...i,ref:t,onMouseDown:ke(e.onMouseDown,h=>{!n&&h.button===0&&h.ctrlKey===!1?o.onValueChange(s):h.preventDefault()}),onKeyDown:ke(e.onKeyDown,h=>{[" ","Enter"].includes(h.key)&&o.onValueChange(s)}),onFocus:ke(e.onFocus,()=>{const h=o.activationMode!=="manual";!u&&!n&&h&&o.onValueChange(s)})})})});Lh.displayName=Mh;var Bh="TabsContent",Uh=p.forwardRef((e,t)=>{const{__scopeTabs:r,value:s,forceMount:n,children:i,...o}=e,l=tl(Bh,r),d=$h(l.baseId,s),c=zh(l.baseId,s),u=s===l.value,h=p.useRef(u);return p.useEffect(()=>{const f=requestAnimationFrame(()=>h.current=!1);return()=>cancelAnimationFrame(f)},[]),a.jsx(_r,{present:n||u,children:({present:f})=>a.jsx(nt.div,{"data-state":u?"active":"inactive","data-orientation":l.orientation,role:"tabpanel","aria-labelledby":d,hidden:!f,id:c,tabIndex:0,...o,ref:t,style:{...e.style,animationDuration:h.current?"0s":void 0},children:f&&i})})});Uh.displayName=Bh;function $h(e,t){return`${e}-trigger-${t}`}function zh(e,t){return`${e}-content-${t}`}var j_=Ph,Vh=Oh,Hh=Lh,Wh=Uh;const rl=j_,ni=p.forwardRef(({className:e,...t},r)=>a.jsx(Vh,{ref:r,className:De("inline-flex h-9 items-center justify-center rounded-lg bg-muted p-1 text-muted-foreground",e),...t}));ni.displayName=Vh.displayName;const qt=p.forwardRef(({className:e,...t},r)=>a.jsx(Hh,{ref:r,className:De("inline-flex items-center justify-center whitespace-nowrap rounded-md px-3 py-1 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow",e),...t}));qt.displayName=Hh.displayName;const Vr=p.forwardRef(({className:e,...t},r)=>a.jsx(Wh,{ref:r,className:De("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",e),...t}));Vr.displayName=Wh.displayName;const al=class al{static async extractFromURL(t){try{if(!this.isValidGupyURL(t))return{message:"URL deve ser do domínio atento.gupy.io ou gupy.io",code:"VALIDATION_ERROR"};const r=await this.fetchPage(t);if(typeof r=="object"&&"message"in r)return r;const s=this.extractFromHTML(r),n=this.extractFromJSON(r);return this.combineResults(s,n,t)}catch(r){return{message:`Erro ao processar URL: ${r instanceof Error?r.message:"Erro desconhecido"}`,code:"UNKNOWN_ERROR"}}}static extractFromHTML(t){try{const s=new DOMParser().parseFromString(t,"text/html"),n={},i={},o=["titulo","descricao_vaga","responsabilidades_atribuicoes","requisitos_qualificacoes","salario","horario_trabalho","jornada_trabalho","beneficios","local_trabalho","etapas_processo"];let l=0,d=0;return o.forEach(c=>{const u=this.extractFieldWithConfidence(s,c);n[c]=u,i[c]=u.cleanedValue,l+=u.confidence,u.found&&d++}),i.extractedFields=n,i.confidence=Math.round(l/o.length),i.source="html",i}catch(r){return{message:`Erro ao processar HTML: ${r instanceof Error?r.message:"Erro desconhecido"}`,code:"PARSE_ERROR"}}}static extractFromJSON(t){var r,s;try{const n=t.match(/<script id="__NEXT_DATA__" type="application\/json">(.*?)<\/script>/s);if(!n)return null;const i=JSON.parse(n[1]),o=(s=(r=i==null?void 0:i.props)==null?void 0:r.pageProps)==null?void 0:s.job;if(!o)return null;const l={},d={},c=this.processJSONField(o.name,"titulo"),u=this.processJSONField(this.cleanHTML(o.description||""),"descricao_vaga"),h=this.processJSONField(this.cleanHTML(o.responsibilities||""),"responsabilidades_atribuicoes"),f=this.processJSONField(this.cleanHTML(o.prerequisites||""),"requisitos_qualificacoes"),m=o.relevantExperiences||"",v=this.processJSONField(this.extractSalaryFromText(m),"salario"),g=this.processJSONField(this.extractHorarioFromText(m),"horario_trabalho"),x=this.processJSONField(this.extractJornadaFromText(m),"jornada_trabalho"),b=this.processJSONField(this.extractBeneficiosFromText(m),"beneficios"),N=this.processJSONField(o.addressLine||"","local_trabalho"),y=this.processJSONField(this.formatEtapasProcesso(o.jobSteps||[]),"etapas_processo");l.titulo=c,l.descricao_vaga=u,l.responsabilidades_atribuicoes=h,l.requisitos_qualificacoes=f,l.salario=v,l.horario_trabalho=g,l.jornada_trabalho=x,l.beneficios=b,l.local_trabalho=N,l.etapas_processo=y,d.titulo=c.cleanedValue,d.descricao_vaga=u.cleanedValue,d.responsabilidades_atribuicoes=h.cleanedValue,d.requisitos_qualificacoes=f.cleanedValue,d.salario=v.cleanedValue,d.horario_trabalho=g.cleanedValue,d.jornada_trabalho=x.cleanedValue,d.beneficios=b.cleanedValue,d.local_trabalho=N.cleanedValue,d.etapas_processo=y.cleanedValue;const A=Object.values(l).reduce((B,W)=>B+W.confidence,0);return d.confidence=Math.round(A/Object.keys(l).length),d.extractedFields=l,d.source="json",d}catch(n){return console.warn("Erro ao extrair dados do JSON:",n),null}}static extractFieldWithConfidence(t,r){const s=this.XPATH_PATTERNS[r];if(r==="etapas_processo")return this.extractEtapasProcesso(t,s);for(let n=0;n<s.length;n++)try{const i=this.evaluateXPath(t,s[n]);if(i){const o=i.textContent||i.innerText||"",l=this.cleanText(o,r);if(l.trim()){const d=Math.max(0,100-n*15),c=this.calculateContentConfidence(l,r);return{found:!0,confidence:Math.min(100,d+c),source:"xpath",rawValue:o,cleanedValue:l}}}}catch(i){console.warn(`Erro ao extrair ${r} com XPath: ${s[n]}`,i)}return{found:!1,confidence:0,source:"xpath",rawValue:"",cleanedValue:""}}static extractEtapasProcesso(t,r){for(let s=0;s<r.length;s++)try{const n=this.evaluateXPath(t,r[s]);if(n){const i=n.querySelectorAll("li");if(i.length>0){const o=Array.from(i).map(d=>d.textContent||d.innerText||"").join(`
`),l=this.cleanText(o,"etapas_processo");if(l.trim()){const d=Math.max(0,100-s*15),c=this.calculateContentConfidence(l,"etapas_processo");return{found:!0,confidence:Math.min(100,d+c),source:"xpath",rawValue:o,cleanedValue:l}}}}}catch(n){console.warn(`Erro ao extrair etapas_processo com XPath: ${r[s]}`,n)}return{found:!1,confidence:0,source:"xpath",rawValue:"",cleanedValue:""}}static processJSONField(t,r){const s=this.cleanText(t,r),n=this.calculateContentConfidence(s,r);return{found:!!s.trim(),confidence:Math.min(100,n+20),source:"json",rawValue:t,cleanedValue:s}}static combineResults(t,r,s){const n={titulo:"",descricao_vaga:"",responsabilidades_atribuicoes:"",requisitos_qualificacoes:"",salario:"",horario_trabalho:"",jornada_trabalho:"",beneficios:"",local_trabalho:"",etapas_processo:"",confidence:0,extractedFields:{},source:"mixed",url:s},i={},o=["titulo","descricao_vaga","responsabilidades_atribuicoes","requisitos_qualificacoes","salario","horario_trabalho","jornada_trabalho","beneficios","local_trabalho","etapas_processo"];let l=0;return o.forEach(d=>{var f,m;const c="extractedFields"in t?(f=t.extractedFields)==null?void 0:f[d]:null,u=(m=r==null?void 0:r.extractedFields)==null?void 0:m[d];let h;u&&c?(h=u.confidence>=c.confidence?u:c,n.source="mixed"):u?h=u:c?h=c:h={found:!1,confidence:0,source:"fallback",rawValue:"",cleanedValue:""},i[d]=h,n[d]=h.cleanedValue,l+=h.confidence}),n.extractedFields=i,n.confidence=Math.round(l/o.length),{titulo:n.titulo||"",descricao_vaga:n.descricao_vaga||"",responsabilidades_atribuicoes:n.responsabilidades_atribuicoes||"",requisitos_qualificacoes:n.requisitos_qualificacoes||"",salario:n.salario||"",horario_trabalho:n.horario_trabalho||"",jornada_trabalho:n.jornada_trabalho||"",beneficios:n.beneficios||"",local_trabalho:n.local_trabalho||"",etapas_processo:n.etapas_processo||"",confidence:n.confidence||0,extractedFields:n.extractedFields||{},source:n.source||"mixed",url:n.url}}static calculateContentConfidence(t,r){if(!t.trim())return 0;let s=0;switch(r){case"titulo":t.length>10&&t.length<200&&(s+=30),(t.includes("-")||t.includes("("))&&(s+=20),t.match(/[A-Z][a-z]+.*[A-Z][a-z]+/)&&(s+=15);break;case"salario":t.includes("R$")&&(s+=40),t.match(/\d{1,3}(?:\.\d{3})*(?:,\d{2})?/)&&(s+=30),(t.includes("variável")||t.includes("meta"))&&(s+=10);break;case"horario_trabalho":t.match(/\d{1,2}:\d{2}/)&&(s+=35),(t.includes("às")||t.includes("h"))&&(s+=25),(t.includes("saídas")||t.includes("entrada"))&&(s+=15);break;case"jornada_trabalho":(t.includes("h/mês")||t.includes("h/ mês"))&&(s+=35),t.match(/\d+x\d+/)&&(s+=25),(t.includes("escala")||t.includes("folga"))&&(s+=15);break;case"local_trabalho":(t.includes("Praça")||t.includes("Avenida")||t.includes("Rua"))&&(s+=30),t.includes("-")&&t.includes(",")&&(s+=25),t.match(/\d{5}-\d{3}/)&&(s+=20);break;case"etapas_processo":t.includes("Etapa")&&(s+=35),t.split(`
`).length>3&&(s+=25),(t.includes("Cadastro")||t.includes("Entrevista"))&&(s+=15);break;default:t.length>100&&(s+=20),(t.includes(`
`)||t.includes("•")||t.includes("-"))&&(s+=15),t.split(" ").length>20&&(s+=10)}return t.length>200&&(s+=10),t.split(" ").length>15&&(s+=10),(t.includes("Atento")||t.includes("Gupy"))&&(s+=5),Math.min(70,s)}static async fetchPage(t){try{const r=await fetch(t,{method:"GET",headers:{Accept:"text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8","User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36","Accept-Language":"pt-BR,pt;q=0.9,en;q=0.8","Accept-Encoding":"gzip, deflate, br",DNT:"1",Connection:"keep-alive","Upgrade-Insecure-Requests":"1","Sec-Fetch-Dest":"document","Sec-Fetch-Mode":"navigate","Sec-Fetch-Site":"none"}});return r.ok?await r.text():{message:`Erro HTTP: ${r.status} ${r.statusText}`,code:"NETWORK_ERROR"}}catch(r){if(r instanceof TypeError&&(r.message.includes("fetch")||r.message.includes("CORS")||r.message.includes("Failed to fetch")||r.message.includes("ERR_FAILED"))){console.log("Tentando usar proxy para contornar CORS...");try{const s=`/api/proxy-scrape?url=${encodeURIComponent(t)}`,n=await fetch(s);if(!n.ok){const o=await n.text();return console.error("Erro no proxy:",o),{message:`Erro no proxy (${n.status}): ${o}. Tente fazer upload do arquivo HTML.`,code:"NETWORK_ERROR"}}const i=await n.text();return console.log("Proxy funcionou! HTML recebido via proxy."),i}catch(s){return console.error("Erro no proxy:",s),{message:"Erro de CORS: Não foi possível acessar a URL. Tente fazer upload do arquivo HTML.",code:"CORS_ERROR"}}}return{message:`Erro de rede: ${r instanceof Error?r.message:"Erro desconhecido"}`,code:"NETWORK_ERROR"}}}static isValidGupyURL(t){try{const r=new URL(t);return r.hostname.includes("gupy.io")||r.hostname.includes("atento.gupy.io")}catch{return!1}}static evaluateXPath(t,r){try{return t.evaluate(r,t,null,XPathResult.FIRST_ORDERED_NODE_TYPE,null).singleNodeValue}catch{return null}}static cleanText(t,r){let s=t.replace(/\n\s*\n/g,`

`);return r==="etapas_processo"?s=s.replace(/[ \t]+/g," ").replace(/[ \t]+$/gm,"").replace(/^[ \t]+/gm,"").trim().replace(/^\s*Etapas do processo[:\s]*/i,"").split(`
`).map(n=>{let i=n.replace(/^Etapa\s+\d+:\s*/i,"").trim();i=i.replace(/\d+$/,"").trim();const o=i.split(/(?=\d)/);return o.length>1&&o[1].match(/^\d/)&&(i=o[0].trim()),i}).filter(n=>n.trim()!=="").join(`
`):r==="beneficios"?s=s.replace(/[ \t]+/g," ").replace(/[ \t]+$/gm,"").replace(/^[ \t]+/gm,"").trim().replace(/^\s*Benefícios[:\s]*/i,"").split(/[;]\s*/).map(n=>n.trim()).filter(n=>n.trim()!=="").join(`
`):r==="requisitos_qualificacoes"?s=s.replace(/[ \t]+/g," ").replace(/[ \t]+$/gm,"").replace(/^[ \t]+/gm,"").trim().replace(/^\s*Requisitos[:\s]*/i,"").replace(/^\s*Qualificações[:\s]*/i,"").split(/[;]\s*/).map(n=>n.trim()).filter(n=>n.trim()!=="").join(`
`):r==="responsabilidades_atribuicoes"?s=s.replace(/[ \t]+/g," ").replace(/[ \t]+$/gm,"").replace(/^[ \t]+/gm,"").trim().replace(/^\s*Responsabilidades[:\s]*/i,"").replace(/^\s*Atribuições[:\s]*/i,"").split(/[;]\s*/).map(n=>n.trim()).filter(n=>n.trim()!=="").join(`
`):r==="descricao_vaga"?s=s.replace(/[ \t]+/g," ").replace(/[ \t]+$/gm,"").replace(/^[ \t]+/gm,"").trim().replace(/^\s*Descrição[:\s]*/i,"").replace(/^\s*Vaga[:\s]*/i,""):s=s.replace(/[ \t]+/g," ").replace(/[ \t]+$/gm,"").replace(/^[ \t]+/gm,"").trim().replace(/^\s*Salário[:\s]*/i,"").replace(/^\s*Local de trabalho[:\s]*/i,"").replace(/^\s*Horário de Trabalho[:\s]*/i,"").replace(/^\s*Jornada de Trabalho[:\s]*/i,"").replace(/^\s*Benefícios[:\s]*/i,"").replace(/^\s*Responsabilidades[:\s]*/i,"").replace(/^\s*Requisitos[:\s]*/i,""),s}static cleanHTML(t){return t.replace(/<br\s*\/?>/gi,`
`).replace(/<\/p>/gi,`

`).replace(/<\/div>/gi,`
`).replace(/<\/li>/gi,`
`).replace(/<\/h[1-6]>/gi,`

`).replace(/<li[^>]*>/gi,"• ").replace(/<[^>]*>/g,"").replace(/&nbsp;/g," ").replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&apos;/g,"'").replace(/\n\s*\n\s*\n/g,`

`).replace(/[ \t]+/g," ").replace(/[ \t]+$/gm,"").replace(/^[ \t]+/gm,"").trim()}static extractSalaryFromText(t){const r=t.match(/Salário[:\s]*([^<]*?)(?=<|$)/i);return r?r[1].trim():""}static extractHorarioFromText(t){const r=t.match(/Horário de Trabalho[^<]*?([0-9]{1,2}[hH][0-9]{2}[^<]*?)(?=<|$)/i);return r?r[1].trim():""}static extractJornadaFromText(t){const r=t.match(/Jornada de Trabalho[^<]*?([0-9]+h\/mês[^<]*?)(?=<|$)/i);return r?r[1].trim():""}static extractBeneficiosFromText(t){const r=t.match(/Benefícios[^<]*?(.*?)(?=Local de trabalho|$)/is);if(r){const s=this.cleanHTML(r[1]).trim();return this.formatBeneficiosAsList(s)}return""}static formatBeneficiosAsList(t){if(!t.trim())return"";const r=t.split(/[;]\s*/).map(s=>s.trim()).filter(s=>s.length>0);if(r.length===1){const s=t.split(/\n+/).map(n=>n.trim()).filter(n=>n.length>0);if(s.length>1)return s.join(`
`)}return r.join(`
`)}static formatEtapasProcesso(t){return Array.isArray(t)?t.sort((r,s)=>(r.order||0)-(s.order||0)).map(r=>r.name||"").filter(r=>r.trim()!=="").join(`
`):""}static toVagaFormData(t,r={}){return{site:r.site||"",categoria:r.categoria||"",cargo:r.cargo||"",cliente:r.cliente||"",celula:r.celula||"",titulo:t.titulo,descricao_vaga:t.descricao_vaga,responsabilidades_atribuicoes:t.responsabilidades_atribuicoes,requisitos_qualificacoes:t.requisitos_qualificacoes,salario:t.salario,horario_trabalho:t.horario_trabalho,jornada_trabalho:t.jornada_trabalho,beneficios:t.beneficios,local_trabalho:t.local_trabalho,etapas_processo:t.etapas_processo}}};al.XPATH_PATTERNS={titulo:['//h1[@id="h1" and @class="sc-ccd5d36-6 gdqSpl"]','//meta[@property="og:title"]/@content',"//title",'//h1[@id="h1"]','//h1[contains(@class, "gdqSpl")]'],descricao_vaga:['//div[@data-testid="text-section" and .//h2[@data-testid="section-Descrição da vaga-title"]]/div[@class="sc-add46fb1-3 cOkxvQ"]','//h2[@data-testid="section-Descrição da vaga-title"]/following-sibling::div[@class="sc-add46fb1-3 cOkxvQ"]','//div[@class="sc-add46fb1-3 cOkxvQ" and preceding-sibling::h2[@data-testid="section-Descrição da vaga-title"]]','//h2[contains(text(), "Descrição da vaga")]/following-sibling::div[@class="sc-add46fb1-3 cOkxvQ"]'],responsabilidades_atribuicoes:['//div[@data-testid="text-section" and .//h2[@data-testid="section-Responsabilidades e atribuições-title"]]/div[@class="sc-add46fb1-3 cOkxvQ"]','//h2[@data-testid="section-Responsabilidades e atribuições-title"]/following-sibling::div[@class="sc-add46fb1-3 cOkxvQ"]','//div[@class="sc-add46fb1-3 cOkxvQ" and preceding-sibling::h2[@data-testid="section-Responsabilidades e atribuições-title"]]','//h2[contains(text(), "Responsabilidades e atribuições")]/following-sibling::div[@class="sc-add46fb1-3 cOkxvQ"]'],requisitos_qualificacoes:['//div[@data-testid="text-section" and .//h2[@data-testid="section-Requisitos e qualificações-title"]]/div[@class="sc-add46fb1-3 cOkxvQ"]','//h2[@data-testid="section-Requisitos e qualificações-title"]/following-sibling::div[@class="sc-add46fb1-3 cOkxvQ"]','//div[@class="sc-add46fb1-3 cOkxvQ" and preceding-sibling::h2[@data-testid="section-Requisitos e qualificações-title"]]','//h2[contains(text(), "Requisitos e qualificações")]/following-sibling::div[@class="sc-add46fb1-3 cOkxvQ"]'],salario:['//div[@data-testid="text-section" and .//h2[@data-testid="section-Informações adicionais-title"]]//p[contains(strong, "Salário")]','//div[@class="sc-add46fb1-3 cOkxvQ"]//p[contains(strong, "Salário")]','//p[contains(strong, "Salário")]','//strong[contains(text(), "Salário")]/parent::p','//*[contains(text(), "R$") and contains(text(), ",")]'],horario_trabalho:['//div[@data-testid="text-section" and .//h2[@data-testid="section-Informações adicionais-title"]]//p[contains(strong, "Horário de Trabalho")]/following-sibling::ul/li','//div[@class="sc-add46fb1-3 cOkxvQ"]//p[contains(strong, "Horário de Trabalho")]/following-sibling::ul/li','//p[contains(strong, "Horário de Trabalho")]/following-sibling::ul/li','//strong[contains(text(), "Horário de Trabalho")]/following-sibling::ul/li','//*[contains(text(), "Das ") and contains(text(), " às ")]'],jornada_trabalho:['//div[@data-testid="text-section" and .//h2[@data-testid="section-Informações adicionais-title"]]//p[contains(strong, "Jornada de Trabalho")]/following-sibling::p','//div[@class="sc-add46fb1-3 cOkxvQ"]//p[contains(strong, "Jornada de Trabalho")]/following-sibling::p','//p[contains(strong, "Jornada de Trabalho")]/following-sibling::p','//strong[contains(text(), "Jornada de Trabalho")]/following-sibling::text()','//*[contains(text(), "h/mês") or contains(text(), "x2") or contains(text(), "x1")]'],beneficios:['//div[@data-testid="text-section" and .//h2[@data-testid="section-Informações adicionais-title"]]//p[contains(strong, "Benefícios")]/following-sibling::ul','//div[@class="sc-add46fb1-3 cOkxvQ"]//p[contains(strong, "Benefícios")]/following-sibling::ul','//p[contains(strong, "Benefícios")]/following-sibling::ul','//strong[contains(text(), "Benefícios")]/following-sibling::ul','//ul[.//li[contains(text(), "Vale Transporte") or contains(text(), "Vale refeição")]]'],local_trabalho:['//div[@data-testid="text-section" and .//h2[@data-testid="section-Informações adicionais-title"]]//p[contains(strong, "Local de trabalho")]','//div[@class="sc-add46fb1-3 cOkxvQ"]//p[contains(strong, "Local de trabalho")]','//p[contains(strong, "Local de trabalho")]','//strong[contains(text(), "Local de trabalho")]/parent::p','//*[contains(text(), "Av ") or contains(text(), "Rua ") or contains(text(), "Praça ")]'],etapas_processo:['//ol[@data-testid="job-steps-list" and @class="sc-97f6c339-0 wTJDe"]','//div[@data-testid="text-section" and .//h2[@data-testid="section-Etapas do processo-title"]]//ol[@data-testid="job-steps-list"]','//h2[@data-testid="section-Etapas do processo-title"]/following-sibling::ol[@data-testid="job-steps-list"]','//ol[.//li[contains(text(), "Etapa 1:")]]','//ol[@class="sc-97f6c339-0 wTJDe"]']};let ao=al;function qh({confidence:e,size:t="md",showPercentage:r=!0}){const s=l=>l>=80?"text-green-600 dark:text-green-400 bg-green-100 dark:bg-green-900/30":l>=60?"text-yellow-600 dark:text-yellow-400 bg-yellow-100 dark:bg-yellow-900/30":l>=40?"text-orange-600 dark:text-orange-400 bg-orange-100 dark:bg-orange-900/30":"text-red-600 dark:text-red-400 bg-red-100 dark:bg-red-900/30",n=l=>l>=80?"🟢":l>=60?"🟡":l>=40?"🟠":"🔴",i=l=>l>=80?"Excelente":l>=60?"Boa":l>=40?"Regular":"Baixa",o={sm:"px-2 py-1 text-xs",md:"px-3 py-1.5 text-sm",lg:"px-4 py-2 text-base"};return a.jsxs("div",{className:`inline-flex items-center space-x-2 rounded-full ${s(e)} ${o[t]}`,children:[a.jsx("span",{className:"text-sm",children:n(e)}),a.jsx("span",{className:"font-medium",children:i(e)}),r&&a.jsxs("span",{className:"font-bold",children:[e,"%"]})]})}function E_({extractedFields:e}){const t=Object.entries(e),r=t.length,s=t.filter(([,l])=>l.found).length,n=Math.round(t.reduce((l,[,d])=>l+d.confidence,0)/r),i=l=>({titulo:"Título",descricao_vaga:"Descrição",responsabilidades_atribuicoes:"Responsabilidades",requisitos_qualificacoes:"Requisitos",salario:"Salário",horario_trabalho:"Horário",jornada_trabalho:"Jornada",beneficios:"Benefícios",local_trabalho:"Local",etapas_processo:"Etapas"})[l]||l,o=l=>l.found?l.confidence>=80?"✅":l.confidence>=60?"⚠️":"❌":"❓";return a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800 p-4 rounded-lg",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:"Resumo da Extração"}),a.jsx(qh,{confidence:n})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[a.jsxs("div",{children:[a.jsx("span",{className:"font-medium text-gray-900 dark:text-gray-100",children:"Campos encontrados:"}),a.jsxs("span",{className:"ml-2 text-blue-600 dark:text-blue-400",children:[s,"/",r]})]}),a.jsxs("div",{children:[a.jsx("span",{className:"font-medium text-gray-900 dark:text-gray-100",children:"Assertividade média:"}),a.jsxs("span",{className:"ml-2 text-blue-600 dark:text-blue-400",children:[n,"%"]})]})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("h4",{className:"font-medium text-gray-900 dark:text-gray-100",children:"Detalhamento por Campo"}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:t.map(([l,d])=>a.jsxs("div",{className:`flex items-center justify-between p-3 rounded-lg border ${d.found?"bg-green-50 dark:bg-green-900/20 border-green-200 dark:border-green-800":"bg-red-50 dark:bg-red-900/20 border-red-200 dark:border-red-800"}`,children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("span",{className:"text-lg",children:o(d)}),a.jsx("span",{className:"font-medium text-sm text-gray-900 dark:text-gray-100",children:i(l)})]}),a.jsx("div",{className:"flex items-center space-x-2",children:d.found&&a.jsxs("span",{className:"text-xs px-2 py-1 bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300 rounded",children:[d.confidence,"%"]})})]},l))})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex justify-between text-sm",children:[a.jsx("span",{className:"font-medium",children:"Progresso da Extração"}),a.jsxs("span",{children:[s,"/",r," campos"]})]}),a.jsx("div",{className:"w-full bg-gray-200 rounded-full h-3",children:a.jsx("div",{className:"bg-gradient-to-r from-red-500 via-yellow-500 to-green-500 h-3 rounded-full transition-all duration-300",style:{width:`${s/r*100}%`}})})]})]})}function __({confidence:e,className:t=""}){const r=s=>s>=80?"bg-green-500":s>=60?"bg-yellow-500":s>=40?"bg-orange-500":"bg-red-500";return a.jsx("div",{className:`w-full bg-gray-200 rounded-full h-2 ${t}`,children:a.jsx("div",{className:`h-2 rounded-full transition-all duration-500 ${r(e)}`,style:{width:`${e}%`}})})}function gc(){const{id:e}=Mn(),[t,r]=p.useState({site:"",categoria:"",cargo:"",cliente:"",titulo:"",celula:"",descricao_vaga:"",responsabilidades_atribuicoes:"",requisitos_qualificacoes:"",salario:"",horario_trabalho:"",jornada_trabalho:"",beneficios:"",local_trabalho:"",etapas_processo:""}),[s,n]=p.useState(!1),[i,o]=p.useState(!1),[l,d]=p.useState(!1),[c,u]=p.useState(""),[h,f]=p.useState(""),[m,v]=p.useState(null),[g,x]=p.useState(""),[b,N]=p.useState("manual"),[y,A]=p.useState(0),{user:B}=tt(),{addVaga:W,updateVaga:C}=Br(),L=nr(),T=!!e;p.useEffect(()=>{T&&e&&I()},[e,T]),p.useEffect(()=>{if(m){const J=setInterval(()=>{A(Z=>(Z+1)%6)},1e3);return()=>clearInterval(J)}},[m]);const P=["bg-green-600 hover:bg-green-700","bg-blue-600 hover:bg-blue-700","bg-purple-600 hover:bg-purple-700","bg-orange-600 hover:bg-orange-700","bg-pink-600 hover:bg-pink-700","bg-teal-600 hover:bg-teal-700"],I=async()=>{if(e){o(!0);try{const J=await Un(e);J?(r({site:J.site||"",categoria:J.categoria||"",cargo:J.cargo||"",cliente:J.cliente||"",titulo:J.titulo||"",celula:J.celula||"",descricao_vaga:J.descricao_vaga||"",responsabilidades_atribuicoes:J.responsabilidades_atribuicoes||"",requisitos_qualificacoes:J.requisitos_qualificacoes||"",salario:J.salario||"",horario_trabalho:J.horario_trabalho||"",jornada_trabalho:J.jornada_trabalho||"",beneficios:J.beneficios||"",local_trabalho:J.local_trabalho||"",etapas_processo:J.etapas_processo||""}),u("✅ Dados da vaga carregados com sucesso!")):u("❌ Oportunidade não encontrada")}catch(J){console.error("Erro ao carregar vaga:",J),u("❌ Erro ao carregar dados da vaga")}finally{o(!1)}}},V=async J=>{if(J.preventDefault(),!!B){if(s){console.log("Formulário já está sendo enviado, ignorando...");return}n(!0),u(""),x("");try{const ue=["site","categoria","cargo","cliente","celula"].filter(me=>{var k;return!((k=t[me])!=null&&k.trim())});if(ue.length>0){u(`❌ Campos obrigatórios não preenchidos: ${ue.join(", ")}`);return}if(console.log("🚀 Iniciando envio do formulário..."),console.log("Dados do formulário:",t),T){u("⏳ Atualizando vaga no banco de dados...");const me=new Promise((O,R)=>{setTimeout(()=>R(new Error("Timeout: Operação demorou muito para responder")),6e4)}),k=$n(e,t,B.id),M=await Promise.race([k,me]);M?(u("✅ Oportunidade atualizada com sucesso!"),console.log("Vaga atualizada:",M),M&&typeof M=="object"&&"id"in M&&C(M),setTimeout(()=>{L("/dashboard/clientes")},1500)):u("❌ Erro: Oportunidade não foi atualizada (retorno nulo)")}else{u("⏳ Salvando vaga no banco de dados...");const me=new Promise((O,R)=>{setTimeout(()=>R(new Error("Timeout: Operação demorou muito para responder")),6e4)}),k=Tm(t,B.id),M=await Promise.race([k,me]);M?(u("✅ Oportunidade criada com sucesso!"),console.log("Vaga criada:",M),M&&typeof M=="object"&&"id"in M&&W(M),ve(),setTimeout(()=>{L("/dashboard")},1500)):u("❌ Erro: Oportunidade não foi criada (retorno nulo)")}}catch(Z){console.error("💥 [handleSubmit] Erro detalhado:",Z),console.error("💥 [handleSubmit] Tipo do erro:",typeof Z),console.error("💥 [handleSubmit] Stack trace:",Z.stack);let ue=T?"Erro desconhecido ao atualizar vaga":"Erro desconhecido ao criar vaga";Z!=null&&Z.message?(console.log("📝 [handleSubmit] Mensagem do erro:",Z.message),Z.message.includes("Timeout")?ue="⏰ Timeout: A operação demorou muito. Verifique sua conexão e tente novamente.":Z.message.includes('null value in column "produto"')?ue='❌ MIGRAÇÃO NECESSÁRIA: O banco ainda usa coluna "produto". Execute o script "migrate-produto-to-celula.sql" no Supabase SQL Editor.':Z.message.includes('null value in column "celula"')?ue='❌ Erro: Campo "Célula" é obrigatório e não foi preenchido.':Z.message.includes("violates not-null constraint")?ue="❌ Erro: Algum campo obrigatório não foi preenchido corretamente.":Z.message.includes("JWT")||Z.message.includes("auth")?ue="🔐 Erro de autenticação: Faça login novamente.":Z.message.includes("permission")||Z.message.includes("policy")?ue="🚫 Erro de permissão: Você não tem permissão para criar/editar vagas.":Z.message.includes("network")||Z.message.includes("fetch")?ue="🌐 Erro de rede: Verifique sua conexão com a internet.":Z.message.includes("Campos obrigatórios não preenchidos")?ue=`❌ ${Z.message}`:ue=`❌ Erro inesperado: ${Z.message}`):(console.error("❌ [handleSubmit] Erro sem mensagem:",Z),ue="❌ Erro desconhecido. Verifique o console para mais detalhes."),u(ue)}finally{n(!1)}}},ae=J=>{const{name:Z,value:ue}=J.target;r(me=>({...me,[Z]:ue}))},_e=async()=>{if(!h.trim()){x("Por favor, insira uma URL válida");return}d(!0),x(""),u("Iniciando extração de dados...");try{console.log("Iniciando extração de URL:",h);const J=await ao.extractFromURL(h);if("message"in J){let Z=J.message;J.code==="CORS_ERROR"?Z="🚫 Erro de CORS: Não foi possível acessar a URL diretamente. Tente fazer upload do arquivo HTML ou use uma URL diferente.":J.code==="NETWORK_ERROR"?Z="🌐 Erro de rede: Verifique sua conexão e tente novamente. Se o problema persistir, faça upload do arquivo HTML.":J.code==="VALIDATION_ERROR"&&(Z="⚠️ URL inválida: Certifique-se de que a URL é do domínio gupy.io"),x(`${Z} (Código: ${J.code})`),u("")}else{console.log("Extração bem-sucedida!",J),v(J),r(ue=>({...ue,titulo:J.titulo,descricao_vaga:J.descricao_vaga,responsabilidades_atribuicoes:J.responsabilidades_atribuicoes,requisitos_qualificacoes:J.requisitos_qualificacoes,salario:J.salario,horario_trabalho:J.horario_trabalho,jornada_trabalho:J.jornada_trabalho,beneficios:J.beneficios,local_trabalho:J.local_trabalho,etapas_processo:J.etapas_processo}));const Z=J.confidence>=80?"Excelente":J.confidence>=60?"Boa":J.confidence>=40?"Regular":"Baixa";u(`✅ Dados extraídos com sucesso! Assertividade: ${J.confidence}% (${Z}). Revise e ajuste conforme necessário.`)}}catch(J){console.error("Erro inesperado:",J),x(`❌ Erro inesperado ao extrair dados: ${J.message}`),u("")}finally{d(!1)}},ve=()=>{r({site:"",categoria:"",cargo:"",cliente:"",titulo:"",celula:"",descricao_vaga:"",responsabilidades_atribuicoes:"",requisitos_qualificacoes:"",salario:"",horario_trabalho:"",jornada_trabalho:"",beneficios:"",local_trabalho:"",etapas_processo:""}),v(null),x(""),u("")},we=J=>{r(Z=>({...Z,titulo:J.titulo,descricao_vaga:J.descricao_vaga,responsabilidades_atribuicoes:J.responsabilidades_atribuicoes,requisitos_qualificacoes:J.requisitos_qualificacoes,salario:J.salario,horario_trabalho:J.horario_trabalho,jornada_trabalho:J.jornada_trabalho,beneficios:J.beneficios,local_trabalho:J.local_trabalho,etapas_processo:J.etapas_processo})),v(null),N("manual"),u("✅ Dados aplicados ao formulário! Você está na aba de extração manual para revisar e editar.")},be=(J,Z,ue,me="input",k)=>a.jsxs("div",{className:"space-y-2",children:[a.jsx(fe,{htmlFor:J,className:"field-title",children:Z}),me==="textarea"?a.jsx("textarea",{id:J,name:J,value:t[J]||"",onChange:ae,placeholder:ue,rows:4,className:"flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 text-foreground dark:text-gray-100"}):a.jsx(Re,{id:J,name:J,value:t[J]||"",onChange:ae,placeholder:ue,className:"text-foreground dark:text-gray-100"})]});return i?a.jsx("div",{className:"flex items-center justify-center min-h-screen",children:a.jsxs("div",{className:"text-center",children:[a.jsx(Mr,{className:"h-12 w-12 animate-spin text-blue-600 mx-auto mb-4"}),a.jsx("p",{className:"text-gray-600",children:"Carregando dados da vaga..."})]})}):a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-4xl font-bold bg-gradient-to-r from-primary to-primary/70 bg-clip-text text-transparent page-title",children:T?"Editar Oportunidade":"Nova Oportunidade"}),a.jsx("p",{className:"page-subtitle text-lg",children:T?"Edite as informações da oportunidade com extração automática ou manual":"Adicione uma nova oportunidade ao sistema com extração automática ou manual"})]}),a.jsx("div",{className:`mb-6 p-4 rounded-lg shadow-sm border-l-4 ${c.includes("✅")||c.includes("sucesso")?"bg-green-50 dark:bg-green-900/20 text-green-800 dark:text-green-200 border-green-400 dark:border-green-600 border-l-green-500 dark:border-l-green-400":c.includes("❌")||c.includes("erro")?"bg-red-50 dark:bg-red-900/20 text-red-800 dark:text-red-200 border-red-400 dark:border-red-600 border-l-red-500 dark:border-l-red-400":c.includes("⏳")||c.includes("Testando")?"bg-blue-50 dark:bg-blue-900/20 text-blue-800 dark:text-blue-200 border-blue-400 dark:border-blue-600 border-l-blue-500 dark:border-l-blue-400":"bg-gray-50 dark:bg-gray-800 text-gray-800 dark:text-gray-200 border-gray-400 dark:border-gray-600 border-l-gray-500 dark:border-l-gray-400"}`,children:c||(T?'💡 Edite os campos necessários e clique em "Atualizar Oportunidade" para salvar as alterações.':'💡 Preencha os campos obrigatórios e clique em "Salvar Oportunidade" para criar uma nova oportunidade.')}),a.jsxs(rl,{value:b,onValueChange:N,className:"w-full",children:[a.jsxs(ni,{className:"grid w-full grid-cols-2",children:[a.jsxs(qt,{value:"auto",className:"flex items-center space-x-2",children:[a.jsx(jr,{className:"h-4 w-4"}),a.jsx("span",{children:"Extração Automática"})]}),a.jsxs(qt,{value:"manual",className:"flex items-center space-x-2",children:[a.jsx(va,{className:"h-4 w-4"}),a.jsx("span",{children:"Preenchimento Manual"})]})]}),a.jsx(Vr,{value:"auto",className:"space-y-4",children:a.jsxs(Ee,{children:[a.jsxs(Ae,{children:[a.jsxs(Fe,{className:"flex items-center page-title",children:[a.jsx(jr,{className:"h-5 w-5 mr-2 icon-primary"}),"Extração Automática de Dados"]}),a.jsx(Ge,{className:"page-subtitle",children:"Extraia informações automaticamente de URLs ou arquivos HTML"})]}),a.jsxs(Se,{className:"space-y-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(fe,{htmlFor:"scraping-url",className:"field-title",children:"URL da Oportunidade"}),a.jsxs("div",{className:"flex space-x-2",children:[a.jsx(Re,{id:"scraping-url",value:h,onChange:J=>f(J.target.value),placeholder:"https://atento.gupy.io/jobs/XXXXXXXXXX?jobBoardSource=share_link",className:"flex-1 text-foreground dark:text-gray-100"}),a.jsx(Q,{onClick:_e,disabled:l||!h.trim(),className:l?"btn-active":"btn-text",children:l?a.jsxs(a.Fragment,{children:[a.jsx(ot,{className:"h-4 w-4 animate-spin mr-2"}),"Extraindo..."]}):a.jsxs(a.Fragment,{children:[a.jsx(jr,{className:"h-4 w-4 mr-2"}),"Extrair"]})})]})]}),g&&a.jsx("div",{className:"mt-4 p-4 rounded-lg bg-red-50 text-red-800 border-2 border-red-200 shadow-sm",children:a.jsxs("div",{className:"flex items-start",children:[a.jsx("div",{className:"flex-shrink-0",children:a.jsx("svg",{className:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor",children:a.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),a.jsx("div",{className:"ml-3",children:a.jsx("p",{className:"text-sm font-medium",children:g})})]})}),m&&a.jsx("div",{className:"mt-6 p-4 bg-green-50 dark:bg-gray-800 border-2 border-green-200 dark:border-gray-600 rounded-lg shadow-sm",children:a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsxs("h3",{className:"text-lg font-semibold text-green-800 dark:text-gray-100 flex items-center",children:[a.jsx("svg",{className:"h-5 w-5 mr-2 text-green-600 dark:text-green-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Dados Extraídos com Sucesso!"]}),a.jsxs("div",{className:"flex items-center space-x-3 mt-2",children:[a.jsx(qh,{confidence:m.confidence,size:"sm"}),a.jsxs("span",{className:"text-xs text-green-600 dark:text-gray-300 bg-green-100 dark:bg-gray-700 px-2 py-1 rounded-full",children:["Fonte: ",m.source==="json"?"JSON":m.source==="html"?"HTML":"Mista"]})]})]}),a.jsxs("div",{className:"space-x-2",children:[a.jsxs(Q,{size:"sm",onClick:()=>we(m),className:`${P[y]} text-white transition-all duration-300 animate-pulse`,children:[a.jsx(mn,{className:"h-4 w-4 mr-1"}),"Aplicar"]}),a.jsxs(Q,{size:"sm",variant:"outline",onClick:()=>v(null),className:"border-green-300 text-green-700 hover:bg-green-50",children:[a.jsx(Kr,{className:"h-4 w-4 mr-1"}),"Limpar"]})]})]}),a.jsx(E_,{extractedFields:m.extractedFields}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:Object.entries(m).filter(([J])=>!["confidence","extractedFields","source","url"].includes(J)).map(([J,Z])=>{const ue=m.extractedFields[J];return a.jsxs("div",{className:"space-y-1",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx(fe,{className:"text-sm font-medium capitalize",children:J.replace(/_/g," ")}),ue&&a.jsxs("div",{className:"flex items-center space-x-1",children:[a.jsxs("span",{className:`text-xs px-1.5 py-0.5 rounded ${ue.found?"bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-300":"bg-red-100 dark:bg-red-900/30 text-red-700 dark:text-red-300"}`,children:[ue.confidence,"%"]}),a.jsx("span",{className:"text-xs text-gray-400 dark:text-gray-500",children:ue.source})]})]}),a.jsx("div",{className:`p-3 rounded border text-sm max-h-40 overflow-y-auto ${ue!=null&&ue.found?"bg-green-50 dark:bg-gray-700 border-green-200 dark:border-gray-600 text-gray-900 dark:text-gray-100":"bg-red-50 dark:bg-gray-700 border-red-200 dark:border-gray-600 text-gray-900 dark:text-gray-100"}`,children:Z?a.jsx("div",{className:"whitespace-pre-wrap space-y-1",children:Z.split(`
`).map((me,k)=>{var O;const M=me.trim();return M?M.startsWith("•")||M.startsWith("-")||M.startsWith("*")?a.jsxs("div",{className:"flex items-start",children:[a.jsx("span",{className:"text-green-600 dark:text-green-400 mr-2 mt-0.5 flex-shrink-0",children:"•"}),a.jsx("span",{className:"flex-1",children:M.substring(1).trim()})]},k):/^\d+\.\s/.test(M)?a.jsxs("div",{className:"flex items-start",children:[a.jsxs("span",{className:"text-green-600 dark:text-green-400 mr-2 mt-0.5 flex-shrink-0 font-semibold",children:[(O=M.match(/^\d+/))==null?void 0:O[0],"."]}),a.jsx("span",{className:"flex-1",children:M.replace(/^\d+\.\s/,"").trim()})]},k):a.jsx("div",{className:"leading-relaxed",children:M},k):a.jsx("div",{className:"h-1"},k)})}):a.jsx("span",{className:"text-gray-500 dark:text-gray-400 italic",children:"Não encontrado"})}),a.jsx(__,{confidence:(ue==null?void 0:ue.confidence)||0,className:"h-1"})]},J)})})]})})]})]})}),a.jsx(Vr,{value:"manual",className:"space-y-4",children:a.jsxs(Ee,{children:[a.jsxs(Ae,{children:[a.jsxs(Fe,{className:"flex items-center page-title",children:[a.jsx(Ss,{className:"h-5 w-5 mr-2 icon-primary"}),"Informações da Oportunidade"]}),a.jsx(Ge,{className:"page-subtitle",children:"Preencha todas as informações necessárias sobre a oportunidade"})]}),a.jsx(Se,{children:a.jsxs("form",{onSubmit:V,className:"space-y-6",children:[a.jsxs("div",{className:"grid grid-cols-1 tablet:grid-cols-2 gap-4",children:[be("site","Site","Ex: São Bento, Casa, etc.","input"),be("categoria","Categoria","Ex: Operações","input"),be("cargo","Cargo","Ex: Especialista I","input"),be("cliente","Cliente","Ex: VIVO, REDE, etc.","input"),be("titulo","Título da Oportunidade","Ex: Desenvolvedor Full Stack","input"),be("celula","Célula","Ex: VIVO - Telecom I","input")]}),be("descricao_vaga","Descrição da Oportunidade","Descreva a oportunidade...","textarea"),be("responsabilidades_atribuicoes","Responsabilidades e Atribuições","Liste as responsabilidades...","textarea"),be("requisitos_qualificacoes","Requisitos e Qualificações","Liste os requisitos...","textarea"),a.jsxs("div",{className:"grid grid-cols-1 tablet:grid-cols-2 laptop:grid-cols-3 gap-4",children:[be("salario","Salário","Ex: R$ 1.518,00","input"),be("horario_trabalho","Horário de Trabalho","Ex: Das 09:00 às 18:00","input"),be("jornada_trabalho","Jornada de Trabalho","Ex: 180h mês | Escala 5x2","input")]}),be("beneficios","Benefícios","Liste os benefícios...","textarea"),be("local_trabalho","Local de Trabalho","Endereço e localização...","textarea"),be("etapas_processo","Etapas do Processo","Liste as etapas do processo seletivo...","textarea"),a.jsxs("div",{className:"flex flex-col tablet:flex-row justify-between gap-4 pt-6",children:[a.jsxs(Q,{type:"button",variant:"outline",onClick:ve,className:"w-full tablet:w-auto",children:[a.jsx(Kr,{className:"h-4 w-4 mr-2"}),"Limpar Formulário"]}),a.jsxs("div",{className:"flex flex-col tablet:flex-row gap-2 w-full tablet:w-auto",children:[a.jsx(Q,{type:"button",variant:"outline",onClick:()=>L("/dashboard"),className:"w-full tablet:w-auto",children:"Cancelar"}),a.jsx(Q,{type:"submit",disabled:s,className:"w-full tablet:w-auto",children:s?a.jsxs(a.Fragment,{children:[a.jsx(ot,{className:"h-4 w-4 mr-2 animate-spin"}),T?"Atualizando...":"Salvando..."]}):a.jsxs(a.Fragment,{children:[a.jsx(mn,{className:"h-4 w-4 mr-2"}),T?"Atualizar Oportunidade":"Salvar Oportunidade"]})})]})]})]})})]})})]})]})}var ii="Switch",[S_]=_a(ii),[C_,T_]=S_(ii),Gh=p.forwardRef((e,t)=>{const{__scopeSwitch:r,name:s,checked:n,defaultChecked:i,required:o,disabled:l,value:d="on",onCheckedChange:c,form:u,...h}=e,[f,m]=p.useState(null),v=Mt(t,y=>m(y)),g=p.useRef(!1),x=f?u||!!f.closest("form"):!0,[b,N]=Za({prop:n,defaultProp:i??!1,onChange:c,caller:ii});return a.jsxs(C_,{scope:r,checked:b,disabled:l,children:[a.jsx(nt.button,{type:"button",role:"switch","aria-checked":b,"aria-required":o,"data-state":Jh(b),"data-disabled":l?"":void 0,disabled:l,value:d,...h,ref:v,onClick:ke(e.onClick,y=>{N(A=>!A),x&&(g.current=y.isPropagationStopped(),g.current||y.stopPropagation())})}),x&&a.jsx(Yh,{control:f,bubbles:!g.current,name:s,value:d,checked:b,required:o,disabled:l,form:u,style:{transform:"translateX(-100%)"}})]})});Gh.displayName=ii;var Xh="SwitchThumb",Kh=p.forwardRef((e,t)=>{const{__scopeSwitch:r,...s}=e,n=T_(Xh,r);return a.jsx(nt.span,{"data-state":Jh(n.checked),"data-disabled":n.disabled?"":void 0,...s,ref:t})});Kh.displayName=Xh;var A_="SwitchBubbleInput",Yh=p.forwardRef(({__scopeSwitch:e,control:t,checked:r,bubbles:s=!0,...n},i)=>{const o=p.useRef(null),l=Mt(o,i),d=kf(r),c=Df(t);return p.useEffect(()=>{const u=o.current;if(!u)return;const h=window.HTMLInputElement.prototype,m=Object.getOwnPropertyDescriptor(h,"checked").set;if(d!==r&&m){const v=new Event("click",{bubbles:s});m.call(u,r),u.dispatchEvent(v)}},[d,r,s]),a.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:r,...n,tabIndex:-1,ref:l,style:{...n.style,...c,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});Yh.displayName=A_;function Jh(e){return e?"checked":"unchecked"}var Qh=Gh,R_=Kh;const ra=p.forwardRef(({className:e,...t},r)=>a.jsx(Qh,{className:De("peer inline-flex h-5 w-9 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent shadow-sm transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",e),...t,ref:r,children:a.jsx(R_,{className:De("pointer-events-none block h-4 w-4 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-4 data-[state=unchecked]:translate-x-0")})}));ra.displayName=Qh.displayName;async function F_(){try{const{data:e,error:t}=await Ce.from("contact_email_config").select("*").eq("ativo",!0).order("created_at",{ascending:!0});return t?(console.error("Erro ao buscar configurações de email:",t),[]):e||[]}catch(e){return console.error("Erro ao buscar configurações de email:",e),[]}}async function so(){try{const{data:e,error:t}=await Ce.from("contact_email_config").select("*").order("created_at",{ascending:!0});return t?(console.error("Erro ao buscar todas as configurações de email:",t),[]):e||[]}catch(e){return console.error("Erro ao buscar todas as configurações de email:",e),[]}}async function k_(e){try{const{data:t,error:r}=await Ce.from("contact_email_config").insert({email:e.email,nome:e.nome||null,teams_contact:e.teams_contact||null,ativo:e.ativo!==!1,created_at:new Date().toISOString(),updated_at:new Date().toISOString()}).select().single();return r?(console.error("Erro ao criar configuração de email:",r),null):t}catch(t){return console.error("Erro ao criar configuração de email:",t),null}}async function D_(e,t){try{const{data:r,error:s}=await Ce.from("contact_email_config").update({email:t.email,nome:t.nome||null,teams_contact:t.teams_contact||null,ativo:t.ativo!==!1,updated_at:new Date().toISOString()}).eq("id",e).select().single();return s?(console.error("Erro ao atualizar configuração de email:",s),null):r}catch(r){return console.error("Erro ao atualizar configuração de email:",r),null}}async function P_(e){try{const{error:t}=await Ce.from("contact_email_config").delete().eq("id",e);return t?(console.error("Erro ao remover configuração de email:",t),!1):!0}catch(t){return console.error("Erro ao remover configuração de email:",t),!1}}async function I_(e){try{const{data:t,error:r}=await Ce.from("contact_email_config").select("ativo").eq("id",e).single();if(r)return console.error("Erro ao buscar status atual:",r),null;const{data:s,error:n}=await Ce.from("contact_email_config").update({ativo:!t.ativo,updated_at:new Date().toISOString()}).eq("id",e).select().single();return n?(console.error("Erro ao alternar status:",n),null):s}catch(t){return console.error("Erro ao alternar status:",t),null}}async function O_(){try{return(await F_()).map(t=>t.email)}catch(e){return console.error("Erro ao obter emails destinatários:",e),["roberio.gomes@atento.com"]}}function M_(e){const t={default:{primary:"hsl(220.9 39.3% 11%)",secondary:"hsl(220 14.3% 95.9%)"},blue:{primary:"hsl(221.2 83.2% 53.3%)",secondary:"hsl(210 40% 96%)"},purple:{primary:"hsl(262.1 83.3% 57.8%)",secondary:"hsl(220 14.3% 95.9%)"},green:{primary:"hsl(142.1 76.2% 36.3%)",secondary:"hsl(240 4.8% 95.9%)"},orange:{primary:"hsl(24.6 95% 53.1%)",secondary:"hsl(60 4.8% 95.9%)"},rose:{primary:"hsl(346.8 77.2% 49.8%)",secondary:"hsl(240 4.8% 95.9%)"},violet:{primary:"hsl(262.1 83.3% 57.8%)",secondary:"hsl(240 4.8% 95.9%)"},emerald:{primary:"hsl(158.1 64.4% 51.6%)",secondary:"hsl(240 4.8% 95.9%)"},amber:{primary:"hsl(25 95% 53%)",secondary:"hsl(240 4.8% 95.9%)"},cyan:{primary:"hsl(188.7 94.5% 42.7%)",secondary:"hsl(240 4.8% 95.9%)"}};return t[e]||t.default}function L_(){const{mode:e,profile:t,setMode:r,setProfile:s}=hr(),n=tx(),i=()=>{r(e==="light"?"dark":"light")};return a.jsxs(Ee,{className:"w-full max-w-2xl mx-auto",children:[a.jsxs(Ae,{className:"text-center",children:[a.jsxs(Fe,{className:"flex items-center justify-center gap-2",children:[a.jsx(un,{className:"h-5 w-5"}),"Personalização Visual"]}),a.jsx(Ge,{children:"Escolha o tema e as cores que mais combinam com seu estilo"})]}),a.jsxs(Se,{className:"space-y-6",children:[a.jsxs("div",{className:"flex items-center justify-between p-4 rounded-lg border bg-card",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[e==="light"?a.jsx($c,{className:"h-5 w-5 text-amber-500"}):a.jsx(zc,{className:"h-5 w-5 text-blue-400"}),a.jsxs("div",{children:[a.jsxs("p",{className:"font-medium",children:["Modo ",e==="light"?"Claro":"Escuro"]}),a.jsx("p",{className:"text-sm text-muted-foreground",children:e==="light"?"Tema claro para ambientes bem iluminados":"Tema escuro para reduzir cansaço visual"})]})]}),a.jsx(Q,{variant:"outline",size:"sm",onClick:i,className:"hover-lift",children:"Alternar"})]}),a.jsx(Fo,{}),a.jsxs("div",{children:[a.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[a.jsx(Vc,{className:"h-4 w-4"}),"Perfis de Cor"]}),a.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-3",children:n.map(o=>{const l=rx(o),d=t===o,c=M_(o);return a.jsxs(Q,{variant:d?"default":"outline",size:"sm",onClick:()=>s(o),className:`
                    h-auto p-3 flex flex-col items-center gap-2 transition-all duration-300
                    ${d?"ring-2 ring-primary ring-offset-2 ring-offset-background":"hover:scale-105 hover:shadow-md"}
                  `,children:[a.jsx("div",{className:`
                      w-8 h-8 rounded-full border-2 transition-all duration-300
                      ${d?"scale-110 shadow-lg":""}
                    `,style:{backgroundColor:c.primary,borderColor:c.primary}}),a.jsx("span",{className:"text-xs font-medium",children:l.name})]},o)})})]}),a.jsxs("div",{className:"mt-6 p-4 rounded-lg border bg-card",children:[a.jsx("h4",{className:"font-medium mb-3",children:"Preview do Tema"}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"w-3 h-3 rounded-full bg-primary"}),a.jsx("span",{className:"text-sm",children:"Cor Primária"})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"w-3 h-3 rounded-full bg-secondary"}),a.jsx("span",{className:"text-sm",children:"Cor Secundária"})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"w-3 h-3 rounded-full bg-accent"}),a.jsx("span",{className:"text-sm",children:"Cor de Destaque"})]})]})]})]})]})}class B_{constructor(){this.timers=new Map,this.listeners=new Set,this.metrics=this.initializeMetrics(),this.loadFromStorage()}initializeMetrics(){const t=Date.now();return{hits:0,misses:0,sets:0,deletes:0,averageLoadTime:0,averageSaveTime:0,averageCompressionTime:0,averageDecompressionTime:0,totalDataSize:0,compressedDataSize:0,compressionRatio:0,syncMessagesSent:0,syncMessagesReceived:0,activeTabs:1,firstAccess:t,lastAccess:t,lastUpdate:t,sectionMetrics:{vagas:this.createSectionMetrics(),clientes:this.createSectionMetrics(),sites:this.createSectionMetrics(),categorias:this.createSectionMetrics(),cargos:this.createSectionMetrics(),celulas:this.createSectionMetrics(),usuarios:this.createSectionMetrics(),noticias:this.createSectionMetrics()}}}createSectionMetrics(){return{hits:0,misses:0,loadTime:0,lastAccess:0,dataSize:0}}startTimer(t,r){const s=`${t}_${r||"global"}_${Date.now()}`;return this.timers.set(s,{startTime:performance.now(),operation:t,section:r}),s}endTimer(t){const r=this.timers.get(t);if(!r)return 0;const s=performance.now()-r.startTime;return this.timers.delete(t),this.updateOperationMetrics(r.operation,s,r.section),s}updateOperationMetrics(t,r,s){switch(t){case"load":if(this.metrics.averageLoadTime=this.calculateAverage(this.metrics.averageLoadTime,r,this.metrics.sets),s&&this.metrics.sectionMetrics[s]){const n=this.metrics.sectionMetrics[s];n.loadTime=this.calculateAverage(n.loadTime,r,n.hits+n.misses),n.lastAccess=Date.now()}break;case"save":this.metrics.averageSaveTime=this.calculateAverage(this.metrics.averageSaveTime,r,this.metrics.sets);break;case"compress":this.metrics.averageCompressionTime=this.calculateAverage(this.metrics.averageCompressionTime,r,this.metrics.sets);break;case"decompress":this.metrics.averageDecompressionTime=this.calculateAverage(this.metrics.averageDecompressionTime,r,this.metrics.sets);break}}calculateAverage(t,r,s){return(t*s+r)/(s+1)}recordHit(t){this.metrics.hits++,this.metrics.lastAccess=Date.now(),t&&this.metrics.sectionMetrics[t]&&this.metrics.sectionMetrics[t].hits++,this.notifyListeners()}recordMiss(t){this.metrics.misses++,this.metrics.lastAccess=Date.now(),t&&this.metrics.sectionMetrics[t]&&this.metrics.sectionMetrics[t].misses++,this.notifyListeners()}recordSet(t,r){this.metrics.sets++,this.metrics.lastUpdate=Date.now(),t&&this.metrics.sectionMetrics[t]&&(this.metrics.sectionMetrics[t].lastAccess=Date.now(),r&&(this.metrics.sectionMetrics[t].dataSize=r)),this.notifyListeners()}recordDelete(t){this.metrics.deletes++,this.metrics.lastUpdate=Date.now(),this.notifyListeners()}updateDataSize(t,r){this.metrics.totalDataSize=t,r&&(this.metrics.compressedDataSize=r,this.metrics.compressionRatio=(t-r)/t*100),this.notifyListeners()}updateSyncStats(t,r,s){this.metrics.syncMessagesSent=t,this.metrics.syncMessagesReceived=r,this.metrics.activeTabs=s,this.notifyListeners()}getMetrics(){return{...this.metrics}}getHitRate(){const t=this.metrics.hits+this.metrics.misses;return t>0?this.metrics.hits/t*100:0}getSectionHitRate(t){const r=this.metrics.sectionMetrics[t];if(!r)return 0;const s=r.hits+r.misses;return s>0?r.hits/s*100:0}getPerformanceScore(){const t=this.getHitRate(),r=this.metrics.averageLoadTime,s=this.metrics.compressionRatio,n=Math.min(t,100),i=Math.max(0,100-r/10),o=Math.min(s,50);return n*.4+i*.3+o*.3}loadFromStorage(){try{const t=localStorage.getItem("cache_metrics");if(t){const r=JSON.parse(t);this.metrics={...this.metrics,...r}}}catch(t){console.error("Erro ao carregar métricas do cache:",t)}}saveToStorage(){try{localStorage.setItem("cache_metrics",JSON.stringify(this.metrics))}catch(t){console.error("Erro ao salvar métricas do cache:",t)}}addListener(t){return this.listeners.add(t),()=>this.listeners.delete(t)}notifyListeners(){this.listeners.forEach(t=>t(this.metrics)),this.saveToStorage()}reset(){this.metrics=this.initializeMetrics(),this.timers.clear(),this.notifyListeners()}generateReport(){const t=this.getHitRate(),r=this.getPerformanceScore(),s=Date.now()-this.metrics.firstAccess;return`
📊 Relatório de Performance do Cache
=====================================

🎯 Taxa de Acerto: ${t.toFixed(1)}%
⚡ Score de Performance: ${r.toFixed(1)}/100
⏱️ Tempo Ativo: ${this.formatDuration(s)}

📈 Operações:
• Hits: ${this.metrics.hits}
• Misses: ${this.metrics.misses}
• Sets: ${this.metrics.sets}
• Deletes: ${this.metrics.deletes}

⏱️ Tempos Médios:
• Carregamento: ${this.metrics.averageLoadTime.toFixed(2)}ms
• Salvamento: ${this.metrics.averageSaveTime.toFixed(2)}ms
• Compressão: ${this.metrics.averageCompressionTime.toFixed(2)}ms
• Descompressão: ${this.metrics.averageDecompressionTime.toFixed(2)}ms

💾 Tamanho dos Dados:
• Total: ${this.formatSize(this.metrics.totalDataSize)}
• Comprimido: ${this.formatSize(this.metrics.compressedDataSize)}
• Taxa de Compressão: ${this.metrics.compressionRatio.toFixed(1)}%

🔄 Sincronização:
• Mensagens Enviadas: ${this.metrics.syncMessagesSent}
• Mensagens Recebidas: ${this.metrics.syncMessagesReceived}
• Abas Ativas: ${this.metrics.activeTabs}
    `.trim()}formatDuration(t){const r=Math.floor(t/1e3),s=Math.floor(r/60),n=Math.floor(s/60);return n>0?`${n}h ${s%60}m`:s>0?`${s}m ${r%60}s`:`${r}s`}formatSize(t){if(t===0)return"0 Bytes";const r=1024,s=["Bytes","KB","MB","GB"],n=Math.floor(Math.log(t)/Math.log(r));return parseFloat((t/Math.pow(r,n)).toFixed(2))+" "+s[n]}}let Fi=null;function U_(){return Fi||(Fi=new B_),Fi}function $_(){const e=U_();return{getMetrics:e.getMetrics.bind(e),getHitRate:e.getHitRate.bind(e),getSectionHitRate:e.getSectionHitRate.bind(e),getPerformanceScore:e.getPerformanceScore.bind(e),generateReport:e.generateReport.bind(e),recordHit:e.recordHit.bind(e),recordMiss:e.recordMiss.bind(e),recordSet:e.recordSet.bind(e),recordDelete:e.recordDelete.bind(e),updateDataSize:e.updateDataSize.bind(e),updateSyncStats:e.updateSyncStats.bind(e),startTimer:e.startTimer.bind(e),endTimer:e.endTimer.bind(e),addListener:e.addListener.bind(e),reset:e.reset.bind(e)}}const ki=({value:e,className:t=""})=>a.jsx("div",{className:`w-full bg-gray-200 rounded-full h-2 ${t}`,children:a.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:`${Math.min(100,Math.max(0,e))}%`}})});function z_({className:e}){const[t,r]=p.useState(null),[s,n]=p.useState(!1),i=$_();if(p.useEffect(()=>(r(i.getMetrics()),i.addListener(m=>{r(m)})),[i]),!t)return null;const o=i.getHitRate(),l=i.getPerformanceScore(),d=Date.now()-t.firstAccess,c=f=>{const m=Math.floor(f/1e3),v=Math.floor(m/60),g=Math.floor(v/60);return g>0?`${g}h ${v%60}m`:v>0?`${v}m ${m%60}s`:`${m}s`},u=f=>{if(f===0)return"0 Bytes";const m=1024,v=["Bytes","KB","MB","GB"],g=Math.floor(Math.log(f)/Math.log(m));return parseFloat((f/Math.pow(m,g)).toFixed(2))+" "+v[g]},h=f=>f>=80?"text-green-600":f>=60?"text-yellow-600":"text-red-600";return a.jsxs(Ee,{className:e,children:[a.jsxs(Ae,{className:"pb-3",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(qc,{className:"h-5 w-5 text-blue-600"}),a.jsx(Fe,{className:"text-lg",children:"Métricas do Cache"})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(Q,{variant:"outline",size:"sm",onClick:()=>n(!s),children:s?"Recolher":"Expandir"}),a.jsx(Q,{variant:"outline",size:"sm",onClick:()=>i.reset(),className:"text-red-600 hover:text-red-700",children:a.jsx(Kr,{className:"h-4 w-4"})})]})]}),a.jsx(Ge,{children:"Performance e estatísticas do sistema de cache"})]}),a.jsxs(Se,{className:"space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[a.jsxs("div",{className:"text-center",children:[a.jsxs("div",{className:"text-2xl font-bold text-blue-600",children:[o.toFixed(1),"%"]}),a.jsx("div",{className:"text-sm text-gray-600",children:"Taxa de Acerto"}),a.jsx(ki,{value:o,className:"mt-2 h-2"})]}),a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:`text-2xl font-bold ${h(l)}`,children:l.toFixed(1)}),a.jsx("div",{className:"text-sm text-gray-600",children:"Score Performance"}),a.jsx(ki,{value:l,className:"mt-2 h-2"})]}),a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"text-2xl font-bold text-green-600",children:t.activeTabs}),a.jsx("div",{className:"text-sm text-gray-600",children:"Abas Ativas"}),a.jsx(em,{className:"h-4 w-4 mx-auto mt-1 text-green-600"})]}),a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"text-2xl font-bold text-purple-600",children:u(t.totalDataSize)}),a.jsx("div",{className:"text-sm text-gray-600",children:"Tamanho Total"}),a.jsx(tm,{className:"h-4 w-4 mx-auto mt-1 text-purple-600"})]})]}),s&&a.jsxs("div",{className:"space-y-4 pt-4 border-t",children:[a.jsxs("div",{children:[a.jsxs("h4",{className:"font-semibold mb-2 flex items-center",children:[a.jsx(ot,{className:"h-4 w-4 mr-2"}),"Operações"]}),a.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"text-lg font-semibold text-green-600",children:t.hits}),a.jsx("div",{className:"text-sm text-gray-600",children:"Hits"})]}),a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"text-lg font-semibold text-red-600",children:t.misses}),a.jsx("div",{className:"text-sm text-gray-600",children:"Misses"})]}),a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"text-lg font-semibold text-blue-600",children:t.sets}),a.jsx("div",{className:"text-sm text-gray-600",children:"Sets"})]}),a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"text-lg font-semibold text-orange-600",children:t.deletes}),a.jsx("div",{className:"text-sm text-gray-600",children:"Deletes"})]})]})]}),a.jsxs("div",{children:[a.jsxs("h4",{className:"font-semibold mb-2 flex items-center",children:[a.jsx(ya,{className:"h-4 w-4 mr-2"}),"Tempos Médios"]}),a.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[a.jsxs("div",{className:"text-center",children:[a.jsxs("div",{className:"text-lg font-semibold",children:[t.averageLoadTime.toFixed(2),"ms"]}),a.jsx("div",{className:"text-sm text-gray-600",children:"Carregamento"})]}),a.jsxs("div",{className:"text-center",children:[a.jsxs("div",{className:"text-lg font-semibold",children:[t.averageSaveTime.toFixed(2),"ms"]}),a.jsx("div",{className:"text-sm text-gray-600",children:"Salvamento"})]}),a.jsxs("div",{className:"text-center",children:[a.jsxs("div",{className:"text-lg font-semibold",children:[t.averageCompressionTime.toFixed(2),"ms"]}),a.jsx("div",{className:"text-sm text-gray-600",children:"Compressão"})]}),a.jsxs("div",{className:"text-center",children:[a.jsxs("div",{className:"text-lg font-semibold",children:[t.averageDecompressionTime.toFixed(2),"ms"]}),a.jsx("div",{className:"text-sm text-gray-600",children:"Descompressão"})]})]})]}),t.compressionRatio>0&&a.jsxs("div",{children:[a.jsx("h4",{className:"font-semibold mb-2",children:"Compressão"}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{className:"text-center",children:[a.jsxs("div",{className:"text-lg font-semibold text-blue-600",children:[t.compressionRatio.toFixed(1),"%"]}),a.jsx("div",{className:"text-sm text-gray-600",children:"Taxa de Compressão"})]}),a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"text-lg font-semibold text-green-600",children:u(t.compressedDataSize)}),a.jsx("div",{className:"text-sm text-gray-600",children:"Tamanho Comprimido"})]})]})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-semibold mb-2",children:"Sincronização"}),a.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"text-lg font-semibold text-blue-600",children:t.syncMessagesSent}),a.jsx("div",{className:"text-sm text-gray-600",children:"Enviadas"})]}),a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"text-lg font-semibold text-green-600",children:t.syncMessagesReceived}),a.jsx("div",{className:"text-sm text-gray-600",children:"Recebidas"})]}),a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"text-lg font-semibold text-purple-600",children:c(d)}),a.jsx("div",{className:"text-sm text-gray-600",children:"Tempo Ativo"})]})]})]}),a.jsxs("div",{children:[a.jsxs("h4",{className:"font-semibold mb-2 flex items-center",children:[a.jsx(Mi,{className:"h-4 w-4 mr-2"}),"Performance por Seção"]}),a.jsx("div",{className:"space-y-2",children:Object.entries(t.sectionMetrics).map(([f,m])=>{const v=i.getSectionHitRate(f);return a.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(Ve,{variant:"outline",className:"capitalize",children:f}),a.jsxs("span",{className:"text-sm text-gray-600",children:[m.hits+m.misses," operações"]})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsxs("div",{className:"text-sm font-semibold",children:[v.toFixed(1),"%"]}),a.jsx(ki,{value:v,className:"w-16 h-2"})]})]},f)})})]})]})]})]})}function V_({title:e,subtitle:t,showBackButton:r=!1,backTo:s="/dashboard",className:n=""}){const i=nr(),{user:o}=tt();return a.jsxs("div",{className:`flex items-center justify-between ${n}`,children:[a.jsxs("div",{className:"flex items-center space-x-4",children:[r&&a.jsxs(Q,{variant:"outline",size:"sm",onClick:()=>i(s),className:"flex items-center",children:[a.jsx(Hr,{className:"h-4 w-4 mr-2"}),"Voltar"]}),a.jsx("div",{className:"flex items-center space-x-4",children:a.jsx(fs,{variant:"principal",width:200,height:40})})]}),o&&a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("span",{className:"text-sm font-body text-repovagas-text-secondary",children:o.name}),a.jsx("div",{className:"w-8 h-8 bg-repovagas-primary rounded-full flex items-center justify-center",children:a.jsx("span",{className:"text-white text-sm font-medium",children:o.name.charAt(0).toUpperCase()})})]})]})}function Zh(){const[e,t]=p.useState(""),[r,s]=p.useState("all"),[n,i]=p.useState("all"),[o,l]=p.useState(new Set);Ks();const d=[{id:"auth-login",title:"Como fazer login no sistema",content:`1. Acesse a URL da aplicação no seu navegador
2. Insira seu email e senha
3. Clique em "Entrar"
4. Aguarde a validação das credenciais
5. Você será redirecionado automaticamente para o dashboard`,category:"autenticacao",type:"manual",tags:["login","acesso","entrada","credenciais"],priority:"high",icon:"🔐"},{id:"auth-recovery",title:"Recuperação de senha",content:`1. Na página de login, clique em "Esqueci minha senha"
2. Insira seu email cadastrado
3. Clique em "Enviar link de recuperação"
4. Verifique sua caixa de email
5. Clique no link recebido
6. Defina uma nova senha`,category:"autenticacao",type:"manual",tags:["senha","recuperação","esqueci","reset"],priority:"high",icon:"🔑"},{id:"vagas-criar",title:"Criar uma nova vaga",content:`1. Acesse "Nova Vaga" no menu lateral
2. Preencha todas as informações obrigatórias (Site, Categoria, Cargo, Cliente, Descrição)
3. Use o sistema de scraping para extrair dados de URLs
4. Revise as informações extraídas
5. Clique em "Criar Oportunidade"`,category:"vagas",type:"manual",tags:["criar","vaga","nova","oportunidade","formulário"],priority:"high",icon:"➕"},{id:"vagas-editar",title:"Editar uma vaga existente",content:`1. Na lista de vagas, clique no ícone "Editar" (✏️)
2. Modifique os campos desejados
3. Clique em "Salvar alterações"
4. Confirme a operação

O sistema mantém um histórico de todas as alterações realizadas.`,category:"vagas",type:"manual",tags:["editar","modificar","alterar","atualizar"],priority:"high",icon:"✏️"},{id:"vagas-buscar",title:"Buscar vagas específicas",content:`Use o campo de busca na página de oportunidades para procurar por:
• Cliente
• Cargo
• Site
• Célula
• Título

Use filtros avançados para refinar os resultados.`,category:"vagas",type:"manual",tags:["buscar","procurar","filtrar","pesquisar"],priority:"medium",icon:"🔍"},{id:"vagas-scraping",title:"Sistema de scraping automático",content:`O sistema pode extrair automaticamente informações de vagas:
1. Cole a URL da vaga no campo apropriado
2. Clique em "Extrair Informações"
3. Revise e ajuste as informações extraídas
4. Salve a vaga

Funciona com a maioria dos sites de vagas.`,category:"vagas",type:"manual",tags:["scraping","extrair","url","automático"],priority:"medium",icon:"🤖"},{id:"comparativo-usar",title:"Como usar o comparativo de clientes",content:`1. Acesse "Comparativo" no menu lateral
2. Selecione até 3 clientes para comparação
3. Aplique filtros conforme necessário (Célula → Cargo → Site → Categoria)
4. Visualize a comparação lado a lado
5. Expanda detalhes clicando nas seções`,category:"comparativo",type:"manual",tags:["comparar","clientes","filtros","análise"],priority:"high",icon:"📊"},{id:"comparativo-filtros",title:"Filtros no comparativo",content:`Os filtros são condicionais e funcionam em cascata:
• Célula: Filtro principal que afeta outros filtros
• Cargo: Depende da célula selecionada
• Site: Depende de célula e cargo
• Categoria: Depende dos filtros anteriores

Use "Limpar Filtros" para resetar.`,category:"comparativo",type:"manual",tags:["filtros","condicionais","cascata","limpar"],priority:"medium",icon:"🔧"},{id:"faq-lento",title:"A aplicação está lenta. O que fazer?",content:`• Verifique sua conexão com a internet
• Limpe o cache do navegador
• Feche outras abas desnecessárias
• Entre em contato com o administrador se o problema persistir

O sistema é otimizado para até 10.000 vagas.`,category:"problemas",type:"faq",tags:["lento","performance","cache","internet"],priority:"high",icon:"⚡"},{id:"faq-acesso",title:"Não consigo acessar o sistema",content:`Verifique:
• Se você está online
• Se a URL está correta
• Se não há problemas de cache
• Tente em outro navegador
• Verifique se o sistema não está em manutenção

Entre em contato com o administrador se necessário.`,category:"problemas",type:"faq",tags:["acesso","login","erro","navegador"],priority:"high",icon:"🚫"},{id:"faq-email",title:"Não recebi o email de recuperação de senha",content:`• Verifique sua caixa de spam/lixo eletrônico
• Aguarde alguns minutos (pode demorar até 5 minutos)
• Tente novamente após alguns minutos
• Entre em contato com o administrador do sistema

O sistema usa Resend API para envio de emails.`,category:"problemas",type:"faq",tags:["email","recuperação","spam","demora"],priority:"high",icon:"📧"},{id:"faq-permissoes",title:"Qual a diferença entre usuário ADMIN e RH?",content:`ADMIN:
• Acesso total ao sistema
• Gestão de usuários
• Configurações do sistema
• Backup e exportação
• Exclusão de vagas

RH:
• Visualização de vagas
• Criação e edição de vagas (baseado em configuração)
• Comparativo de clientes
• Exportação de dados`,category:"permissões",type:"faq",tags:["admin","rh","permissões","acesso","diferença"],priority:"high",icon:"👥"},{id:"faq-limites",title:"Há limites no sistema?",content:`Limites conhecidos:
• Comparativo: máximo 3 clientes simultâneos
• Vagas por página: 10, 25 ou 50
• Sessão: expira após 24 horas de inatividade
• Sistema otimizado para até 10.000 vagas

Não há limite específico para criação de vagas.`,category:"permissões",type:"faq",tags:["limites","restrições","máximo","sessão"],priority:"medium",icon:"📏"},{id:"faq-exportar",title:"Como exportar dados?",content:`Você pode exportar:
• Lista de vagas: Clique em "Exportar" na página de oportunidades
• Backup completo: Configurações > Backup e Exportação (apenas ADMIN)
• Formatos: Excel (.xlsx), CSV, JSON

ADMINs podem fazer backup de todos os dados do sistema.`,category:"funcionalidades",type:"faq",tags:["exportar","backup","excel","dados"],priority:"medium",icon:"📤"},{id:"faq-mobile",title:"O sistema funciona em dispositivos móveis?",content:`Sim! O sistema é totalmente responsivo:
• Smartphones
• Tablets
• Desktops
• Laptops

Em dispositivos móveis, a barra lateral se transforma em menu hambúrguer.`,category:"funcionalidades",type:"faq",tags:["mobile","responsivo","tablet","smartphone"],priority:"medium",icon:"📱"},{id:"faq-temas",title:"Como alterar o tema da aplicação?",content:`Opções:
1. Configurações > Temas e Interface (ADMIN)
2. Botão de tema na barra lateral

Temas disponíveis:
• Claro (padrão)
• Escuro
• Perfis de cor personalizados`,category:"funcionalidades",type:"faq",tags:["tema","claro","escuro","cores"],priority:"low",icon:"🎨"},{id:"faq-relatorios",title:"Como criar um relatório?",content:`1. Durante a comparação de clientes, clique no ícone de alerta (⚠️)
2. Preencha o formulário com:
   • Título do problema
   • Descrição detalhada
   • Tipo de problema
   • Prioridade
3. Clique em "Enviar Reporte"

Acompanhe o status em "Relatórios" no menu.`,category:"relatórios",type:"faq",tags:["relatório","reporte","problema","bug"],priority:"medium",icon:"📋"},{id:"admin-backup",title:"Como fazer backup dos dados (ADMIN)",content:`1. Acesse "Configurações" > "Backup e Exportação"
2. Configure quais dados incluir:
   • Vagas (padrão)
   • Usuários (opcional)
   • Logs de backup (opcional)
   • Notícias (opcional)
3. Escolha o formato (Excel, CSV, JSON)
4. Clique em "Criar Backup"
5. Baixe o arquivo gerado`,category:"admin",type:"manual",tags:["backup","exportar","dados","admin","configurações"],priority:"high",icon:"💾"},{id:"admin-usuarios",title:"Gerenciar usuários (ADMIN)",content:`1. Acesse "Usuários" no menu lateral
2. Clique em "Adicionar Usuário" para criar novos
3. Use os ícones de edição para modificar usuários existentes
4. Configure roles (ADMIN/RH)
5. Gerencie permissões específicas

Apenas ADMINs podem gerenciar usuários.`,category:"admin",type:"manual",tags:["usuários","gerenciar","criar","editar","roles"],priority:"high",icon:"👤"},{id:"admin-noticias",title:"Criar notícias internas (ADMIN)",content:`1. Acesse "Configurações" > "Sistema de Notícias"
2. Clique em "Criar Notícia"
3. Preencha:
   • Título
   • Conteúdo
   • Tipo (Info, Warning, Success)
4. Ative/desative conforme necessário
5. Salve a notícia

Notícias aparecem no dashboard dos usuários.`,category:"admin",type:"manual",tags:["notícias","comunicado","avisos","sistema"],priority:"medium",icon:"📢"}],c=[{id:"all",label:"Todas",icon:"📚"},{id:"autenticacao",label:"Autenticação",icon:"🔐"},{id:"vagas",label:"Gestão de Vagas",icon:"💼"},{id:"comparativo",label:"Comparativo",icon:"📊"},{id:"problemas",label:"Problemas Técnicos",icon:"🔧"},{id:"permissões",label:"Permissões",icon:"👥"},{id:"funcionalidades",label:"Funcionalidades",icon:"⚙️"},{id:"relatórios",label:"Relatórios",icon:"📋"},{id:"admin",label:"Configurações (ADMIN)",icon:"🛠️"}],u=p.useMemo(()=>{if(!e.trim())return d.map(b=>({content:b,relevance:1,matchedText:[]}));const x=e.toLowerCase().split(" ").filter(b=>b.length>2);return d.map(b=>{let N=0;const y=[];return x.forEach(A=>{b.title.toLowerCase().includes(A)&&(N+=10,y.push(b.title))}),x.forEach(A=>{b.content.toLowerCase().includes(A)&&(N+=5,y.push(b.content.substring(0,100)+"..."))}),x.forEach(A=>{b.tags.some(B=>B.toLowerCase().includes(A))&&(N+=2,y.push(`Tag: ${A}`))}),{content:b,relevance:N,matchedText:y}}).filter(b=>b.relevance>0).sort((b,N)=>N.relevance-b.relevance)},[e]),h=p.useMemo(()=>u.filter(x=>{const b=r==="all"||x.content.category===r,N=n==="all"||x.content.type===n;return b&&N}),[u,r,n]),f=x=>{const b=new Set(o);b.has(x)?b.delete(x):b.add(x),l(b)},m=x=>{navigator.clipboard.writeText(x),alert("Conteúdo copiado para a área de transferência!")},v=x=>{switch(x){case"high":return"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200";case"medium":return"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200";case"low":return"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200";default:return"bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-200"}},g=x=>{switch(x){case"high":return"Alta";case"medium":return"Média";case"low":return"Baixa";default:return"Normal"}};return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsxs("h1",{className:"text-3xl font-bold flex items-center gap-3",children:[a.jsx(lo,{className:"h-8 w-8 text-blue-600"}),"Tira Dúvidas"]}),a.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-2",children:"Encontre respostas rápidas para suas dúvidas sobre o sistema"})]}),a.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-500",children:[a.jsx(rm,{className:"h-4 w-4"}),a.jsxs("span",{children:[d.length," tópicos disponíveis"]})]})]}),a.jsx(Ee,{children:a.jsx(Se,{className:"pt-6",children:a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"relative",children:[a.jsx(sa,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),a.jsx(Re,{placeholder:"Busque por qualquer termo: login, criar vaga, backup, problemas...",value:e,onChange:x=>t(x.target.value),className:"pl-10 pr-4"}),e&&a.jsx(Q,{variant:"ghost",size:"sm",className:"absolute right-2 top-1/2 transform -translate-y-1/2 h-6 w-6 p-0",onClick:()=>t(""),children:a.jsx(ar,{className:"h-3 w-3"})})]}),a.jsxs("div",{className:"flex flex-wrap gap-4",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(za,{className:"h-4 w-4 text-gray-500"}),a.jsx("span",{className:"text-sm font-medium",children:"Filtros:"})]}),a.jsx(rl,{value:r,onValueChange:s,children:a.jsxs(ni,{className:"grid w-full grid-cols-3 lg:grid-cols-5",children:[a.jsx(qt,{value:"all",children:"Todas"}),a.jsx(qt,{value:"autenticacao",children:"Autenticação"}),a.jsx(qt,{value:"vagas",children:"Vagas"}),a.jsx(qt,{value:"comparativo",children:"Comparativo"}),a.jsx(qt,{value:"problemas",children:"Problemas"})]})}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-sm text-gray-500",children:"Tipo:"}),a.jsxs("div",{className:"flex gap-1",children:[a.jsx(Q,{variant:n==="all"?"default":"outline",size:"sm",onClick:()=>i("all"),children:"Todos"}),a.jsx(Q,{variant:n==="manual"?"default":"outline",size:"sm",onClick:()=>i("manual"),children:"Manual"}),a.jsx(Q,{variant:n==="faq"?"default":"outline",size:"sm",onClick:()=>i("faq"),children:"FAQ"})]})]})]})]})})}),a.jsxs("div",{className:"space-y-4",children:[e&&a.jsxs("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:[h.length,' resultado(s) encontrado(s) para "',e,'"']}),h.length===0?a.jsx(Ee,{children:a.jsxs(Se,{className:"py-12 text-center",children:[a.jsx(sa,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),a.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-gray-100 mb-2",children:"Nenhum resultado encontrado"}),a.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Tente usar termos diferentes ou verifique os filtros aplicados"})]})}):a.jsx("div",{className:"grid gap-4",children:h.map(x=>{var b;return a.jsxs(Ee,{className:"hover:shadow-md transition-shadow",children:[a.jsx(Ae,{className:"cursor-pointer",onClick:()=>f(x.content.id),children:a.jsxs("div",{className:"flex items-start justify-between",children:[a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx("span",{className:"text-2xl",children:x.content.icon}),a.jsxs("div",{className:"flex-1",children:[a.jsxs(Fe,{className:"text-lg flex items-center gap-2",children:[x.content.title,x.content.type==="faq"&&a.jsx(Ve,{variant:"secondary",className:"text-xs",children:"FAQ"}),x.content.type==="manual"&&a.jsx(Ve,{variant:"outline",className:"text-xs",children:"Manual"})]}),a.jsx(Ge,{className:"mt-1",children:(b=c.find(N=>N.id===x.content.category))==null?void 0:b.label})]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Ve,{className:v(x.content.priority),children:g(x.content.priority)}),a.jsx(ys,{className:`h-4 w-4 text-gray-400 transition-transform ${o.has(x.content.id)?"rotate-90":""}`})]})]})}),o.has(x.content.id)&&a.jsx(Se,{children:a.jsxs("div",{className:"space-y-4",children:[a.jsx("div",{className:"prose prose-sm max-w-none dark:prose-invert",children:a.jsx("pre",{className:"whitespace-pre-wrap font-sans text-sm leading-relaxed",children:x.content.content})}),x.content.tags.length>0&&a.jsx("div",{className:"flex flex-wrap gap-1",children:x.content.tags.map((N,y)=>a.jsx(Ve,{variant:"outline",className:"text-xs",children:N},y))}),a.jsxs("div",{className:"flex items-center justify-between pt-2 border-t",children:[a.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-500",children:[a.jsx(Ii,{className:"h-3 w-3"}),a.jsxs("span",{children:["Útil para: ",x.content.tags.slice(0,3).join(", ")]})]}),a.jsxs(Q,{variant:"outline",size:"sm",onClick:()=>m(x.content.content),children:[a.jsx(ll,{className:"h-3 w-3 mr-1"}),"Copiar"]})]})]})})]},x.content.id)})})]}),!e&&a.jsxs(Ee,{children:[a.jsx(Ae,{children:a.jsxs(Fe,{className:"flex items-center gap-2",children:[a.jsx(am,{className:"h-5 w-5 text-yellow-500"}),"Dicas Rápidas"]})}),a.jsx(Se,{children:a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[a.jsxs("div",{className:"flex items-start gap-3 p-3 rounded-lg bg-blue-50 dark:bg-blue-900/20",children:[a.jsx(sa,{className:"h-5 w-5 text-blue-600 mt-0.5"}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-blue-900 dark:text-blue-100",children:"Busca Inteligente"}),a.jsx("p",{className:"text-sm text-blue-700 dark:text-blue-300",children:"Digite qualquer termo para encontrar respostas rápidas"})]})]}),a.jsxs("div",{className:"flex items-start gap-3 p-3 rounded-lg bg-green-50 dark:bg-green-900/20",children:[a.jsx(ll,{className:"h-5 w-5 text-green-600 mt-0.5"}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-green-900 dark:text-green-100",children:"Copiar Respostas"}),a.jsx("p",{className:"text-sm text-green-700 dark:text-green-300",children:'Use o botão "Copiar" para salvar instruções'})]})]}),a.jsxs("div",{className:"flex items-start gap-3 p-3 rounded-lg bg-purple-50 dark:bg-purple-900/20",children:[a.jsx(za,{className:"h-5 w-5 text-purple-600 mt-0.5"}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-purple-900 dark:text-purple-100",children:"Filtros Específicos"}),a.jsx("p",{className:"text-sm text-purple-700 dark:text-purple-300",children:"Use os filtros para encontrar tópicos específicos"})]})]})]})})]})]})}function H_(){const[e,t]=p.useState([]),[r,s]=p.useState([]),[n,i]=p.useState(""),[o,l]=p.useState(!0),[d,c]=p.useState(""),[u,h]=p.useState(null),[f,m]=p.useState(!1),[v,g]=p.useState(!1),[x,b]=p.useState(!1),[N,y]=p.useState(!1),[A,B]=p.useState(null),[W,C]=p.useState(null),[L,T]=p.useState(""),[P,I]=p.useState({name:"",email:"",password:"",role:"RH"}),{user:V}=tt();p.useEffect(()=>{let R=!0;return(async()=>{try{l(!0);const z=await Bi();R&&t(z)}catch(z){console.error("Erro ao carregar usuários:",z)}finally{R&&l(!1)}})(),()=>{R=!1}},[]),p.useEffect(()=>{_e()},[n,e]);const ae=async()=>{try{l(!0);const R=await Bi();t(R)}catch(R){console.error("Erro ao carregar usuários:",R),c("Erro ao carregar usuários")}finally{l(!1)}},_e=()=>{if(!n){s(e);return}const R=e.filter(q=>q.name.toLowerCase().includes(n.toLowerCase())||q.email.toLowerCase().includes(n.toLowerCase())||q.role.toLowerCase().includes(n.toLowerCase()));s(R)},ve=async R=>{R.preventDefault(),l(!0),c("");try{await hm(P)?(c("Usuário criado com sucesso!"),I({name:"",email:"",password:"",role:"RH"}),m(!1),ae()):c("Erro ao criar usuário")}catch(q){console.error("Erro ao criar usuário:",q),c(`Erro ao criar usuário: ${q.message}`)}finally{l(!1)}},we=async R=>{if(R.preventDefault(),!!u){l(!0),c("");try{await mm(u.id,P)?(c("Usuário atualizado com sucesso!"),g(!1),h(null),ae()):c("Erro ao atualizar usuário")}catch(q){console.error("Erro ao atualizar usuário:",q),c(`Erro ao atualizar usuário: ${q.message}`)}finally{l(!1)}}},be=async()=>{if(A){l(!0),c("");try{await xm(A.id)?(c("Usuário excluído com sucesso!"),b(!1),B(null),ae()):c("Erro ao excluir usuário")}catch(R){console.error("Erro ao excluir usuário:",R),c(`Erro ao excluir usuário: ${R.message}`)}finally{l(!1)}}},J=async()=>{if(!(!W||!L)){l(!0),c("");try{await gm(W.id,L)?(c("Senha redefinida com sucesso!"),y(!1),C(null),T("")):c("Erro ao redefinir senha")}catch(R){console.error("Erro ao redefinir senha:",R),c(`Erro ao redefinir senha: ${R.message}`)}finally{l(!1)}}},Z=R=>{h(R),I({name:R.name,email:R.email,password:"",role:R.role}),g(!0)},ue=R=>{B(R),b(!0)},me=R=>{C(R),T(""),y(!0)},k=R=>{const{name:q,value:z}=R.target;I(D=>({...D,[q]:z}))},M=R=>new Date(R).toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}),O=R=>R==="ADMIN"?"bg-red-100 text-red-800 border-red-200":"bg-blue-100 text-blue-800 border-blue-200";return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-4xl font-bold bg-gradient-to-r from-primary to-primary/70 bg-clip-text text-transparent page-title",children:"Gerenciar Usuários"}),a.jsx("p",{className:"page-subtitle text-lg",children:"Gerencie usuários do sistema, suas permissões e configurações"})]}),a.jsxs(At,{open:f,onOpenChange:m,children:[a.jsx(So,{asChild:!0,children:a.jsxs(Q,{children:[a.jsx(oo,{className:"h-4 w-4 mr-2"}),"Novo Usuário"]})}),a.jsxs(gt,{children:[a.jsxs(pt,{children:[a.jsx(vt,{children:"Criar Novo Usuário"}),a.jsx(yr,{children:"Preencha os dados para criar um novo usuário no sistema"})]}),a.jsxs("form",{onSubmit:ve,children:[a.jsxs("div",{className:"space-y-4 py-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(fe,{htmlFor:"name",children:"Nome"}),a.jsx(Re,{id:"name",name:"name",value:P.name,onChange:k,placeholder:"Nome completo",autoComplete:"name",required:!0})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(fe,{htmlFor:"email",children:"Email"}),a.jsx(Re,{id:"email",name:"email",type:"email",value:P.email,onChange:k,placeholder:"email@exemplo.com",autoComplete:"email",required:!0})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(fe,{htmlFor:"password",children:"Senha"}),a.jsx(Re,{id:"password",name:"password",type:"password",value:P.password,onChange:k,placeholder:"Senha temporária",autoComplete:"new-password",required:!0})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(fe,{htmlFor:"role",children:"Tipo de Usuário"}),a.jsxs(Gt,{value:P.role,onValueChange:R=>I(q=>({...q,role:R})),children:[a.jsx(zt,{children:a.jsx(Xt,{})}),a.jsxs(Vt,{children:[a.jsx(Oe,{value:"RH",children:"RH - Recursos Humanos"}),a.jsx(Oe,{value:"ADMIN",children:"ADMIN - Administrador"})]})]})]})]}),a.jsxs(Ir,{children:[a.jsx(Q,{type:"button",variant:"outline",onClick:()=>m(!1),children:"Cancelar"}),a.jsx(Q,{type:"submit",disabled:o,children:o?"Criando...":"Criar Usuário"})]})]})]})]})]}),d&&a.jsx("div",{className:`p-4 rounded-md ${d.includes("sucesso")?"bg-green-50 text-green-800 border border-green-200":"bg-red-50 text-red-800 border border-red-200"}`,children:d}),a.jsxs(Ee,{children:[a.jsxs(Ae,{children:[a.jsxs(Fe,{className:"flex items-center",children:[a.jsx(Xa,{className:"h-5 w-5 mr-2"}),"Lista de Usuários"]}),a.jsxs(Ge,{children:[e.length," usuário",e.length!==1?"s":""," cadastrado",e.length!==1?"s":""," no sistema"]})]}),a.jsx(Se,{children:a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(sa,{className:"h-4 w-4 text-gray-400"}),a.jsx(Re,{placeholder:"Buscar por nome, email ou tipo...",value:n,onChange:R=>i(R.target.value),className:"max-w-sm"})]}),o?a.jsxs("div",{className:"flex items-center justify-center py-8",children:[a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-4 border-primary border-t-transparent"}),a.jsx("span",{className:"ml-2",children:"Carregando usuários..."})]}):r.length===0?a.jsx("div",{className:"text-center py-8 text-gray-500",children:n?"Nenhum usuário encontrado para a busca":"Nenhum usuário cadastrado"}):a.jsx("div",{className:"space-y-3",children:r.map(R=>a.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg hover:bg-gray-50",children:[a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsx("div",{className:"w-10 h-10 bg-gray-200 rounded-full flex items-center justify-center",children:a.jsx(Xa,{className:"h-5 w-5 text-gray-600"})}),a.jsxs("div",{children:[a.jsx("div",{className:"font-medium text-gray-900",children:R.name}),a.jsx("div",{className:"text-sm text-gray-600",children:R.email}),a.jsxs("div",{className:"text-xs text-gray-500",children:["Criado em ",M(R.created_at)]})]})]}),a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium border ${O(R.role)}`,children:R.role==="ADMIN"?"Administrador":"Recursos Humanos"}),a.jsxs("div",{className:"flex items-center space-x-1",children:[a.jsx(Q,{size:"sm",variant:"outline",onClick:()=>Z(R),disabled:R.id===(V==null?void 0:V.id),children:a.jsx(va,{className:"h-3 w-3"})}),a.jsx(Q,{size:"sm",variant:"outline",onClick:()=>me(R),children:a.jsx(Gc,{className:"h-3 w-3"})}),a.jsx(Q,{size:"sm",variant:"outline",onClick:()=>ue(R),disabled:R.id===(V==null?void 0:V.id),className:"text-red-600 hover:text-red-700",children:a.jsx(Kr,{className:"h-3 w-3"})})]})]})]},R.id))})]})})]}),a.jsx(At,{open:v,onOpenChange:g,children:a.jsxs(gt,{children:[a.jsxs(pt,{children:[a.jsx(vt,{children:"Editar Usuário"}),a.jsx(yr,{children:"Atualize as informações do usuário"})]}),a.jsxs("form",{onSubmit:we,children:[a.jsxs("div",{className:"space-y-4 py-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(fe,{htmlFor:"edit-name",children:"Nome"}),a.jsx(Re,{id:"edit-name",name:"name",value:P.name,onChange:k,placeholder:"Nome completo",autoComplete:"name",required:!0})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(fe,{htmlFor:"edit-email",children:"Email"}),a.jsx(Re,{id:"edit-email",name:"email",type:"email",value:P.email,onChange:k,placeholder:"email@exemplo.com",autoComplete:"email",required:!0})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(fe,{htmlFor:"edit-role",children:"Tipo de Usuário"}),a.jsxs(Gt,{value:P.role,onValueChange:R=>I(q=>({...q,role:R})),children:[a.jsx(zt,{children:a.jsx(Xt,{})}),a.jsxs(Vt,{children:[a.jsx(Oe,{value:"RH",children:"RH - Recursos Humanos"}),a.jsx(Oe,{value:"ADMIN",children:"ADMIN - Administrador"})]})]})]})]}),a.jsxs(Ir,{children:[a.jsx(Q,{type:"button",variant:"outline",onClick:()=>g(!1),children:"Cancelar"}),a.jsx(Q,{type:"submit",disabled:o,children:o?"Salvando...":"Salvar Alterações"})]})]})]})}),a.jsx(At,{open:x,onOpenChange:b,children:a.jsxs(gt,{children:[a.jsxs(pt,{children:[a.jsxs(vt,{className:"flex items-center",children:[a.jsx(oa,{className:"h-5 w-5 mr-2 text-red-600"}),"Confirmar Exclusão"]}),a.jsxs(yr,{children:["Tem certeza que deseja excluir o usuário ",a.jsx("strong",{children:A==null?void 0:A.name}),"? Esta ação não pode ser desfeita."]})]}),a.jsxs(Ir,{children:[a.jsx(Q,{type:"button",variant:"outline",onClick:()=>b(!1),children:"Cancelar"}),a.jsx(Q,{type:"button",variant:"destructive",onClick:be,disabled:o,children:o?"Excluindo...":"Excluir Usuário"})]})]})}),a.jsx(At,{open:N,onOpenChange:y,children:a.jsxs(gt,{children:[a.jsxs(pt,{children:[a.jsx(vt,{children:"Redefinir Senha"}),a.jsxs(yr,{children:["Digite uma nova senha para o usuário ",a.jsx("strong",{children:W==null?void 0:W.name})]})]}),a.jsx("div",{className:"space-y-4 py-4",children:a.jsxs("div",{className:"space-y-2",children:[a.jsx(fe,{htmlFor:"new-password",children:"Nova Senha"}),a.jsx(Re,{id:"new-password",type:"password",value:L,onChange:R=>T(R.target.value),placeholder:"Digite a nova senha",autoComplete:"new-password",required:!0})]})}),a.jsxs(Ir,{children:[a.jsx(Q,{type:"button",variant:"outline",onClick:()=>y(!1),children:"Cancelar"}),a.jsx(Q,{type:"button",onClick:J,disabled:o||!L,children:o?"Redefinindo...":"Redefinir Senha"})]})]})})]})}function W_(){var Cr,Zr,ir,Da;const[e,t]=p.useState({type:"manual",data:{vagas:!0,users:!1,backup_logs:!1,noticias:!1},format:"excel"}),[r,s]=p.useState([]),[n,i]=p.useState([]),[o,l]=p.useState(!1),[d,c]=p.useState(""),[u,h]=p.useState(!1),[f,m]=p.useState(!1),[v,g]=p.useState(null),[x,b]=p.useState({titulo:"",conteudo:"",tipo:"info",ativa:!0,prioridade:"media"}),[N,y]=p.useState([]),[A,B]=p.useState(!1),[W,C]=p.useState(!1),[L,T]=p.useState(!1),[P,I]=p.useState(null),[V,ae]=p.useState({email:"",nome:"",teams_contact:"",ativo:!0}),{user:_e}=tt(),{isEnabled:ve,toggleAccess:we,loading:be}=vu(),{isEnabled:J,toggleAccess:Z,loading:ue}=$g(),{isEnabled:me,toggleAccess:k,loading:M}=zg();p.useEffect(()=>{let U=!0,ne=0;const Be=3;(async()=>{try{console.log("🔄 Carregando dados da página Configurações...");const[jt,ea,lr]=await Promise.all([fc(),Vi(),so()]);U&&(console.log("✅ Dados carregados com sucesso:",{logs:jt.length,noticias:ea.length,emails:lr.length}),s(jt),i(ea),y(lr))}catch(jt){console.error("❌ Erro ao carregar dados:",jt),ne<Be&&(ne++,console.log(`🔄 Tentativa ${ne}/${Be} para recarregar emails...`),setTimeout(()=>{U&&q()},2e3*ne))}})();const gr=setInterval(()=>{U&&N.length===0&&(console.log("🔄 Verificando emails de contato (intervalo)..."),q())},3e4);return()=>{U=!1,clearInterval(gr)}},[]);const O=async()=>{try{const U=await fc();s(U)}catch(U){console.error("Erro ao carregar logs de backup:",U)}},R=async()=>{try{const U=await Vi();i(U)}catch(U){console.error("Erro ao carregar notícias:",U)}},q=async()=>{B(!0);try{console.log("🔄 Carregando emails de contato...");const U=await so();console.log("✅ Emails carregados:",U.length,"emails encontrados"),y(U),U.length===0&&console.warn("⚠️ Nenhum email de contato encontrado no banco de dados")}catch(U){console.error("❌ Erro ao carregar emails de contato:",U),setTimeout(()=>{console.log("🔄 Tentando recarregar emails após erro..."),q()},5e3)}finally{B(!1)}},z=async U=>{if(U.preventDefault(),!V.email.trim()){c("Por favor, insira um email válido");return}B(!0),c("");try{await k_(V)?(c("Email de contato adicionado com sucesso!"),ae({email:"",nome:"",teams_contact:"",ativo:!0}),C(!1),q()):c("Erro ao adicionar email de contato")}catch(ne){console.error("Erro ao criar email de contato:",ne),c(`Erro ao criar email de contato: ${ne.message}`)}finally{B(!1)}},D=async U=>{if(U.preventDefault(),!!P){B(!0),c("");try{await D_(P.id,V)?(c("Email de contato atualizado com sucesso!"),T(!1),I(null),q()):c("Erro ao atualizar email de contato")}catch(ne){console.error("Erro ao atualizar email de contato:",ne),c(`Erro ao atualizar email de contato: ${ne.message}`)}finally{B(!1)}}},G=async U=>{try{const ne=await we(U);c(ne?`Acesso à página Nova Oportunidade ${U?"habilitado":"desabilitado"} para usuários RH`:"Erro ao atualizar configuração")}catch(ne){console.error("Erro ao atualizar configuração RH:",ne),ne.message.includes("Tabela system_config não existe")?c("ERRO: Tabela system_config não existe. Execute a migração do banco de dados primeiro."):c(`Erro ao atualizar configuração: ${ne.message}`)}},ee=async U=>{try{const ne=await Z(U);c(ne?`Funcionalidade de Edição ${U?"habilitada":"desabilitada"} para usuários RH`:"Erro ao atualizar configuração")}catch(ne){console.error("Erro ao atualizar configuração RH Edit:",ne),ne.message.includes("Tabela system_config não existe")?c("ERRO: Tabela system_config não existe. Execute a migração do banco de dados primeiro."):c(`Erro ao atualizar configuração: ${ne.message}`)}},ge=async U=>{try{const ne=await k(U);c(ne?`Funcionalidade de Exclusão ${U?"habilitada":"desabilitada"} para usuários RH`:"Erro ao atualizar configuração")}catch(ne){console.error("Erro ao atualizar configuração RH Delete:",ne),ne.message.includes("Tabela system_config não existe")?c("ERRO: Tabela system_config não existe. Execute a migração do banco de dados primeiro."):c(`Erro ao atualizar configuração: ${ne.message}`)}},Te=async U=>{if(confirm("Tem certeza que deseja excluir este email de contato?")){B(!0),c("");try{await P_(U)?(c("Email de contato removido com sucesso!"),q()):c("Erro ao remover email de contato")}catch(ne){console.error("Erro ao remover email de contato:",ne),c(`Erro ao remover email de contato: ${ne.message}`)}finally{B(!1)}}},Me=async U=>{B(!0),c("");try{const ne=await I_(U);ne?(c(`Email ${ne.ativo?"ativado":"desativado"} com sucesso!`),q()):c("Erro ao alterar status do email")}catch(ne){console.error("Erro ao alterar status do email:",ne),c(`Erro ao alterar status do email: ${ne.message}`)}finally{B(!1)}},pe=U=>{I(U),ae({email:U.email,nome:U.nome||"",teams_contact:U.teams_contact||"",ativo:U.ativo}),T(!0)},it=async U=>{const ne=ft.book_new();return Object.keys(U).forEach(Be=>{if(U[Be]&&Array.isArray(U[Be])){const or=ft.json_to_sheet(U[Be]);ft.book_append_sheet(ne,or,Be)}}),ai(ne,{type:"buffer",bookType:"xlsx"})},Le=async U=>{const ne=[];return Object.keys(U).forEach(Be=>{if(U[Be]&&Array.isArray(U[Be])&&(ne.push(`
=== ${Be.toUpperCase()} ===
`),U[Be].length>0)){const or=Object.keys(U[Be][0]);ne.push(or.join(",")),U[Be].forEach(gr=>{const jt=or.map(ea=>{const lr=gr[ea];return typeof lr=="string"&&(lr.includes(",")||lr.includes('"'))?`"${lr.replace(/"/g,'""')}"`:lr||""});ne.push(jt.join(","))})}}),ne.join(`
`)},ye=async U=>{try{if(!U.backup_data){c("Dados do backup não disponíveis");return}let ne=U.file_path||`backup_${new Date().toISOString().split("T")[0]}.xlsx`,Be=null;ne.endsWith(".xlsx")?Be=await it(U.backup_data):ne.endsWith(".csv")?Be=await Le(U.backup_data):Be=JSON.stringify(U.backup_data,null,2);const or=new Blob([Be],{type:ne.endsWith(".xlsx")?"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":ne.endsWith(".csv")?"text/csv":"application/json"}),gr=window.URL.createObjectURL(or),jt=document.createElement("a");jt.href=gr,jt.download=ne,document.body.appendChild(jt),jt.click(),document.body.removeChild(jt),window.URL.revokeObjectURL(gr),c("Download iniciado com sucesso!")}catch(ne){console.error("Erro ao fazer download do backup:",ne),c("Erro ao fazer download do backup")}},mt=async()=>{if(_e){l(!0),c("");try{await i_(_e.id,e)?(c("Backup criado com sucesso!"),O()):c("Erro ao criar backup")}catch{c("Erro ao criar backup")}finally{l(!1)}}},yt=(U,ne)=>{t(Be=>({...Be,data:{...Be.data,[U]:ne}}))},xr=async U=>{if(U.preventDefault(),!!_e){l(!0),c("");try{await Dm(x,_e.id)?(c("Notícia criada com sucesso!"),b({titulo:"",conteudo:"",tipo:"info",ativa:!0,prioridade:"media"}),h(!1),R()):c("Erro ao criar notícia")}catch(ne){console.error("Erro ao criar notícia:",ne),c(`Erro ao criar notícia: ${ne.message}`)}finally{l(!1)}}},Sr=async U=>{if(U.preventDefault(),!!v){l(!0),c("");try{await Pm(v.id,x)?(c("Notícia atualizada com sucesso!"),m(!1),g(null),R()):c("Erro ao atualizar notícia")}catch(ne){console.error("Erro ao atualizar notícia:",ne),c(`Erro ao atualizar notícia: ${ne.message}`)}finally{l(!1)}}},ka=async U=>{if(confirm("Tem certeza que deseja excluir esta notícia?")){l(!0),c("");try{await Im(U)?(c("Notícia excluída com sucesso!"),R()):c("Erro ao excluir notícia")}catch(ne){console.error("Erro ao excluir notícia:",ne),c(`Erro ao excluir notícia: ${ne.message}`)}finally{l(!1)}}},xa=async(U,ne)=>{l(!0),c("");try{await Om(U,!ne)?(c(`Notícia ${ne?"desativada":"ativada"} com sucesso!`),R()):c("Erro ao alterar status da notícia")}catch(Be){console.error("Erro ao alterar status da notícia:",Be),c(`Erro ao alterar status: ${Be.message}`)}finally{l(!1)}},Wt=U=>{g(U),b({titulo:U.titulo,conteudo:U.conteudo,tipo:U.tipo,ativa:U.ativa,prioridade:U.prioridade}),m(!0)},Nt=(U,ne)=>{b(Be=>({...Be,[U]:ne}))};return a.jsxs("div",{className:"space-y-8",children:[a.jsx(V_,{title:"Configurações",subtitle:"Gerencie backups do sistema, notícias e configurações gerais"}),d&&a.jsx("div",{className:`p-4 rounded-md ${d.includes("sucesso")?"bg-green-50 text-green-800 border border-green-200":"bg-red-50 text-red-800 border border-red-200"}`,children:d}),a.jsxs(rl,{defaultValue:"backup",className:"w-full",children:[a.jsxs(ni,{className:"grid w-full grid-cols-6",children:[a.jsx(qt,{value:"backup",children:"Configuração Geral"}),a.jsx(qt,{value:"usuarios",children:"Usuários"}),a.jsx(qt,{value:"noticias",children:"Gerenciar Notícias"}),a.jsx(qt,{value:"personalizacao",children:"Personalização Visual"}),a.jsx(qt,{value:"acesso",children:"Controle de Acesso"}),a.jsx(qt,{value:"ajuda",children:"Tira Dúvidas"})]}),a.jsxs(Vr,{value:"backup",className:"space-y-6",children:[a.jsxs("div",{className:"grid grid-cols-1 gap-8",children:[a.jsxs(Ee,{children:[a.jsxs(Ae,{children:[a.jsxs(Fe,{className:"flex items-center",children:[a.jsx(Xr,{className:"h-5 w-5 mr-2"}),"Emails de Contato"]}),a.jsx(Ge,{children:"Configure os emails que receberão as mensagens do formulário de contato"})]}),a.jsx(Se,{className:"space-y-6",children:a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-muted-foreground",children:"Gerencie os emails que receberão as mensagens do formulário de contato"}),N.length===0&&a.jsx("p",{className:"text-xs text-orange-600 mt-1",children:'⚠️ Se você tem emails cadastrados mas não aparecem aqui, clique em "Recarregar"'})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs(Q,{onClick:q,size:"sm",variant:"outline",className:"flex items-center gap-2 transition-all duration-200 hover:scale-105 hover:shadow-md active:scale-95",disabled:A,children:[a.jsx(ot,{className:`h-4 w-4 ${A?"animate-spin":""}`}),"Recarregar"]}),a.jsxs(Q,{onClick:()=>C(!0),size:"sm",className:"flex items-center gap-2 transition-all duration-200 hover:scale-105 hover:shadow-md active:scale-95 group",children:[a.jsx(Ss,{className:"h-4 w-4 transition-transform duration-200 group-hover:rotate-90"}),"Adicionar Email"]})]})]}),a.jsx("div",{className:"space-y-3",children:A?a.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[a.jsx(ot,{className:"h-12 w-12 mx-auto mb-4 opacity-50 animate-spin"}),a.jsx("p",{children:"Carregando emails de contato..."})]}):N.length===0?a.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[a.jsx(Xr,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),a.jsx("p",{children:"Nenhum email de contato configurado"}),a.jsx("p",{className:"text-sm",children:'Clique em "Adicionar Email" para começar'})]}):a.jsx("div",{className:"space-y-2",children:N.map(U=>a.jsxs("div",{className:`flex items-center justify-between p-3 rounded-lg border ${U.ativo?"bg-green-50 border-green-200 dark:bg-green-950 dark:border-green-800":"bg-gray-50 border-gray-200 dark:bg-gray-900 dark:border-gray-700"}`,children:[a.jsx("div",{className:"flex-1",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"font-medium",children:U.email}),U.nome&&a.jsxs("span",{className:"text-sm text-muted-foreground",children:["(",U.nome,")"]}),a.jsx(Ve,{variant:U.ativo?"default":"secondary",children:U.ativo?"Ativo":"Inativo"})]})}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Q,{onClick:()=>Me(U.id),disabled:A,variant:"outline",size:"sm",className:"transition-all duration-200 hover:scale-110 hover:shadow-sm active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:scale-100",children:U.ativo?a.jsx(la,{className:"h-4 w-4 transition-transform duration-200"}):a.jsx(Pt,{className:"h-4 w-4 transition-transform duration-200"})}),a.jsx(Q,{onClick:()=>pe(U),disabled:A,variant:"outline",size:"sm",className:"transition-all duration-200 hover:scale-110 hover:shadow-sm active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:scale-100",children:a.jsx(va,{className:"h-4 w-4 transition-transform duration-200"})}),a.jsx(Q,{onClick:()=>Te(U.id),disabled:A,variant:"destructive",size:"sm",className:"transition-all duration-200 hover:scale-110 hover:shadow-sm active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:scale-100",children:a.jsx(sm,{className:"h-4 w-4 transition-transform duration-200"})})]})]},U.id))})})]})})]}),a.jsxs(Ee,{children:[a.jsxs(Ae,{children:[a.jsxs(Fe,{className:"flex items-center",children:[a.jsx(Pi,{className:"h-5 w-5 mr-2"}),"Backup do Sistema"]}),a.jsx(Ge,{children:"Faça backup dos dados do sistema em diferentes formatos"})]}),a.jsxs(Se,{className:"space-y-6",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(fe,{children:"Dados para Backup"}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("input",{type:"checkbox",id:"vagas",name:"vagas",checked:((Cr=e.data)==null?void 0:Cr.vagas)||!1,onChange:U=>yt("vagas",U.target.checked),className:"rounded"}),a.jsx(fe,{htmlFor:"vagas",className:"text-sm",children:"Vagas"})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("input",{type:"checkbox",id:"users",name:"users",checked:((Zr=e.data)==null?void 0:Zr.users)||!1,onChange:U=>yt("users",U.target.checked),className:"rounded"}),a.jsx(fe,{htmlFor:"users",className:"text-sm",children:"Usuários"})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("input",{type:"checkbox",id:"logs",name:"logs",checked:((ir=e.data)==null?void 0:ir.backup_logs)||!1,onChange:U=>yt("backup_logs",U.target.checked),className:"rounded"}),a.jsx(fe,{htmlFor:"logs",className:"text-sm",children:"Logs de Backup"})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("input",{type:"checkbox",id:"noticias",name:"noticias",checked:((Da=e.data)==null?void 0:Da.noticias)||!1,onChange:U=>yt("noticias",U.target.checked),className:"rounded"}),a.jsx(fe,{htmlFor:"noticias",className:"text-sm",children:"Notícias"})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(fe,{htmlFor:"format",children:"Formato do Backup"}),a.jsxs(Gt,{value:e.format,onValueChange:U=>t(ne=>({...ne,format:U})),children:[a.jsx(zt,{children:a.jsx(Xt,{})}),a.jsxs(Vt,{children:[a.jsx(Oe,{value:"excel",children:"Excel (.xlsx)"}),a.jsx(Oe,{value:"json",children:"JSON"}),a.jsx(Oe,{value:"csv",children:"CSV"})]})]})]}),a.jsxs(Q,{onClick:mt,disabled:o,className:"w-full transition-all duration-200 hover:scale-105 hover:shadow-lg active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:scale-100",children:[a.jsx(jr,{className:"h-4 w-4 mr-2 transition-transform duration-200 group-hover:rotate-12"}),o?"Criando Backup...":"Criar Backup"]})]})]})]}),a.jsxs(Ee,{children:[a.jsxs(Ae,{children:[a.jsxs(Fe,{className:"flex items-center",children:[a.jsx(Wc,{className:"h-5 w-5 mr-2"}),"Histórico de Backups"]}),a.jsx(Ge,{children:"Últimos backups realizados no sistema"})]}),a.jsx(Se,{children:r.length===0?a.jsx("div",{className:"text-center py-8 text-gray-500",children:"Nenhum backup realizado ainda"}):a.jsx("div",{className:"space-y-3",children:r.slice(0,10).map(U=>a.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("div",{className:`w-3 h-3 rounded-full ${U.status==="success"?"bg-green-500":U.status==="failed"?"bg-red-500":"bg-yellow-500"}`}),a.jsxs("div",{children:[a.jsxs("div",{className:"font-medium",children:["Backup ",U.backup_type==="manual"?"Manual":"Automático"]}),a.jsx("div",{className:"text-sm text-gray-600",children:new Date(U.created_at).toLocaleString("pt-BR")})]})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${U.status==="success"?"bg-green-100 text-green-800":U.status==="failed"?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"}`,children:U.status==="success"?"Sucesso":U.status==="failed"?"Falhou":"Pendente"}),U.file_path&&a.jsx(Q,{size:"sm",variant:"outline",onClick:()=>ye(U),title:"Baixar backup",children:a.jsx(jr,{className:"h-3 w-3"})})]})]},U.id))})})]})]}),a.jsx(Vr,{value:"usuarios",className:"space-y-6",children:a.jsxs("div",{className:"space-y-6",children:[a.jsx("div",{className:"flex items-center justify-between",children:a.jsxs("div",{children:[a.jsxs("h2",{className:"text-xl font-semibold flex items-center",children:[a.jsx(Xa,{className:"h-5 w-5 mr-2"}),"Gerenciar Usuários"]}),a.jsx("p",{className:"text-gray-600 text-sm",children:"Gerencie usuários do sistema, suas permissões e configurações"})]})}),a.jsx(H_,{})]})}),a.jsxs(Vr,{value:"noticias",className:"space-y-6",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-xl font-semibold",children:"Gerenciar Notícias"}),a.jsx("p",{className:"text-gray-600 text-sm",children:"Crie e gerencie notícias, avisos e anúncios do sistema"}),n.filter(U=>U.ativa).length>=9&&a.jsx("div",{className:"mt-2 p-3 bg-amber-50 border border-amber-200 rounded-lg",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx(at,{className:"h-5 w-5 text-amber-600 mr-2"}),a.jsxs("div",{children:[a.jsx("p",{className:"text-amber-800 font-medium text-sm",children:"⚠️ Mural de Notícias Completo!"}),a.jsxs("p",{className:"text-amber-700 text-xs",children:["Você tem ",n.filter(U=>U.ativa).length," notícias ativas. Para adicionar uma nova, faça backup das notícias atuais e desative ou remova uma notícia existente."]})]})]})})]}),a.jsxs(At,{open:u,onOpenChange:h,children:[a.jsx(So,{asChild:!0,children:a.jsxs(Q,{children:[a.jsx(Ss,{className:"h-4 w-4 mr-2"}),"Nova Notícia"]})}),a.jsxs(gt,{className:"max-w-2xl",children:[a.jsxs(pt,{children:[a.jsx(vt,{children:"Criar Nova Notícia"}),a.jsx(yr,{children:"Preencha os dados para criar uma nova notícia ou aviso"})]}),a.jsxs("form",{onSubmit:xr,children:[a.jsxs("div",{className:"space-y-4 py-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(fe,{htmlFor:"create-titulo-noticia",children:"Título"}),a.jsx(Re,{id:"create-titulo-noticia",value:x.titulo,onChange:U=>Nt("titulo",U.target.value),placeholder:"Digite o título da notícia",required:!0})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(fe,{htmlFor:"create-conteudo-noticia",children:"Conteúdo"}),a.jsx(rr,{id:"create-conteudo-noticia",value:x.conteudo,onChange:U=>Nt("conteudo",U.target.value),placeholder:"Digite o conteúdo da notícia (suporte a emojis)",rows:6,required:!0})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(fe,{htmlFor:"create-tipo-noticia",children:"Tipo"}),a.jsxs(Gt,{value:x.tipo,onValueChange:U=>Nt("tipo",U),children:[a.jsx(zt,{children:a.jsx(Xt,{})}),a.jsxs(Vt,{children:[a.jsx(Oe,{value:"info",children:"ℹ️ Informação"}),a.jsx(Oe,{value:"alerta",children:"⚠️ Alerta"}),a.jsx(Oe,{value:"anuncio",children:"📢 Anúncio"})]})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(fe,{htmlFor:"create-prioridade-noticia",children:"Prioridade"}),a.jsxs(Gt,{value:x.prioridade,onValueChange:U=>Nt("prioridade",U),children:[a.jsx(zt,{children:a.jsx(Xt,{})}),a.jsxs(Vt,{children:[a.jsx(Oe,{value:"baixa",children:"🟢 Baixa"}),a.jsx(Oe,{value:"media",children:"🟡 Média"}),a.jsx(Oe,{value:"alta",children:"🔴 Alta"})]})]})]})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(ra,{id:"create-ativa-noticia",checked:x.ativa,onCheckedChange:U=>Nt("ativa",U)}),a.jsx(fe,{htmlFor:"create-ativa-noticia",children:"Notícia ativa"})]})]}),a.jsxs(Ir,{children:[a.jsx(Q,{type:"button",variant:"outline",onClick:()=>h(!1),className:"transition-all duration-200 hover:scale-105 hover:shadow-sm active:scale-95",children:"Cancelar"}),a.jsx(Q,{type:"submit",disabled:o,className:"transition-all duration-200 hover:scale-105 hover:shadow-lg active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:scale-100",children:o?"Criando...":"Criar Notícia"})]})]})]})]})]}),a.jsx(At,{open:f,onOpenChange:m,children:a.jsxs(gt,{className:"max-w-2xl",children:[a.jsxs(pt,{children:[a.jsx(vt,{children:"Editar Notícia"}),a.jsx(yr,{children:"Atualize as informações da notícia"})]}),a.jsxs("form",{onSubmit:Sr,children:[a.jsxs("div",{className:"space-y-4 py-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(fe,{htmlFor:"edit-titulo-noticia",children:"Título"}),a.jsx(Re,{id:"edit-titulo-noticia",value:x.titulo,onChange:U=>Nt("titulo",U.target.value),placeholder:"Digite o título da notícia",required:!0})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(fe,{htmlFor:"edit-conteudo-noticia",children:"Conteúdo"}),a.jsx(rr,{id:"edit-conteudo-noticia",value:x.conteudo,onChange:U=>Nt("conteudo",U.target.value),placeholder:"Digite o conteúdo da notícia (suporte a emojis)",rows:6,required:!0})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(fe,{htmlFor:"edit-tipo-noticia",children:"Tipo"}),a.jsxs(Gt,{value:x.tipo,onValueChange:U=>Nt("tipo",U),children:[a.jsx(zt,{children:a.jsx(Xt,{})}),a.jsxs(Vt,{children:[a.jsx(Oe,{value:"info",children:"ℹ️ Informação"}),a.jsx(Oe,{value:"alerta",children:"⚠️ Alerta"}),a.jsx(Oe,{value:"anuncio",children:"📢 Anúncio"})]})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(fe,{htmlFor:"edit-prioridade-noticia",children:"Prioridade"}),a.jsxs(Gt,{value:x.prioridade,onValueChange:U=>Nt("prioridade",U),children:[a.jsx(zt,{children:a.jsx(Xt,{})}),a.jsxs(Vt,{children:[a.jsx(Oe,{value:"baixa",children:"🟢 Baixa"}),a.jsx(Oe,{value:"media",children:"🟡 Média"}),a.jsx(Oe,{value:"alta",children:"🔴 Alta"})]})]})]})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(ra,{id:"edit-ativa-noticia",checked:x.ativa,onCheckedChange:U=>Nt("ativa",U)}),a.jsx(fe,{htmlFor:"edit-ativa-noticia",children:"Notícia ativa"})]})]}),a.jsxs(Ir,{children:[a.jsx(Q,{type:"button",variant:"outline",onClick:()=>m(!1),children:"Cancelar"}),a.jsx(Q,{type:"submit",disabled:o,children:o?"Salvando...":"Salvar Alterações"})]})]})]})}),a.jsxs(Ee,{children:[a.jsxs(Ae,{children:[a.jsxs(Fe,{className:"flex items-center",children:[a.jsx(fn,{className:"h-5 w-5 mr-2"}),"Lista de Notícias"]}),a.jsxs(Ge,{children:[n.length," notícia",n.length!==1?"s":""," cadastrada",n.length!==1?"s":""]})]}),a.jsx(Se,{children:n.length===0?a.jsxs("div",{className:"text-center py-8 text-gray-500",children:[a.jsx(fn,{className:"h-12 w-12 mx-auto mb-4 text-gray-300"}),a.jsx("p",{className:"text-lg font-medium",children:"Nenhuma notícia cadastrada"}),a.jsx("p",{className:"text-sm",children:'Clique em "Nova Notícia" para criar a primeira'})]}):a.jsx("div",{className:"space-y-4",children:n.map(U=>a.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg hover:bg-gray-50",children:[a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsx("div",{className:`p-2 rounded-full ${U.tipo==="alerta"?"bg-red-100 text-red-800":U.tipo==="anuncio"?"bg-blue-100 text-blue-800":"bg-green-100 text-green-800"}`,children:U.tipo==="alerta"?a.jsx(at,{className:"h-4 w-4"}):U.tipo==="anuncio"?a.jsx($a,{className:"h-4 w-4"}):a.jsx(js,{className:"h-4 w-4"})}),a.jsxs("div",{children:[a.jsx("div",{className:"font-medium",children:U.titulo}),a.jsx("div",{className:"text-sm text-gray-600 line-clamp-2",children:U.conteudo}),a.jsxs("div",{className:"flex items-center space-x-2 mt-1",children:[a.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${U.prioridade==="alta"?"bg-red-100 text-red-800":U.prioridade==="media"?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800"}`,children:U.prioridade}),a.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${U.ativa?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:U.ativa?"Ativa":"Inativa"})]})]})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(Q,{size:"sm",variant:"outline",onClick:()=>xa(U.id,U.ativa),children:U.ativa?a.jsx(la,{className:"h-3 w-3"}):a.jsx(Pt,{className:"h-3 w-3"})}),a.jsx(Q,{size:"sm",variant:"outline",onClick:()=>Wt(U),children:a.jsx(va,{className:"h-3 w-3"})}),a.jsx(Q,{size:"sm",variant:"outline",onClick:()=>ka(U.id),className:"text-red-600 hover:text-red-700",children:a.jsx(Kr,{className:"h-3 w-3"})})]})]},U.id))})})]})]}),a.jsx(Vr,{value:"personalizacao",className:"space-y-6",children:a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{children:[a.jsxs("h2",{className:"text-xl font-semibold flex items-center gap-2",children:[a.jsx(un,{className:"h-5 w-5"}),"Personalização Visual"]}),a.jsx("p",{className:"text-muted-foreground text-sm",children:"Personalize a aparência da aplicação com diferentes temas e cores"})]}),a.jsx(L_,{}),(_e==null?void 0:_e.role)==="ADMIN"&&a.jsx(z_,{className:"mt-6"})]})}),a.jsx(Vr,{value:"acesso",className:"space-y-6",children:a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{children:[a.jsxs("h2",{className:"text-xl font-semibold flex items-center gap-2",children:[a.jsx($a,{className:"h-5 w-5"}),"Controle de Acesso por Perfil"]}),a.jsx("p",{className:"text-muted-foreground mt-2",children:"Configure quais funcionalidades estão disponíveis para cada tipo de usuário"})]}),(be||ue||M)&&a.jsx("div",{className:"p-4 bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-lg",children:a.jsxs("div",{className:"flex items-start gap-2",children:[a.jsx(at,{className:"h-5 w-5 text-yellow-600 dark:text-yellow-400 mt-0.5 flex-shrink-0"}),a.jsxs("div",{className:"text-sm",children:[a.jsx("p",{className:"font-medium text-yellow-800 dark:text-yellow-200 mb-1",children:"⚠️ Migração do Banco de Dados Necessária"}),a.jsx("p",{className:"text-yellow-700 dark:text-yellow-300 mb-2",children:"Para usar os controles de acesso, execute primeiro a migração do banco de dados:"}),a.jsxs("div",{className:"bg-yellow-100 dark:bg-yellow-800 p-3 rounded border text-xs font-mono",children:[a.jsxs("p",{className:"mb-1",children:[a.jsx("strong",{children:"1."})," Acesse o Supabase Dashboard"]}),a.jsxs("p",{className:"mb-1",children:[a.jsx("strong",{children:"2."})," Vá para SQL Editor"]}),a.jsxs("p",{className:"mb-1",children:[a.jsx("strong",{children:"3."})," Execute o script: ",a.jsx("code",{children:"scripts/migrate-system-config-manual.sql"})]}),a.jsxs("p",{children:[a.jsx("strong",{children:"4."})," Recarregue esta página"]})]})]})]})}),a.jsxs(Ee,{children:[a.jsxs(Ae,{children:[a.jsxs(Fe,{className:"flex items-center gap-2",children:[a.jsx(oo,{className:"h-5 w-5"}),"Acesso à Página Nova Oportunidade"]}),a.jsx(Ge,{children:"Controle se usuários RH podem acessar a funcionalidade de criar novas oportunidades"})]}),a.jsxs(Se,{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"font-medium",children:"Usuários RH"}),a.jsx(Ve,{variant:"outline",className:"bg-blue-50 text-blue-700 border-blue-200",children:"RH"})]}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"Permitir acesso à página Nova Oportunidade para usuários com perfil RH"})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[be?a.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-2 border-primary border-t-transparent"}):a.jsx(ra,{checked:ve,onCheckedChange:G,disabled:be}),a.jsx("span",{className:"text-sm font-medium",children:ve?"Habilitado":"Desabilitado"})]})]}),a.jsx("div",{className:"p-4 bg-muted/50 rounded-lg",children:a.jsxs("div",{className:"flex items-start gap-2",children:[a.jsx(js,{className:"h-4 w-4 text-blue-600 mt-0.5 flex-shrink-0"}),a.jsxs("div",{className:"text-sm text-muted-foreground",children:[a.jsx("p",{className:"font-medium text-foreground mb-1",children:"Informações importantes:"}),a.jsxs("ul",{className:"space-y-1 text-xs",children:[a.jsx("li",{children:"• Usuários ADMIN sempre têm acesso completo a todas as funcionalidades"}),a.jsx("li",{children:"• Esta configuração afeta apenas usuários com perfil RH"}),a.jsx("li",{children:"• As alterações são aplicadas imediatamente para todos os usuários RH"}),a.jsx("li",{children:"• Usuários RH sem acesso serão redirecionados para o dashboard principal"})]})]})]})})]})]}),a.jsxs(Ee,{children:[a.jsxs(Ae,{children:[a.jsxs(Fe,{className:"flex items-center gap-2",children:[a.jsx(va,{className:"h-5 w-5"}),"Controle de Edição de Vagas"]}),a.jsx(Ge,{children:"Controle se usuários RH podem editar vagas existentes"})]}),a.jsx(Se,{className:"space-y-4",children:a.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"font-medium",children:"Usuários RH"}),a.jsx(Ve,{variant:"outline",className:"bg-blue-50 text-blue-700 border-blue-200",children:"RH"})]}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"Permitir edição de vagas para usuários com perfil RH"})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[ue?a.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-2 border-primary border-t-transparent"}):a.jsx(ra,{checked:J,onCheckedChange:ee,disabled:ue}),a.jsx("span",{className:"text-sm font-medium",children:J?"Habilitado":"Desabilitado"})]})]})})]}),a.jsxs(Ee,{children:[a.jsxs(Ae,{children:[a.jsxs(Fe,{className:"flex items-center gap-2",children:[a.jsx(Kr,{className:"h-5 w-5"}),"Controle de Exclusão de Vagas"]}),a.jsx(Ge,{children:"Controle se usuários RH podem excluir vagas existentes"})]}),a.jsx(Se,{className:"space-y-4",children:a.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"font-medium",children:"Usuários RH"}),a.jsx(Ve,{variant:"outline",className:"bg-blue-50 text-blue-700 border-blue-200",children:"RH"})]}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"Permitir exclusão de vagas para usuários com perfil RH"})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[M?a.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-2 border-primary border-t-transparent"}):a.jsx(ra,{checked:me,onCheckedChange:ge,disabled:M}),a.jsx("span",{className:"text-sm font-medium",children:me?"Habilitado":"Desabilitado"})]})]})})]})]})}),a.jsx(Vr,{value:"ajuda",className:"space-y-6",children:a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{children:[a.jsxs("h2",{className:"text-xl font-semibold flex items-center gap-2",children:[a.jsx(lo,{className:"h-5 w-5"}),"Tira Dúvidas"]}),a.jsx("p",{className:"text-muted-foreground mt-2",children:"Central de ajuda com todas as informações sobre o sistema"})]}),a.jsx(Ee,{children:a.jsx(Se,{className:"pt-6",children:a.jsx(Zh,{})})})]})})]}),a.jsx(At,{open:W,onOpenChange:C,children:a.jsxs(gt,{children:[a.jsxs(pt,{children:[a.jsx(vt,{children:"Adicionar Email de Contato"}),a.jsx(yr,{children:"Adicione um novo email que receberá mensagens do formulário de contato"})]}),a.jsxs("form",{onSubmit:z,children:[a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(fe,{htmlFor:"create-email-contact",children:"Email *"}),a.jsx(Re,{id:"create-email-contact",type:"email",value:V.email,onChange:U=>ae(ne=>({...ne,email:U.target.value})),placeholder:"exemplo@empresa.com",required:!0})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(fe,{htmlFor:"create-nome-contact",children:"Nome (opcional)"}),a.jsx(Re,{id:"create-nome-contact",type:"text",value:V.nome||"",onChange:U=>ae(ne=>({...ne,nome:U.target.value})),placeholder:"Nome do destinatário"})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(fe,{htmlFor:"create-teams-contact",children:"Contato Teams (opcional)"}),a.jsx(Re,{id:"create-teams-contact",type:"text",value:V.teams_contact||"",onChange:U=>ae(ne=>({...ne,teams_contact:U.target.value})),placeholder:"https://teams.microsoft.com/l/chat/..."})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(ra,{id:"create-ativo-contact",checked:V.ativo||!0,onCheckedChange:U=>ae(ne=>({...ne,ativo:U}))}),a.jsx(fe,{htmlFor:"create-ativo-contact",children:"Email ativo"})]})]}),a.jsxs(Ir,{children:[a.jsx(Q,{type:"button",variant:"outline",onClick:()=>C(!1),className:"transition-all duration-200 hover:scale-105 hover:shadow-sm active:scale-95",children:"Cancelar"}),a.jsx(Q,{type:"submit",disabled:A,className:"transition-all duration-200 hover:scale-105 hover:shadow-lg active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:scale-100",children:A?"Adicionando...":"Adicionar Email"})]})]})]})}),a.jsx(At,{open:L,onOpenChange:T,children:a.jsxs(gt,{children:[a.jsxs(pt,{children:[a.jsx(vt,{children:"Editar Email de Contato"}),a.jsx(yr,{children:"Edite as informações do email de contato"})]}),a.jsxs("form",{onSubmit:D,children:[a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(fe,{htmlFor:"edit-email-contact",children:"Email *"}),a.jsx(Re,{id:"edit-email-contact",type:"email",value:V.email,onChange:U=>ae(ne=>({...ne,email:U.target.value})),placeholder:"exemplo@empresa.com",required:!0})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(fe,{htmlFor:"edit-nome-contact",children:"Nome (opcional)"}),a.jsx(Re,{id:"edit-nome-contact",type:"text",value:V.nome||"",onChange:U=>ae(ne=>({...ne,nome:U.target.value})),placeholder:"Nome do destinatário"})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(fe,{htmlFor:"edit-teams-contact",children:"Contato Teams (opcional)"}),a.jsx(Re,{id:"edit-teams-contact",type:"text",value:V.teams_contact||"",onChange:U=>ae(ne=>({...ne,teams_contact:U.target.value})),placeholder:"https://teams.microsoft.com/l/chat/..."})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(ra,{id:"edit-ativo-contact",checked:V.ativo||!1,onCheckedChange:U=>ae(ne=>({...ne,ativo:U}))}),a.jsx(fe,{htmlFor:"edit-ativo-contact",children:"Email ativo"})]})]}),a.jsxs(Ir,{children:[a.jsx(Q,{type:"button",variant:"outline",onClick:()=>T(!1),className:"transition-all duration-200 hover:scale-105 hover:shadow-sm active:scale-95",children:"Cancelar"}),a.jsx(Q,{type:"submit",disabled:A,className:"transition-all duration-200 hover:scale-105 hover:shadow-lg active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:scale-100",children:A?"Salvando...":"Salvar Alterações"})]})]})]})})]})}const q_="https://repositoriodevagas.vercel.app/api";async function G_(e){console.log("📧 [Resend] Tentando envio via Resend...");try{const t=await fetch(`${q_}/send-email`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({nome:e.nome,email:e.email,telefone:e.telefone,assunto:e.assunto,mensagem:e.mensagem,destinatarios:e.destinatarios})});console.log("📨 [Resend] Status da resposta:",t.status,t.statusText);let r;try{const s=await t.text();if(console.log("📨 [Resend] Resposta bruta:",s.substring(0,200)+"..."),s.trim().startsWith("{")||s.trim().startsWith("["))r=JSON.parse(s);else throw new Error(`Resposta não é JSON válido: ${s.substring(0,100)}`)}catch(s){throw console.error("❌ [Resend] Erro ao fazer parse da resposta:",s),new Error(`Erro na resposta do servidor: ${t.status} ${t.statusText}`)}if(console.log("📨 [Resend] Resultado parseado:",r),t.ok&&r.success)return console.log("✅ [Resend] Email enviado com sucesso!"),{success:!0,message:"Email enviado com sucesso! Você receberá uma confirmação em breve."};throw new Error(r.message||"Erro desconhecido no Resend")}catch(t){return console.error("❌ [Resend] Erro ao enviar email:",t),{success:!1,message:`Erro no Resend: ${t.message||"Erro desconhecido"}`}}}async function X_(e){return console.log("🚀 [Resend] Iniciando envio de email..."),console.log("📧 [Resend] Dados do email:",{nome:e.nome,email:e.email,assunto:e.assunto,destinatarios:e.destinatarios}),await G_(e)}function K_(){const[e,t]=p.useState({nome:"",email:"",telefone:"",assunto:"",mensagem:""}),[r,s]=p.useState(!1),[n,i]=p.useState(""),[o,l]=p.useState(""),[d,c]=p.useState(["roberio.gomes@atento.com"]),[u,h]=p.useState(""),{user:f}=tt();p.useEffect(()=>{f!=null&&f.email&&t(x=>({...x,email:f.email}))},[f]),p.useEffect(()=>{(async()=>{console.log("🔧 [Contato] Carregando dados de contato...");try{const[b,N]=await Promise.all([O_(),so()]);console.log("📧 [Contato] Emails destinatários carregados:",b),c(b);const y=N.find(A=>A.ativo&&A.email.endsWith("@atento.com"));if(y){const A=`https://teams.microsoft.com/l/chat/0/0?users=${encodeURIComponent(y.email)}`;console.log("💬 [Contato] Link Teams automático criado para:",y.email),console.log("💬 [Contato] Link Teams:",A),h(A)}else{const A=N.find(B=>B.ativo&&B.teams_contact);A!=null&&A.teams_contact&&(console.log("💬 [Contato] Usando contato Teams manual:",A.teams_contact),h(A.teams_contact))}console.log("✅ [Contato] Dados de contato carregados com sucesso")}catch(b){console.error("❌ [Contato] Erro ao carregar dados de contato:",b)}})()},[]);const m=x=>{const{name:b,value:N}=x.target;t(y=>({...y,[b]:N}))},v=x=>{t(b=>({...b,assunto:x}))},g=async x=>{if(x.preventDefault(),console.log("📝 [Contato] Iniciando envio do formulário via Resend..."),console.log("📝 [Contato] Dados do formulário:",e),console.log("📝 [Contato] Emails destinatários:",d),!e.nome||!e.email||!e.assunto||!e.mensagem){console.error("❌ [Contato] Validação falhou - campos obrigatórios não preenchidos"),i("Por favor, preencha todos os campos obrigatórios."),l("error");return}s(!0),i(""),l("");try{console.log("📧 [Contato] Enviando via Resend...");const b={nome:e.nome,email:e.email,telefone:e.telefone,assunto:e.assunto,mensagem:e.mensagem,destinatarios:d};console.log("📤 [Contato] Dados para envio:",b);const N=await X_(b);console.log("📨 [Contato] Resultado do envio:",N),N.success?(console.log("✅ [Contato] Email enviado com sucesso!"),i(N.message),l("success"),t({nome:"",email:(f==null?void 0:f.email)||"",telefone:"",assunto:"",mensagem:""})):(console.error("❌ [Contato] Erro no envio:",N.message),i(N.message),l("error"))}catch(b){console.error("💥 [Contato] Erro ao enviar mensagem:",b),console.error("💥 [Contato] Detalhes do erro:",{message:b.message,stack:b.stack}),i("Erro ao enviar mensagem. Tente novamente."),l("error")}finally{console.log("🏁 [Contato] Finalizando envio do formulário"),s(!1)}};return a.jsx("div",{className:"container mx-auto p-6 max-w-2xl",children:a.jsxs(Ee,{children:[a.jsxs(Ae,{children:[a.jsxs(Fe,{className:"flex items-center gap-2",children:[a.jsx(Xr,{className:"h-5 w-5"}),"Entre em Contato"]}),a.jsxs(Ge,{children:["Envie sua mensagem diretamente através do sistema. O email será enviado automaticamente via Resend para nossa equipe.",d.length>1&&a.jsxs("span",{className:"block mt-2 text-sm text-blue-600 dark:text-blue-400",children:["📧 Sua mensagem será enviada para ",d.length," destinatários configurados pelos administradores."]}),u&&a.jsxs("div",{className:"mt-3 p-3 bg-blue-50 dark:bg-blue-900/20 rounded-lg border border-blue-200 dark:border-blue-800",children:[a.jsxs("div",{className:"flex items-center gap-2 text-blue-700 dark:text-blue-300",children:[a.jsx(cl,{className:"h-4 w-4"}),a.jsx("span",{className:"text-sm font-medium",children:"Precisa de uma resposta rápida?"})]}),a.jsxs("a",{href:u,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-2 mt-2 text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-200 transition-colors",children:[a.jsx(cl,{className:"h-4 w-4"}),a.jsx("span",{className:"text-sm font-medium underline",children:"Chat direto no Teams: Clique aqui"})]}),a.jsx("p",{className:"text-xs text-blue-600 dark:text-blue-400 mt-1",children:"Será aberto automaticamente no Teams para o administrador @atento.com"})]})]})]}),a.jsx(Se,{children:a.jsxs("form",{onSubmit:g,className:"space-y-6",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsxs(fe,{htmlFor:"nome",className:"flex items-center gap-2",children:[a.jsx(Es,{className:"h-4 w-4"}),"Nome *"]}),a.jsx(Re,{id:"nome",name:"nome",type:"text",value:e.nome,onChange:m,placeholder:"Seu nome completo",required:!0})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs(fe,{htmlFor:"email",className:"flex items-center gap-2",children:[a.jsx(Xr,{className:"h-4 w-4"}),"Email *"]}),a.jsx(Re,{id:"email",name:"email",type:"email",value:e.email,onChange:m,placeholder:"seu@email.com",required:!0})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs(fe,{htmlFor:"telefone",className:"flex items-center gap-2",children:[a.jsx(nm,{className:"h-4 w-4"}),"Telefone"]}),a.jsx(Re,{id:"telefone",name:"telefone",type:"tel",value:e.telefone,onChange:m,placeholder:"(11) 99999-9999"})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs(fe,{htmlFor:"assunto",className:"flex items-center gap-2",children:[a.jsx(dl,{className:"h-4 w-4"}),"Assunto *"]}),a.jsxs(Gt,{value:e.assunto,onValueChange:v,children:[a.jsx(zt,{children:a.jsx(Xt,{placeholder:"Selecione o assunto"})}),a.jsxs(Vt,{children:[a.jsx(Oe,{value:"duvida",children:"Dúvida sobre vagas"}),a.jsx(Oe,{value:"sugestao",children:"Sugestão de melhoria"}),a.jsx(Oe,{value:"problema",children:"Reportar problema"}),a.jsx(Oe,{value:"parceria",children:"Proposta de parceria"}),a.jsx(Oe,{value:"outro",children:"Outro"})]})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs(fe,{htmlFor:"mensagem",className:"flex items-center gap-2",children:[a.jsx(dl,{className:"h-4 w-4"}),"Mensagem *"]}),a.jsx(rr,{id:"mensagem",name:"mensagem",value:e.mensagem,onChange:m,placeholder:"Descreva sua mensagem aqui...",rows:6,required:!0})]}),n&&a.jsx("div",{className:`p-4 rounded-md ${o==="success"?"bg-green-50 text-green-800 border border-green-200":"bg-red-50 text-red-800 border border-red-200"}`,children:n}),a.jsx(Q,{type:"submit",className:"w-full",disabled:r,children:r?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Enviando..."]}):a.jsxs(a.Fragment,{children:[a.jsx(Xc,{className:"h-4 w-4 mr-2"}),"Enviar Mensagem"]})})]})})]})})}function Y_(){const{id:e}=Mn(),t=nr(),{user:r}=tt(),{canEdit:s,canDelete:n}=Fh(),[i,o]=p.useState(null),[l,d]=p.useState(!0),[c,u]=p.useState(null);p.useEffect(()=>{e&&h()},[e]);const h=async()=>{try{d(!0),u(null);const g=await Un(e);g?o(g):u("Oportunidade não encontrada")}catch(g){console.error("Erro ao carregar vaga:",g),u("Erro ao carregar vaga")}finally{d(!1)}},f=()=>{t(`/dashboard/editar-vaga/${e}`)},m=async()=>{if((r==null?void 0:r.role)!=="ADMIN"){alert("Apenas administradores podem excluir vagas");return}if(confirm("Tem certeza que deseja excluir esta vaga?"))try{await ad(e)?t("/dashboard/lista-clientes"):alert("Erro ao excluir vaga")}catch(g){console.error("Erro ao excluir vaga:",g),alert("Erro ao excluir vaga")}},v=()=>{t("/dashboard/lista-clientes")};return l?a.jsx("div",{className:"flex items-center justify-center min-h-screen",children:a.jsxs("div",{className:"text-center",children:[a.jsx(Mr,{className:"h-12 w-12 animate-spin text-blue-600 mx-auto mb-4"}),a.jsx("p",{className:"text-contrast-primary",children:"Carregando vaga..."})]})}):c||!i?a.jsx("div",{className:"flex items-center justify-center min-h-screen",children:a.jsxs("div",{className:"text-center",children:[a.jsx("h1",{className:"text-2xl font-bold text-contrast-primary mb-4",children:"Oportunidade não encontrada"}),a.jsx("p",{className:"text-contrast-primary mb-6",children:c}),a.jsxs(Q,{onClick:v,className:"transition-all duration-200 hover:scale-105 active:scale-95 hover:shadow-lg",children:[a.jsx(Hr,{className:"h-4 w-4 mr-2 transition-transform duration-200 hover:-translate-x-1"}),"Voltar para Lista"]})]})}):a.jsxs("div",{className:"min-h-screen bg-gray-50",children:[a.jsx("div",{className:"bg-white border-b border-gray-200 px-6 py-4",children:a.jsx("div",{className:"max-w-4xl mx-auto",children:a.jsxs(Q,{variant:"outline",onClick:v,className:"mb-4 transition-all duration-200 hover:scale-105 active:scale-95 hover:shadow-md",children:[a.jsx(Hr,{className:"h-4 w-4 mr-2 transition-transform duration-200 hover:-translate-x-1"}),"Voltar para Lista de Oportunidades"]})})}),a.jsx("div",{className:"py-8",children:a.jsx(ro,{vaga:i,onEdit:s?f:void 0,onDelete:n?m:void 0,showActions:(r==null?void 0:r.role)==="ADMIN"||s||n,showEditAction:s,showDeleteAction:n,showFocusAction:!0,showDownloadAction:!0})})]})}function J_(){const{id:e}=Mn(),t=nr(),{user:r}=tt(),[s]=Oc(),n=s.get("reportId"),[i,o]=p.useState({site:"",categoria:"",cargo:"",cliente:"",titulo:"",celula:"",descricao_vaga:"",responsabilidades_atribuicoes:"",requisitos_qualificacoes:"",salario:"",horario_trabalho:"",jornada_trabalho:"",beneficios:"",local_trabalho:"",etapas_processo:""}),[l,d]=p.useState(!1),[c,u]=p.useState(!0),[h,f]=p.useState("");p.useEffect(()=>{(async()=>{if(!e){f("ID da vaga não fornecido"),u(!1);return}try{u(!0);const x=await Un(e);x?o({site:x.site||"",categoria:x.categoria||"",cargo:x.cargo||"",cliente:x.cliente||"",titulo:x.titulo||"",celula:x.celula||"",descricao_vaga:x.descricao_vaga||"",responsabilidades_atribuicoes:x.responsabilidades_atribuicoes||"",requisitos_qualificacoes:x.requisitos_qualificacoes||"",salario:x.salario||"",horario_trabalho:x.horario_trabalho||"",jornada_trabalho:x.jornada_trabalho||"",beneficios:x.beneficios||"",local_trabalho:x.local_trabalho||"",etapas_processo:x.etapas_processo||""}):f("Vaga não encontrada")}catch(x){console.error("Erro ao carregar vaga:",x),f(`Erro ao carregar vaga: ${(x==null?void 0:x.message)||"Erro desconhecido"}`)}finally{u(!1)}})()},[e]);const m=async g=>{if(g.preventDefault(),!(!r||!e)){d(!0),f("");try{if(await $n(e,i,r.id)){if(f("Vaga atualizada com sucesso!"),n)try{console.log("✅ Marcando report como concluído:",n),await ms(n,"completed","Ajustes realizados pelo administrador através da edição da vaga"),console.log("✅ Report marcado como concluído com sucesso"),window.dispatchEvent(new CustomEvent("report-status-updated",{detail:{reportId:n,status:"completed"}}))}catch(b){console.error("❌ Erro ao marcar report como concluído:",b)}setTimeout(()=>{t("/dashboard")},2e3)}else f("Erro ao atualizar vaga")}catch(x){console.error("Erro detalhado ao atualizar vaga:",x);const b=(x==null?void 0:x.message)||"Erro ao atualizar vaga";f(`Erro ao atualizar vaga: ${b}`)}finally{d(!1)}}},v=g=>{const{name:x,value:b}=g.target;o(N=>({...N,[x]:b}))};return c?a.jsxs("div",{className:"flex items-center justify-center min-h-screen",children:[a.jsx(Mr,{className:"h-12 w-12 animate-spin text-blue-600"}),a.jsx("p",{className:"ml-3 text-lg text-gray-700",children:"Carregando vaga..."})]}):h&&h.includes("não encontrada")?a.jsxs("div",{className:"flex flex-col items-center justify-center min-h-screen text-red-600",children:[a.jsx("p",{className:"text-xl mb-4",children:h}),a.jsxs(Q,{onClick:()=>t("/dashboard"),variant:"outline",children:[a.jsx(Hr,{className:"h-4 w-4 mr-2"})," Voltar para a lista de vagas"]})]}):a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsxs(Q,{variant:"outline",onClick:()=>t("/dashboard"),children:[a.jsx(Hr,{className:"h-4 w-4 mr-2"}),"Voltar"]}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Editar Vaga"}),a.jsx("p",{className:"text-gray-600 mt-2",children:"Edite as informações da vaga"})]})]}),n&&a.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-md p-4 mb-4",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"flex-shrink-0",children:a.jsx("svg",{className:"h-5 w-5 text-blue-400",fill:"currentColor",viewBox:"0 0 20 20",children:a.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})})}),a.jsxs("div",{className:"ml-3",children:[a.jsx("h3",{className:"text-sm font-medium text-blue-800",children:"Editando vaga devido a report"}),a.jsx("p",{className:"text-sm text-blue-700 mt-1",children:"Esta vaga será marcada como concluída automaticamente após salvar as alterações."})]})]})}),h&&a.jsx("div",{className:`p-4 rounded-md ${h.includes("sucesso")?"bg-green-50 text-green-800 border border-green-200":"bg-red-50 text-red-800 border border-red-200"}`,children:h}),a.jsxs(Ee,{className:"max-w-4xl",children:[a.jsxs(Ae,{children:[a.jsxs(Fe,{className:"flex items-center",children:[a.jsx(mn,{className:"h-5 w-5 mr-2"}),"Informações da Vaga"]}),a.jsx(Ge,{children:"Edite as informações necessárias sobre a vaga"})]}),a.jsx(Se,{children:a.jsxs("form",{onSubmit:m,className:"space-y-6",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(fe,{htmlFor:"site",children:"Site"}),a.jsx(Re,{id:"site",name:"site",value:i.site,onChange:v,placeholder:"Ex: São Bento, Casa, etc.",required:!0})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(fe,{htmlFor:"categoria",children:"Categoria"}),a.jsx(Re,{id:"categoria",name:"categoria",value:i.categoria,onChange:v,placeholder:"Ex: Operações",required:!0})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(fe,{htmlFor:"cargo",children:"Cargo"}),a.jsx(Re,{id:"cargo",name:"cargo",value:i.cargo,onChange:v,placeholder:"Ex: Especialista I",required:!0})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(fe,{htmlFor:"cliente",children:"Cliente"}),a.jsx(Re,{id:"cliente",name:"cliente",value:i.cliente,onChange:v,placeholder:"Ex: VIVO, REDE, etc.",required:!0})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(fe,{htmlFor:"titulo",children:"Título da Vaga"}),a.jsx(Re,{id:"titulo",name:"titulo",value:i.titulo,onChange:v,placeholder:"Ex: Desenvolvedor Full Stack"})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(fe,{htmlFor:"celula",children:"Célula"}),a.jsx(Re,{id:"celula",name:"celula",value:i.celula,onChange:v,placeholder:"Ex: VIVO - Telecom I",required:!0})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(fe,{htmlFor:"descricao_vaga",children:"Descrição da Vaga"}),a.jsx("textarea",{id:"descricao_vaga",name:"descricao_vaga",value:i.descricao_vaga,onChange:v,placeholder:"Descreva a vaga...",rows:4,className:"flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50"})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(fe,{htmlFor:"responsabilidades_atribuicoes",children:"Responsabilidades e Atribuições"}),a.jsx("textarea",{id:"responsabilidades_atribuicoes",name:"responsabilidades_atribuicoes",value:i.responsabilidades_atribuicoes,onChange:v,placeholder:"Liste as responsabilidades...",rows:4,className:"flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50"})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(fe,{htmlFor:"requisitos_qualificacoes",children:"Requisitos e Qualificações"}),a.jsx("textarea",{id:"requisitos_qualificacoes",name:"requisitos_qualificacoes",value:i.requisitos_qualificacoes,onChange:v,placeholder:"Liste os requisitos...",rows:4,className:"flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50"})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(fe,{htmlFor:"salario",children:"Salário"}),a.jsx(Re,{id:"salario",name:"salario",value:i.salario,onChange:v,placeholder:"Ex: R$ 1.518,00"})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(fe,{htmlFor:"horario_trabalho",children:"Horário de Trabalho"}),a.jsx(Re,{id:"horario_trabalho",name:"horario_trabalho",value:i.horario_trabalho,onChange:v,placeholder:"Ex: Das 09:00 às 18:00"})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(fe,{htmlFor:"jornada_trabalho",children:"Jornada de Trabalho"}),a.jsx(Re,{id:"jornada_trabalho",name:"jornada_trabalho",value:i.jornada_trabalho,onChange:v,placeholder:"Ex: 180h mês | Escala 5x2"})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(fe,{htmlFor:"beneficios",children:"Benefícios"}),a.jsx("textarea",{id:"beneficios",name:"beneficios",value:i.beneficios,onChange:v,placeholder:"Liste os benefícios...",rows:3,className:"flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50"})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(fe,{htmlFor:"local_trabalho",children:"Local de Trabalho"}),a.jsx("textarea",{id:"local_trabalho",name:"local_trabalho",value:i.local_trabalho,onChange:v,placeholder:"Endereço e localização...",rows:2,className:"flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50"})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(fe,{htmlFor:"etapas_processo",children:"Etapas do Processo"}),a.jsx("textarea",{id:"etapas_processo",name:"etapas_processo",value:i.etapas_processo,onChange:v,placeholder:"Liste as etapas do processo seletivo...",rows:4,className:"flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50"})]}),a.jsxs("div",{className:"flex justify-end space-x-4 pt-6",children:[a.jsx(Q,{type:"button",variant:"outline",onClick:()=>t("/dashboard"),children:"Cancelar"}),a.jsx(Q,{type:"submit",disabled:l,children:l?"Salvando...":"Salvar Alterações"})]})]})})]})]})}function Q_(){const{id:e}=Mn(),t=nr(),{user:r}=tt(),[s,n]=p.useState({site:"",categoria:"",cargo:"",cliente:"",titulo:"",celula:"",descricao_vaga:"",responsabilidades_atribuicoes:"",requisitos_qualificacoes:"",salario:"",horario_trabalho:"",jornada_trabalho:"",beneficios:"",local_trabalho:"",etapas_processo:""}),[i,o]=p.useState(!1),[l,d]=p.useState(!0),[c,u]=p.useState(""),[h,f]=p.useState(null),[m,v]=p.useState(""),[g,x]=p.useState("");p.useEffect(()=>{(async()=>{if(e)try{d(!0);const T=await s1(e);if(!T){u("Report não encontrado");return}f(T),v(T.field_name);const P=await Un(T.vaga_id);if(!P){u("Vaga não encontrada");return}n({site:P.site||"",categoria:P.categoria||"",cargo:P.cargo||"",cliente:P.cliente||"",titulo:P.titulo||"",celula:P.celula||"",descricao_vaga:P.descricao_vaga||"",responsabilidades_atribuicoes:P.responsabilidades_atribuicoes||"",requisitos_qualificacoes:P.requisitos_qualificacoes||"",salario:P.salario||"",horario_trabalho:P.horario_trabalho||"",jornada_trabalho:P.jornada_trabalho||"",beneficios:P.beneficios||"",local_trabalho:P.local_trabalho||"",etapas_processo:P.etapas_processo||""});const I=P[T.field_name]||"";x(I)}catch(T){console.error("Erro ao carregar dados:",T),u(`Erro ao carregar dados: ${T.message}`)}finally{d(!1)}})()},[e]);const b=async L=>{if(L.preventDefault(),!(!r||!e||!h)){o(!0),u("");try{await $n(h.vaga_id,s,r.id)?(await ms(e,"completed","Alteração realizada com sucesso"),u("Alteração realizada com sucesso!"),setTimeout(()=>{alert("Alteração realizada com sucesso!"),t("/dashboard/clientes")},1e3)):u("Erro ao atualizar vaga")}catch(T){console.error("Erro detalhado ao atualizar vaga:",T);const P=(T==null?void 0:T.message)||"Erro ao atualizar vaga";u(`Erro ao atualizar vaga: ${P}`)}finally{o(!1)}}},N=L=>{const{name:T,value:P}=L.target;n(I=>({...I,[T]:P}))},y=L=>L===m,A=L=>({site:"Site",categoria:"Categoria",cargo:"Cargo",cliente:"Cliente",titulo:"Título",descricao_vaga:"Descrição da vaga",responsabilidades_atribuicoes:"Responsabilidades e atribuições",requisitos_qualificacoes:"Requisitos e qualificações",salario:"Salário",horario_trabalho:"Horário de Trabalho",jornada_trabalho:"Jornada de Trabalho",beneficios:"Benefícios",local_trabalho:"Local de Trabalho",etapas_processo:"Etapas do processo"})[L]||L,B=L=>y(L)?"border-green-300 bg-green-50 dark:bg-green-900/20 focus:border-green-500 focus:ring-green-500":"bg-gray-100 dark:bg-gray-800",W=L=>y(L)?"text-green-700 font-semibold flex items-center gap-1":"",C=(L,T)=>a.jsxs(fe,{htmlFor:L,className:W(L),children:[y(L)&&a.jsx(di,{className:"h-3 w-3"}),T]});return l?a.jsxs("div",{className:"flex items-center justify-center min-h-screen",children:[a.jsx(Mr,{className:"h-12 w-12 animate-spin text-blue-600"}),a.jsx("p",{className:"ml-3 text-lg text-gray-700",children:"Carregando dados do report..."})]}):c&&c.includes("não encontrado")?a.jsxs("div",{className:"flex flex-col items-center justify-center min-h-screen text-red-600",children:[a.jsx("p",{className:"text-xl mb-4",children:c}),a.jsxs(Q,{onClick:()=>t("/dashboard"),variant:"outline",children:[a.jsx(Hr,{className:"h-4 w-4 mr-2"})," Voltar para o dashboard"]})]}):h?a.jsxs("div",{className:"max-w-4xl mx-auto space-y-6",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsxs("h1",{className:"text-2xl font-bold flex items-center gap-2",children:[a.jsx(at,{className:"h-6 w-6 text-orange-500"}),"Editar Oportunidade - Report"]}),a.jsxs("p",{className:"text-gray-600 mt-1",children:["Campo reportado: ",a.jsx("span",{className:"font-semibold",children:A(m)})]})]}),a.jsxs(Q,{onClick:()=>t("/dashboard/clientes"),variant:"outline",children:[a.jsx(Hr,{className:"h-4 w-4 mr-2"}),"Voltar"]})]}),a.jsxs(Ee,{className:"border-orange-200 bg-orange-50 dark:bg-orange-900/20",children:[a.jsx(Ae,{children:a.jsxs(Fe,{className:"text-sm flex items-center gap-2",children:[a.jsx(at,{className:"h-4 w-4 text-orange-500"}),"Informações do Report"]})}),a.jsxs(Se,{className:"space-y-3",children:[a.jsxs("div",{children:[a.jsx(fe,{className:"text-sm font-medium",children:"Campo Reportado:"}),a.jsx("p",{className:"text-sm text-gray-700",children:A(m)})]}),a.jsxs("div",{children:[a.jsx(fe,{className:"text-sm font-medium",children:"Valor Atual:"}),a.jsx("div",{className:"bg-gray-100 dark:bg-gray-800 p-2 rounded text-sm",children:g||"Não informado"})]}),a.jsxs("div",{children:[a.jsx(fe,{className:"text-sm font-medium",children:"Sugestões do RH:"}),a.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/20 p-2 rounded text-sm",children:h.suggested_changes})]})]})]}),a.jsxs(Ee,{className:"border-blue-200 bg-blue-50 dark:bg-blue-900/20",children:[a.jsx(Ae,{children:a.jsxs(Fe,{className:"text-sm flex items-center gap-2",children:[a.jsx(js,{className:"h-4 w-4 text-blue-500"}),"Instruções de Edição"]})}),a.jsxs(Se,{className:"space-y-3",children:[a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx(di,{className:"h-5 w-5 text-green-600 mt-0.5 flex-shrink-0"}),a.jsxs("div",{children:[a.jsx("p",{className:"font-medium text-sm text-green-700",children:"Campo Editável"}),a.jsxs("p",{className:"text-sm text-gray-600",children:["Apenas o campo ",a.jsxs("strong",{children:['"',A(m),'"']})," pode ser editado. Este campo está destacado em verde e permite modificações."]})]})]}),a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx(Pt,{className:"h-5 w-5 text-gray-500 mt-0.5 flex-shrink-0"}),a.jsxs("div",{children:[a.jsx("p",{className:"font-medium text-sm text-gray-700",children:"Campos Somente Leitura"}),a.jsx("p",{className:"text-sm text-gray-600",children:"Todos os outros campos são apenas para visualização e estão desabilitados. Eles servem como contexto para entender melhor a oportunidade."})]})]}),a.jsx("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 p-3 rounded-md border border-yellow-200",children:a.jsxs("p",{className:"text-sm text-yellow-800 dark:text-yellow-200",children:[a.jsx("strong",{children:"Dica:"}),' Consulte as sugestões do RH na seção "Informações do Report" para entender melhor as alterações solicitadas.']})})]})]}),c&&a.jsx("div",{className:`p-4 rounded-md ${c.includes("sucesso")?"bg-green-50 text-green-700 border border-green-200":"bg-red-50 text-red-700 border border-red-200"}`,children:c}),a.jsxs(Ee,{children:[a.jsxs(Ae,{children:[a.jsxs(Fe,{className:"flex items-center gap-2",children:[a.jsx(Dt,{className:"h-5 w-5 text-green-500"}),"Informações da Oportunidade"]}),a.jsxs(Ge,{children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(di,{className:"h-4 w-4 text-green-600"}),a.jsxs("span",{children:["Campo editável: ",a.jsx("strong",{className:"text-green-700",children:A(m)})]})]}),a.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[a.jsx(Pt,{className:"h-4 w-4 text-gray-500"}),a.jsx("span",{className:"text-gray-600",children:"Demais campos são somente leitura para contexto"})]})]})]}),a.jsx(Se,{children:a.jsxs("form",{onSubmit:b,className:"space-y-6",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{className:"space-y-2",children:[C("site","Site"),a.jsx(Re,{id:"site",name:"site",value:s.site,onChange:N,disabled:!y("site"),className:B("site")})]}),a.jsxs("div",{className:"space-y-2",children:[C("categoria","Categoria"),a.jsx(Re,{id:"categoria",name:"categoria",value:s.categoria,onChange:N,disabled:!y("categoria"),className:B("categoria")})]}),a.jsxs("div",{className:"space-y-2",children:[C("cargo","Cargo"),a.jsx(Re,{id:"cargo",name:"cargo",value:s.cargo,onChange:N,disabled:!y("cargo"),className:B("cargo")})]}),a.jsxs("div",{className:"space-y-2",children:[C("cliente","Cliente"),a.jsx(Re,{id:"cliente",name:"cliente",value:s.cliente,onChange:N,disabled:!y("cliente"),className:B("cliente")})]}),a.jsxs("div",{className:"space-y-2",children:[C("titulo","Título"),a.jsx(Re,{id:"titulo",name:"titulo",value:s.titulo,onChange:N,disabled:!y("titulo"),className:B("titulo")})]}),a.jsxs("div",{className:"space-y-2",children:[C("celula","Célula"),a.jsx(Re,{id:"celula",name:"celula",value:s.celula,onChange:N,disabled:!y("celula"),className:B("celula")})]})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"space-y-2",children:[C("descricao_vaga","Descrição da Vaga"),a.jsx(rr,{id:"descricao_vaga",name:"descricao_vaga",value:s.descricao_vaga,onChange:N,disabled:!y("descricao_vaga"),className:B("descricao_vaga"),rows:3})]}),a.jsxs("div",{className:"space-y-2",children:[C("responsabilidades_atribuicoes","Responsabilidades e Atribuições"),a.jsx(rr,{id:"responsabilidades_atribuicoes",name:"responsabilidades_atribuicoes",value:s.responsabilidades_atribuicoes,onChange:N,disabled:!y("responsabilidades_atribuicoes"),className:B("responsabilidades_atribuicoes"),rows:3})]}),a.jsxs("div",{className:"space-y-2",children:[C("requisitos_qualificacoes","Requisitos e Qualificações"),a.jsx(rr,{id:"requisitos_qualificacoes",name:"requisitos_qualificacoes",value:s.requisitos_qualificacoes,onChange:N,disabled:!y("requisitos_qualificacoes"),className:B("requisitos_qualificacoes"),rows:3})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{className:"space-y-2",children:[C("salario","Salário"),a.jsx(Re,{id:"salario",name:"salario",value:s.salario,onChange:N,disabled:!y("salario"),className:B("salario")})]}),a.jsxs("div",{className:"space-y-2",children:[C("horario_trabalho","Horário de Trabalho"),a.jsx(Re,{id:"horario_trabalho",name:"horario_trabalho",value:s.horario_trabalho,onChange:N,disabled:!y("horario_trabalho"),className:B("horario_trabalho")})]}),a.jsxs("div",{className:"space-y-2",children:[C("jornada_trabalho","Jornada de Trabalho"),a.jsx(Re,{id:"jornada_trabalho",name:"jornada_trabalho",value:s.jornada_trabalho,onChange:N,disabled:!y("jornada_trabalho"),className:B("jornada_trabalho")})]})]}),a.jsxs("div",{className:"space-y-2",children:[C("beneficios","Benefícios"),a.jsx(rr,{id:"beneficios",name:"beneficios",value:s.beneficios,onChange:N,disabled:!y("beneficios"),className:B("beneficios"),rows:3})]}),a.jsxs("div",{className:"space-y-2",children:[C("local_trabalho","Local de Trabalho"),a.jsx(rr,{id:"local_trabalho",name:"local_trabalho",value:s.local_trabalho,onChange:N,disabled:!y("local_trabalho"),className:B("local_trabalho"),rows:2})]}),a.jsxs("div",{className:"space-y-2",children:[C("etapas_processo","Etapas do Processo"),a.jsx(rr,{id:"etapas_processo",name:"etapas_processo",value:s.etapas_processo,onChange:N,disabled:!y("etapas_processo"),className:B("etapas_processo"),rows:3})]})]}),a.jsxs("div",{className:"flex justify-end gap-3 pt-6",children:[a.jsx(Q,{type:"button",variant:"outline",onClick:()=>t("/dashboard/clientes"),disabled:i,children:"Cancelar"}),a.jsx(Q,{type:"submit",disabled:i,children:i?a.jsxs(a.Fragment,{children:[a.jsx(Mr,{className:"h-4 w-4 mr-2 animate-spin"}),"Salvando..."]}):a.jsxs(a.Fragment,{children:[a.jsx(mn,{className:"h-4 w-4 mr-2"}),"Salvar Alterações"]})})]})]})})]})]}):a.jsxs("div",{className:"flex flex-col items-center justify-center min-h-screen text-red-600",children:[a.jsx("p",{className:"text-xl mb-4",children:"Report não encontrado"}),a.jsxs(Q,{onClick:()=>t("/dashboard"),variant:"outline",children:[a.jsx(Hr,{className:"h-4 w-4 mr-2"})," Voltar para o dashboard"]})]})}function Z_(){var k,M,O,R,q,z;const{user:e}=tt();nr();const[t,r]=p.useState([]),[s,n]=p.useState(!0),[i,o]=p.useState(!1),[l,d]=p.useState(!1),[c,u]=p.useState(null),[h,f]=p.useState(""),[m,v]=p.useState(!1),[g,x]=p.useState(!1),[b,N]=p.useState(null),[y,A]=p.useState(!1),[B,W]=p.useState({}),C=async(D=!1)=>{try{D?o(!0):n(!0),console.log("📝 [ReportsList] Carregando reports para usuário:",{id:e==null?void 0:e.id,role:e==null?void 0:e.role,name:e==null?void 0:e.name});const G=await n1(e.id,e.role);console.log("📝 [ReportsList] Reports carregados:",G),r(G)}catch(G){console.error("❌ [ReportsList] Erro ao carregar reports:",G)}finally{n(!1),o(!1)}},L=async()=>{console.log("🔄 [ReportsList] Forçando refresh dos reports..."),console.log("🔍 [ReportsList] Dados do usuário para debug:",{id:e==null?void 0:e.id,role:e==null?void 0:e.role,email:e==null?void 0:e.email,name:e==null?void 0:e.name}),await C(!0)};p.useEffect(()=>{e&&C()},[e]),p.useEffect(()=>{if(!e||s)return;const D=setTimeout(()=>{t.length===0&&!i&&(console.log("🔄 [ReportsList] Tentando recarregar reports após timeout..."),C(!0))},2e3);return()=>clearTimeout(D)},[e,t.length,s,i]),p.useEffect(()=>{const D=G=>{console.log("📢 Evento de report criado recebido:",G.detail),setTimeout(()=>{C(!0)},1e3)};return window.addEventListener("report-created",D),()=>{window.removeEventListener("report-created",D)}},[e]);const T=D=>{var G;if(!e||e.role!=="ADMIN"){alert("Apenas administradores podem aceitar reports");return}if(console.log("✅ Abrindo modal de edição para report:",D.id),(G=D.vaga)!=null&&G.id){u(D);const ee={};D.suggested_changes&&(ee[D.field_name]=D.suggested_changes),W(ee),A(!0)}else console.error("❌ ID da vaga não encontrado no report"),alert("Erro: ID da vaga não encontrado")},P=D=>{if(!e||e.role!=="ADMIN"){alert("Apenas administradores podem rejeitar reports");return}u(D),f(""),d(!0)},I=async()=>{if(!c||!h.trim()){alert("Por favor, informe o motivo da rejeição");return}v(!0);try{console.log("❌ Rejeitando report:",c.id,"Motivo:",h),await ms(c.id,"rejected",h.trim())&&(console.log("✅ Report rejeitado com sucesso"),d(!1),u(null),f(""),await C(!0),window.dispatchEvent(new CustomEvent("report-status-updated",{detail:{reportId:c.id,status:"rejected"}})))}catch(D){console.error("❌ Erro ao rejeitar report:",D),alert("Erro ao rejeitar report. Tente novamente.")}finally{v(!1)}},V=()=>{d(!1),u(null),f("")},ae=D=>{if(!e||e.role!=="ADMIN"){alert("Apenas administradores podem deletar reports");return}N(D),x(!0)},_e=async()=>{if(b){v(!0);try{console.log("🗑️ Limpando registro do report:",b.id),await o1(b.id)&&(console.log("✅ Registro do report limpo com sucesso"),x(!1),N(null),await C(!0),window.dispatchEvent(new CustomEvent("report-deleted",{detail:{reportId:b.id}})))}catch(D){console.error("❌ Erro ao deletar report:",D),alert("Erro ao deletar report. Tente novamente.")}finally{v(!1)}}},ve=()=>{x(!1),N(null)},we=()=>{A(!1),u(null),W({})},be=async()=>{if(!(!c||!c.vaga||!e)){v(!0);try{console.log("✅ Aceitando alterações da vaga:",c.vaga.id);const D={...c.vaga,...B},G=await $n(c.vaga.id,D,e.id);G?(await ms(c.id,"completed","Ajustes aceitos e implementados pelo administrador"),console.log("✅ Vaga atualizada e report marcado como concluído"),we(),await C(!0),window.dispatchEvent(new CustomEvent("report-status-updated",{detail:{reportId:c.id,status:"completed"}})),window.dispatchEvent(new CustomEvent("vaga-updated",{detail:{vagaId:c.vaga.id,updatedVaga:G}}))):alert("Erro ao atualizar vaga")}catch(D){console.error("❌ Erro ao aceitar alterações:",D),alert("Erro ao aceitar alterações. Tente novamente.")}finally{v(!1)}}},J=async()=>{if(!(!c||!e)){v(!0);try{console.log("❌ Rejeitando alterações do report:",c.id),await ms(c.id,"rejected","Ajustes rejeitados pelo administrador - mantidas informações originais"),console.log("✅ Report marcado como rejeitado"),we(),await C(!0),window.dispatchEvent(new CustomEvent("report-status-updated",{detail:{reportId:c.id,status:"rejected"}}))}catch(D){console.error("❌ Erro ao rejeitar alterações:",D),alert("Erro ao rejeitar alterações. Tente novamente.")}finally{v(!1)}}},Z=(D,G)=>{W(ee=>({...ee,[D]:G}))},ue=D=>{const G={pending:{color:"bg-yellow-100 text-yellow-800",icon:ya},in_progress:{color:"bg-blue-100 text-blue-800",icon:Pt},completed:{color:"bg-green-100 text-green-800",icon:Dt},rejected:{color:"bg-red-100 text-red-800",icon:ln}},ee=G[D]||G.pending,ge=ee.icon;return a.jsxs(Ve,{className:`${ee.color} flex items-center gap-1`,children:[a.jsx(ge,{className:"h-3 w-3"}),D==="pending"?"Pendente":D==="in_progress"?"Em Andamento":D==="completed"?"Concluído":"Rejeitado"]})},me=D=>({site:"Site",categoria:"Categoria",cargo:"Cargo",cliente:"Cliente",titulo:"Título",descricao_vaga:"Descrição da vaga",responsabilidades_atribuicoes:"Responsabilidades e atribuições",requisitos_qualificacoes:"Requisitos e qualificações",salario:"Salário",horario_trabalho:"Horário de Trabalho",jornada_trabalho:"Jornada de Trabalho",beneficios:"Benefícios",local_trabalho:"Local de Trabalho",etapas_processo:"Etapas do processo"})[D]||D;return s?a.jsxs("div",{className:"flex items-center justify-center min-h-screen",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"}),a.jsx("p",{className:"ml-3 text-lg text-gray-700",children:"Carregando reports..."})]}):a.jsxs("div",{className:"max-w-6xl mx-auto space-y-6",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsxs("h1",{className:"text-2xl font-bold flex items-center gap-2",children:[a.jsx(at,{className:"h-6 w-6 text-orange-500"}),"Reports de Oportunidades"]}),a.jsx("p",{className:"text-gray-600 mt-1",children:(e==null?void 0:e.role)==="ADMIN"?"Gerencie todos os reports de oportunidades":"Visualize seus reports enviados"})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs(Q,{variant:"outline",onClick:L,disabled:i||s,size:"sm",className:"flex items-center gap-2",children:[a.jsx(ot,{className:`h-4 w-4 transition-transform duration-300 ${i?"animate-spin":"hover:rotate-180"}`}),a.jsx("span",{children:i?"Atualizando...":"Atualizar"})]}),a.jsxs(Q,{variant:"outline",onClick:()=>{console.log("🔍 [DEBUG] Informações do usuário:",e),console.log("🔍 [DEBUG] Reports atuais:",t),console.log("🔍 [DEBUG] Loading state:",s),console.log("🔍 [DEBUG] IsRefreshing state:",i),alert(`Debug Info:
User ID: ${e==null?void 0:e.id}
User Role: ${e==null?void 0:e.role}
Reports Count: ${t.length}
Loading: ${s}`)},size:"sm",className:"flex items-center gap-2 bg-blue-50 hover:bg-blue-100 border-blue-200 text-blue-700",children:[a.jsx(at,{className:"h-4 w-4"}),a.jsx("span",{children:"Debug"})]})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4",children:[a.jsx(Ee,{children:a.jsx(Se,{className:"p-4",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(ya,{className:"h-5 w-5 text-yellow-500"}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-600",children:"Pendentes"}),a.jsx("p",{className:"text-2xl font-bold text-yellow-600",children:t.filter(D=>D.status==="pending").length})]})]})})}),a.jsx(Ee,{children:a.jsx(Se,{className:"p-4",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Pt,{className:"h-5 w-5 text-blue-500"}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-600",children:"Em Andamento"}),a.jsx("p",{className:"text-2xl font-bold text-blue-600",children:t.filter(D=>D.status==="in_progress").length})]})]})})}),a.jsx(Ee,{children:a.jsx(Se,{className:"p-4",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Dt,{className:"h-5 w-5 text-green-500"}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-600",children:"Aceitos"}),a.jsx("p",{className:"text-2xl font-bold text-green-600",children:t.filter(D=>D.status==="completed").length})]})]})})}),a.jsx(Ee,{children:a.jsx(Se,{className:"p-4",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(ln,{className:"h-5 w-5 text-red-500"}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-600",children:"Rejeitados"}),a.jsx("p",{className:"text-2xl font-bold text-red-600",children:t.filter(D=>D.status==="rejected").length})]})]})})}),a.jsx(Ee,{children:a.jsx(Se,{className:"p-4",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(at,{className:"h-5 w-5 text-orange-500"}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-600",children:"Total"}),a.jsx("p",{className:"text-2xl font-bold text-orange-600",children:t.length})]})]})})})]}),t.length===0?a.jsx(Ee,{children:a.jsxs(Se,{className:"text-center py-8",children:[a.jsx(at,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),a.jsx("h3",{className:"text-lg font-semibold text-gray-600 mb-2",children:"Nenhum report encontrado"}),a.jsx("p",{className:"text-gray-500",children:(e==null?void 0:e.role)==="ADMIN"?"Não há reports pendentes no momento.":"Você ainda não enviou nenhum report."})]})}):a.jsx("div",{className:"space-y-4",children:t.map(D=>{var G,ee,ge,Te,Me;return a.jsxs(Ee,{className:"hover:shadow-md transition-shadow",children:[a.jsx(Ae,{children:a.jsxs("div",{className:"flex items-start justify-between",children:[a.jsxs("div",{className:"flex-1",children:[a.jsxs(Fe,{className:"text-lg flex items-center gap-2",children:[a.jsx(at,{className:"h-5 w-5 text-orange-500"}),((G=D.vaga)==null?void 0:G.titulo)||((ee=D.vaga)==null?void 0:ee.cargo)," - ",(ge=D.vaga)==null?void 0:ge.cliente]}),a.jsxs(Ge,{className:"mt-1",children:["Campo reportado: ",a.jsx("span",{className:"font-semibold",children:me(D.field_name)})]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[ue(D.status),(e==null?void 0:e.role)==="ADMIN"&&D.status==="pending"&&a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs(Q,{size:"sm",onClick:()=>T(D),className:"bg-green-500 hover:bg-green-600 text-white",children:[a.jsx(ul,{className:"h-4 w-4 mr-1"}),"Aceitar"]}),a.jsxs(Q,{size:"sm",variant:"outline",onClick:()=>P(D),disabled:m,className:"bg-red-50 hover:bg-red-100 border-red-200 text-red-700 hover:text-red-800",children:[a.jsx(hl,{className:"h-4 w-4 mr-1"}),"Rejeitar"]})]}),(e==null?void 0:e.role)==="ADMIN"&&D.status==="completed"&&a.jsxs(Q,{size:"sm",variant:"outline",onClick:()=>ae(D),disabled:m,className:"bg-red-50 hover:bg-red-100 border-red-200 text-red-700 hover:text-red-800",children:[a.jsx(Kr,{className:"h-4 w-4 mr-1"}),"Apagar"]})]})]})}),a.jsxs(Se,{className:"space-y-3",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-gray-600 mb-1",children:"Valor Atual:"}),a.jsx("div",{className:"bg-gray-100 dark:bg-gray-800 p-2 rounded text-sm",children:D.current_value||"Não informado"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-gray-600 mb-1",children:"Sugestões:"}),a.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/20 p-2 rounded text-sm",children:D.suggested_changes})]})]}),a.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-500",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(Es,{className:"h-4 w-4"}),a.jsxs("span",{children:["Reportado por: ",(Te=D.reporter)==null?void 0:Te.name]})]}),(e==null?void 0:e.role)==="ADMIN"&&a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(Es,{className:"h-4 w-4"}),a.jsxs("span",{children:["Atribuído para: ",(Me=D.assignee)==null?void 0:Me.name]})]})]}),a.jsxs("span",{children:[new Date(D.created_at).toLocaleDateString("pt-BR")," às"," ",new Date(D.created_at).toLocaleTimeString("pt-BR")]})]}),D.admin_notes&&a.jsxs("div",{className:"mt-3 p-3 bg-green-50 dark:bg-green-900/20 rounded border border-green-200 dark:border-green-800",children:[a.jsx("p",{className:"text-sm font-medium text-green-800 dark:text-green-200 mb-1",children:"Notas do Admin:"}),a.jsx("p",{className:"text-sm text-green-700 dark:text-green-300",children:D.admin_notes})]}),(D.status==="completed"||D.status==="rejected")&&a.jsxs("div",{className:`mt-3 p-3 rounded border ${D.status==="completed"?"bg-green-50 dark:bg-green-900/20 border-green-200 dark:border-green-800":"bg-red-50 dark:bg-red-900/20 border-red-200 dark:border-red-800"}`,children:[a.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[D.status==="completed"?a.jsx(Dt,{className:"h-4 w-4 text-green-600"}):a.jsx(ln,{className:"h-4 w-4 text-red-600"}),a.jsx("p",{className:`text-sm font-medium ${D.status==="completed"?"text-green-800 dark:text-green-200":"text-red-800 dark:text-red-200"}`,children:D.status==="completed"?"Ajustes Aceitos pelo Admin":"Ajustes Rejeitados pelo Admin"})]}),D.completed_at&&a.jsxs("p",{className:`text-xs ${D.status==="completed"?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400"}`,children:["Processado em: ",new Date(D.completed_at).toLocaleDateString("pt-BR")," às"," ",new Date(D.completed_at).toLocaleTimeString("pt-BR")]})]})]})]},D.id)})}),a.jsx(At,{open:l,onOpenChange:d,children:a.jsxs(gt,{className:"max-w-md",children:[a.jsx(pt,{children:a.jsxs(vt,{className:"flex items-center gap-2",children:[a.jsx(hl,{className:"h-5 w-5 text-red-500"}),"Rejeitar Report"]})}),a.jsxs("div",{className:"space-y-4",children:[c&&a.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[a.jsxs("p",{className:"text-sm font-medium text-gray-700 mb-1",children:["Report: ",((k=c.vaga)==null?void 0:k.titulo)||((M=c.vaga)==null?void 0:M.cargo)," - ",(O=c.vaga)==null?void 0:O.cliente]}),a.jsxs("p",{className:"text-xs text-gray-500",children:["Campo: ",me(c.field_name)]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(fe,{htmlFor:"reject-reason",className:"text-sm font-medium",children:"Motivo da Rejeição *"}),a.jsx(rr,{id:"reject-reason",placeholder:"Explique o motivo da rejeição deste report...",value:h,onChange:D=>f(D.target.value),rows:4,className:"resize-none"})]}),a.jsxs("div",{className:"flex items-center justify-end gap-2 pt-4",children:[a.jsx(Q,{variant:"outline",onClick:V,disabled:m,children:"Cancelar"}),a.jsx(Q,{onClick:I,disabled:m||!h.trim(),className:"bg-red-500 hover:bg-red-600 text-white",children:m?"Rejeitando...":"Confirmar Rejeição"})]})]})]})}),a.jsx(At,{open:y,onOpenChange:A,children:a.jsxs(gt,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[a.jsx(pt,{children:a.jsxs(vt,{className:"flex items-center gap-2",children:[a.jsx(ul,{className:"h-5 w-5 text-green-500"}),"Editar Vaga - Campo Reportado"]})}),a.jsx("div",{className:"space-y-4",children:c&&c.vaga&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg border border-blue-200",children:[a.jsx("h3",{className:"font-medium text-blue-800 mb-2",children:"Informações do Report"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 text-sm",children:[a.jsxs("div",{children:[a.jsx("span",{className:"font-medium text-blue-700",children:"Vaga:"}),a.jsxs("p",{className:"text-blue-600",children:[c.vaga.titulo||c.vaga.cargo," - ",c.vaga.cliente]})]}),a.jsxs("div",{children:[a.jsx("span",{className:"font-medium text-blue-700",children:"Campo Reportado:"}),a.jsx("p",{className:"text-blue-600",children:me(c.field_name)})]}),a.jsxs("div",{children:[a.jsx("span",{className:"font-medium text-blue-700",children:"Valor Atual:"}),a.jsx("p",{className:"text-blue-600 bg-white p-2 rounded border text-xs",children:c.current_value||"Não informado"})]}),a.jsxs("div",{children:[a.jsx("span",{className:"font-medium text-blue-700",children:"Sugestão:"}),a.jsx("p",{className:"text-blue-600 bg-white p-2 rounded border text-xs",children:c.suggested_changes||"Não informado"})]})]})]}),a.jsxs("div",{className:"bg-green-50 p-4 rounded-lg border border-green-200",children:[a.jsx("h3",{className:"font-medium text-green-800 mb-2",children:"📋 Instruções"}),a.jsxs("ul",{className:"text-sm text-green-700 space-y-1",children:[a.jsx("li",{children:"• O campo foi pré-preenchido com a sugestão do RH"}),a.jsx("li",{children:"• Você pode editar o valor antes de aceitar ou rejeitar"}),a.jsxs("li",{children:["• ",a.jsx("strong",{children:"Aceitar"}),": Aplica as alterações na vaga e conclui o report"]}),a.jsxs("li",{children:["• ",a.jsx("strong",{children:"Rejeitar"}),": Mantém a vaga como está e marca o report como rejeitado"]})]})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("h3",{className:"font-medium text-gray-800",children:["Editar Campo: ",me(c.field_name)]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs(fe,{htmlFor:`edit-${c.field_name}`,className:"text-sm font-medium",children:[me(c.field_name)," *"]}),c.field_name.includes("descricao")||c.field_name.includes("responsabilidades")||c.field_name.includes("requisitos")||c.field_name.includes("beneficios")?a.jsx(rr,{id:`edit-${c.field_name}`,value:B[c.field_name]||c.vaga[c.field_name]||"",onChange:D=>Z(c.field_name,D.target.value),rows:4,className:"border-green-300 focus:border-green-500 focus:ring-green-500",placeholder:"Digite o novo valor..."}):a.jsx(Re,{id:`edit-${c.field_name}`,value:B[c.field_name]||c.vaga[c.field_name]||"",onChange:D=>Z(c.field_name,D.target.value),className:"border-green-300 focus:border-green-500 focus:ring-green-500",placeholder:"Digite o novo valor..."}),a.jsxs("div",{className:"flex flex-col gap-1",children:[a.jsxs("p",{className:"text-xs text-gray-500",children:[a.jsx("span",{className:"font-medium",children:"Valor atual:"})," ",c.current_value||"Não informado"]}),a.jsxs("p",{className:"text-xs text-green-600 bg-green-50 px-2 py-1 rounded border",children:[a.jsx("span",{className:"font-medium",children:"✅ Pré-preenchido com sugestão:"})," ",c.suggested_changes||"Não informado"]})]})]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:Object.entries(c.vaga).map(([D,G])=>D===c.field_name||D==="id"||D==="created_at"||D==="updated_at"?null:a.jsxs("div",{className:"space-y-1",children:[a.jsx(fe,{className:"text-xs text-gray-500",children:me(D)}),a.jsx(Re,{value:G||"",disabled:!0,className:"bg-gray-50 text-gray-500"})]},D))})]}),a.jsxs("div",{className:"flex items-center justify-end gap-2 pt-4 border-t",children:[a.jsx(Q,{variant:"outline",onClick:we,disabled:m,children:"Cancelar"}),a.jsx(Q,{onClick:J,disabled:m,className:"bg-red-500 hover:bg-red-600 text-white",children:m?"Rejeitando...":"Rejeitar"}),a.jsx(Q,{onClick:be,disabled:m,className:"bg-green-500 hover:bg-green-600 text-white",children:m?"Aceitando...":"Aceitar"})]})]})})]})}),a.jsx(At,{open:g,onOpenChange:x,children:a.jsxs(gt,{className:"max-w-md",children:[a.jsx(pt,{children:a.jsxs(vt,{className:"flex items-center gap-2",children:[a.jsx(Kr,{className:"h-5 w-5 text-red-500"}),"Limpar Registro do Histórico"]})}),a.jsxs("div",{className:"space-y-4",children:[b&&a.jsxs("div",{className:"bg-red-50 p-3 rounded-lg border border-red-200",children:[a.jsxs("p",{className:"text-sm font-medium text-red-700 mb-1",children:["Report: ",((R=b.vaga)==null?void 0:R.titulo)||((q=b.vaga)==null?void 0:q.cargo)," - ",(z=b.vaga)==null?void 0:z.cliente]}),a.jsxs("p",{className:"text-xs text-red-600",children:["Campo: ",me(b.field_name)]}),a.jsxs("p",{className:"text-xs text-red-600 mt-1",children:["Status: ",b.status==="completed"?"Concluído":b.status]})]}),a.jsxs("div",{className:"bg-yellow-50 p-3 rounded-lg border border-yellow-200",children:[a.jsx("p",{className:"text-sm text-yellow-800 font-medium",children:"⚠️ Esta ação vai limpar este registro do histórico de Reports"}),a.jsx("p",{className:"text-xs text-yellow-700 mt-1",children:"O registro do report será permanentemente removido do banco de dados."})]}),a.jsxs("div",{className:"flex items-center justify-end gap-2 pt-4",children:[a.jsx(Q,{variant:"outline",onClick:ve,disabled:m,children:"Cancelar"}),a.jsx(Q,{onClick:_e,disabled:m,className:"bg-red-500 hover:bg-red-600 text-white",children:m?"Limpando...":"Limpar Registro"})]})]})]})})]})}function pc({children:e}){const{user:t,loading:r}=tt(),[s,n]=p.useState(null),[i,o]=p.useState(!0);return p.useEffect(()=>{!r&&t&&(async()=>{if((t==null?void 0:t.role)==="ADMIN"){n(!0),o(!1);return}if((t==null?void 0:t.role)==="RH")try{const d=await xu();n(d)}catch(d){console.error("Erro ao verificar acesso RH:",d),n(!1)}else n(!1);o(!1)})()},[t,r]),r||i?a.jsx(ho,{message:"Verificando permissões..."}):t?t.role==="ADMIN"?a.jsx(a.Fragment,{children:e}):t.role==="RH"&&s===!0?a.jsx(a.Fragment,{children:e}):a.jsx(aa,{to:"/dashboard",replace:!0}):a.jsx(aa,{to:"/login",replace:!0})}function Rr({children:e,requireAdmin:t=!1}){const{user:r,loading:s}=tt();return s?a.jsx(ho,{message:"Verificando autenticação..."}):r?t&&r.role!=="ADMIN"?a.jsx(aa,{to:"/dashboard",replace:!0}):a.jsx(a.Fragment,{children:e}):a.jsx(aa,{to:"/login",replace:!0})}function eS(){const{user:e,loading:t,error:r,retry:s}=tt();return r?a.jsx(ix,{error:r,onRetry:s}):t?a.jsx(ho,{message:e?"Carregando dados...":"Inicializando aplicação..."}):a.jsxs(Mf,{children:[a.jsx(Et,{path:"/login",element:e?a.jsx(aa,{to:"/dashboard",replace:!0}):a.jsx(Ig,{})}),a.jsx(Et,{path:"/forgot-password",element:e?a.jsx(aa,{to:"/dashboard",replace:!0}):a.jsx(Og,{})}),a.jsx(Et,{path:"/reset-password",element:a.jsx(Mg,{})}),a.jsx(Et,{path:"/dashboard",element:a.jsx(Rr,{children:a.jsx(Ar,{children:a.jsx(v1,{})})})}),a.jsx(Et,{path:"/dashboard/clientes",element:a.jsx(Rr,{children:a.jsx(Ar,{children:a.jsx(w_,{})})})}),a.jsx(Et,{path:"/dashboard/comparativo",element:a.jsx(Rr,{children:a.jsx(Ar,{children:a.jsx(b_,{})})})}),a.jsx(Et,{path:"/dashboard/nova-vaga",element:a.jsx(pc,{children:a.jsx(Ar,{children:a.jsx(gc,{})})})}),a.jsx(Et,{path:"/dashboard/nova-vaga/:id",element:a.jsx(pc,{children:a.jsx(Ar,{children:a.jsx(gc,{})})})}),a.jsx(Et,{path:"/dashboard/configuracoes",element:a.jsx(Rr,{requireAdmin:!0,children:a.jsx(Ar,{children:a.jsx(W_,{})})})}),a.jsx(Et,{path:"/dashboard/contato",element:a.jsx(Rr,{children:a.jsx(Ar,{children:a.jsx(K_,{})})})}),a.jsx(Et,{path:"/dashboard/tira-duvidas",element:a.jsx(Rr,{children:a.jsx(Ar,{children:a.jsx(Zh,{})})})}),a.jsx(Et,{path:"/dashboard/vaga/:id",element:a.jsx(Rr,{children:a.jsx(Y_,{})})}),a.jsx(Et,{path:"/dashboard/editar-vaga/:id",element:a.jsx(Rr,{children:a.jsx(J_,{})})}),a.jsx(Et,{path:"/dashboard/editar-report/:id",element:a.jsx(Rr,{requireAdmin:!0,children:a.jsx(Ar,{children:a.jsx(Q_,{})})})}),a.jsx(Et,{path:"/dashboard/reports",element:a.jsx(Rr,{children:a.jsx(Ar,{children:a.jsx(Z_,{})})})}),a.jsx(Et,{path:"/",element:a.jsx(aa,{to:"/dashboard",replace:!0})}),a.jsx(Et,{path:"*",element:a.jsx(aa,{to:"/dashboard",replace:!0})})]})}function tS(){return sx(),a.jsx(ax,{children:a.jsx(Cm,{children:a.jsxs(Zm,{children:[a.jsx(eS,{}),a.jsx(nx,{})]})})})}"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/sw.js",{scope:"/"}).then(e=>{console.log("[SW] Service worker registrado com sucesso:",e.scope),e.addEventListener("updatefound",()=>{const t=e.installing;t&&t.addEventListener("statechange",()=>{t.state==="installed"&&navigator.serviceWorker.controller&&(console.log("[SW] Nova versão disponível!"),window.dispatchEvent(new CustomEvent("sw-update-available")))})})}).catch(e=>{console.error("[SW] Falha ao registrar service worker:",e)})});Li.createRoot(document.getElementById("root")).render(a.jsx(If.StrictMode,{children:a.jsx(Lf,{children:a.jsx(tS,{})})}));
//# sourceMappingURL=index-DOpnh03Y.js.map
